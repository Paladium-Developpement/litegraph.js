{"version":3,"file":"litegraph.js","sources":["../src/litegraph.js","../src/LGraph.js","../src/LLink.js","../src/LGraphNode.js","../src/LGraphGroup.js","../src/litegraph-editor.js"],"sourcesContent":["// *************************************************************\n//   LiteGraph CLASS                                     *******\n// *************************************************************\n\n/**\n * The Global Scope. It contains all the registered node classes.\n *\n * @class LiteGraph\n * @constructor\n */\n\nlet LiteGraph = {\n    VERSION: 0.4,\n\n    CANVAS_GRID_SIZE: 10,\n\n    NODE_TITLE_HEIGHT: 30,\n    NODE_TITLE_TEXT_Y: 20,\n    NODE_SLOT_HEIGHT: 20,\n    NODE_WIDGET_HEIGHT: 20,\n    NODE_WIDTH: 140,\n    NODE_MIN_WIDTH: 50,\n    NODE_COLLAPSED_RADIUS: 10,\n    NODE_COLLAPSED_WIDTH: 80,\n    NODE_TITLE_COLOR: \"#999\",\n    NODE_SELECTED_TITLE_COLOR: \"#FFF\",\n    NODE_TEXT_SIZE: 14,\n    NODE_TEXT_COLOR: \"#AAA\",\n    NODE_SUBTEXT_SIZE: 12,\n    NODE_DEFAULT_COLOR: \"#333\",\n    NODE_DEFAULT_BGCOLOR: \"#353535\",\n    NODE_DEFAULT_BOXCOLOR: \"#666\",\n    NODE_DEFAULT_SHAPE: \"box\",\n    NODE_BOX_OUTLINE_COLOR: \"#FFF\",\n    DEFAULT_SHADOW_COLOR: \"rgba(0,0,0,0.5)\",\n    DEFAULT_GROUP_FONT: 24,\n\n    WIDGET_BGCOLOR: \"#222\",\n    WIDGET_OUTLINE_COLOR: \"#666\",\n    WIDGET_TEXT_COLOR: \"#DDD\",\n    WIDGET_SECONDARY_TEXT_COLOR: \"#999\",\n\n    LINK_COLOR: \"#9A9\",\n    EVENT_LINK_COLOR: \"#A86\",\n    CONNECTING_LINK_COLOR: \"#AFA\",\n\n    MAX_NUMBER_OF_NODES: 1000, // avoid infinite loops\n    DEFAULT_POSITION: [100, 100], // default node position\n    VALID_SHAPES: [\"default\", \"box\", \"round\", \"card\"], // ,\"circle\"\n\n    // shapes are used for nodes but also for slots\n    BOX_SHAPE: 1,\n    ROUND_SHAPE: 2,\n    CIRCLE_SHAPE: 3,\n    CARD_SHAPE: 4,\n    ARROW_SHAPE: 5,\n\n    // enums\n    INPUT: 1,\n    OUTPUT: 2,\n\n    EVENT: -1, // for outputs\n    ACTION: -1, // for inputs\n\n    ALWAYS: 0,\n    ON_EVENT: 1,\n    NEVER: 2,\n    ON_TRIGGER: 3,\n\n    UP: 1,\n    DOWN: 2,\n    LEFT: 3,\n    RIGHT: 4,\n    CENTER: 5,\n\n    STRAIGHT_LINK: 0,\n    LINEAR_LINK: 1,\n    SPLINE_LINK: 2,\n\n    NORMAL_TITLE: 0,\n    NO_TITLE: 1,\n    TRANSPARENT_TITLE: 2,\n    AUTOHIDE_TITLE: 3,\n\n    proxy: null, // used to redirect calls\n    node_images_path: \"\",\n\n    debug: false,\n    catch_exceptions: true,\n    throw_errors: true,\n    allow_scripts: false,\n    // if set to true some nodes like Formula would be allowed\n    // to evaluate code that comes from unsafe sources\n    // (like node configuration), which could lead to exploits\n    registered_node_types: {}, // nodetypes by string\n    node_types_by_file_extension: {}, // used for dropping files in the canvas\n    Nodes: {}, // node types by classname\n    Globals: {}, // used to store vars between graphs\n\n    searchbox_extras: {}, // used to add extra features to the search box\n    auto_sort_node_types: false,\n    // If set to true, will automatically sort node types / categories in the context menus\n\n    /**\n     * Register a node class so it can be listed when the user wants to create a new one\n     * @method registerNodeType\n     * @param {String} type name of the node and path\n     * @param {Class} base_class class containing the structure of a node\n     */\n\n    registerNodeType(type, base_class) {\n        if (!base_class.prototype) {\n            throw \"Cannot register a simple object, it must be a class with a prototype\";\n        }\n        base_class.type = type;\n\n        if (LiteGraph.debug) {\n            console.log(`Node registered: ${type}`);\n        }\n\n        const categories = type.split(\"/\");\n        const classname = base_class.name;\n\n        const pos = type.lastIndexOf(\"/\");\n        base_class.category = type.substr(0, pos);\n\n        if (!base_class.title) {\n            base_class.title = classname;\n        }\n        // info.name = name.substr(pos+1,name.length - pos);\n\n        // extend class\n        if (base_class.prototype) {\n            // is a class\n            for (var i in LGraphNode.prototype) {\n                if (!base_class.prototype[i]) {\n                    base_class.prototype[i] = LGraphNode.prototype[i];\n                }\n            }\n        }\n\n        const prev = this.registered_node_types[type];\n        if (prev) {\n            console.log(`replacing node type: ${type}`);\n        } else {\n            if (!Object.hasOwnProperty(base_class.prototype, \"shape\")) {\n                Object.defineProperty(base_class.prototype, \"shape\", {\n                    set(v) {\n                        switch (v) {\n                            case \"default\":\n                                delete this._shape;\n                                break;\n                            case \"box\":\n                                this._shape = LiteGraph.BOX_SHAPE;\n                                break;\n                            case \"round\":\n                                this._shape = LiteGraph.ROUND_SHAPE;\n                                break;\n                            case \"circle\":\n                                this._shape = LiteGraph.CIRCLE_SHAPE;\n                                break;\n                            case \"card\":\n                                this._shape = LiteGraph.CARD_SHAPE;\n                                break;\n                            default:\n                                this._shape = v;\n                        }\n                    },\n                    get(v) {\n                        return this._shape;\n                    },\n                    enumerable: true,\n                    configurable: true,\n                });\n            }\n\n            // warnings\n            if (base_class.prototype.onPropertyChange) {\n                console.warn(\n                    `LiteGraph node class ${\n                        type\n                    } has onPropertyChange method, it must be called onPropertyChanged with d at the end`,\n                );\n            }\n\n            // used to know which nodes create when dragging files to the canvas\n            if (base_class.supported_extensions) {\n                for (var i in base_class.supported_extensions) {\n                    var ext = base_class.supported_extensions[i];\n                    if (ext && ext.constructor === String) this.node_types_by_file_extension[ext.toLowerCase()] = base_class;\n                }\n            }\n        }\n\n        this.registered_node_types[type] = base_class;\n        if (base_class.constructor.name) {\n            this.Nodes[classname] = base_class;\n        }\n        if (LiteGraph.onNodeTypeRegistered) {\n            LiteGraph.onNodeTypeRegistered(type, base_class);\n        }\n        if (prev && LiteGraph.onNodeTypeReplaced) {\n            LiteGraph.onNodeTypeReplaced(type, base_class, prev);\n        }\n\n        // warnings\n        if (base_class.prototype.onPropertyChange) {\n            console.warn(\n                `LiteGraph node class ${\n                    type\n                } has onPropertyChange method, it must be called onPropertyChanged with d at the end`,\n            );\n        }\n\n        // used to know which nodes create when dragging files to the canvas\n        if (base_class.supported_extensions) {\n            for (var i = 0; i < base_class.supported_extensions.length; i++) {\n                var ext = base_class.supported_extensions[i];\n                if (ext && ext.constructor === String) this.node_types_by_file_extension[ext.toLowerCase()] = base_class;\n            }\n        }\n    },\n\n    /**\n     * removes a node type from the system\n     * @method unregisterNodeType\n     * @param {String|Object} type name of the node or the node constructor itself\n     */\n    unregisterNodeType(type) {\n        const base_class = type.constructor === String ? this.registered_node_types[type] : type;\n        if (!base_class) throw (`node type not found: ${type}`);\n        delete this.registered_node_types[base_class.type];\n        if (base_class.constructor.name) delete this.Nodes[base_class.constructor.name];\n    },\n\n    /**\n     * Create a new nodetype by passing a function, it wraps it with a proper class and\n     * generates inputs according to the parameters of the function. Useful to wrap simple\n     * methods that do not require properties, and that only process some input to generate an\n     * output.\n     * @method wrapFunctionAsNode\n     * @param {String} name node name with namespace (p.e.: 'math/sum')\n     * @param {Function} func\n     * @param {Array} param_types [optional] an array containing the type of every parameter,\n     *     otherwise parameters will accept any type\n     * @param {String} return_type [optional] string with the return type, otherwise it will be\n     *     generic\n     * @param {Object} properties [optional] properties to be configurable\n     */\n    wrapFunctionAsNode(\n        name,\n        func,\n        param_types,\n        return_type,\n        properties,\n    ) {\n        const params = Array(func.length);\n        let code = \"\";\n        const names = LiteGraph.getParameterNames(func);\n        for (let i = 0; i < names.length; ++i) {\n            code\n                += `this.addInput('${\n                    names[i]\n                }',${\n                    param_types && param_types[i]\n                        ? `'${param_types[i]}'`\n                        : \"0\"\n                });\\n`;\n        }\n        code\n            += `this.addOutput('out',${\n                return_type ? `'${return_type}'` : 0\n            });\\n`;\n        if (properties) {\n            code\n                += `this.properties = ${JSON.stringify(properties)};\\n`;\n        }\n        const classobj = Function(code);\n        classobj.title = name.split(\"/\")\n            .pop();\n        classobj.desc = `Generated from ${func.name}`;\n        classobj.prototype.onExecute = function onExecute() {\n            for (let i = 0; i < params.length; ++i) {\n                params[i] = this.getInputData(i);\n            }\n            const r = func.apply(this, params);\n            this.setOutputData(0, r);\n        };\n        this.registerNodeType(name, classobj);\n    },\n\n    /**\n     * Removes all previously registered node's types\n     */\n    clearRegisteredTypes() {\n        this.registered_node_types = {};\n        this.node_types_by_file_extension = {};\n        this.Nodes = {};\n        this.searchbox_extras = {};\n    },\n\n    /**\n     * Adds this method to all nodetypes, existing and to be created\n     * (You can add it to LGraphNode.prototype but then existing node types wont have it)\n     * @method addNodeMethod\n     * @param {Function} func\n     */\n    addNodeMethod(name, func) {\n        LGraphNode.prototype[name] = func;\n        for (const i in this.registered_node_types) {\n            const type = this.registered_node_types[i];\n            if (type.prototype[name]) {\n                type.prototype[`_${name}`] = type.prototype[name];\n            } // keep old in case of replacing\n            type.prototype[name] = func;\n        }\n    },\n\n    /**\n     * Create a node of a given type with a name. The node is not attached to any graph yet.\n     * @method createNode\n     * @param {String} type full name of the node class. p.e. \"math/sin\"\n     * @param {String} name a name to distinguish from other nodes\n     * @param {Object} options to set options\n     */\n\n    createNode(type, title, options) {\n        const base_class = this.registered_node_types[type];\n        if (!base_class) {\n            if (LiteGraph.debug) {\n                console.log(\n                    `GraphNode type \"${type}\" not registered.`,\n                );\n            }\n            return null;\n        }\n\n        const prototype = base_class.prototype || base_class;\n\n        title = title || base_class.title || type;\n\n        let node = null;\n\n        if (LiteGraph.catch_exceptions) {\n            try {\n                node = new base_class(title);\n            } catch (err) {\n                console.error(err);\n                return null;\n            }\n        } else {\n            node = new base_class(title);\n        }\n\n        node.type = type;\n\n        if (!node.title && title) {\n            node.title = title;\n        }\n        if (!node.properties) {\n            node.properties = {};\n        }\n        if (!node.properties_info) {\n            node.properties_info = [];\n        }\n        if (!node.flags) {\n            node.flags = {};\n        }\n        if (!node.size) {\n            node.size = node.computeSize();\n            // call onresize?\n        }\n        if (!node.pos) {\n            node.pos = LiteGraph.DEFAULT_POSITION.concat();\n        }\n        if (!node.mode) {\n            node.mode = LiteGraph.ALWAYS;\n        }\n\n        // extra options\n        if (options) {\n            for (const i in options) {\n                node[i] = options[i];\n            }\n        }\n\n        return node;\n    },\n\n    /**\n     * Returns a registered node type with a given name\n     * @method getNodeType\n     * @param {String} type full name of the node class. p.e. \"math/sin\"\n     * @return {Class} the node class\n     */\n    getNodeType(type) {\n        return this.registered_node_types[type];\n    },\n\n    /**\n     * Returns a list of node types matching one category\n     * @method getNodeType\n     * @param {String} category category name\n     * @return {Array} array with all the node classes\n     */\n\n    getNodeTypesInCategory(category, filter) {\n        const r = [];\n        for (const i in this.registered_node_types) {\n            const type = this.registered_node_types[i];\n            if (type.filter != filter) {\n                continue;\n            }\n\n            if (category == \"\") {\n                if (type.category == null) {\n                    r.push(type);\n                }\n            } else if (type.category == category) {\n                r.push(type);\n            }\n        }\n\n        return this.auto_sort_node_types ? r.sort() : r;\n    },\n\n    /**\n     * Returns a list with all the node type categories\n     * @method getNodeTypesCategories\n     * @param {String} filter only nodes with ctor.filter equal can be shown\n     * @return {Array} array with all the names of the categories\n     */\n    getNodeTypesCategories(filter) {\n        const categories = { \"\": 1 };\n        for (var i in this.registered_node_types) {\n            const type = this.registered_node_types[i];\n            if (type.category && !type.skip_list) {\n                if (type.filter != filter) continue;\n                categories[type.category] = 1;\n            }\n        }\n        const result = [];\n        for (var i in categories) {\n            result.push(i);\n        }\n        return this.auto_sort_node_types ? result.sort() : result;\n    },\n\n    // debug purposes: reloads all the js scripts that matches a wildcard\n    reloadNodes(folder_wildcard) {\n        const tmp = document.getElementsByTagName(\"script\");\n        // weird, this array changes by its own, so we use a copy\n        const script_files = [];\n        for (var i = 0; i < tmp.length; i++) {\n            script_files.push(tmp[i]);\n        }\n\n        const docHeadObj = document.getElementsByTagName(\"head\")[0];\n        folder_wildcard = document.location.href + folder_wildcard;\n\n        for (var i = 0; i < script_files.length; i++) {\n            const { src } = script_files[i];\n            if (\n                !src\n                || src.substr(0, folder_wildcard.length) != folder_wildcard\n            ) {\n                continue;\n            }\n\n            try {\n                if (LiteGraph.debug) {\n                    console.log(`Reloading: ${src}`);\n                }\n                const dynamicScript = document.createElement(\"script\");\n                dynamicScript.type = \"text/javascript\";\n                dynamicScript.src = src;\n                docHeadObj.appendChild(dynamicScript);\n                docHeadObj.removeChild(script_files[i]);\n            } catch (err) {\n                if (LiteGraph.throw_errors) {\n                    throw err;\n                }\n                if (LiteGraph.debug) {\n                    console.log(`Error while reloading ${src}`);\n                }\n            }\n        }\n\n        if (LiteGraph.debug) {\n            console.log(\"Nodes reloaded\");\n        }\n    },\n\n    // separated just to improve if it doesn't work\n    cloneObject(obj, target) {\n        if (obj == null) {\n            return null;\n        }\n        const r = JSON.parse(JSON.stringify(obj));\n        if (!target) {\n            return r;\n        }\n\n        for (const i in r) {\n            target[i] = r[i];\n        }\n        return target;\n    },\n\n    /**\n     * Returns if the types of two slots are compatible (taking into account wildcards, etc)\n     * @method isValidConnection\n     * @param {String} type_a\n     * @param {String} type_b\n     * @return {Boolean} true if they can be connected\n     */\n    isValidConnection(type_a, type_b) {\n        if (\n            !type_a // generic output\n            || !type_b // generic input\n            || type_a == type_b // same type (is valid for triggers)\n            || (type_a == LiteGraph.EVENT && type_b == LiteGraph.ACTION)\n        ) {\n            return true;\n        }\n\n        // Enforce string type to handle toLowerCase call (-1 number not ok)\n        type_a = String(type_a);\n        type_b = String(type_b);\n        type_a = type_a.toLowerCase();\n        type_b = type_b.toLowerCase();\n\n        // For nodes supporting multiple connection types\n        if (type_a.indexOf(\",\") == -1 && type_b.indexOf(\",\") == -1) {\n            return type_a == type_b;\n        }\n\n        // Check all permutations to see if one is valid\n        const supported_types_a = type_a.split(\",\");\n        const supported_types_b = type_b.split(\",\");\n        for (let i = 0; i < supported_types_a.length; ++i) {\n            for (let j = 0; j < supported_types_b.length; ++j) {\n                if (supported_types_a[i] == supported_types_b[j]) {\n                    return true;\n                }\n            }\n        }\n\n        return false;\n    },\n\n    /**\n     * Register a string in the search box so when the user types it it will recommend this node\n     * @method registerSearchboxExtra\n     * @param {String} node_type the node recommended\n     * @param {String} description text to show next to it\n     * @param {Object} data it could contain info of how the node should be configured\n     * @return {Boolean} true if they can be connected\n     */\n    registerSearchboxExtra(node_type, description, data) {\n        this.searchbox_extras[description.toLowerCase()] = {\n            type: node_type,\n            desc: description,\n            data,\n        };\n    },\n\n    /**\n     * Wrapper to load files (from url using fetch or from file using FileReader)\n     * @method fetchFile\n     * @param {String|File|Blob} url the url of the file (or the file itself)\n     * @param {String} type an string to know how to fetch it:\n     *     \"text\",\"arraybuffer\",\"json\",\"blob\"\n     * @param {Function} on_complete callback(data)\n     * @param {Function} on_error in case of an error\n     * @return {FileReader|Promise} returns the object used to\n     */\n    fetchFile(url, type, on_complete, on_error) {\n        const that = this;\n        if (!url) return null;\n\n        type = type || \"text\";\n        if (url.constructor === String) {\n            if (url.substr(0, 4) == \"http\" && LiteGraph.proxy) {\n                url = LiteGraph.proxy + url.substr(url.indexOf(\":\") + 3);\n            }\n            return fetch(url)\n                .then((response) => {\n                    if (!response.ok) throw new Error(\"File not found\"); // it will be catch\n                    // below\n                    if (type == \"arraybuffer\") return response.arrayBuffer();\n                    if (type == \"text\" || type == \"string\") return response.text();\n                    if (type == \"json\") return response.json();\n                    if (type == \"blob\") return response.blob();\n                })\n                .then((data) => {\n                    if (on_complete) on_complete(data);\n                })\n                .catch((error) => {\n                    console.error(\"error fetching file:\", url);\n                    if (on_error) on_error(error);\n                });\n        }\n        if (url.constructor === File || url.constructor === Blob) {\n            const reader = new FileReader();\n            reader.onload = function (e) {\n                let v = e.target.result;\n                if (type == \"json\") v = JSON.parse(v);\n                if (on_complete) on_complete(v);\n            };\n            if (type == \"arraybuffer\") return reader.readAsArrayBuffer(url);\n            if (type == \"text\" || type == \"json\") return reader.readAsText(url);\n            if (type == \"blob\") return reader.readAsBinaryString(url);\n        }\n        return null;\n    },\n};\n\n// timer that works everywhere\nif (performance) {\n    LiteGraph.getTime = performance.now.bind(performance);\n} else if (Date && Date.now) {\n    LiteGraph.getTime = Date.now.bind(Date);\n} else if (process) {\n    LiteGraph.getTime = () => {\n        const t = process.hrtime();\n        return t[0] * 0.001 + t[1] * 1e-6;\n    };\n} else {\n    LiteGraph.getTime = function getTime() {\n        return new Date().getTime();\n    };\n}\n//* ***************************************\n\n// Scale and Offset\nfunction DragAndScale(element, skip_events) {\n    this.offset = new Float32Array([0, 0]);\n    this.scale = 1;\n    this.max_scale = 10;\n    this.min_scale = 0.1;\n    this.onredraw = null;\n    this.enabled = true;\n    this.last_mouse = [0, 0];\n    this.element = null;\n    this.visible_area = new Float32Array(4);\n\n    if (element) {\n        this.element = element;\n        if (!skip_events) {\n            this.bindEvents(element);\n        }\n    }\n}\n\nLiteGraph.DragAndScale = DragAndScale;\n\nDragAndScale.prototype.bindEvents = function (element) {\n    this.last_mouse = new Float32Array(2);\n\n    this._binded_mouse_callback = this.onMouse.bind(this);\n\n    element.addEventListener(\"mousedown\", this._binded_mouse_callback);\n    element.addEventListener(\"mousemove\", this._binded_mouse_callback);\n\n    element.addEventListener(\n        \"mousewheel\",\n        this._binded_mouse_callback,\n        false,\n    );\n    element.addEventListener(\"wheel\", this._binded_mouse_callback, false);\n};\n\nDragAndScale.prototype.computeVisibleArea = function () {\n    if (!this.element) {\n        this.visible_area[0] = this.visible_area[1] = this.visible_area[2] = this.visible_area[3] = 0;\n        return;\n    }\n    const { width } = this.element;\n    const { height } = this.element;\n    const startx = -this.offset[0];\n    const starty = -this.offset[1];\n    const endx = startx + width / this.scale;\n    const endy = starty + height / this.scale;\n    this.visible_area[0] = startx;\n    this.visible_area[1] = starty;\n    this.visible_area[2] = endx - startx;\n    this.visible_area[3] = endy - starty;\n};\n\nDragAndScale.prototype.onMouse = function (e) {\n    if (!this.enabled) {\n        return;\n    }\n\n    const canvas = this.element;\n    const rect = canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    e.canvasx = x;\n    e.canvasy = y;\n    e.dragging = this.dragging;\n\n    let ignore = false;\n    if (this.onmouse) {\n        ignore = this.onmouse(e);\n    }\n\n    if (e.type == \"mousedown\") {\n        this.dragging = true;\n        canvas.removeEventListener(\n            \"mousemove\",\n            this._binded_mouse_callback,\n        );\n        document.body.addEventListener(\n            \"mousemove\",\n            this._binded_mouse_callback,\n        );\n        document.body.addEventListener(\n            \"mouseup\",\n            this._binded_mouse_callback,\n        );\n    } else if (e.type == \"mousemove\") {\n        if (!ignore) {\n            const deltax = x - this.last_mouse[0];\n            const deltay = y - this.last_mouse[1];\n            if (this.dragging) {\n                this.mouseDrag(deltax, deltay);\n            }\n        }\n    } else if (e.type == \"mouseup\") {\n        this.dragging = false;\n        document.body.removeEventListener(\n            \"mousemove\",\n            this._binded_mouse_callback,\n        );\n        document.body.removeEventListener(\n            \"mouseup\",\n            this._binded_mouse_callback,\n        );\n        canvas.addEventListener(\"mousemove\", this._binded_mouse_callback);\n    } else if (\n        e.type == \"mousewheel\"\n        || e.type == \"wheel\"\n        || e.type == \"DOMMouseScroll\"\n    ) {\n        e.eventType = \"mousewheel\";\n        if (e.type == \"wheel\") {\n            e.wheel = -e.deltaY;\n        } else {\n            e.wheel = e.wheelDeltaY != null ? e.wheelDeltaY : e.detail * -60;\n        }\n\n        // from stack overflow\n        e.delta = e.wheelDelta\n            ? e.wheelDelta / 40\n            : e.deltaY\n                ? -e.deltaY / 3\n                : 0;\n        this.changeDeltaScale(1.0 + e.delta * 0.05);\n    }\n\n    this.last_mouse[0] = x;\n    this.last_mouse[1] = y;\n\n    e.preventDefault();\n    e.stopPropagation();\n    return false;\n};\n\nDragAndScale.prototype.toCanvasContext = function (ctx) {\n    ctx.scale(this.scale, this.scale);\n    ctx.translate(this.offset[0], this.offset[1]);\n};\n\nDragAndScale.prototype.convertOffsetToCanvas = function (pos) {\n    // return [pos[0] / this.scale - this.offset[0], pos[1] / this.scale - this.offset[1]];\n    return [\n        (pos[0] + this.offset[0]) * this.scale,\n        (pos[1] + this.offset[1]) * this.scale,\n    ];\n};\n\nDragAndScale.prototype.convertCanvasToOffset = function (pos, out) {\n    out = out || [0, 0];\n    out[0] = pos[0] / this.scale - this.offset[0];\n    out[1] = pos[1] / this.scale - this.offset[1];\n    return out;\n};\n\nDragAndScale.prototype.mouseDrag = function (x, y) {\n    this.offset[0] += x / this.scale;\n    this.offset[1] += y / this.scale;\n\n    if (this.onredraw) {\n        this.onredraw(this);\n    }\n};\n\nDragAndScale.prototype.changeScale = function (value, zooming_center) {\n    if (value < this.min_scale) {\n        value = this.min_scale;\n    } else if (value > this.max_scale) {\n        value = this.max_scale;\n    }\n\n    if (value == this.scale) {\n        return;\n    }\n\n    if (!this.element) {\n        return;\n    }\n\n    const rect = this.element.getBoundingClientRect();\n    if (!rect) {\n        return;\n    }\n\n    zooming_center = zooming_center || [\n        rect.width * 0.5,\n        rect.height * 0.5,\n    ];\n    const center = this.convertCanvasToOffset(zooming_center);\n    this.scale = value;\n    if (Math.abs(this.scale - 1) < 0.01) {\n        this.scale = 1;\n    }\n\n    const new_center = this.convertCanvasToOffset(zooming_center);\n    const delta_offset = [\n        new_center[0] - center[0],\n        new_center[1] - center[1],\n    ];\n\n    this.offset[0] += delta_offset[0];\n    this.offset[1] += delta_offset[1];\n\n    if (this.onredraw) {\n        this.onredraw(this);\n    }\n};\n\nDragAndScale.prototype.changeDeltaScale = function (value, zooming_center) {\n    this.changeScale(this.scale * value, zooming_center);\n};\n\nDragAndScale.prototype.reset = function () {\n    this.scale = 1;\n    this.offset[0] = 0;\n    this.offset[1] = 0;\n};\n\n//* ********************************************************************************\n// LGraphCanvas: LGraph renderer CLASS\n//* ********************************************************************************\n\n/**\n * This class is in charge of rendering one graph inside a canvas. And provides all the\n * interaction required. Valid callbacks are: onNodeSelected, onNodeDeselected,\n * onShowNodePanel, onNodeDblClicked\n *\n * @class LGraphCanvas\n * @constructor\n * @param {HTMLCanvas} canvas the canvas where you want to render (it accepts a selector in\n *     string format or the canvas element itself)\n * @param {LGraph} graph [optional]\n * @param {Object} options [optional] { skip_rendering, autoresize }\n */\nfunction LGraphCanvas(canvas, graph, options) {\n    options = options || {};\n\n    // if(graph === undefined)\n    //\tthrow (\"No graph assigned\");\n    this.background_image = LGraphCanvas.DEFAULT_BACKGROUND_IMAGE;\n\n    if (canvas && canvas.constructor === String) {\n        canvas = document.querySelector(canvas);\n    }\n\n    this.ds = new DragAndScale();\n    this.zoom_modify_alpha = true; // otherwise it generates ugly patterns when scaling down\n    // too much\n\n    this.title_text_font = `${LiteGraph.NODE_TEXT_SIZE}px Arial`;\n    this.inner_text_font = `normal ${LiteGraph.NODE_SUBTEXT_SIZE}px Arial`;\n    this.node_title_color = LiteGraph.NODE_TITLE_COLOR;\n    this.default_link_color = LiteGraph.LINK_COLOR;\n    this.default_connection_color = {\n        input_off: \"#778\",\n        input_on: \"#7F7\",\n        output_off: \"#778\",\n        output_on: \"#7F7\",\n    };\n\n    this.highquality_render = true;\n    this.use_gradients = false; // set to true to render titlebar with gradients\n    this.editor_alpha = 1; // used for transition\n    this.pause_rendering = false;\n    this.clear_background = true;\n\n    this.read_only = false; // if set to true users cannot modify the graph\n    this.render_only_selected = true;\n    this.live_mode = false;\n    this.show_info = true;\n    this.allow_dragcanvas = true;\n    this.allow_dragnodes = true;\n    this.allow_interaction = true; // allow to control widgets, buttons, collapse, etc\n    this.allow_searchbox = true;\n    this.allow_reconnect_links = false; // allows to change a connection with having to redo it\n    // again\n\n    this.drag_mode = false;\n    this.dragging_rectangle = null;\n\n    this.filter = null; // allows to filter to only accept some type of nodes in a graph\n\n    this.set_canvas_dirty_on_mouse_event = true; // forces to redraw the canvas if the mouse\n    // does anything\n    this.always_render_background = false;\n    this.render_shadows = true;\n    this.render_canvas_border = true;\n    this.render_connections_shadows = false; // too much cpu\n    this.render_connections_border = true;\n    this.render_curved_connections = false;\n    this.render_connection_arrows = false;\n    this.render_collapsed_slots = true;\n    this.render_execution_order = false;\n    this.render_title_colored = true;\n    this.render_link_tooltip = true;\n\n    this.links_render_mode = LiteGraph.SPLINE_LINK;\n\n    this.mouse = [0, 0]; // mouse in canvas coordinates, where 0,0 is the top-left corner of\n    // the blue rectangle\n    this.graph_mouse = [0, 0]; // mouse in graph coordinates, where 0,0 is the top-left corner\n    // of the blue rectangle\n    this.canvas_mouse = this.graph_mouse; // LEGACY: REMOVE THIS, USE GRAPH_MOUSE INSTEAD\n\n    // to personalize the search box\n    this.onSearchBox = null;\n    this.onSearchBoxSelection = null;\n\n    // callbacks\n    this.onMouse = null;\n    this.onDrawBackground = null; // to render background objects (behind nodes and\n    // connections) in the canvas affected by transform\n    this.onDrawForeground = null; // to render foreground objects (above nodes and connections)\n    // in the canvas affected by transform\n    this.onDrawOverlay = null; // to render foreground objects not affected by transform (for\n    // GUIs)\n    this.onDrawLinkTooltip = null; // called when rendering a tooltip\n    this.onNodeMoved = null; // called after moving a node\n    this.onSelectionChange = null; // called if the selection changes\n    this.onConnectingChange = null; // called before any link changes\n    this.onBeforeChange = null; // called before modifying the graph\n    this.onAfterChange = null; // called after modifying the graph\n\n    this.connections_width = 3;\n    this.round_radius = 8;\n\n    this.current_node = null;\n    this.node_widget = null; // used for widgets\n    this.over_link_center = null;\n    this.last_mouse_position = [0, 0];\n    this.visible_area = this.ds.visible_area;\n    this.visible_links = [];\n\n    // link canvas and graph\n    if (graph) {\n        graph.attachCanvas(this);\n    }\n\n    this.setCanvas(canvas);\n    this.clear();\n\n    if (!options.skip_render) {\n        this.startRendering();\n    }\n\n    this.autoresize = options.autoresize;\n}\n\nLGraphCanvas = LiteGraph.LGraphCanvas = LGraphCanvas;\n\nLGraphCanvas.DEFAULT_BACKGROUND_IMAGE = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQBJREFUeNrs1rEKwjAUhlETUkj3vP9rdmr1Ysammk2w5wdxuLgcMHyptfawuZX4pJSWZTnfnu/lnIe/jNNxHHGNn//HNbbv+4dr6V+11uF527arU7+u63qfa/bnmh8sWLBgwYJlqRf8MEptXPBXJXa37BSl3ixYsGDBMliwFLyCV/DeLIMFCxYsWLBMwSt4Be/NggXLYMGCBUvBK3iNruC9WbBgwYJlsGApeAWv4L1ZBgsWLFiwYJmCV/AK3psFC5bBggULloJX8BpdwXuzYMGCBctgwVLwCl7Be7MMFixYsGDBsu8FH1FaSmExVfAxBa/gvVmwYMGCZbBg/W4vAQYA5tRF9QYlv/QAAAAASUVORK5CYII=\";\n\nLGraphCanvas.link_type_colors = {\n    \"-1\": LiteGraph.EVENT_LINK_COLOR,\n    number: \"#AAA\",\n    node: \"#DCA\",\n};\nLGraphCanvas.gradients = {}; // cache of gradients\n\n/**\n * clears all the data inside\n *\n * @method clear\n */\nLGraphCanvas.prototype.clear = function () {\n    this.frame = 0;\n    this.last_draw_time = 0;\n    this.render_time = 0;\n    this.fps = 0;\n\n    // this.scale = 1;\n    // this.offset = [0,0];\n\n    this.dragging_rectangle = null;\n\n    this.selected_nodes = {};\n    this.selected_group = null;\n\n    this.visible_nodes = [];\n    this.node_dragged = null;\n    this.node_over = null;\n    this.node_capturing_input = null;\n    this.connecting_node = null;\n    this.highlighted_links = {};\n\n    this.dragging_canvas = false;\n\n    this.dirty_canvas = true;\n    this.dirty_bgcanvas = true;\n    this.dirty_area = null;\n\n    this.node_in_panel = null;\n    this.node_widget = null;\n\n    this.last_mouse = [0, 0];\n    this.last_mouseclick = 0;\n    this.visible_area.set([0, 0, 0, 0]);\n\n    if (this.onClear) {\n        this.onClear();\n    }\n};\n\n/**\n * assigns a graph, you can reassign graphs to the same canvas\n *\n * @method setGraph\n * @param {LGraph} graph\n */\nLGraphCanvas.prototype.setGraph = function (graph, skip_clear) {\n    if (this.graph == graph) {\n        return;\n    }\n\n    if (!skip_clear) {\n        this.clear();\n    }\n\n    if (!graph && this.graph) {\n        this.graph.detachCanvas(this);\n        return;\n    }\n\n    graph.attachCanvas(this);\n\n    // remove the graph stack in case a subgraph was open\n    if (this._graph_stack) this._graph_stack = null;\n\n    this.setDirty(true, true);\n};\n\n/**\n * returns the top level graph (in case there are subgraphs open on the canvas)\n *\n * @method getTopGraph\n * @return {LGraph} graph\n */\nLGraphCanvas.prototype.getTopGraph = function () {\n    if (this._graph_stack.length) return this._graph_stack[0];\n    return this.graph;\n};\n\n/**\n * opens a graph contained inside a node in the current graph\n *\n * @method openSubgraph\n * @param {LGraph} graph\n */\nLGraphCanvas.prototype.openSubgraph = function (graph) {\n    if (!graph) {\n        throw \"graph cannot be null\";\n    }\n\n    if (this.graph == graph) {\n        throw \"graph cannot be the same\";\n    }\n\n    this.clear();\n\n    if (this.graph) {\n        if (!this._graph_stack) {\n            this._graph_stack = [];\n        }\n        this._graph_stack.push(this.graph);\n    }\n\n    graph.attachCanvas(this);\n    this.checkPanels();\n    this.setDirty(true, true);\n};\n\n/**\n * closes a subgraph contained inside a node\n *\n * @method closeSubgraph\n * @param {LGraph} assigns a graph\n */\nLGraphCanvas.prototype.closeSubgraph = function () {\n    if (!this._graph_stack || this._graph_stack.length == 0) {\n        return;\n    }\n    const subgraph_node = this.graph._subgraph_node;\n    const graph = this._graph_stack.pop();\n    this.selected_nodes = {};\n    this.highlighted_links = {};\n    graph.attachCanvas(this);\n    this.setDirty(true, true);\n    if (subgraph_node) {\n        this.centerOnNode(subgraph_node);\n        this.selectNodes([subgraph_node]);\n    }\n};\n\n/**\n * returns the visualy active graph (in case there are more in the stack)\n * @method getCurrentGraph\n * @return {LGraph} the active graph\n */\nLGraphCanvas.prototype.getCurrentGraph = function () {\n    return this.graph;\n};\n\n/**\n * assigns a canvas\n *\n * @method setCanvas\n * @param {Canvas} assigns a canvas (also accepts the ID of the element (not a selector)\n */\nLGraphCanvas.prototype.setCanvas = function (canvas, skip_events) {\n    const that = this;\n\n    if (canvas) {\n        if (canvas.constructor === String) {\n            canvas = document.getElementById(canvas);\n            if (!canvas) {\n                throw \"Error creating LiteGraph canvas: Canvas not found\";\n            }\n        }\n    }\n\n    if (canvas === this.canvas) {\n        return;\n    }\n\n    if (!canvas && this.canvas) {\n        // maybe detach events from old_canvas\n        if (!skip_events) {\n            this.unbindEvents();\n        }\n    }\n\n    this.canvas = canvas;\n    this.ds.element = canvas;\n\n    if (!canvas) {\n        return;\n    }\n\n    // this.canvas.tabindex = \"1000\";\n    canvas.className += \" lgraphcanvas\";\n    canvas.data = this;\n    canvas.tabindex = \"1\"; // to allow key events\n\n    // bg canvas: used for non changing stuff\n    this.bgcanvas = null;\n    if (!this.bgcanvas) {\n        this.bgcanvas = document.createElement(\"canvas\");\n        this.bgcanvas.width = this.canvas.width;\n        this.bgcanvas.height = this.canvas.height;\n    }\n\n    if (canvas.getContext == null) {\n        if (canvas.localName != \"canvas\") {\n            throw `Element supplied for LGraphCanvas must be a <canvas> element, you passed a ${\n                canvas.localName}`;\n        }\n        throw \"This browser doesn't support Canvas\";\n    }\n\n    const ctx = (this.ctx = canvas.getContext(\"2d\"));\n    if (ctx == null) {\n        if (!canvas.webgl_enabled) {\n            console.warn(\n                \"This canvas seems to be WebGL, enabling WebGL renderer\",\n            );\n        }\n        this.enableWebGL();\n    }\n\n    // input:  (move and up could be unbinded)\n    this._mousemove_callback = this.processMouseMove.bind(this);\n    this._mouseup_callback = this.processMouseUp.bind(this);\n\n    if (!skip_events) {\n        this.bindEvents();\n    }\n};\n\n// used in some events to capture them\nLGraphCanvas.prototype._doNothing = function doNothing(e) {\n    e.preventDefault();\n    return false;\n};\nLGraphCanvas.prototype._doReturnTrue = function doNothing(e) {\n    e.preventDefault();\n    return true;\n};\n\n/**\n * binds mouse, keyboard, touch and drag events to the canvas\n * @method bindEvents\n * */\nLGraphCanvas.prototype.bindEvents = function () {\n    if (this._events_binded) {\n        console.warn(\"LGraphCanvas: events already binded\");\n        return;\n    }\n\n    const { canvas } = this;\n\n    const ref_window = this.getCanvasWindow();\n    const { document } = ref_window; // hack used when moving canvas between windows\n\n    this._mousedown_callback = this.processMouseDown.bind(this);\n    this._mousewheel_callback = this.processMouseWheel.bind(this);\n\n    canvas.addEventListener(\"mousedown\", this._mousedown_callback, true); // down do not need\n    // to store the\n    // binded\n    canvas.addEventListener(\"mousemove\", this._mousemove_callback);\n    canvas.addEventListener(\"mousewheel\", this._mousewheel_callback, false);\n\n    canvas.addEventListener(\"contextmenu\", this._doNothing);\n    canvas.addEventListener(\n        \"DOMMouseScroll\",\n        this._mousewheel_callback,\n        false,\n    );\n\n    // touch events\n    // if( 'touchstart' in document.documentElement )\n    {\n        canvas.addEventListener(\"touchstart\", this.touchHandler, true);\n        canvas.addEventListener(\"touchmove\", this.touchHandler, true);\n        canvas.addEventListener(\"touchend\", this.touchHandler, true);\n        canvas.addEventListener(\"touchcancel\", this.touchHandler, true);\n    }\n\n    // Keyboard ******************\n    this._key_callback = this.processKey.bind(this);\n\n    canvas.addEventListener(\"keydown\", this._key_callback, true);\n    document.addEventListener(\"keyup\", this._key_callback, true); // in document, otherwise it\n    // doesn't fire keyup\n\n    // Dropping Stuff over nodes ************************************\n    this._ondrop_callback = this.processDrop.bind(this);\n\n    canvas.addEventListener(\"dragover\", this._doNothing, false);\n    canvas.addEventListener(\"dragend\", this._doNothing, false);\n    canvas.addEventListener(\"drop\", this._ondrop_callback, false);\n    canvas.addEventListener(\"dragenter\", this._doReturnTrue, false);\n\n    this._events_binded = true;\n};\n\n/**\n * unbinds mouse events from the canvas\n * @method unbindEvents\n * */\nLGraphCanvas.prototype.unbindEvents = function () {\n    if (!this._events_binded) {\n        console.warn(\"LGraphCanvas: no events binded\");\n        return;\n    }\n\n    const ref_window = this.getCanvasWindow();\n    const { document } = ref_window;\n\n    this.canvas.removeEventListener(\"mousedown\", this._mousedown_callback);\n    this.canvas.removeEventListener(\n        \"mousewheel\",\n        this._mousewheel_callback,\n    );\n    this.canvas.removeEventListener(\n        \"DOMMouseScroll\",\n        this._mousewheel_callback,\n    );\n    this.canvas.removeEventListener(\"keydown\", this._key_callback);\n    document.removeEventListener(\"keyup\", this._key_callback);\n    this.canvas.removeEventListener(\"contextmenu\", this._doNothing);\n    this.canvas.removeEventListener(\"drop\", this._ondrop_callback);\n    this.canvas.removeEventListener(\"dragenter\", this._doReturnTrue);\n\n    this.canvas.removeEventListener(\"touchstart\", this.touchHandler);\n    this.canvas.removeEventListener(\"touchmove\", this.touchHandler);\n    this.canvas.removeEventListener(\"touchend\", this.touchHandler);\n    this.canvas.removeEventListener(\"touchcancel\", this.touchHandler);\n\n    this._mousedown_callback = null;\n    this._mousewheel_callback = null;\n    this._key_callback = null;\n    this._ondrop_callback = null;\n\n    this._events_binded = false;\n};\n\nLGraphCanvas.getFileExtension = function (url) {\n    const question = url.indexOf(\"?\");\n    if (question != -1) {\n        url = url.substr(0, question);\n    }\n    const point = url.lastIndexOf(\".\");\n    if (point == -1) {\n        return \"\";\n    }\n    return url.substr(point + 1)\n        .toLowerCase();\n};\n\n/**\n * this function allows to render the canvas using WebGL instead of Canvas2D\n * this is useful if you plant to render 3D objects inside your nodes, it uses litegl.js for\n * webgl and canvas2DtoWebGL to emulate the Canvas2D calls in webGL\n * @method enableWebGL\n * */\nLGraphCanvas.prototype.enableWebGL = function () {\n    if (typeof GL === undefined) {\n        throw \"litegl.js must be included to use a WebGL canvas\";\n    }\n    if (typeof enableWebGLCanvas === undefined) {\n        throw \"webglCanvas.js must be included to use this feature\";\n    }\n\n    this.gl = this.ctx = enableWebGLCanvas(this.canvas);\n    this.ctx.webgl = true;\n    this.bgcanvas = this.canvas;\n    this.bgctx = this.gl;\n    this.canvas.webgl_enabled = true;\n\n    /*\nGL.create({ canvas: this.bgcanvas });\nthis.bgctx = enableWebGLCanvas( this.bgcanvas );\nwindow.gl = this.gl;\n*/\n};\n\n/**\n * marks as dirty the canvas, this way it will be rendered again\n *\n * @class LGraphCanvas\n * @method setDirty\n * @param {bool} fgcanvas if the foreground canvas is dirty (the one containing the nodes)\n * @param {bool} bgcanvas if the background canvas is dirty (the one containing the wires)\n */\nLGraphCanvas.prototype.setDirty = function (fgcanvas, bgcanvas) {\n    if (fgcanvas) {\n        this.dirty_canvas = true;\n    }\n    if (bgcanvas) {\n        this.dirty_bgcanvas = true;\n    }\n};\n\n/**\n * Used to attach the canvas in a popup\n *\n * @method getCanvasWindow\n * @return {window} returns the window where the canvas is attached (the DOM root node)\n */\nLGraphCanvas.prototype.getCanvasWindow = function () {\n    if (!this.canvas) {\n        return window;\n    }\n    const doc = this.canvas.ownerDocument;\n    return doc.defaultView || doc.parentWindow;\n};\n\n/**\n * starts rendering the content of the canvas when needed\n *\n * @method startRendering\n */\nLGraphCanvas.prototype.startRendering = function () {\n    if (this.is_rendering) {\n        return;\n    } // already rendering\n\n    this.is_rendering = true;\n    renderFrame.call(this);\n\n    function renderFrame() {\n        if (!this.pause_rendering) {\n            this.draw();\n        }\n\n        const window = this.getCanvasWindow();\n        if (this.is_rendering) {\n            window.requestAnimationFrame(renderFrame.bind(this));\n        }\n    }\n};\n\n/**\n * stops rendering the content of the canvas (to save resources)\n *\n * @method stopRendering\n */\nLGraphCanvas.prototype.stopRendering = function () {\n    this.is_rendering = false;\n    /*\nif(this.rendering_timer_id)\n{\nclearInterval(this.rendering_timer_id);\nthis.rendering_timer_id = null;\n}\n*/\n};\n\n/* LiteGraphCanvas input */\n\n// used to block future mouse events (because of im gui)\nLGraphCanvas.prototype.blockClick = function () {\n    this.block_click = true;\n    this.last_mouseclick = 0;\n};\n\nLGraphCanvas.prototype.processMouseDown = function (e) {\n    if (this.set_canvas_dirty_on_mouse_event) this.dirty_canvas = true;\n\n    if (!this.graph) {\n        return;\n    }\n\n    this.adjustMouseEvent(e);\n\n    const ref_window = this.getCanvasWindow();\n    const { document } = ref_window;\n    LGraphCanvas.active_canvas = this;\n    var that = this;\n\n    // move mouse move event to the window in case it drags outside of the canvas\n    this.canvas.removeEventListener(\"mousemove\", this._mousemove_callback);\n    ref_window.document.addEventListener(\n        \"mousemove\",\n        this._mousemove_callback,\n        true,\n    ); // catch for the entire window\n    ref_window.document.addEventListener(\n        \"mouseup\",\n        this._mouseup_callback,\n        true,\n    );\n\n    const node = this.graph.getNodeOnPos(\n        e.canvasX,\n        e.canvasY,\n        this.visible_nodes,\n        5,\n    );\n    const skip_dragging = false;\n    let skip_action = false;\n    const now = LiteGraph.getTime();\n    const is_double_click = now - this.last_mouseclick < 300;\n    this.mouse[0] = e.localX;\n    this.mouse[1] = e.localY;\n    this.graph_mouse[0] = e.canvasX;\n    this.graph_mouse[1] = e.canvasY;\n    this.last_click_position = [this.mouse[0], this.mouse[1]];\n\n    this.canvas.focus();\n\n    LiteGraph.closeAllContextMenus(ref_window);\n\n    if (this.onMouse) {\n        if (this.onMouse(e) == true) return;\n    }\n\n    // left button mouse\n    if (e.which == 1) {\n        if (e.ctrlKey) {\n            this.dragging_rectangle = new Float32Array(4);\n            this.dragging_rectangle[0] = e.canvasX;\n            this.dragging_rectangle[1] = e.canvasY;\n            this.dragging_rectangle[2] = 1;\n            this.dragging_rectangle[3] = 1;\n            skip_action = true;\n        }\n\n        let clicking_canvas_bg = false;\n\n        // when clicked on top of a node\n        // and it is not interactive\n        if (node && this.allow_interaction && !skip_action && !this.read_only) {\n            if (!this.live_mode && !node.flags.pinned) {\n                this.bringToFront(node);\n            } // if it wasn't selected?\n\n            // not dragging mouse to connect two slots\n            if (\n                !this.connecting_node\n                && !node.flags.collapsed\n                && !this.live_mode\n            ) {\n                // Search for corner for resize\n                if (\n                    !skip_action\n                    && node.resizable !== false\n                    && isInsideRectangle(\n                        e.canvasX,\n                        e.canvasY,\n                        node.pos[0] + node.size[0] - 5,\n                        node.pos[1] + node.size[1] - 5,\n                        10,\n                        10,\n                    )\n                ) {\n                    this.graph.beforeChange();\n                    this.resizing_node = node;\n                    this.canvas.style.cursor = \"se-resize\";\n                    skip_action = true;\n                } else {\n                    // search for outputs\n                    if (node.outputs) {\n                        for (\n                            var i = 0, l = node.outputs.length;\n                            i < l;\n                            ++i\n                        ) {\n                            const output = node.outputs[i];\n                            var link_pos = node.getConnectionPos(false, i);\n                            if (\n                                isInsideRectangle(\n                                    e.canvasX,\n                                    e.canvasY,\n                                    link_pos[0] - 15,\n                                    link_pos[1] - 10,\n                                    30,\n                                    20,\n                                )\n                            ) {\n                                this.connecting_node = node;\n                                this.connecting_output = output;\n                                this.connecting_pos = node.getConnectionPos(false, i);\n                                this.connecting_slot = i;\n\n                                if (e.shiftKey) {\n                                    node.disconnectOutput(i);\n                                }\n\n                                if (is_double_click) {\n                                    if (node.onOutputDblClick) {\n                                        node.onOutputDblClick(i, e);\n                                    }\n                                } else if (node.onOutputClick) {\n                                    node.onOutputClick(i, e);\n                                }\n\n                                skip_action = true;\n                                break;\n                            }\n                        }\n                    }\n\n                    // search for inputs\n                    if (node.inputs) {\n                        for (\n                            var i = 0, l = node.inputs.length;\n                            i < l;\n                            ++i\n                        ) {\n                            const input = node.inputs[i];\n                            var link_pos = node.getConnectionPos(true, i);\n                            if (\n                                isInsideRectangle(\n                                    e.canvasX,\n                                    e.canvasY,\n                                    link_pos[0] - 15,\n                                    link_pos[1] - 10,\n                                    30,\n                                    20,\n                                )\n                            ) {\n                                if (is_double_click) {\n                                    if (node.onInputDblClick) {\n                                        node.onInputDblClick(i, e);\n                                    }\n                                } else if (node.onInputClick) {\n                                    node.onInputClick(i, e);\n                                }\n\n                                if (input.link !== null) {\n                                    const link_info = this.graph.links[\n                                        input.link\n                                    ]; // before disconnecting\n                                    node.disconnectInput(i);\n\n                                    if (\n                                        this.allow_reconnect_links\n                                        || e.shiftKey\n                                    ) {\n                                        this.connecting_node = this.graph._nodes_by_id[\n                                            link_info.origin_id\n                                        ];\n                                        this.connecting_slot = link_info.origin_slot;\n                                        this.connecting_output = this.connecting_node.outputs[\n                                            this.connecting_slot\n                                        ];\n                                        this.connecting_pos = this.connecting_node.getConnectionPos(false, this.connecting_slot);\n                                    }\n\n                                    this.dirty_bgcanvas = true;\n                                    skip_action = true;\n                                }\n                            }\n                        }\n                    }\n                } // not resizing\n            }\n\n            // it wasn't clicked on the links boxes\n            if (!skip_action) {\n                let block_drag_node = false;\n                const pos = [e.canvasX - node.pos[0], e.canvasY - node.pos[1]];\n\n                // widgets\n                const widget = this.processNodeWidgets(node, this.graph_mouse, e);\n                if (widget) {\n                    block_drag_node = true;\n                    this.node_widget = [node, widget];\n                }\n\n                // double clicking\n                if (is_double_click && this.selected_nodes[node.id]) {\n                    // double click node\n                    if (node.onDblClick) {\n                        node.onDblClick(e, pos, this);\n                    }\n                    this.processNodeDblClicked(node);\n                    block_drag_node = true;\n                }\n\n                // if do not capture mouse\n                if (node.onMouseDown && node.onMouseDown(e, pos, this)) {\n                    block_drag_node = true;\n                } else {\n                    // open subgraph button\n                    if (node.subgraph && !node.skip_subgraph_button) {\n                        if (!node.flags.collapsed && pos[0] > node.size[0] - LiteGraph.NODE_TITLE_HEIGHT && pos[1] < 0) {\n                            var that = this;\n                            setTimeout(() => {\n                                that.openSubgraph(node.subgraph);\n                            }, 10);\n                        }\n                    }\n\n                    if (this.live_mode) {\n                        clicking_canvas_bg = true;\n                        block_drag_node = true;\n                    }\n                }\n\n                if (!block_drag_node) {\n                    if (this.allow_dragnodes) {\n                        this.graph.beforeChange();\n                        this.node_dragged = node;\n                    }\n                    if (!this.selected_nodes[node.id]) {\n                        this.processNodeSelected(node, e);\n                    }\n                }\n\n                this.dirty_canvas = true;\n            }\n        } // clicked outside of nodes\n        else {\n            // search for link connector\n            if (!this.read_only) {\n                for (var i = 0; i < this.visible_links.length; ++i) {\n                    const link = this.visible_links[i];\n                    const center = link._pos;\n                    if (\n                        !center\n                        || e.canvasX < center[0] - 4\n                        || e.canvasX > center[0] + 4\n                        || e.canvasY < center[1] - 4\n                        || e.canvasY > center[1] + 4\n                    ) {\n                        continue;\n                    }\n                    // link clicked\n                    this.showLinkMenu(link, e);\n                    this.over_link_center = null; // clear tooltip\n                    break;\n                }\n            }\n\n            this.selected_group = this.graph.getGroupOnPos(e.canvasX, e.canvasY);\n            this.selected_group_resizing = false;\n            if (this.selected_group && !this.read_only) {\n                if (e.ctrlKey) {\n                    this.dragging_rectangle = null;\n                }\n\n                const dist = distance([e.canvasX, e.canvasY], [this.selected_group.pos[0] + this.selected_group.size[0], this.selected_group.pos[1] + this.selected_group.size[1]]);\n                if (dist * this.ds.scale < 10) {\n                    this.selected_group_resizing = true;\n                } else {\n                    this.selected_group.recomputeInsideNodes();\n                }\n            }\n\n            if (is_double_click && !this.read_only && this.allow_searchbox) {\n                this.showSearchBox(e);\n            }\n\n            clicking_canvas_bg = true;\n        }\n\n        if (!skip_action && clicking_canvas_bg && this.allow_dragcanvas) {\n            this.dragging_canvas = true;\n        }\n    } else if (e.which == 2) {\n        // middle button\n    } else if (e.which == 3) {\n        // right button\n        if (!this.read_only) this.processContextMenu(node, e);\n    }\n\n    // TODO\n    // if(this.node_selected != prev_selected)\n    //\tthis.onNodeSelectionChange(this.node_selected);\n\n    this.last_mouse[0] = e.localX;\n    this.last_mouse[1] = e.localY;\n    this.last_mouseclick = LiteGraph.getTime();\n    this.last_mouse_dragging = true;\n\n    /*\nif( (this.dirty_canvas || this.dirty_bgcanvas) && this.rendering_timer_id == null)\nthis.draw();\n*/\n\n    this.graph.change();\n\n    // this is to ensure to defocus(blur) if a text input element is on focus\n    if (\n        !ref_window.document.activeElement\n        || (ref_window.document.activeElement.nodeName.toLowerCase()\n        != \"input\"\n        && ref_window.document.activeElement.nodeName.toLowerCase()\n        != \"textarea\")\n    ) {\n        e.preventDefault();\n    }\n    e.stopPropagation();\n\n    if (this.onMouseDown) {\n        this.onMouseDown(e);\n    }\n\n    return false;\n};\n\n/**\n * Called when a mouse move event has to be processed\n * @method processMouseMove\n * */\nLGraphCanvas.prototype.processMouseMove = function (e) {\n    if (this.autoresize) {\n        this.resize();\n    }\n\n    if (this.set_canvas_dirty_on_mouse_event) this.dirty_canvas = true;\n\n    if (!this.graph) {\n        return;\n    }\n\n    LGraphCanvas.active_canvas = this;\n    this.adjustMouseEvent(e);\n    const mouse = [e.localX, e.localY];\n    this.mouse[0] = mouse[0];\n    this.mouse[1] = mouse[1];\n    const delta = [\n        mouse[0] - this.last_mouse[0],\n        mouse[1] - this.last_mouse[1],\n    ];\n    this.last_mouse = mouse;\n    this.graph_mouse[0] = e.canvasX;\n    this.graph_mouse[1] = e.canvasY;\n\n    if (this.block_click) {\n        e.preventDefault();\n        return false;\n    }\n\n    e.dragging = this.last_mouse_dragging;\n\n    if (this.node_widget) {\n        this.processNodeWidgets(\n            this.node_widget[0],\n            this.graph_mouse,\n            e,\n            this.node_widget[1],\n        );\n        this.dirty_canvas = true;\n    }\n\n    if (this.dragging_rectangle) {\n        this.dragging_rectangle[2] = e.canvasX - this.dragging_rectangle[0];\n        this.dragging_rectangle[3] = e.canvasY - this.dragging_rectangle[1];\n        this.dirty_canvas = true;\n    } else if (this.selected_group && !this.read_only) {\n        // moving/resizing a group\n        if (this.selected_group_resizing) {\n            this.selected_group.size = [\n                e.canvasX - this.selected_group.pos[0],\n                e.canvasY - this.selected_group.pos[1],\n            ];\n        } else {\n            const deltax = delta[0] / this.ds.scale;\n            const deltay = delta[1] / this.ds.scale;\n            this.selected_group.move(deltax, deltay, e.ctrlKey);\n            if (this.selected_group._nodes.length) {\n                this.dirty_canvas = true;\n            }\n        }\n        this.dirty_bgcanvas = true;\n    } else if (this.dragging_canvas) {\n        this.ds.offset[0] += delta[0] / this.ds.scale;\n        this.ds.offset[1] += delta[1] / this.ds.scale;\n        this.dirty_canvas = true;\n        this.dirty_bgcanvas = true;\n    } else if (this.allow_interaction && !this.read_only) {\n        if (this.connecting_node) {\n            this.dirty_canvas = true;\n        }\n\n        // get node over\n        const node = this.graph.getNodeOnPos(e.canvasX, e.canvasY, this.visible_nodes);\n\n        // remove mouseover flag\n        for (var i = 0, l = this.graph._nodes.length; i < l; ++i) {\n            if (this.graph._nodes[i].mouseOver && node != this.graph._nodes[i]) {\n                // mouse leave\n                this.graph._nodes[i].mouseOver = false;\n                if (this.node_over && this.node_over.onMouseLeave) {\n                    this.node_over.onMouseLeave(e);\n                }\n                this.node_over = null;\n                this.dirty_canvas = true;\n            }\n        }\n\n        // mouse over a node\n        if (node) {\n            if (node.redraw_on_mouse) this.dirty_canvas = true;\n\n            // this.canvas.style.cursor = \"move\";\n            if (!node.mouseOver) {\n                // mouse enter\n                node.mouseOver = true;\n                this.node_over = node;\n                this.dirty_canvas = true;\n\n                if (node.onMouseEnter) {\n                    node.onMouseEnter(e);\n                }\n            }\n\n            // in case the node wants to do something\n            if (node.onMouseMove) {\n                node.onMouseMove(e, [e.canvasX - node.pos[0], e.canvasY - node.pos[1]], this);\n            }\n\n            // if dragging a link\n            if (this.connecting_node) {\n                const pos = this._highlight_input || [0, 0]; // to store the output of\n                // isOverNodeInput\n\n                // on top of input\n                if (this.isOverNodeBox(node, e.canvasX, e.canvasY)) {\n                    // mouse on top of the corner box, don't know what to do\n                } else {\n                    // check if I have a slot below de mouse\n                    const slot = this.isOverNodeInput(node, e.canvasX, e.canvasY, pos);\n                    if (slot != -1 && node.inputs[slot]) {\n                        const slot_type = node.inputs[slot].type;\n                        if (LiteGraph.isValidConnection(this.connecting_output.type, slot_type)) {\n                            this._highlight_input = pos;\n                        }\n                    } else {\n                        this._highlight_input = null;\n                    }\n                }\n            }\n\n            // Search for corner\n            if (this.canvas) {\n                if (\n                    isInsideRectangle(\n                        e.canvasX,\n                        e.canvasY,\n                        node.pos[0] + node.size[0] - 5,\n                        node.pos[1] + node.size[1] - 5,\n                        5,\n                        5,\n                    )\n                ) {\n                    this.canvas.style.cursor = \"se-resize\";\n                } else {\n                    this.canvas.style.cursor = \"crosshair\";\n                }\n            }\n        } else { // not over a node\n            // search for link connector\n            let over_link = null;\n            for (var i = 0; i < this.visible_links.length; ++i) {\n                const link = this.visible_links[i];\n                const center = link._pos;\n                if (\n                    !center\n                    || e.canvasX < center[0] - 4\n                    || e.canvasX > center[0] + 4\n                    || e.canvasY < center[1] - 4\n                    || e.canvasY > center[1] + 4\n                ) {\n                    continue;\n                }\n                over_link = link;\n                break;\n            }\n            if (over_link != this.over_link_center) {\n                this.over_link_center = over_link;\n                this.dirty_canvas = true;\n            }\n\n            if (this.canvas) {\n                this.canvas.style.cursor = \"\";\n            }\n        } // end\n\n        // send event to node if capturing input (used with widgets that allow drag outside of\n        // the area of the node)\n        if (this.node_capturing_input && this.node_capturing_input != node && this.node_capturing_input.onMouseMove) {\n            this.node_capturing_input.onMouseMove(e, [e.canvasX - this.node_capturing_input.pos[0], e.canvasY - this.node_capturing_input.pos[1]], this);\n        }\n\n        // node being dragged\n        if (this.node_dragged && !this.live_mode) {\n            // console.log(\"draggin!\",this.selected_nodes);\n            for (var i in this.selected_nodes) {\n                const n = this.selected_nodes[i];\n                n.pos[0] += delta[0] / this.ds.scale;\n                n.pos[1] += delta[1] / this.ds.scale;\n            }\n\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n        }\n\n        if (this.resizing_node && !this.live_mode) {\n            // convert mouse to node space\n            const desired_size = [e.canvasX - this.resizing_node.pos[0], e.canvasY - this.resizing_node.pos[1]];\n            const min_size = this.resizing_node.computeSize();\n            desired_size[0] = Math.max(min_size[0], desired_size[0]);\n            desired_size[1] = Math.max(min_size[1], desired_size[1]);\n            this.resizing_node.setSize(desired_size);\n\n            this.canvas.style.cursor = \"se-resize\";\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n        }\n    }\n\n    e.preventDefault();\n    return false;\n};\n\n/**\n * Called when a mouse up event has to be processed\n * @method processMouseUp\n * */\nLGraphCanvas.prototype.processMouseUp = function (e) {\n    if (this.set_canvas_dirty_on_mouse_event) this.dirty_canvas = true;\n\n    if (!this.graph) return;\n\n    const window = this.getCanvasWindow();\n    const { document } = window;\n    LGraphCanvas.active_canvas = this;\n\n    // restore the mousemove event back to the canvas\n    document.removeEventListener(\"mousemove\", this._mousemove_callback, true);\n    this.canvas.addEventListener(\"mousemove\", this._mousemove_callback, true);\n    document.removeEventListener(\"mouseup\", this._mouseup_callback, true);\n\n    this.adjustMouseEvent(e);\n    const now = LiteGraph.getTime();\n    e.click_time = now - this.last_mouseclick;\n    this.last_mouse_dragging = false;\n    this.last_click_position = null;\n\n    if (this.block_click) {\n        console.log(\"foo\");\n        this.block_click = false; // used to avoid sending twice a click in a immediate button\n    }\n\n    if (e.which == 1) {\n        if (this.node_widget) {\n            this.processNodeWidgets(this.node_widget[0], this.graph_mouse, e);\n        }\n\n        // left button\n        this.node_widget = null;\n\n        if (this.selected_group) {\n            const diffx = this.selected_group.pos[0]\n                - Math.round(this.selected_group.pos[0]);\n            const diffy = this.selected_group.pos[1]\n                - Math.round(this.selected_group.pos[1]);\n            this.selected_group.move(diffx, diffy, e.ctrlKey);\n            this.selected_group.pos[0] = Math.round(\n                this.selected_group.pos[0],\n            );\n            this.selected_group.pos[1] = Math.round(\n                this.selected_group.pos[1],\n            );\n            if (this.selected_group._nodes.length) {\n                this.dirty_canvas = true;\n            }\n            this.selected_group = null;\n        }\n        this.selected_group_resizing = false;\n\n        if (this.dragging_rectangle) {\n            if (this.graph) {\n                const nodes = this.graph._nodes;\n                const node_bounding = new Float32Array(4);\n                this.deselectAllNodes();\n                // compute bounding and flip if left to right\n                const w = Math.abs(this.dragging_rectangle[2]);\n                const h = Math.abs(this.dragging_rectangle[3]);\n                const startx = this.dragging_rectangle[2] < 0\n                    ? this.dragging_rectangle[0] - w\n                    : this.dragging_rectangle[0];\n                const starty = this.dragging_rectangle[3] < 0\n                    ? this.dragging_rectangle[1] - h\n                    : this.dragging_rectangle[1];\n                this.dragging_rectangle[0] = startx;\n                this.dragging_rectangle[1] = starty;\n                this.dragging_rectangle[2] = w;\n                this.dragging_rectangle[3] = h;\n\n                // test against all nodes (not visible because the rectangle maybe start outside\n                const to_select = [];\n                for (let i = 0; i < nodes.length; ++i) {\n                    var node = nodes[i];\n                    node.getBounding(node_bounding);\n                    if (\n                        !overlapBounding(\n                            this.dragging_rectangle,\n                            node_bounding,\n                        )\n                    ) {\n                        continue;\n                    } // out of the visible area\n                    to_select.push(node);\n                }\n                if (to_select.length) {\n                    this.selectNodes(to_select);\n                }\n            }\n            this.dragging_rectangle = null;\n        } else if (this.connecting_node) {\n            // dragging a connection\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n\n            var node = this.graph.getNodeOnPos(\n                e.canvasX,\n                e.canvasY,\n                this.visible_nodes,\n            );\n\n            // node below mouse\n            if (node) {\n                if (\n                    this.connecting_output.type == LiteGraph.EVENT\n                    && this.isOverNodeBox(node, e.canvasX, e.canvasY)\n                ) {\n                    this.connecting_node.connect(\n                        this.connecting_slot,\n                        node,\n                        LiteGraph.EVENT,\n                    );\n                } else {\n                    // slot below mouse? connect\n                    const slot = this.isOverNodeInput(\n                        node,\n                        e.canvasX,\n                        e.canvasY,\n                    );\n                    if (slot != -1) {\n                        this.connecting_node.connect(\n                            this.connecting_slot,\n                            node,\n                            slot,\n                        );\n                    } else {\n                        // not on top of an input\n                        const input = node.getInputInfo(0);\n                        // auto connect\n                        if (\n                            this.connecting_output.type == LiteGraph.EVENT\n                        ) {\n                            this.connecting_node.connect(\n                                this.connecting_slot,\n                                node,\n                                LiteGraph.EVENT,\n                            );\n                        } else if (\n                            input\n                            && !input.link\n                            && LiteGraph.isValidConnection(\n                                input.type && this.connecting_output.type,\n                            )\n                        ) {\n                            this.connecting_node.connect(\n                                this.connecting_slot,\n                                node,\n                                0,\n                            );\n                        }\n                    }\n                }\n            }\n\n            this.connecting_output = null;\n            this.connecting_pos = null;\n            this.connecting_node = null;\n            this.connecting_slot = -1;\n        } // not dragging connection\n        else if (this.resizing_node) {\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n            this.graph.afterChange(this.resizing_node);\n            this.resizing_node = null;\n        } else if (this.node_dragged) {\n            // node being dragged?\n            var node = this.node_dragged;\n            if (\n                node\n                && e.click_time < 300\n                && isInsideRectangle(e.canvasX, e.canvasY, node.pos[0], node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT, LiteGraph.NODE_TITLE_HEIGHT, LiteGraph.NODE_TITLE_HEIGHT)\n            ) {\n                node.collapse();\n            }\n\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n            this.node_dragged.pos[0] = Math.round(this.node_dragged.pos[0]);\n            this.node_dragged.pos[1] = Math.round(this.node_dragged.pos[1]);\n            if (this.graph.config.align_to_grid) {\n                this.node_dragged.alignToGrid();\n            }\n            if (this.onNodeMoved) this.onNodeMoved(this.node_dragged);\n            this.graph.afterChange(this.node_dragged);\n            this.node_dragged = null;\n        } // no node being dragged\n        else {\n            // get node over\n            var node = this.graph.getNodeOnPos(\n                e.canvasX,\n                e.canvasY,\n                this.visible_nodes,\n            );\n\n            if (!node && e.click_time < 300) {\n                this.deselectAllNodes();\n            }\n\n            this.dirty_canvas = true;\n            this.dragging_canvas = false;\n\n            if (this.node_over && this.node_over.onMouseUp) {\n                this.node_over.onMouseUp(e, [e.canvasX - this.node_over.pos[0], e.canvasY - this.node_over.pos[1]], this);\n            }\n            if (\n                this.node_capturing_input\n                && this.node_capturing_input.onMouseUp\n            ) {\n                this.node_capturing_input.onMouseUp(e, [\n                    e.canvasX - this.node_capturing_input.pos[0],\n                    e.canvasY - this.node_capturing_input.pos[1],\n                ]);\n            }\n        }\n    } else if (e.which == 2) {\n        // middle button\n        // trace(\"middle\");\n        this.dirty_canvas = true;\n        this.dragging_canvas = false;\n    } else if (e.which == 3) {\n        // right button\n        // trace(\"right\");\n        this.dirty_canvas = true;\n        this.dragging_canvas = false;\n    }\n\n    /*\nif((this.dirty_canvas || this.dirty_bgcanvas) && this.rendering_timer_id == null)\nthis.draw();\n*/\n\n    this.graph.change();\n\n    e.stopPropagation();\n    e.preventDefault();\n    return false;\n};\n\n/**\n * Called when a mouse wheel event has to be processed\n * @method processMouseWheel\n * */\nLGraphCanvas.prototype.processMouseWheel = function (e) {\n    if (!this.graph || !this.allow_dragcanvas) {\n        return;\n    }\n\n    const delta = e.wheelDeltaY != null ? e.wheelDeltaY : e.detail * -60;\n\n    this.adjustMouseEvent(e);\n\n    let { scale } = this.ds;\n\n    if (delta > 0) {\n        scale *= 1.1;\n    } else if (delta < 0) {\n        scale *= 1 / 1.1;\n    }\n\n    // this.setZoom( scale, [ e.localX, e.localY ] );\n    this.ds.changeScale(scale, [e.localX, e.localY]);\n\n    this.graph.change();\n\n    e.preventDefault();\n    return false; // prevent default\n};\n\n/**\n * returns true if a position (in graph space) is on top of a node little corner box\n * @method isOverNodeBox\n * */\nLGraphCanvas.prototype.isOverNodeBox = function (node, canvasx, canvasy) {\n    const title_height = LiteGraph.NODE_TITLE_HEIGHT;\n    if (\n        isInsideRectangle(\n            canvasx,\n            canvasy,\n            node.pos[0] + 2,\n            node.pos[1] + 2 - title_height,\n            title_height - 4,\n            title_height - 4,\n        )\n    ) {\n        return true;\n    }\n    return false;\n};\n\n/**\n * returns true if a position (in graph space) is on top of a node input slot\n * @method isOverNodeInput\n * */\nLGraphCanvas.prototype.isOverNodeInput = function (\n    node,\n    canvasx,\n    canvasy,\n    slot_pos,\n) {\n    if (node.inputs) {\n        for (let i = 0, l = node.inputs.length; i < l; ++i) {\n            const input = node.inputs[i];\n            const link_pos = node.getConnectionPos(true, i);\n            let is_inside = false;\n            if (node.horizontal) {\n                is_inside = isInsideRectangle(\n                    canvasx,\n                    canvasy,\n                    link_pos[0] - 5,\n                    link_pos[1] - 10,\n                    10,\n                    20,\n                );\n            } else {\n                is_inside = isInsideRectangle(\n                    canvasx,\n                    canvasy,\n                    link_pos[0] - 10,\n                    link_pos[1] - 5,\n                    40,\n                    10,\n                );\n            }\n            if (is_inside) {\n                if (slot_pos) {\n                    slot_pos[0] = link_pos[0];\n                    slot_pos[1] = link_pos[1];\n                }\n                return i;\n            }\n        }\n    }\n    return -1;\n};\n\n/**\n * process a key event\n * @method processKey\n * */\nLGraphCanvas.prototype.processKey = function (e) {\n    if (!this.graph) {\n        return;\n    }\n\n    let block_default = false;\n    // console.log(e); //debug\n\n    if (e.target.localName == \"input\") {\n        return;\n    }\n\n    if (e.type == \"keydown\") {\n        if (e.keyCode == 32) {\n            // esc\n            this.dragging_canvas = true;\n            block_default = true;\n        }\n\n        // select all Control A\n        if (e.keyCode == 65 && e.ctrlKey) {\n            this.selectNodes();\n            block_default = true;\n        }\n\n        if (e.code == \"KeyC\" && (e.metaKey || e.ctrlKey) && !e.shiftKey) {\n            // copy\n            if (this.selected_nodes) {\n                this.copyToClipboard();\n                block_default = true;\n            }\n        }\n\n        if (e.code == \"KeyV\" && (e.metaKey || e.ctrlKey) && !e.shiftKey) {\n            // paste\n            this.pasteFromClipboard();\n        }\n\n        // delete or backspace\n        if (e.keyCode == 46 || e.keyCode == 8) {\n            if (\n                e.target.localName != \"input\"\n                && e.target.localName != \"textarea\"\n            ) {\n                this.deleteSelectedNodes();\n                block_default = true;\n            }\n        }\n\n        // collapse\n        // ...\n\n        // TODO\n        if (this.selected_nodes) {\n            for (var i in this.selected_nodes) {\n                if (this.selected_nodes[i].onKeyDown) {\n                    this.selected_nodes[i].onKeyDown(e);\n                }\n            }\n        }\n    } else if (e.type == \"keyup\") {\n        if (e.keyCode == 32) {\n            this.dragging_canvas = false;\n        }\n\n        if (this.selected_nodes) {\n            for (var i in this.selected_nodes) {\n                if (this.selected_nodes[i].onKeyUp) {\n                    this.selected_nodes[i].onKeyUp(e);\n                }\n            }\n        }\n    }\n\n    this.graph.change();\n\n    if (block_default) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        return false;\n    }\n};\n\nLGraphCanvas.prototype.copyToClipboard = function () {\n    const clipboard_info = {\n        nodes: [],\n        links: [],\n    };\n    let index = 0;\n    const selected_nodes_array = [];\n    for (var i in this.selected_nodes) {\n        var node = this.selected_nodes[i];\n        node._relative_id = index;\n        selected_nodes_array.push(node);\n        index += 1;\n    }\n\n    for (var i = 0; i < selected_nodes_array.length; ++i) {\n        var node = selected_nodes_array[i];\n        const cloned = node.clone();\n        if (!cloned) {\n            console.warn(`node type not found: ${node.type}`);\n            continue;\n        }\n        clipboard_info.nodes.push(cloned.serialize());\n        if (node.inputs && node.inputs.length) {\n            for (let j = 0; j < node.inputs.length; ++j) {\n                const input = node.inputs[j];\n                if (!input || input.link == null) {\n                    continue;\n                }\n                const link_info = this.graph.links[input.link];\n                if (!link_info) {\n                    continue;\n                }\n                const target_node = this.graph.getNodeById(\n                    link_info.origin_id,\n                );\n                if (!target_node || !this.selected_nodes[target_node.id]) {\n                    // improve this by allowing connections to non-selected nodes\n                    continue;\n                } // not selected\n                clipboard_info.links.push([\n                    target_node._relative_id,\n                    link_info.origin_slot, // j,\n                    node._relative_id,\n                    link_info.target_slot,\n                ]);\n            }\n        }\n    }\n    localStorage.setItem(\n        \"litegrapheditor_clipboard\",\n        JSON.stringify(clipboard_info),\n    );\n};\n\nLGraphCanvas.prototype.pasteFromClipboard = function () {\n    const data = localStorage.getItem(\"litegrapheditor_clipboard\");\n    if (!data) {\n        return;\n    }\n\n    this.graph.beforeChange();\n\n    // create nodes\n    const clipboard_info = JSON.parse(data);\n    const nodes = [];\n    for (var i = 0; i < clipboard_info.nodes.length; ++i) {\n        const node_data = clipboard_info.nodes[i];\n        const node = LiteGraph.createNode(node_data.type);\n        if (node) {\n            node.configure(node_data);\n            node.pos[0] += 5;\n            node.pos[1] += 5;\n            this.graph.add(node);\n            nodes.push(node);\n        }\n    }\n\n    // create links\n    for (var i = 0; i < clipboard_info.links.length; ++i) {\n        const link_info = clipboard_info.links[i];\n        const origin_node = nodes[link_info[0]];\n        const target_node = nodes[link_info[2]];\n        if (origin_node && target_node) {\n            origin_node.connect(link_info[1], target_node, link_info[3]);\n        } else {\n            console.warn(\"Warning, nodes missing on pasting\");\n        }\n    }\n\n    this.selectNodes(nodes);\n\n    this.graph.afterChange();\n};\n\n/**\n * process a item drop event on top the canvas\n * @method processDrop\n * */\nLGraphCanvas.prototype.processDrop = function (e) {\n    e.preventDefault();\n    this.adjustMouseEvent(e);\n\n    const pos = [e.canvasX, e.canvasY];\n    const node = this.graph ? this.graph.getNodeOnPos(pos[0], pos[1]) : null;\n\n    if (!node) {\n        let r = null;\n        if (this.onDropItem) {\n            r = this.onDropItem(event);\n        }\n        if (!r) {\n            this.checkDropItem(e);\n        }\n        return;\n    }\n\n    if (node.onDropFile || node.onDropData) {\n        const { files } = e.dataTransfer;\n        if (files && files.length) {\n            for (let i = 0; i < files.length; i++) {\n                var file = e.dataTransfer.files[0];\n                var filename = file.name;\n                const ext = LGraphCanvas.getFileExtension(filename);\n                // console.log(file);\n\n                if (node.onDropFile) {\n                    node.onDropFile(file);\n                }\n\n                if (node.onDropData) {\n                    // prepare reader\n                    const reader = new FileReader();\n                    reader.onload = function (event) {\n                        // console.log(event.target);\n                        const data = event.target.result;\n                        node.onDropData(data, filename, file);\n                    };\n\n                    // read data\n                    const type = file.type.split(\"/\")[0];\n                    if (type == \"text\" || type == \"\") {\n                        reader.readAsText(file);\n                    } else if (type == \"image\") {\n                        reader.readAsDataURL(file);\n                    } else {\n                        reader.readAsArrayBuffer(file);\n                    }\n                }\n            }\n        }\n    }\n\n    if (node.onDropItem) {\n        if (node.onDropItem(event)) {\n            return true;\n        }\n    }\n\n    if (this.onDropItem) {\n        return this.onDropItem(event);\n    }\n\n    return false;\n};\n\n// called if the graph doesn't have a default drop item behaviour\nLGraphCanvas.prototype.checkDropItem = function (e) {\n    if (e.dataTransfer.files.length) {\n        const file = e.dataTransfer.files[0];\n        const ext = LGraphCanvas.getFileExtension(file.name)\n            .toLowerCase();\n        const nodetype = LiteGraph.node_types_by_file_extension[ext];\n        if (nodetype) {\n            this.graph.beforeChange();\n            const node = LiteGraph.createNode(nodetype.type);\n            node.pos = [e.canvasX, e.canvasY];\n            this.graph.add(node);\n            if (node.onDropFile) {\n                node.onDropFile(file);\n            }\n            this.graph.afterChange();\n        }\n    }\n};\n\nLGraphCanvas.prototype.processNodeDblClicked = function (n) {\n    if (this.onShowNodePanel) {\n        this.onShowNodePanel(n);\n    } else {\n        this.showShowNodePanel(n);\n    }\n\n    if (this.onNodeDblClicked) {\n        this.onNodeDblClicked(n);\n    }\n\n    this.setDirty(true);\n};\n\nLGraphCanvas.prototype.processNodeSelected = function (node, e) {\n    this.selectNode(node, e && e.shiftKey);\n    if (this.onNodeSelected) {\n        this.onNodeSelected(node);\n    }\n};\n\n/**\n * selects a given node (or adds it to the current selection)\n * @method selectNode\n * */\nLGraphCanvas.prototype.selectNode = function (\n    node,\n    add_to_current_selection,\n) {\n    if (node == null) {\n        this.deselectAllNodes();\n    } else {\n        this.selectNodes([node], add_to_current_selection);\n    }\n};\n\n/**\n * selects several nodes (or adds them to the current selection)\n * @method selectNodes\n * */\nLGraphCanvas.prototype.selectNodes = function (nodes, add_to_current_selection) {\n    if (!add_to_current_selection) {\n        this.deselectAllNodes();\n    }\n\n    nodes = nodes || this.graph._nodes;\n    for (let i = 0; i < nodes.length; ++i) {\n        const node = nodes[i];\n        if (node.is_selected) {\n            continue;\n        }\n\n        if (!node.is_selected && node.onSelected) {\n            node.onSelected();\n        }\n        node.is_selected = true;\n        this.selected_nodes[node.id] = node;\n\n        if (node.inputs) {\n            for (var j = 0; j < node.inputs.length; ++j) {\n                this.highlighted_links[node.inputs[j].link] = true;\n            }\n        }\n        if (node.outputs) {\n            for (var j = 0; j < node.outputs.length; ++j) {\n                const out = node.outputs[j];\n                if (out.links) {\n                    for (let k = 0; k < out.links.length; ++k) {\n                        this.highlighted_links[out.links[k]] = true;\n                    }\n                }\n            }\n        }\n    }\n\n    if (this.onSelectionChange) this.onSelectionChange(this.selected_nodes);\n\n    this.setDirty(true);\n};\n\n/**\n * removes a node from the current selection\n * @method deselectNode\n * */\nLGraphCanvas.prototype.deselectNode = function (node) {\n    if (!node.is_selected) {\n        return;\n    }\n    if (node.onDeselected) {\n        node.onDeselected();\n    }\n    node.is_selected = false;\n\n    if (this.onNodeDeselected) {\n        this.onNodeDeselected(node);\n    }\n\n    // remove highlighted\n    if (node.inputs) {\n        for (var i = 0; i < node.inputs.length; ++i) {\n            delete this.highlighted_links[node.inputs[i].link];\n        }\n    }\n    if (node.outputs) {\n        for (var i = 0; i < node.outputs.length; ++i) {\n            const out = node.outputs[i];\n            if (out.links) {\n                for (let j = 0; j < out.links.length; ++j) {\n                    delete this.highlighted_links[out.links[j]];\n                }\n            }\n        }\n    }\n};\n\n/**\n * removes all nodes from the current selection\n * @method deselectAllNodes\n * */\nLGraphCanvas.prototype.deselectAllNodes = function () {\n    if (!this.graph) {\n        return;\n    }\n    const nodes = this.graph._nodes;\n    for (let i = 0, l = nodes.length; i < l; ++i) {\n        const node = nodes[i];\n        if (!node.is_selected) {\n            continue;\n        }\n        if (node.onDeselected) {\n            node.onDeselected();\n        }\n        node.is_selected = false;\n        if (this.onNodeDeselected) {\n            this.onNodeDeselected(node);\n        }\n    }\n    this.selected_nodes = {};\n    this.current_node = null;\n    this.highlighted_links = {};\n    if (this.onSelectionChange) this.onSelectionChange(this.selected_nodes);\n    this.setDirty(true);\n};\n\n/**\n * deletes all nodes in the current selection from the graph\n * @method deleteSelectedNodes\n * */\nLGraphCanvas.prototype.deleteSelectedNodes = function () {\n    this.graph.beforeChange();\n\n    for (const i in this.selected_nodes) {\n        const node = this.selected_nodes[i];\n\n        if (node.block_delete) continue;\n\n        // autoconnect when possible (very basic, only takes into account first input-output)\n        if (node.inputs && node.inputs.length && node.outputs && node.outputs.length && LiteGraph.isValidConnection(node.inputs[0].type, node.outputs[0].type) && node.inputs[0].link && node.outputs[0].links && node.outputs[0].links.length) {\n            const input_link = node.graph.links[node.inputs[0].link];\n            const output_link = node.graph.links[node.outputs[0].links[0]];\n            const input_node = node.getInputNode(0);\n            const output_node = node.getOutputNodes(0)[0];\n            if (input_node && output_node) input_node.connect(input_link.origin_slot, output_node, output_link.target_slot);\n        }\n        this.graph.remove(node);\n        if (this.onNodeDeselected) {\n            this.onNodeDeselected(node);\n        }\n    }\n    this.selected_nodes = {};\n    this.current_node = null;\n    this.highlighted_links = {};\n    this.setDirty(true);\n    this.graph.afterChange();\n};\n\n/**\n * centers the camera on a given node\n * @method centerOnNode\n * */\nLGraphCanvas.prototype.centerOnNode = function (node) {\n    this.ds.offset[0] = -node.pos[0]\n        - node.size[0] * 0.5\n        + (this.canvas.width * 0.5) / this.ds.scale;\n    this.ds.offset[1] = -node.pos[1]\n        - node.size[1] * 0.5\n        + (this.canvas.height * 0.5) / this.ds.scale;\n    this.setDirty(true, true);\n};\n\n/**\n * adds some useful properties to a mouse event, like the position in graph coordinates\n * @method adjustMouseEvent\n * */\nLGraphCanvas.prototype.adjustMouseEvent = function (e) {\n    if (this.canvas) {\n        const b = this.canvas.getBoundingClientRect();\n        e.localX = e.clientX - b.left;\n        e.localY = e.clientY - b.top;\n    } else {\n        e.localX = e.clientX;\n        e.localY = e.clientY;\n    }\n\n    e.deltaX = e.localX - this.last_mouse_position[0];\n    e.deltaY = e.localY - this.last_mouse_position[1];\n\n    this.last_mouse_position[0] = e.localX;\n    this.last_mouse_position[1] = e.localY;\n\n    e.canvasX = e.localX / this.ds.scale - this.ds.offset[0];\n    e.canvasY = e.localY / this.ds.scale - this.ds.offset[1];\n};\n\n/**\n * changes the zoom level of the graph (default is 1), you can pass also a place used to pivot\n * the zoom\n * @method setZoom\n * */\nLGraphCanvas.prototype.setZoom = function (value, zooming_center) {\n    this.ds.changeScale(value, zooming_center);\n    /*\nif(!zooming_center && this.canvas)\nzooming_center = [this.canvas.width * 0.5,this.canvas.height * 0.5];\n\nvar center = this.convertOffsetToCanvas( zooming_center );\n\nthis.ds.scale = value;\n\nif(this.scale > this.max_zoom)\nthis.scale = this.max_zoom;\nelse if(this.scale < this.min_zoom)\nthis.scale = this.min_zoom;\n\nvar new_center = this.convertOffsetToCanvas( zooming_center );\nvar delta_offset = [new_center[0] - center[0], new_center[1] - center[1]];\n\nthis.offset[0] += delta_offset[0];\nthis.offset[1] += delta_offset[1];\n*/\n\n    this.dirty_canvas = true;\n    this.dirty_bgcanvas = true;\n};\n\n/**\n * converts a coordinate from graph coordinates to canvas2D coordinates\n * @method convertOffsetToCanvas\n * */\nLGraphCanvas.prototype.convertOffsetToCanvas = function (pos, out) {\n    return this.ds.convertOffsetToCanvas(pos, out);\n};\n\n/**\n * converts a coordinate from Canvas2D coordinates to graph space\n * @method convertCanvasToOffset\n * */\nLGraphCanvas.prototype.convertCanvasToOffset = function (pos, out) {\n    return this.ds.convertCanvasToOffset(pos, out);\n};\n\n// converts event coordinates from canvas2D to graph coordinates\nLGraphCanvas.prototype.convertEventToCanvasOffset = function (e) {\n    const rect = this.canvas.getBoundingClientRect();\n    return this.convertCanvasToOffset([\n        e.clientX - rect.left,\n        e.clientY - rect.top,\n    ]);\n};\n\n/**\n * brings a node to front (above all other nodes)\n * @method bringToFront\n * */\nLGraphCanvas.prototype.bringToFront = function (node) {\n    const i = this.graph._nodes.indexOf(node);\n    if (i == -1) {\n        return;\n    }\n\n    this.graph._nodes.splice(i, 1);\n    this.graph._nodes.push(node);\n};\n\n/**\n * sends a node to the back (below all other nodes)\n * @method sendToBack\n * */\nLGraphCanvas.prototype.sendToBack = function (node) {\n    const i = this.graph._nodes.indexOf(node);\n    if (i == -1) {\n        return;\n    }\n\n    this.graph._nodes.splice(i, 1);\n    this.graph._nodes.unshift(node);\n};\n\n/* Interaction */\n\n/* LGraphCanvas render */\nconst temp = new Float32Array(4);\n\n/**\n * checks which nodes are visible (inside the camera area)\n * @method computeVisibleNodes\n * */\nLGraphCanvas.prototype.computeVisibleNodes = function (nodes, out) {\n    const visible_nodes = out || [];\n    visible_nodes.length = 0;\n    nodes = nodes || this.graph._nodes;\n    for (let i = 0, l = nodes.length; i < l; ++i) {\n        const n = nodes[i];\n\n        // skip rendering nodes in live mode\n        if (this.live_mode && !n.onDrawBackground && !n.onDrawForeground) {\n            continue;\n        }\n\n        if (!overlapBounding(this.visible_area, n.getBounding(temp))) {\n            continue;\n        } // out of the visible area\n\n        visible_nodes.push(n);\n    }\n    return visible_nodes;\n};\n\n/**\n * renders the whole canvas content, by rendering in two separated canvas, one containing the\n * background grid and the connections, and one containing the nodes)\n * @method draw\n * */\nLGraphCanvas.prototype.draw = function (force_canvas, force_bgcanvas) {\n    if (!this.canvas || this.canvas.width == 0 || this.canvas.height == 0) {\n        return;\n    }\n\n    // fps counting\n    const now = LiteGraph.getTime();\n    this.render_time = (now - this.last_draw_time) * 0.001;\n    this.last_draw_time = now;\n\n    if (this.graph) {\n        this.ds.computeVisibleArea();\n    }\n\n    if (\n        this.dirty_bgcanvas\n        || force_bgcanvas\n        || this.always_render_background\n        || (this.graph\n        && this.graph._last_trigger_time\n        && now - this.graph._last_trigger_time < 1000)\n    ) {\n        this.drawBackCanvas();\n    }\n\n    if (this.dirty_canvas || force_canvas) {\n        this.drawFrontCanvas();\n    }\n\n    this.fps = this.render_time ? 1.0 / this.render_time : 0;\n    this.frame += 1;\n};\n\n/**\n * draws the front canvas (the one containing all the nodes)\n * @method drawFrontCanvas\n * */\nLGraphCanvas.prototype.drawFrontCanvas = function () {\n    this.dirty_canvas = false;\n\n    if (!this.ctx) {\n        this.ctx = this.bgcanvas.getContext(\"2d\");\n    }\n    const { ctx } = this;\n    if (!ctx) {\n        // maybe is using webgl...\n        return;\n    }\n\n    if (ctx.start2D) {\n        ctx.start2D();\n    }\n\n    const { canvas } = this;\n\n    // reset in case of error\n    ctx.restore();\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n\n    // clip dirty area if there is one, otherwise work in full canvas\n    if (this.dirty_area) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.rect(\n            this.dirty_area[0],\n            this.dirty_area[1],\n            this.dirty_area[2],\n            this.dirty_area[3],\n        );\n        ctx.clip();\n    }\n\n    // clear\n    // canvas.width = canvas.width;\n    if (this.clear_background) {\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n\n    // draw bg canvas\n    if (this.bgcanvas == this.canvas) {\n        this.drawBackCanvas();\n    } else {\n        ctx.drawImage(this.bgcanvas, 0, 0);\n    }\n\n    // rendering\n    if (this.onRender) {\n        this.onRender(canvas, ctx);\n    }\n\n    // info widget\n    if (this.show_info) {\n        this.renderInfo(ctx);\n    }\n\n    if (this.graph) {\n        // apply transformations\n        ctx.save();\n        this.ds.toCanvasContext(ctx);\n\n        // draw nodes\n        let drawn_nodes = 0;\n        const visible_nodes = this.computeVisibleNodes(\n            null,\n            this.visible_nodes,\n        );\n\n        for (let i = 0; i < visible_nodes.length; ++i) {\n            const node = visible_nodes[i];\n\n            // transform coords system\n            ctx.save();\n            ctx.translate(node.pos[0], node.pos[1]);\n\n            // Draw\n            this.drawNode(node, ctx);\n            drawn_nodes += 1;\n\n            // Restore\n            ctx.restore();\n        }\n\n        // on top (debug)\n        if (this.render_execution_order) {\n            this.drawExecutionOrder(ctx);\n        }\n\n        // connections ontop?\n        if (this.graph.config.links_ontop) {\n            if (!this.live_mode) {\n                this.drawConnections(ctx);\n            }\n        }\n\n        // current connection (the one being dragged by the mouse)\n        if (this.connecting_pos != null) {\n            ctx.lineWidth = this.connections_width;\n            let link_color = null;\n\n            switch (this.connecting_output.type) {\n                case LiteGraph.EVENT:\n                    link_color = LiteGraph.EVENT_LINK_COLOR;\n                    break;\n                default:\n                    link_color = LiteGraph.CONNECTING_LINK_COLOR;\n            }\n\n            // the connection being dragged by the mouse\n            this.renderLink(\n                ctx,\n                this.connecting_pos,\n                [this.graph_mouse[0], this.graph_mouse[1]],\n                null,\n                false,\n                null,\n                link_color,\n                this.connecting_output.dir\n                || (this.connecting_node.horizontal\n                    ? LiteGraph.DOWN\n                    : LiteGraph.RIGHT),\n                LiteGraph.CENTER,\n            );\n\n            ctx.beginPath();\n            if (\n                this.connecting_output.type === LiteGraph.EVENT\n                || this.connecting_output.shape === LiteGraph.BOX_SHAPE\n            ) {\n                ctx.rect(\n                    this.connecting_pos[0] - 6 + 0.5,\n                    this.connecting_pos[1] - 5 + 0.5,\n                    14,\n                    10,\n                );\n            } else {\n                ctx.arc(\n                    this.connecting_pos[0],\n                    this.connecting_pos[1],\n                    4,\n                    0,\n                    Math.PI * 2,\n                );\n            }\n            ctx.fill();\n\n            ctx.fillStyle = \"#ffcc00\";\n            if (this._highlight_input) {\n                ctx.beginPath();\n                ctx.arc(\n                    this._highlight_input[0],\n                    this._highlight_input[1],\n                    6,\n                    0,\n                    Math.PI * 2,\n                );\n                ctx.fill();\n            }\n        }\n\n        // the selection rectangle\n        if (this.dragging_rectangle) {\n            ctx.strokeStyle = \"#FFF\";\n            ctx.strokeRect(\n                this.dragging_rectangle[0],\n                this.dragging_rectangle[1],\n                this.dragging_rectangle[2],\n                this.dragging_rectangle[3],\n            );\n        }\n\n        // on top of link center\n        if (this.over_link_center && this.render_link_tooltip) {\n            this.drawLinkTooltip(ctx, this.over_link_center);\n        } else if (this.onDrawLinkTooltip) // to remove\n        {\n            this.onDrawLinkTooltip(ctx, null);\n        }\n\n        // custom info\n        if (this.onDrawForeground) {\n            this.onDrawForeground(ctx, this.visible_rect);\n        }\n\n        ctx.restore();\n    }\n\n    // draws panel in the corner\n    if (this._graph_stack && this._graph_stack.length) {\n        this.drawSubgraphPanel(ctx);\n    }\n\n    if (this.onDrawOverlay) {\n        this.onDrawOverlay(ctx);\n    }\n\n    if (this.dirty_area) {\n        ctx.restore();\n        // this.dirty_area = null;\n    }\n\n    if (ctx.finish2D) {\n        // this is a function I use in webgl renderer\n        ctx.finish2D();\n    }\n};\n\n/**\n * draws the panel in the corner that shows subgraph properties\n * @method drawSubgraphPanel\n * */\nLGraphCanvas.prototype.drawSubgraphPanel = function (ctx) {\n    const subgraph = this.graph;\n    const subnode = subgraph._subgraph_node;\n    if (!subnode) {\n        console.warn(\"subgraph without subnode\");\n        return;\n    }\n\n    const num = subnode.inputs ? subnode.inputs.length : 0;\n    const w = 300;\n    const h = Math.floor(LiteGraph.NODE_SLOT_HEIGHT * 1.6);\n\n    ctx.fillStyle = \"#111\";\n    ctx.globalAlpha = 0.8;\n    ctx.beginPath();\n    ctx.roundRect(10, 10, w, (num + 1) * h + 50, 8);\n    ctx.fill();\n    ctx.globalAlpha = 1;\n\n    ctx.fillStyle = \"#888\";\n    ctx.font = \"14px Arial\";\n    ctx.textAlign = \"left\";\n    ctx.fillText(\"Graph Inputs\", 20, 34);\n    const pos = this.mouse;\n\n    if (this.drawButton(w - 20, 20, 20, 20, \"X\", \"#151515\")) {\n        this.closeSubgraph();\n        return;\n    }\n\n    let y = 50;\n    ctx.font = \"20px Arial\";\n    if (subnode.inputs) {\n        for (let i = 0; i < subnode.inputs.length; ++i) {\n            const input = subnode.inputs[i];\n            if (input.not_subgraph_input) continue;\n\n            // input button clicked\n            if (this.drawButton(20, y + 2, w - 20, h - 2)) {\n                const type = subnode.constructor.input_node_type || \"graph/input\";\n                this.graph.beforeChange();\n                const newnode = LiteGraph.createNode(type);\n                if (newnode) {\n                    subgraph.add(newnode);\n                    this.block_click = false;\n                    this.last_click_position = null;\n                    this.selectNodes([newnode]);\n                    this.node_dragged = newnode;\n                    this.dragging_canvas = false;\n                    newnode.setProperty(\"name\", input.name);\n                    newnode.setProperty(\"type\", input.type);\n                    this.node_dragged.pos[0] = this.graph_mouse[0] - 5;\n                    this.node_dragged.pos[1] = this.graph_mouse[1] - 5;\n                    this.graph.afterChange();\n                } else {\n                    console.error(\"graph input node not found:\", type);\n                }\n            }\n\n            ctx.fillStyle = \"#9C9\";\n            ctx.beginPath();\n            ctx.arc(w - 16, y + h * 0.5, 5, 0, 2 * Math.PI);\n            ctx.fill();\n\n            ctx.fillStyle = \"#AAA\";\n            ctx.fillText(input.name, 50, y + h * 0.75);\n            const tw = ctx.measureText(input.name);\n            ctx.fillStyle = \"#777\";\n            ctx.fillText(input.type, 50 + tw.width + 10, y + h * 0.75);\n\n            y += h;\n        }\n    }\n\n    // add + button\n    if (this.drawButton(20, y + 2, w - 20, h - 2, \"+\", \"#151515\", \"#222\")) {\n        this.showSubgraphPropertiesDialog(subnode);\n    }\n};\n\n// Draws a button into the canvas overlay and computes if it was clicked using the immediate\n// gui paradigm\nLGraphCanvas.prototype.drawButton = function (x, y, w, h, text, bgcolor, hovercolor, textcolor) {\n    const { ctx } = this;\n    bgcolor = bgcolor || LiteGraph.NODE_DEFAULT_COLOR;\n    hovercolor = hovercolor || \"#555\";\n    textcolor = textcolor || LiteGraph.NODE_TEXT_COLOR;\n\n    let pos = this.mouse;\n    const hover = LiteGraph.isInsideRectangle(pos[0], pos[1], x, y, w, h);\n    pos = this.last_click_position;\n    const clicked = pos && LiteGraph.isInsideRectangle(pos[0], pos[1], x, y, w, h);\n\n    ctx.fillStyle = hover ? hovercolor : bgcolor;\n    if (clicked) ctx.fillStyle = \"#AAA\";\n    ctx.beginPath();\n    ctx.roundRect(x, y, w, h, 4);\n    ctx.fill();\n\n    if (text != null) {\n        if (text.constructor == String) {\n            ctx.fillStyle = textcolor;\n            ctx.textAlign = \"center\";\n            ctx.font = `${(h * 0.65) | 0}px Arial`;\n            ctx.fillText(text, x + w * 0.5, y + h * 0.75);\n            ctx.textAlign = \"left\";\n        }\n    }\n\n    const was_clicked = clicked && !this.block_click;\n    if (clicked) this.blockClick();\n    return was_clicked;\n};\n\nLGraphCanvas.prototype.isAreaClicked = function (x, y, w, h, hold_click) {\n    let pos = this.mouse;\n    const hover = LiteGraph.isInsideRectangle(pos[0], pos[1], x, y, w, h);\n    pos = this.last_click_position;\n    const clicked = pos && LiteGraph.isInsideRectangle(pos[0], pos[1], x, y, w, h);\n    const was_clicked = clicked && !this.block_click;\n    if (clicked && hold_click) this.blockClick();\n    return was_clicked;\n};\n\n/**\n * draws some useful stats in the corner of the canvas\n * @method renderInfo\n * */\nLGraphCanvas.prototype.renderInfo = function (ctx, x, y) {\n    x = x || 10;\n    y = y || this.canvas.height - 80;\n\n    ctx.save();\n    ctx.translate(x, y);\n\n    ctx.font = \"10px Arial\";\n    ctx.fillStyle = \"#888\";\n    if (this.graph) {\n        ctx.fillText(`T: ${this.graph.globaltime.toFixed(2)}s`, 5, 13 * 1);\n        ctx.fillText(`I: ${this.graph.iteration}`, 5, 13 * 2);\n        ctx.fillText(`N: ${this.graph._nodes.length} [${this.visible_nodes.length}]`, 5, 13 * 3);\n        ctx.fillText(`V: ${this.graph._version}`, 5, 13 * 4);\n        ctx.fillText(`FPS:${this.fps.toFixed(2)}`, 5, 13 * 5);\n    } else {\n        ctx.fillText(\"No graph selected\", 5, 13 * 1);\n    }\n    ctx.restore();\n};\n\n/**\n * draws the back canvas (the one containing the background and the connections)\n * @method drawBackCanvas\n * */\nLGraphCanvas.prototype.drawBackCanvas = function () {\n    const canvas = this.bgcanvas;\n    if (\n        canvas.width != this.canvas.width\n        || canvas.height != this.canvas.height\n    ) {\n        canvas.width = this.canvas.width;\n        canvas.height = this.canvas.height;\n    }\n\n    if (!this.bgctx) {\n        this.bgctx = this.bgcanvas.getContext(\"2d\");\n    }\n    const ctx = this.bgctx;\n    if (ctx.start) {\n        ctx.start();\n    }\n\n    // clear\n    if (this.clear_background) {\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n\n    if (this._graph_stack && this._graph_stack.length) {\n        ctx.save();\n        const parent_graph = this._graph_stack[this._graph_stack.length - 1];\n        const subgraph_node = this.graph._subgraph_node;\n        ctx.strokeStyle = subgraph_node.bgcolor;\n        ctx.lineWidth = 10;\n        ctx.strokeRect(1, 1, canvas.width - 2, canvas.height - 2);\n        ctx.lineWidth = 1;\n        ctx.font = \"40px Arial\";\n        ctx.textAlign = \"center\";\n        ctx.fillStyle = subgraph_node.bgcolor || \"#AAA\";\n        let title = \"\";\n        for (let i = 1; i < this._graph_stack.length; ++i) {\n            title\n                += `${this._graph_stack[i]._subgraph_node.getTitle()} >> `;\n        }\n        ctx.fillText(\n            title + subgraph_node.getTitle(),\n            canvas.width * 0.5,\n            40,\n        );\n        ctx.restore();\n    }\n\n    let bg_already_painted = false;\n    if (this.onRenderBackground) {\n        bg_already_painted = this.onRenderBackground(canvas, ctx);\n    }\n\n    // reset in case of error\n    ctx.restore();\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    this.visible_links.length = 0;\n\n    if (this.graph) {\n        // apply transformations\n        ctx.save();\n        this.ds.toCanvasContext(ctx);\n\n        // render BG\n        if (\n            this.background_image\n            && this.ds.scale > 0.5\n            && !bg_already_painted\n        ) {\n            if (this.zoom_modify_alpha) {\n                ctx.globalAlpha = (1.0 - 0.5 / this.ds.scale) * this.editor_alpha;\n            } else {\n                ctx.globalAlpha = this.editor_alpha;\n            }\n            ctx.imageSmoothingEnabled = ctx.mozImageSmoothingEnabled = ctx.imageSmoothingEnabled = false;\n            if (\n                !this._bg_img\n                || this._bg_img.name != this.background_image\n            ) {\n                this._bg_img = new Image();\n                this._bg_img.name = this.background_image;\n                this._bg_img.src = this.background_image;\n                const that = this;\n                this._bg_img.onload = function () {\n                    that.draw(true, true);\n                };\n            }\n\n            let pattern = null;\n            if (this._pattern == null && this._bg_img.width > 0) {\n                pattern = ctx.createPattern(this._bg_img, \"repeat\");\n                this._pattern_img = this._bg_img;\n                this._pattern = pattern;\n            } else {\n                pattern = this._pattern;\n            }\n            if (pattern) {\n                ctx.fillStyle = pattern;\n                ctx.fillRect(\n                    this.visible_area[0],\n                    this.visible_area[1],\n                    this.visible_area[2],\n                    this.visible_area[3],\n                );\n                ctx.fillStyle = \"transparent\";\n            }\n\n            ctx.globalAlpha = 1.0;\n            ctx.imageSmoothingEnabled = ctx.mozImageSmoothingEnabled = ctx.imageSmoothingEnabled = true;\n        }\n\n        // groups\n        if (this.graph._groups.length && !this.live_mode) {\n            this.drawGroups(canvas, ctx);\n        }\n\n        if (this.onDrawBackground) {\n            this.onDrawBackground(ctx, this.visible_area);\n        }\n        if (this.onBackgroundRender) {\n            // LEGACY\n            console.error(\n                \"WARNING! onBackgroundRender deprecated, now is named onDrawBackground \",\n            );\n            this.onBackgroundRender = null;\n        }\n\n        // DEBUG: show clipping area\n        // ctx.fillStyle = \"red\";\n        // ctx.fillRect( this.visible_area[0] + 10, this.visible_area[1] + 10,\n        // this.visible_area[2] - 20, this.visible_area[3] - 20);\n\n        // bg\n        if (this.render_canvas_border) {\n            ctx.strokeStyle = \"#235\";\n            ctx.strokeRect(0, 0, canvas.width, canvas.height);\n        }\n\n        if (this.render_connections_shadows) {\n            ctx.shadowColor = \"#000\";\n            ctx.shadowOffsetX = 0;\n            ctx.shadowOffsetY = 0;\n            ctx.shadowBlur = 6;\n        } else {\n            ctx.shadowColor = \"rgba(0,0,0,0)\";\n        }\n\n        // draw connections\n        if (!this.live_mode) {\n            this.drawConnections(ctx);\n        }\n\n        ctx.shadowColor = \"rgba(0,0,0,0)\";\n\n        // restore state\n        ctx.restore();\n    }\n\n    if (ctx.finish) {\n        ctx.finish();\n    }\n\n    this.dirty_bgcanvas = false;\n    this.dirty_canvas = true; // to force to repaint the front canvas with the bgcanvas\n};\n\nconst temp_vec2 = new Float32Array(2);\n\n/**\n * draws the given node inside the canvas\n * @method drawNode\n * */\nLGraphCanvas.prototype.drawNode = function (node, ctx) {\n    let glow = false;\n    this.current_node = node;\n\n    const color = node.color || node.constructor.color || LiteGraph.NODE_DEFAULT_COLOR;\n    let bgcolor = node.bgcolor || node.constructor.bgcolor || LiteGraph.NODE_DEFAULT_BGCOLOR;\n\n    // shadow and glow\n    if (node.mouseOver) {\n        glow = true;\n    }\n\n    const low_quality = this.ds.scale < 0.6; // zoomed out\n\n    // only render if it forces it to do it\n    if (this.live_mode) {\n        if (!node.flags.collapsed) {\n            ctx.shadowColor = \"transparent\";\n            if (node.onDrawForeground) {\n                node.onDrawForeground(ctx, this, this.canvas);\n            }\n        }\n        return;\n    }\n\n    const { editor_alpha } = this;\n    ctx.globalAlpha = editor_alpha;\n\n    if (this.render_shadows && !low_quality) {\n        ctx.shadowColor = LiteGraph.DEFAULT_SHADOW_COLOR;\n        ctx.shadowOffsetX = 2 * this.ds.scale;\n        ctx.shadowOffsetY = 2 * this.ds.scale;\n        ctx.shadowBlur = 3 * this.ds.scale;\n    } else {\n        ctx.shadowColor = \"transparent\";\n    }\n\n    // custom draw collapsed method (draw after shadows because they are affected)\n    if (\n        node.flags.collapsed\n        && node.onDrawCollapsed\n        && node.onDrawCollapsed(ctx, this) == true\n    ) {\n        return;\n    }\n\n    // clip if required (mask)\n    const shape = node._shape || LiteGraph.BOX_SHAPE;\n    const size = temp_vec2;\n    temp_vec2.set(node.size);\n    const { horizontal } = node; // || node.flags.horizontal;\n\n    if (node.flags.collapsed) {\n        ctx.font = this.inner_text_font;\n        const title = node.getTitle ? node.getTitle() : node.title;\n        if (title != null) {\n            node._collapsed_width = Math.min(\n                node.size[0],\n                ctx.measureText(title).width\n                + LiteGraph.NODE_TITLE_HEIGHT * 2,\n            ); // LiteGraph.NODE_COLLAPSED_WIDTH;\n            size[0] = node._collapsed_width;\n            size[1] = 0;\n        }\n    }\n\n    if (node.clip_area) {\n        // Start clipping\n        ctx.save();\n        ctx.beginPath();\n        if (shape == LiteGraph.BOX_SHAPE) {\n            ctx.rect(0, 0, size[0], size[1]);\n        } else if (shape == LiteGraph.ROUND_SHAPE) {\n            ctx.roundRect(0, 0, size[0], size[1], 10);\n        } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n            ctx.arc(\n                size[0] * 0.5,\n                size[1] * 0.5,\n                size[0] * 0.5,\n                0,\n                Math.PI * 2,\n            );\n        }\n        ctx.clip();\n    }\n\n    // draw shape\n    if (node.has_errors) {\n        bgcolor = \"red\";\n    }\n    this.drawNodeShape(\n        node,\n        ctx,\n        size,\n        color,\n        bgcolor,\n        node.is_selected,\n        node.mouseOver,\n    );\n    ctx.shadowColor = \"transparent\";\n\n    // draw foreground\n    if (node.onDrawForeground) {\n        node.onDrawForeground(ctx, this, this.canvas);\n    }\n\n    // connection slots\n    ctx.textAlign = horizontal ? \"center\" : \"left\";\n    ctx.font = this.inner_text_font;\n\n    const render_text = !low_quality;\n\n    const out_slot = this.connecting_output;\n    ctx.lineWidth = 1;\n\n    let max_y = 0;\n    const slot_pos = new Float32Array(2); // to reuse\n\n    // render inputs and outputs\n    if (!node.flags.collapsed) {\n        // input connection slots\n        if (node.inputs) {\n            for (var i = 0; i < node.inputs.length; i++) {\n                var slot = node.inputs[i];\n\n                ctx.globalAlpha = editor_alpha;\n                // change opacity of incompatible slots when dragging a connection\n                if (this.connecting_node && !LiteGraph.isValidConnection(slot.type, out_slot.type)) {\n                    ctx.globalAlpha = 0.4 * editor_alpha;\n                }\n\n                ctx.fillStyle = slot.link != null\n                    ? slot.color_on\n                    || this.default_connection_color.input_on\n                    : slot.color_off\n                    || this.default_connection_color.input_off;\n\n                var pos = node.getConnectionPos(true, i, slot_pos);\n                pos[0] -= node.pos[0];\n                pos[1] -= node.pos[1];\n                if (max_y < pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5) {\n                    max_y = pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n                }\n\n                ctx.beginPath();\n\n                if (\n                    slot.type === LiteGraph.EVENT\n                    || slot.shape === LiteGraph.BOX_SHAPE\n                ) {\n                    if (horizontal) {\n                        ctx.rect(\n                            pos[0] - 5 + 0.5,\n                            pos[1] - 8 + 0.5,\n                            10,\n                            14,\n                        );\n                    } else {\n                        ctx.rect(\n                            pos[0] - 6 + 0.5,\n                            pos[1] - 5 + 0.5,\n                            14,\n                            10,\n                        );\n                    }\n                } else if (slot.shape === LiteGraph.ARROW_SHAPE) {\n                    ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n                    ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n                    ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n                    ctx.closePath();\n                } else if (low_quality) {\n                    ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8);\n                }// faster\n                else {\n                    ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n                }\n                ctx.fill();\n\n                // render name\n                if (render_text) {\n                    var text = slot.label != null ? slot.label : slot.name;\n                    if (text) {\n                        ctx.fillStyle = LiteGraph.NODE_TEXT_COLOR;\n                        if (horizontal || slot.dir == LiteGraph.UP) {\n                            ctx.fillText(text, pos[0], pos[1] - 10);\n                        } else {\n                            ctx.fillText(text, pos[0] + 10, pos[1] + 5);\n                        }\n                    }\n                }\n            }\n        }\n\n        // output connection slots\n        if (this.connecting_node) {\n            ctx.globalAlpha = 0.4 * editor_alpha;\n        }\n\n        ctx.textAlign = horizontal ? \"center\" : \"right\";\n        ctx.strokeStyle = \"black\";\n        if (node.outputs) {\n            for (var i = 0; i < node.outputs.length; i++) {\n                var slot = node.outputs[i];\n\n                var pos = node.getConnectionPos(false, i, slot_pos);\n                pos[0] -= node.pos[0];\n                pos[1] -= node.pos[1];\n                if (max_y < pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5) {\n                    max_y = pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n                }\n\n                ctx.fillStyle = slot.links && slot.links.length\n                    ? slot.color_on\n                    || this.default_connection_color.output_on\n                    : slot.color_off\n                    || this.default_connection_color.output_off;\n                ctx.beginPath();\n                // ctx.rect( node.size[0] - 14,i*14,10,10);\n\n                if (\n                    slot.type === LiteGraph.EVENT\n                    || slot.shape === LiteGraph.BOX_SHAPE\n                ) {\n                    if (horizontal) {\n                        ctx.rect(\n                            pos[0] - 5 + 0.5,\n                            pos[1] - 8 + 0.5,\n                            10,\n                            14,\n                        );\n                    } else {\n                        ctx.rect(\n                            pos[0] - 6 + 0.5,\n                            pos[1] - 5 + 0.5,\n                            14,\n                            10,\n                        );\n                    }\n                } else if (slot.shape === LiteGraph.ARROW_SHAPE) {\n                    ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n                    ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n                    ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n                    ctx.closePath();\n                } else if (low_quality) {\n                    ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8);\n                } else {\n                    ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n                }\n\n                // trigger\n                // if(slot.node_id != null && slot.slot == -1)\n                //\tctx.fillStyle = \"#F85\";\n\n                // if(slot.links != null && slot.links.length)\n                ctx.fill();\n                if (!low_quality) ctx.stroke();\n\n                // render output name\n                if (render_text) {\n                    var text = slot.label != null ? slot.label : slot.name;\n                    if (text) {\n                        ctx.fillStyle = LiteGraph.NODE_TEXT_COLOR;\n                        if (horizontal || slot.dir == LiteGraph.DOWN) {\n                            ctx.fillText(text, pos[0], pos[1] - 8);\n                        } else {\n                            ctx.fillText(text, pos[0] - 10, pos[1] + 5);\n                        }\n                    }\n                }\n            }\n        }\n\n        ctx.textAlign = \"left\";\n        ctx.globalAlpha = 1;\n\n        if (node.widgets) {\n            let widgets_y = max_y;\n            if (horizontal || node.widgets_up) {\n                widgets_y = 2;\n            }\n            if (node.widgets_start_y != null) widgets_y = node.widgets_start_y;\n            this.drawNodeWidgets(\n                node,\n                widgets_y,\n                ctx,\n                this.node_widget && this.node_widget[0] == node\n                    ? this.node_widget[1]\n                    : null,\n            );\n        }\n    } else if (this.render_collapsed_slots) {\n        // if collapsed\n        let input_slot = null;\n        let output_slot = null;\n\n        // get first connected slot to render\n        if (node.inputs) {\n            for (var i = 0; i < node.inputs.length; i++) {\n                var slot = node.inputs[i];\n                if (slot.link == null) {\n                    continue;\n                }\n                input_slot = slot;\n                break;\n            }\n        }\n        if (node.outputs) {\n            for (var i = 0; i < node.outputs.length; i++) {\n                var slot = node.outputs[i];\n                if (!slot.links || !slot.links.length) {\n                    continue;\n                }\n                output_slot = slot;\n            }\n        }\n\n        if (input_slot) {\n            var x = 0;\n            var y = LiteGraph.NODE_TITLE_HEIGHT * -0.5; // center\n            if (horizontal) {\n                x = node._collapsed_width * 0.5;\n                y = -LiteGraph.NODE_TITLE_HEIGHT;\n            }\n            ctx.fillStyle = \"#686\";\n            ctx.beginPath();\n            if (\n                slot.type === LiteGraph.EVENT\n                || slot.shape === LiteGraph.BOX_SHAPE\n            ) {\n                ctx.rect(x - 7 + 0.5, y - 4, 14, 8);\n            } else if (slot.shape === LiteGraph.ARROW_SHAPE) {\n                ctx.moveTo(x + 8, y);\n                ctx.lineTo(x + -4, y - 4);\n                ctx.lineTo(x + -4, y + 4);\n                ctx.closePath();\n            } else {\n                ctx.arc(x, y, 4, 0, Math.PI * 2);\n            }\n            ctx.fill();\n        }\n\n        if (output_slot) {\n            var x = node._collapsed_width;\n            var y = LiteGraph.NODE_TITLE_HEIGHT * -0.5; // center\n            if (horizontal) {\n                x = node._collapsed_width * 0.5;\n                y = 0;\n            }\n            ctx.fillStyle = \"#686\";\n            ctx.strokeStyle = \"black\";\n            ctx.beginPath();\n            if (\n                slot.type === LiteGraph.EVENT\n                || slot.shape === LiteGraph.BOX_SHAPE\n            ) {\n                ctx.rect(x - 7 + 0.5, y - 4, 14, 8);\n            } else if (slot.shape === LiteGraph.ARROW_SHAPE) {\n                ctx.moveTo(x + 6, y);\n                ctx.lineTo(x - 6, y - 4);\n                ctx.lineTo(x - 6, y + 4);\n                ctx.closePath();\n            } else {\n                ctx.arc(x, y, 4, 0, Math.PI * 2);\n            }\n            ctx.fill();\n            // ctx.stroke();\n        }\n    }\n\n    if (node.clip_area) {\n        ctx.restore();\n    }\n\n    ctx.globalAlpha = 1.0;\n};\n\n// used by this.over_link_center\nLGraphCanvas.prototype.drawLinkTooltip = function (ctx, link) {\n    const pos = link._pos;\n    ctx.fillStyle = \"black\";\n    ctx.beginPath();\n    ctx.arc(pos[0], pos[1], 3, 0, Math.PI * 2);\n    ctx.fill();\n\n    if (link.data == null) return;\n\n    if (this.onDrawLinkTooltip) if (this.onDrawLinkTooltip(ctx, link, this) == true) return;\n\n    const { data } = link;\n    let text = null;\n\n    if (data.constructor === Number) {\n        text = data.toFixed(2);\n    } else if (data.constructor === String) {\n        text = `\"${data}\"`;\n    } else if (data.constructor === Boolean) {\n        text = String(data);\n    } else if (data.toToolTip) {\n        text = data.toToolTip();\n    } else {\n        text = `[${data.constructor.name}]`;\n    }\n\n    if (text == null) return;\n    text = text.substr(0, 30); // avoid weird\n\n    ctx.font = \"14px Courier New\";\n    const info = ctx.measureText(text);\n    const w = info.width + 20;\n    const h = 24;\n    ctx.shadowColor = \"black\";\n    ctx.shadowOffsetX = 2;\n    ctx.shadowOffsetY = 2;\n    ctx.shadowBlur = 3;\n    ctx.fillStyle = \"#454\";\n    ctx.beginPath();\n    ctx.roundRect(pos[0] - w * 0.5, pos[1] - 15 - h, w, h, 3, 3);\n    ctx.moveTo(pos[0] - 10, pos[1] - 15);\n    ctx.lineTo(pos[0] + 10, pos[1] - 15);\n    ctx.lineTo(pos[0], pos[1] - 5);\n    ctx.fill();\n    ctx.shadowColor = \"transparent\";\n    ctx.textAlign = \"center\";\n    ctx.fillStyle = \"#CEC\";\n    ctx.fillText(text, pos[0], pos[1] - 15 - h * 0.3);\n};\n\n/**\n * draws the shape of the given node in the canvas\n * @method drawNodeShape\n * */\nconst tmp_area = new Float32Array(4);\n\nLGraphCanvas.prototype.drawNodeShape = function (\n    node,\n    ctx,\n    size,\n    fgcolor,\n    bgcolor,\n    selected,\n    mouse_over,\n) {\n    // bg rect\n    ctx.strokeStyle = fgcolor;\n    ctx.fillStyle = bgcolor;\n\n    const title_height = LiteGraph.NODE_TITLE_HEIGHT;\n    const low_quality = this.ds.scale < 0.5;\n\n    // render node area depending on shape\n    const shape = node._shape || node.constructor.shape || LiteGraph.ROUND_SHAPE;\n\n    const { title_mode } = node.constructor;\n\n    let render_title = true;\n    if (title_mode == LiteGraph.TRANSPARENT_TITLE) {\n        render_title = false;\n    } else if (title_mode == LiteGraph.AUTOHIDE_TITLE && mouse_over) {\n        render_title = true;\n    }\n\n    const area = tmp_area;\n    area[0] = 0; // x\n    area[1] = render_title ? -title_height : 0; // y\n    area[2] = size[0] + 1; // w\n    area[3] = render_title ? size[1] + title_height : size[1]; // h\n\n    const old_alpha = ctx.globalAlpha;\n\n    // full node shape\n    // if(node.flags.collapsed)\n    {\n        ctx.beginPath();\n        if (shape == LiteGraph.BOX_SHAPE || low_quality) {\n            ctx.fillRect(area[0], area[1], area[2], area[3]);\n        } else if (\n            shape == LiteGraph.ROUND_SHAPE\n            || shape == LiteGraph.CARD_SHAPE\n        ) {\n            ctx.roundRect(\n                area[0],\n                area[1],\n                area[2],\n                area[3],\n                this.round_radius,\n                shape == LiteGraph.CARD_SHAPE ? 0 : this.round_radius,\n            );\n        } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n            ctx.arc(\n                size[0] * 0.5,\n                size[1] * 0.5,\n                size[0] * 0.5,\n                0,\n                Math.PI * 2,\n            );\n        }\n        ctx.fill();\n\n        // separator\n        if (!node.flags.collapsed) {\n            ctx.shadowColor = \"transparent\";\n            ctx.fillStyle = \"rgba(0,0,0,0.2)\";\n            ctx.fillRect(0, -1, area[2], 2);\n        }\n    }\n    ctx.shadowColor = \"transparent\";\n\n    if (node.onDrawBackground) {\n        node.onDrawBackground(ctx, this, this.canvas, this.graph_mouse);\n    }\n\n    // title bg (remember, it is rendered ABOVE the node)\n    if (render_title || title_mode == LiteGraph.TRANSPARENT_TITLE) {\n        // title bar\n        if (node.onDrawTitleBar) {\n            node.onDrawTitleBar(ctx, title_height, size, this.ds.scale, fgcolor);\n        } else if (\n            title_mode != LiteGraph.TRANSPARENT_TITLE\n            && (node.constructor.title_color || this.render_title_colored)\n        ) {\n            const title_color = node.constructor.title_color || fgcolor;\n\n            if (node.flags.collapsed) {\n                ctx.shadowColor = LiteGraph.DEFAULT_SHADOW_COLOR;\n            }\n\n            //* gradient test\n            if (this.use_gradients) {\n                let grad = LGraphCanvas.gradients[title_color];\n                if (!grad) {\n                    grad = LGraphCanvas.gradients[title_color] = ctx.createLinearGradient(0, 0, 400, 0);\n                    grad.addColorStop(0, title_color);\n                    grad.addColorStop(1, \"#000\");\n                }\n                ctx.fillStyle = grad;\n            } else {\n                ctx.fillStyle = title_color;\n            }\n\n            // ctx.globalAlpha = 0.5 * old_alpha;\n            ctx.beginPath();\n            if (shape == LiteGraph.BOX_SHAPE || low_quality) {\n                ctx.rect(0, -title_height, size[0] + 1, title_height);\n            } else if (shape == LiteGraph.ROUND_SHAPE || shape == LiteGraph.CARD_SHAPE) {\n                ctx.roundRect(\n                    0,\n                    -title_height,\n                    size[0] + 1,\n                    title_height,\n                    this.round_radius,\n                    node.flags.collapsed ? this.round_radius : 0,\n                );\n            }\n            ctx.fill();\n            ctx.shadowColor = \"transparent\";\n        }\n\n        // title box\n        const box_size = 10;\n        if (node.onDrawTitleBox) {\n            node.onDrawTitleBox(ctx, title_height, size, this.ds.scale);\n        } else if (\n            shape == LiteGraph.ROUND_SHAPE\n            || shape == LiteGraph.CIRCLE_SHAPE\n            || shape == LiteGraph.CARD_SHAPE\n        ) {\n            if (low_quality) {\n                ctx.fillStyle = \"black\";\n                ctx.beginPath();\n                ctx.arc(\n                    title_height * 0.5,\n                    title_height * -0.5,\n                    box_size * 0.5 + 1,\n                    0,\n                    Math.PI * 2,\n                );\n                ctx.fill();\n            }\n\n            ctx.fillStyle = node.boxcolor || LiteGraph.NODE_DEFAULT_BOXCOLOR;\n            if (low_quality) {\n                ctx.fillRect(title_height * 0.5 - box_size * 0.5, title_height * -0.5 - box_size * 0.5, box_size, box_size);\n            } else {\n                ctx.beginPath();\n                ctx.arc(\n                    title_height * 0.5,\n                    title_height * -0.5,\n                    box_size * 0.5,\n                    0,\n                    Math.PI * 2,\n                );\n                ctx.fill();\n            }\n        } else {\n            if (low_quality) {\n                ctx.fillStyle = \"black\";\n                ctx.fillRect(\n                    (title_height - box_size) * 0.5 - 1,\n                    (title_height + box_size) * -0.5 - 1,\n                    box_size + 2,\n                    box_size + 2,\n                );\n            }\n            ctx.fillStyle = node.boxcolor || LiteGraph.NODE_DEFAULT_BOXCOLOR;\n            ctx.fillRect(\n                (title_height - box_size) * 0.5,\n                (title_height + box_size) * -0.5,\n                box_size,\n                box_size,\n            );\n        }\n        ctx.globalAlpha = old_alpha;\n\n        // title text\n        if (node.onDrawTitleText) {\n            node.onDrawTitleText(\n                ctx,\n                title_height,\n                size,\n                this.ds.scale,\n                this.title_text_font,\n                selected,\n            );\n        }\n        if (!low_quality) {\n            ctx.font = this.title_text_font;\n            const title = String(node.getTitle());\n            if (title) {\n                if (selected) {\n                    ctx.fillStyle = LiteGraph.NODE_SELECTED_TITLE_COLOR;\n                } else {\n                    ctx.fillStyle = node.constructor.title_text_color\n                        || this.node_title_color;\n                }\n                if (node.flags.collapsed) {\n                    ctx.textAlign = \"left\";\n                    const measure = ctx.measureText(title);\n                    ctx.fillText(\n                        title.substr(0, 20), // avoid urls too long\n                        title_height, // + measure.width * 0.5,\n                        LiteGraph.NODE_TITLE_TEXT_Y - title_height,\n                    );\n                    ctx.textAlign = \"left\";\n                } else {\n                    ctx.textAlign = \"left\";\n                    ctx.fillText(\n                        title,\n                        title_height,\n                        LiteGraph.NODE_TITLE_TEXT_Y - title_height,\n                    );\n                }\n            }\n        }\n\n        // subgraph box\n        if (!node.flags.collapsed && node.subgraph && !node.skip_subgraph_button) {\n            const w = LiteGraph.NODE_TITLE_HEIGHT;\n            const x = node.size[0] - w;\n            const over = LiteGraph.isInsideRectangle(this.graph_mouse[0] - node.pos[0], this.graph_mouse[1] - node.pos[1], x + 2, -w + 2, w - 4, w - 4);\n            ctx.fillStyle = over ? \"#888\" : \"#555\";\n            if (shape == LiteGraph.BOX_SHAPE || low_quality) {\n                ctx.fillRect(x + 2, -w + 2, w - 4, w - 4);\n            } else {\n                ctx.beginPath();\n                ctx.roundRect(x + 2, -w + 2, w - 4, w - 4, 4);\n                ctx.fill();\n            }\n            ctx.fillStyle = \"#333\";\n            ctx.beginPath();\n            ctx.moveTo(x + w * 0.2, -w * 0.6);\n            ctx.lineTo(x + w * 0.8, -w * 0.6);\n            ctx.lineTo(x + w * 0.5, -w * 0.3);\n            ctx.fill();\n        }\n\n        // custom title render\n        if (node.onDrawTitle) {\n            node.onDrawTitle(ctx);\n        }\n    }\n\n    // render selection marker\n    if (selected) {\n        if (node.onBounding) {\n            node.onBounding(area);\n        }\n\n        if (title_mode == LiteGraph.TRANSPARENT_TITLE) {\n            area[1] -= title_height;\n            area[3] += title_height;\n        }\n        ctx.lineWidth = 1;\n        ctx.globalAlpha = 0.8;\n        ctx.beginPath();\n        if (shape == LiteGraph.BOX_SHAPE) {\n            ctx.rect(\n                -6 + area[0],\n                -6 + area[1],\n                12 + area[2],\n                12 + area[3],\n            );\n        } else if (\n            shape == LiteGraph.ROUND_SHAPE\n            || (shape == LiteGraph.CARD_SHAPE && node.flags.collapsed)\n        ) {\n            ctx.roundRect(\n                -6 + area[0],\n                -6 + area[1],\n                12 + area[2],\n                12 + area[3],\n                this.round_radius * 2,\n            );\n        } else if (shape == LiteGraph.CARD_SHAPE) {\n            ctx.roundRect(\n                -6 + area[0],\n                -6 + area[1],\n                12 + area[2],\n                12 + area[3],\n                this.round_radius * 2,\n                2,\n            );\n        } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n            ctx.arc(\n                size[0] * 0.5,\n                size[1] * 0.5,\n                size[0] * 0.5 + 6,\n                0,\n                Math.PI * 2,\n            );\n        }\n        ctx.strokeStyle = LiteGraph.NODE_BOX_OUTLINE_COLOR;\n        ctx.stroke();\n        ctx.strokeStyle = fgcolor;\n        ctx.globalAlpha = 1;\n    }\n};\n\nconst margin_area = new Float32Array(4);\nconst link_bounding = new Float32Array(4);\nconst tempA = new Float32Array(2);\nconst tempB = new Float32Array(2);\n\n/**\n * draws every connection visible in the canvas\n * OPTIMIZE THIS: pre-catch connections position instead of recomputing them every time\n * @method drawConnections\n * */\nLGraphCanvas.prototype.drawConnections = function (ctx) {\n    const now = LiteGraph.getTime();\n    const { visible_area } = this;\n    margin_area[0] = visible_area[0] - 20;\n    margin_area[1] = visible_area[1] - 20;\n    margin_area[2] = visible_area[2] + 40;\n    margin_area[3] = visible_area[3] + 40;\n\n    // draw connections\n    ctx.lineWidth = this.connections_width;\n\n    ctx.fillStyle = \"#AAA\";\n    ctx.strokeStyle = \"#AAA\";\n    ctx.globalAlpha = this.editor_alpha;\n    // for every node\n    const nodes = this.graph._nodes;\n    for (let n = 0, l = nodes.length; n < l; ++n) {\n        const node = nodes[n];\n        // for every input (we render just inputs because it is easier as every slot can only\n        // have one input)\n        if (!node.inputs || !node.inputs.length) {\n            continue;\n        }\n\n        for (let i = 0; i < node.inputs.length; ++i) {\n            const input = node.inputs[i];\n            if (!input || input.link == null) {\n                continue;\n            }\n            const link_id = input.link;\n            const link = this.graph.links[link_id];\n            if (!link) {\n                continue;\n            }\n\n            // find link info\n            const start_node = this.graph.getNodeById(link.origin_id);\n            if (start_node == null) {\n                continue;\n            }\n            const start_node_slot = link.origin_slot;\n            let start_node_slotpos = null;\n            if (start_node_slot == -1) {\n                start_node_slotpos = [\n                    start_node.pos[0] + 10,\n                    start_node.pos[1] + 10,\n                ];\n            } else {\n                start_node_slotpos = start_node.getConnectionPos(\n                    false,\n                    start_node_slot,\n                    tempA,\n                );\n            }\n            const end_node_slotpos = node.getConnectionPos(true, i, tempB);\n\n            // compute link bounding\n            link_bounding[0] = start_node_slotpos[0];\n            link_bounding[1] = start_node_slotpos[1];\n            link_bounding[2] = end_node_slotpos[0] - start_node_slotpos[0];\n            link_bounding[3] = end_node_slotpos[1] - start_node_slotpos[1];\n            if (link_bounding[2] < 0) {\n                link_bounding[0] += link_bounding[2];\n                link_bounding[2] = Math.abs(link_bounding[2]);\n            }\n            if (link_bounding[3] < 0) {\n                link_bounding[1] += link_bounding[3];\n                link_bounding[3] = Math.abs(link_bounding[3]);\n            }\n\n            // skip links outside of the visible area of the canvas\n            if (!overlapBounding(link_bounding, margin_area)) {\n                continue;\n            }\n\n            const start_slot = start_node.outputs[start_node_slot];\n            const end_slot = node.inputs[i];\n            if (!start_slot || !end_slot) {\n                continue;\n            }\n            const start_dir = start_slot.dir\n                || (start_node.horizontal ? LiteGraph.DOWN : LiteGraph.RIGHT);\n            const end_dir = end_slot.dir\n                || (node.horizontal ? LiteGraph.UP : LiteGraph.LEFT);\n\n            this.renderLink(\n                ctx,\n                start_node_slotpos,\n                end_node_slotpos,\n                link,\n                false,\n                0,\n                null,\n                start_dir,\n                end_dir,\n            );\n\n            // event triggered rendered on top\n            if (link && link._last_time && now - link._last_time < 1000) {\n                const f = 2.0 - (now - link._last_time) * 0.002;\n                const tmp = ctx.globalAlpha;\n                ctx.globalAlpha = tmp * f;\n                this.renderLink(\n                    ctx,\n                    start_node_slotpos,\n                    end_node_slotpos,\n                    link,\n                    true,\n                    f,\n                    \"white\",\n                    start_dir,\n                    end_dir,\n                );\n                ctx.globalAlpha = tmp;\n            }\n        }\n    }\n    ctx.globalAlpha = 1;\n};\n\n/**\n * draws a link between two points\n * @method renderLink\n * @param {vec2} a start pos\n * @param {vec2} b end pos\n * @param {Object} link the link object with all the link info\n * @param {boolean} skip_border ignore the shadow of the link\n * @param {boolean} flow show flow animation (for events)\n * @param {string} color the color for the link\n * @param {number} start_dir the direction enum\n * @param {number} end_dir the direction enum\n * @param {number} num_sublines number of sublines (useful to represent vec3 or rgb)\n * */\nLGraphCanvas.prototype.renderLink = function (\n    ctx,\n    a,\n    b,\n    link,\n    skip_border,\n    flow,\n    color,\n    start_dir,\n    end_dir,\n    num_sublines,\n) {\n    if (link) {\n        this.visible_links.push(link);\n    }\n\n    // choose color\n    if (!color && link) {\n        color = link.color || LGraphCanvas.link_type_colors[link.type];\n    }\n    if (!color) {\n        color = this.default_link_color;\n    }\n    if (link != null && this.highlighted_links[link.id]) {\n        color = \"#FFF\";\n    }\n\n    start_dir = start_dir || LiteGraph.RIGHT;\n    end_dir = end_dir || LiteGraph.LEFT;\n\n    const dist = distance(a, b);\n\n    if (this.render_connections_border && this.ds.scale > 0.6) {\n        ctx.lineWidth = this.connections_width + 4;\n    }\n    ctx.lineJoin = \"round\";\n    num_sublines = num_sublines || 1;\n    if (num_sublines > 1) {\n        ctx.lineWidth = 0.5;\n    }\n\n    // begin line shape\n    ctx.beginPath();\n    for (var i = 0; i < num_sublines; i += 1) {\n        const offsety = (i - (num_sublines - 1) * 0.5) * 5;\n\n        if (this.links_render_mode == LiteGraph.SPLINE_LINK) {\n            ctx.moveTo(a[0], a[1] + offsety);\n            var start_offset_x = 0;\n            var start_offset_y = 0;\n            var end_offset_x = 0;\n            var end_offset_y = 0;\n            switch (start_dir) {\n                case LiteGraph.LEFT:\n                    start_offset_x = dist * -0.25;\n                    break;\n                case LiteGraph.RIGHT:\n                    start_offset_x = dist * 0.25;\n                    break;\n                case LiteGraph.UP:\n                    start_offset_y = dist * -0.25;\n                    break;\n                case LiteGraph.DOWN:\n                    start_offset_y = dist * 0.25;\n                    break;\n            }\n            switch (end_dir) {\n                case LiteGraph.LEFT:\n                    end_offset_x = dist * -0.25;\n                    break;\n                case LiteGraph.RIGHT:\n                    end_offset_x = dist * 0.25;\n                    break;\n                case LiteGraph.UP:\n                    end_offset_y = dist * -0.25;\n                    break;\n                case LiteGraph.DOWN:\n                    end_offset_y = dist * 0.25;\n                    break;\n            }\n            ctx.bezierCurveTo(\n                a[0] + start_offset_x,\n                a[1] + start_offset_y + offsety,\n                b[0] + end_offset_x,\n                b[1] + end_offset_y + offsety,\n                b[0],\n                b[1] + offsety,\n            );\n        } else if (this.links_render_mode == LiteGraph.LINEAR_LINK) {\n            ctx.moveTo(a[0], a[1] + offsety);\n            var start_offset_x = 0;\n            var start_offset_y = 0;\n            var end_offset_x = 0;\n            var end_offset_y = 0;\n            switch (start_dir) {\n                case LiteGraph.LEFT:\n                    start_offset_x = -1;\n                    break;\n                case LiteGraph.RIGHT:\n                    start_offset_x = 1;\n                    break;\n                case LiteGraph.UP:\n                    start_offset_y = -1;\n                    break;\n                case LiteGraph.DOWN:\n                    start_offset_y = 1;\n                    break;\n            }\n            switch (end_dir) {\n                case LiteGraph.LEFT:\n                    end_offset_x = -1;\n                    break;\n                case LiteGraph.RIGHT:\n                    end_offset_x = 1;\n                    break;\n                case LiteGraph.UP:\n                    end_offset_y = -1;\n                    break;\n                case LiteGraph.DOWN:\n                    end_offset_y = 1;\n                    break;\n            }\n            const l = 15;\n            ctx.lineTo(\n                a[0] + start_offset_x * l,\n                a[1] + start_offset_y * l + offsety,\n            );\n            ctx.lineTo(\n                b[0] + end_offset_x * l,\n                b[1] + end_offset_y * l + offsety,\n            );\n            ctx.lineTo(b[0], b[1] + offsety);\n        } else if (this.links_render_mode == LiteGraph.STRAIGHT_LINK) {\n            ctx.moveTo(a[0], a[1]);\n            let start_x = a[0];\n            let start_y = a[1];\n            let end_x = b[0];\n            let end_y = b[1];\n            if (start_dir == LiteGraph.RIGHT) {\n                start_x += 10;\n            } else {\n                start_y += 10;\n            }\n            if (end_dir == LiteGraph.LEFT) {\n                end_x -= 10;\n            } else {\n                end_y -= 10;\n            }\n            ctx.lineTo(start_x, start_y);\n            ctx.lineTo((start_x + end_x) * 0.5, start_y);\n            ctx.lineTo((start_x + end_x) * 0.5, end_y);\n            ctx.lineTo(end_x, end_y);\n            ctx.lineTo(b[0], b[1]);\n        } else {\n            return;\n        } // unknown\n    }\n\n    // rendering the outline of the connection can be a little bit slow\n    if (\n        this.render_connections_border\n        && this.ds.scale > 0.6\n        && !skip_border\n    ) {\n        ctx.strokeStyle = \"rgba(0,0,0,0.5)\";\n        ctx.stroke();\n    }\n\n    ctx.lineWidth = this.connections_width;\n    ctx.fillStyle = ctx.strokeStyle = color;\n    ctx.stroke();\n    // end line shape\n\n    var pos = this.computeConnectionPoint(a, b, 0.5, start_dir, end_dir);\n    if (link && link._pos) {\n        link._pos[0] = pos[0];\n        link._pos[1] = pos[1];\n    }\n\n    // render arrow in the middle\n    if (\n        this.ds.scale >= 0.6\n        && this.highquality_render\n        && end_dir != LiteGraph.CENTER\n    ) {\n        // render arrow\n        if (this.render_connection_arrows) {\n            // compute two points in the connection\n            const posA = this.computeConnectionPoint(\n                a,\n                b,\n                0.25,\n                start_dir,\n                end_dir,\n            );\n            const posB = this.computeConnectionPoint(\n                a,\n                b,\n                0.26,\n                start_dir,\n                end_dir,\n            );\n            const posC = this.computeConnectionPoint(\n                a,\n                b,\n                0.75,\n                start_dir,\n                end_dir,\n            );\n            const posD = this.computeConnectionPoint(\n                a,\n                b,\n                0.76,\n                start_dir,\n                end_dir,\n            );\n\n            // compute the angle between them so the arrow points in the right direction\n            let angleA = 0;\n            let angleB = 0;\n            if (this.render_curved_connections) {\n                angleA = -Math.atan2(posB[0] - posA[0], posB[1] - posA[1]);\n                angleB = -Math.atan2(posD[0] - posC[0], posD[1] - posC[1]);\n            } else {\n                angleB = angleA = b[1] > a[1] ? 0 : Math.PI;\n            }\n\n            // render arrow\n            ctx.save();\n            ctx.translate(posA[0], posA[1]);\n            ctx.rotate(angleA);\n            ctx.beginPath();\n            ctx.moveTo(-5, -3);\n            ctx.lineTo(0, +7);\n            ctx.lineTo(+5, -3);\n            ctx.fill();\n            ctx.restore();\n            ctx.save();\n            ctx.translate(posC[0], posC[1]);\n            ctx.rotate(angleB);\n            ctx.beginPath();\n            ctx.moveTo(-5, -3);\n            ctx.lineTo(0, +7);\n            ctx.lineTo(+5, -3);\n            ctx.fill();\n            ctx.restore();\n        }\n\n        // circle\n        ctx.beginPath();\n        ctx.arc(pos[0], pos[1], 5, 0, Math.PI * 2);\n        ctx.fill();\n    }\n\n    // render flowing points\n    if (flow) {\n        ctx.fillStyle = color;\n        for (var i = 0; i < 5; ++i) {\n            const f = (LiteGraph.getTime() * 0.001 + i * 0.2) % 1;\n            var pos = this.computeConnectionPoint(\n                a,\n                b,\n                f,\n                start_dir,\n                end_dir,\n            );\n            ctx.beginPath();\n            ctx.arc(pos[0], pos[1], 5, 0, 2 * Math.PI);\n            ctx.fill();\n        }\n    }\n};\n\n// returns the link center point based on curvature\nLGraphCanvas.prototype.computeConnectionPoint = function (\n    a,\n    b,\n    t,\n    start_dir,\n    end_dir,\n) {\n    start_dir = start_dir || LiteGraph.RIGHT;\n    end_dir = end_dir || LiteGraph.LEFT;\n\n    const dist = distance(a, b);\n    const p0 = a;\n    const p1 = [a[0], a[1]];\n    const p2 = [b[0], b[1]];\n    const p3 = b;\n\n    switch (start_dir) {\n        case LiteGraph.LEFT:\n            p1[0] += dist * -0.25;\n            break;\n        case LiteGraph.RIGHT:\n            p1[0] += dist * 0.25;\n            break;\n        case LiteGraph.UP:\n            p1[1] += dist * -0.25;\n            break;\n        case LiteGraph.DOWN:\n            p1[1] += dist * 0.25;\n            break;\n    }\n    switch (end_dir) {\n        case LiteGraph.LEFT:\n            p2[0] += dist * -0.25;\n            break;\n        case LiteGraph.RIGHT:\n            p2[0] += dist * 0.25;\n            break;\n        case LiteGraph.UP:\n            p2[1] += dist * -0.25;\n            break;\n        case LiteGraph.DOWN:\n            p2[1] += dist * 0.25;\n            break;\n    }\n\n    const c1 = (1 - t) * (1 - t) * (1 - t);\n    const c2 = 3 * ((1 - t) * (1 - t)) * t;\n    const c3 = 3 * (1 - t) * (t * t);\n    const c4 = t * t * t;\n\n    const x = c1 * p0[0] + c2 * p1[0] + c3 * p2[0] + c4 * p3[0];\n    const y = c1 * p0[1] + c2 * p1[1] + c3 * p2[1] + c4 * p3[1];\n    return [x, y];\n};\n\nLGraphCanvas.prototype.drawExecutionOrder = function (ctx) {\n    ctx.shadowColor = \"transparent\";\n    ctx.globalAlpha = 0.25;\n\n    ctx.textAlign = \"center\";\n    ctx.strokeStyle = \"white\";\n    ctx.globalAlpha = 0.75;\n\n    const { visible_nodes } = this;\n    for (let i = 0; i < visible_nodes.length; ++i) {\n        const node = visible_nodes[i];\n        ctx.fillStyle = \"black\";\n        ctx.fillRect(\n            node.pos[0] - LiteGraph.NODE_TITLE_HEIGHT,\n            node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT,\n            LiteGraph.NODE_TITLE_HEIGHT,\n            LiteGraph.NODE_TITLE_HEIGHT,\n        );\n        if (node.order == 0) {\n            ctx.strokeRect(\n                node.pos[0] - LiteGraph.NODE_TITLE_HEIGHT + 0.5,\n                node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5,\n                LiteGraph.NODE_TITLE_HEIGHT,\n                LiteGraph.NODE_TITLE_HEIGHT,\n            );\n        }\n        ctx.fillStyle = \"#FFF\";\n        ctx.fillText(\n            node.order,\n            node.pos[0] + LiteGraph.NODE_TITLE_HEIGHT * -0.5,\n            node.pos[1] - 6,\n        );\n    }\n    ctx.globalAlpha = 1;\n};\n\n/**\n * draws the widgets stored inside a node\n * @method drawNodeWidgets\n * */\nLGraphCanvas.prototype.drawNodeWidgets = function (\n    node,\n    posY,\n    ctx,\n    active_widget,\n) {\n    if (!node.widgets || !node.widgets.length) {\n        return 0;\n    }\n    const width = node.size[0];\n    const { widgets } = node;\n    posY += 2;\n    const H = LiteGraph.NODE_WIDGET_HEIGHT;\n    const show_text = this.ds.scale > 0.5;\n    ctx.save();\n    ctx.globalAlpha = this.editor_alpha;\n    const outline_color = LiteGraph.WIDGET_OUTLINE_COLOR;\n    const background_color = LiteGraph.WIDGET_BGCOLOR;\n    const text_color = LiteGraph.WIDGET_TEXT_COLOR;\n    const secondary_text_color = LiteGraph.WIDGET_SECONDARY_TEXT_COLOR;\n    const margin = 15;\n\n    for (let i = 0; i < widgets.length; ++i) {\n        const w = widgets[i];\n        let y = posY;\n        if (w.y) {\n            y = w.y;\n        }\n        w.last_y = y;\n        ctx.strokeStyle = outline_color;\n        ctx.fillStyle = \"#222\";\n        ctx.textAlign = \"left\";\n        // ctx.lineWidth = 2;\n        if (w.disabled) ctx.globalAlpha *= 0.5;\n        const widget_width = w.width || width;\n\n        switch (w.type) {\n            case \"button\":\n                if (w.clicked) {\n                    ctx.fillStyle = \"#AAA\";\n                    w.clicked = false;\n                    this.dirty_canvas = true;\n                }\n                ctx.fillRect(margin, y, widget_width - margin * 2, H);\n                if (show_text && !w.disabled) ctx.strokeRect(margin, y, widget_width - margin * 2, H);\n                if (show_text) {\n                    ctx.textAlign = \"center\";\n                    ctx.fillStyle = text_color;\n                    ctx.fillText(w.name, widget_width * 0.5, y + H * 0.7);\n                }\n                break;\n            case \"toggle\":\n                ctx.textAlign = \"left\";\n                ctx.strokeStyle = outline_color;\n                ctx.fillStyle = background_color;\n                ctx.beginPath();\n                if (show_text) {\n                    ctx.roundRect(margin, posY, widget_width - margin * 2, H, H * 0.5);\n                } else {\n                    ctx.rect(margin, posY, widget_width - margin * 2, H);\n                }\n                ctx.fill();\n                if (show_text && !w.disabled) ctx.stroke();\n                ctx.fillStyle = w.value ? \"#89A\" : \"#333\";\n                ctx.beginPath();\n                ctx.arc(widget_width - margin * 2, y + H * 0.5, H * 0.36, 0, Math.PI * 2);\n                ctx.fill();\n                if (show_text) {\n                    ctx.fillStyle = secondary_text_color;\n                    if (w.name != null) {\n                        ctx.fillText(w.name, margin * 2, y + H * 0.7);\n                    }\n                    ctx.fillStyle = w.value ? text_color : secondary_text_color;\n                    ctx.textAlign = \"right\";\n                    ctx.fillText(\n                        w.value\n                            ? w.options.on || \"true\"\n                            : w.options.off || \"false\",\n                        widget_width - 40,\n                        y + H * 0.7,\n                    );\n                }\n                break;\n            case \"slider\":\n                ctx.fillStyle = background_color;\n                ctx.fillRect(margin, y, widget_width - margin * 2, H);\n                var range = w.options.max - w.options.min;\n                var nvalue = (w.value - w.options.min) / range;\n                ctx.fillStyle = active_widget == w ? \"#89A\" : \"#678\";\n                ctx.fillRect(margin, y, nvalue * (widget_width - margin * 2), H);\n                if (show_text && !w.disabled) ctx.strokeRect(margin, y, widget_width - margin * 2, H);\n                if (w.marker) {\n                    const marker_nvalue = (w.marker - w.options.min) / range;\n                    ctx.fillStyle = \"#AA9\";\n                    ctx.fillRect(margin + marker_nvalue * (widget_width - margin * 2), y, 2, H);\n                }\n                if (show_text) {\n                    ctx.textAlign = \"center\";\n                    ctx.fillStyle = text_color;\n                    ctx.fillText(\n                        `${w.name}  ${Number(w.value)\n                            .toFixed(3)}`,\n                        widget_width * 0.5,\n                        y + H * 0.7,\n                    );\n                }\n                break;\n            case \"number\":\n            case \"combo\":\n                ctx.textAlign = \"left\";\n                ctx.strokeStyle = outline_color;\n                ctx.fillStyle = background_color;\n                ctx.beginPath();\n                if (show_text) {\n                    ctx.roundRect(margin, posY, widget_width - margin * 2, H, H * 0.5);\n                } else {\n                    ctx.rect(margin, posY, widget_width - margin * 2, H);\n                }\n                ctx.fill();\n                if (show_text) {\n                    if (!w.disabled) ctx.stroke();\n                    ctx.fillStyle = text_color;\n                    if (!w.disabled) {\n                        ctx.beginPath();\n                        ctx.moveTo(margin + 16, posY + 5);\n                        ctx.lineTo(margin + 6, posY + H * 0.5);\n                        ctx.lineTo(margin + 16, posY + H - 5);\n                        ctx.fill();\n                        ctx.beginPath();\n                        ctx.moveTo(widget_width - margin - 16, posY + 5);\n                        ctx.lineTo(widget_width - margin - 6, posY + H * 0.5);\n                        ctx.lineTo(widget_width - margin - 16, posY + H - 5);\n                        ctx.fill();\n                    }\n                    ctx.fillStyle = secondary_text_color;\n                    ctx.fillText(w.name, margin * 2 + 5, y + H * 0.7);\n                    ctx.fillStyle = text_color;\n                    ctx.textAlign = \"right\";\n                    if (w.type == \"number\") {\n                        ctx.fillText(\n                            Number(w.value)\n                                .toFixed(\n                                    w.options.precision !== undefined\n                                        ? w.options.precision\n                                        : 3,\n                                ),\n                            widget_width - margin * 2 - 20,\n                            y + H * 0.7,\n                        );\n                    } else {\n                        let v = w.value;\n                        if (w.options.values) {\n                            let { values } = w.options;\n                            if (values.constructor === Function) values = values();\n                            if (values && values.constructor !== Array) v = values[w.value];\n                        }\n                        ctx.fillText(\n                            v,\n                            widget_width - margin * 2 - 20,\n                            y + H * 0.7,\n                        );\n                    }\n                }\n                break;\n            case \"string\":\n            case \"text\":\n                ctx.textAlign = \"left\";\n                ctx.strokeStyle = outline_color;\n                ctx.fillStyle = background_color;\n                ctx.beginPath();\n                if (show_text) {\n                    ctx.roundRect(margin, posY, widget_width - margin * 2, H, H * 0.5);\n                } else {\n                    ctx.rect(margin, posY, widget_width - margin * 2, H);\n                }\n                ctx.fill();\n                if (show_text) {\n                    if (!w.disabled) ctx.stroke();\n                    ctx.save();\n                    ctx.beginPath();\n                    ctx.rect(margin, posY, widget_width - margin * 2, H);\n                    ctx.clip();\n\n                    // ctx.stroke();\n                    ctx.fillStyle = secondary_text_color;\n                    if (w.name != null) {\n                        ctx.fillText(w.name, margin * 2, y + H * 0.7);\n                    }\n                    ctx.fillStyle = text_color;\n                    ctx.textAlign = \"right\";\n                    ctx.fillText(String(w.value)\n                        .substr(0, 30), widget_width - margin * 2, y + H * 0.7); // 30 chars max\n                    ctx.restore();\n                }\n                break;\n            default:\n                if (w.draw) {\n                    w.draw(ctx, node, widget_width, y, H);\n                }\n                break;\n        }\n        posY += (w.computeSize ? w.computeSize(widget_width)[1] : H) + 4;\n        ctx.globalAlpha = this.editor_alpha;\n    }\n    ctx.restore();\n    ctx.textAlign = \"left\";\n};\n\n/**\n * process an event on widgets\n * @method processNodeWidgets\n * */\nLGraphCanvas.prototype.processNodeWidgets = function (\n    node,\n    pos,\n    event,\n    active_widget,\n) {\n    if (!node.widgets || !node.widgets.length) {\n        return null;\n    }\n\n    const x = pos[0] - node.pos[0];\n    const y = pos[1] - node.pos[1];\n    const width = node.size[0];\n    const that = this;\n    const ref_window = this.getCanvasWindow();\n\n    for (let i = 0; i < node.widgets.length; ++i) {\n        var w = node.widgets[i];\n        if (!w || w.disabled) continue;\n        const widget_height = w.computeSize ? w.computeSize(width)[1] : LiteGraph.NODE_WIDGET_HEIGHT;\n        const widget_width = w.width || width;\n        // outside\n        if (w != active_widget\n            && (x < 6 || x > widget_width - 12 || y < w.last_y || y > w.last_y + widget_height)) {\n            continue;\n        }\n\n        var old_value = w.value;\n\n        // if ( w == active_widget || (x > 6 && x < widget_width - 12 && y > w.last_y && y <\n        // w.last_y + widget_height) ) { inside widget\n        switch (w.type) {\n            case \"button\":\n                if (event.type === \"mousemove\") {\n                    break;\n                }\n                if (w.callback) {\n                    setTimeout(() => {\n                        w.callback(w, that, node, pos, event);\n                    }, 20);\n                }\n                w.clicked = true;\n                this.dirty_canvas = true;\n                break;\n            case \"slider\":\n                var range = w.options.max - w.options.min;\n                var nvalue = Math.clamp((x - 15) / (widget_width - 30), 0, 1);\n                w.value = w.options.min + (w.options.max - w.options.min) * nvalue;\n                if (w.callback) {\n                    setTimeout(() => {\n                        inner_value_change(w, w.value);\n                    }, 20);\n                }\n                this.dirty_canvas = true;\n                break;\n            case \"number\":\n            case \"combo\":\n                var old_value = w.value;\n                if (event.type == \"mousemove\" && w.type == \"number\") {\n                    w.value += event.deltaX * 0.1 * (w.options.step || 1);\n                    if (w.options.min != null && w.value < w.options.min) {\n                        w.value = w.options.min;\n                    }\n                    if (w.options.max != null && w.value > w.options.max) {\n                        w.value = w.options.max;\n                    }\n                } else if (event.type == \"mousedown\") {\n                    var { values } = w.options;\n                    if (values && values.constructor === Function) {\n                        values = w.options.values(w, node);\n                    }\n                    var values_list = null;\n\n                    if (w.type != \"number\") values_list = values.constructor === Array ? values : Object.keys(values);\n\n                    var delta = x < 40 ? -1 : x > widget_width - 40 ? 1 : 0;\n                    if (w.type == \"number\") {\n                        w.value += delta * 0.1 * (w.options.step || 1);\n                        if (w.options.min != null && w.value < w.options.min) {\n                            w.value = w.options.min;\n                        }\n                        if (w.options.max != null && w.value > w.options.max) {\n                            w.value = w.options.max;\n                        }\n                    } else if (delta) { // clicked in arrow, used for combos\n                        let index = -1;\n                        this.last_mouseclick = 0; // avoids dobl click event\n                        if (values.constructor === Object) {\n                            index = values_list.indexOf(String(w.value)) + delta;\n                        } else {\n                            index = values_list.indexOf(w.value) + delta;\n                        }\n                        if (index >= values_list.length) {\n                            index = values_list.length - 1;\n                        }\n                        if (index < 0) {\n                            index = 0;\n                        }\n                        if (values.constructor === Array) {\n                            w.value = values[index];\n                        } else {\n                            w.value = index;\n                        }\n                    } else { // combo clicked\n                        var text_values = values != values_list ? Object.values(values) : values;\n                        const menu = new LiteGraph.ContextMenu(text_values, {\n                            scale: Math.max(1, this.ds.scale),\n                            event,\n                            className: \"dark\",\n                            callback: inner_clicked.bind(w),\n                        },\n                        ref_window);\n\n                        function inner_clicked(v, option, event) {\n                            if (values != values_list) v = text_values.indexOf(v);\n                            this.value = v;\n                            inner_value_change(this, v);\n                            that.dirty_canvas = true;\n                            return false;\n                        }\n                    }\n                } // end mousedown\n                else if (event.type == \"mouseup\" && w.type == \"number\") {\n                    var delta = x < 40 ? -1 : x > widget_width - 40 ? 1 : 0;\n                    if (event.click_time < 200 && delta == 0) {\n                        this.prompt(\"Value\", w.value, function (v) {\n                            this.value = Number(v);\n                            inner_value_change(this, this.value);\n                        }.bind(w),\n                        event);\n                    }\n                }\n\n                if (old_value != w.value) {\n                    setTimeout(\n                        function () {\n                            inner_value_change(this, this.value);\n                        }.bind(w),\n                        20,\n                    );\n                }\n                this.dirty_canvas = true;\n                break;\n            case \"toggle\":\n                if (event.type == \"mousedown\") {\n                    w.value = !w.value;\n                    setTimeout(() => {\n                        inner_value_change(w, w.value);\n                    }, 20);\n                }\n                break;\n            case \"string\":\n            case \"text\":\n                if (event.type == \"mousedown\") {\n                    this.prompt(\"Value\", w.value, function (v) {\n                        this.value = v;\n                        inner_value_change(this, v);\n                    }.bind(w),\n                    event, w.options ? w.options.multiline : false);\n                }\n                break;\n            default:\n                if (w.mouse) {\n                    this.dirty_canvas = w.mouse(event, [x, y], node);\n                }\n                break;\n        } // end switch\n\n        // value changed\n        if (old_value != w.value) {\n            if (node.onWidgetChanged) node.onWidgetChanged(w.name, w.value, old_value, w);\n            node.graph._version++;\n        }\n\n        return w;\n    }// end for\n\n    function inner_value_change(widget, value) {\n        widget.value = value;\n        if (widget.options && widget.options.property && node.properties[widget.options.property] !== undefined) {\n            node.setProperty(widget.options.property, value);\n        }\n        if (widget.callback) {\n            widget.callback(widget.value, that, node, pos, event);\n        }\n    }\n\n    return null;\n};\n\n/**\n * draws every group area in the background\n * @method drawGroups\n * */\nLGraphCanvas.prototype.drawGroups = function (canvas, ctx) {\n    if (!this.graph) {\n        return;\n    }\n\n    const groups = this.graph._groups;\n\n    ctx.save();\n    ctx.globalAlpha = 0.5 * this.editor_alpha;\n\n    for (let i = 0; i < groups.length; ++i) {\n        const group = groups[i];\n\n        if (!overlapBounding(this.visible_area, group._bounding)) {\n            continue;\n        } // out of the visible area\n\n        ctx.fillStyle = group.color || \"#335\";\n        ctx.strokeStyle = group.color || \"#335\";\n        const pos = group._pos;\n        const size = group._size;\n        ctx.globalAlpha = 0.25 * this.editor_alpha;\n        ctx.beginPath();\n        ctx.rect(pos[0] + 0.5, pos[1] + 0.5, size[0], size[1]);\n        ctx.fill();\n        ctx.globalAlpha = this.editor_alpha;\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(pos[0] + size[0], pos[1] + size[1]);\n        ctx.lineTo(pos[0] + size[0] - 10, pos[1] + size[1]);\n        ctx.lineTo(pos[0] + size[0], pos[1] + size[1] - 10);\n        ctx.fill();\n\n        const font_size = group.font_size || LiteGraph.DEFAULT_GROUP_FONT_SIZE;\n        ctx.font = `${font_size}px Arial`;\n        ctx.fillText(group.title, pos[0] + 4, pos[1] + font_size);\n    }\n\n    ctx.restore();\n};\n\nLGraphCanvas.prototype.adjustNodesSize = function () {\n    const nodes = this.graph._nodes;\n    for (let i = 0; i < nodes.length; ++i) {\n        nodes[i].size = nodes[i].computeSize();\n    }\n    this.setDirty(true, true);\n};\n\n/**\n * resizes the canvas to a given size, if no size is passed, then it tries to fill the\n * parentNode\n * @method resize\n * */\nLGraphCanvas.prototype.resize = function (width, height) {\n    if (!width && !height) {\n        const parent = this.canvas.parentNode;\n        width = parent.offsetWidth;\n        height = parent.offsetHeight;\n    }\n\n    if (this.canvas.width == width && this.canvas.height == height) {\n        return;\n    }\n\n    this.canvas.width = width;\n    this.canvas.height = height;\n    this.bgcanvas.width = this.canvas.width;\n    this.bgcanvas.height = this.canvas.height;\n    this.setDirty(true, true);\n};\n\n/**\n * switches to live mode (node shapes are not rendered, only the content)\n * this feature was designed when graphs where meant to create user interfaces\n * @method switchLiveMode\n * */\nLGraphCanvas.prototype.switchLiveMode = function (transition) {\n    if (!transition) {\n        this.live_mode = !this.live_mode;\n        this.dirty_canvas = true;\n        this.dirty_bgcanvas = true;\n        return;\n    }\n\n    const self = this;\n    const delta = this.live_mode ? 1.1 : 0.9;\n    if (this.live_mode) {\n        this.live_mode = false;\n        this.editor_alpha = 0.1;\n    }\n\n    var t = setInterval(() => {\n        self.editor_alpha *= delta;\n        self.dirty_canvas = true;\n        self.dirty_bgcanvas = true;\n\n        if (delta < 1 && self.editor_alpha < 0.01) {\n            clearInterval(t);\n            if (delta < 1) {\n                self.live_mode = true;\n            }\n        }\n        if (delta > 1 && self.editor_alpha > 0.99) {\n            clearInterval(t);\n            self.editor_alpha = 1;\n        }\n    }, 1);\n};\n\nLGraphCanvas.prototype.onNodeSelectionChange = function (node) {\n    // disabled\n};\n\nLGraphCanvas.prototype.touchHandler = function (event) {\n    // alert(\"foo\");\n    const touches = event.changedTouches;\n    const first = touches[0];\n    let type = \"\";\n\n    switch (event.type) {\n        case \"touchstart\":\n            type = \"mousedown\";\n            break;\n        case \"touchmove\":\n            type = \"mousemove\";\n            break;\n        case \"touchend\":\n            type = \"mouseup\";\n            break;\n        default:\n            return;\n    }\n\n    // initMouseEvent(type, canBubble, cancelable, view, clickCount,\n    //           screenX, screenY, clientX, clientY, ctrlKey,\n    //           altKey, shiftKey, metaKey, button, relatedTarget);\n\n    const window = this.getCanvasWindow();\n    const { document } = window;\n\n    const simulatedEvent = document.createEvent(\"MouseEvent\");\n    simulatedEvent.initMouseEvent(\n        type,\n        true,\n        true,\n        window,\n        1,\n        first.screenX,\n        first.screenY,\n        first.clientX,\n        first.clientY,\n        false,\n        false,\n        false,\n        false,\n        0 /* left */,\n        null,\n    );\n    first.target.dispatchEvent(simulatedEvent);\n    event.preventDefault();\n};\n\n/* CONTEXT MENU ******************* */\n\nLGraphCanvas.onGroupAdd = function (info, entry, mouse_event) {\n    const canvas = LGraphCanvas.active_canvas;\n    const ref_window = canvas.getCanvasWindow();\n\n    const group = new LiteGraph.LGraphGroup();\n    group.pos = canvas.convertEventToCanvasOffset(mouse_event);\n    canvas.graph.add(group);\n};\n\nLGraphCanvas.onMenuAdd = function (node, options, e, prev_menu, callback) {\n    const canvas = LGraphCanvas.active_canvas;\n    const ref_window = canvas.getCanvasWindow();\n    const { graph } = canvas;\n    if (!graph) return;\n\n    function inner_onMenuAdded(base_category, prev_menu) {\n        const categories = LiteGraph.getNodeTypesCategories(canvas.filter || graph.filter)\n            .filter((category) => category.startsWith(base_category));\n        const entries = [];\n\n        categories.map((category) => {\n            if (!category) {\n                return;\n            }\n\n            const base_category_regex = new RegExp(`^(${base_category})`);\n            const category_name = category.replace(base_category_regex, \"\")\n                .split(\"/\")[0];\n            const category_path = base_category === \"\" ? `${category_name}/` : `${base_category + category_name}/`;\n\n            let name = category_name;\n            if (name.indexOf(\"::\") != -1) // in case it has a namespace like \"shader::math/rand\" it hides the\n            // namespace\n            {\n                name = name.split(\"::\")[1];\n            }\n\n            const index = entries.findIndex((entry) => entry.value === category_path);\n            if (index === -1) {\n                entries.push({\n                    value: category_path,\n                    content: name,\n                    has_submenu: true,\n                    callback(value, event, mouseEvent, contextMenu) {\n                        inner_onMenuAdded(value.value, contextMenu);\n                    },\n                });\n            }\n        });\n\n        const nodes = LiteGraph.getNodeTypesInCategory(base_category.slice(0, -1), canvas.filter || graph.filter);\n        nodes.map((node) => {\n            if (node.skip_list) return;\n\n            const entry = {\n                value: node.type,\n                content: node.title,\n                has_submenu: false,\n                callback(value, event, mouseEvent, contextMenu) {\n                    const first_event = contextMenu.getFirstEvent();\n                    canvas.graph.beforeChange();\n                    const node = LiteGraph.createNode(value.value);\n                    if (node) {\n                        node.pos = canvas.convertEventToCanvasOffset(first_event);\n                        canvas.graph.add(node);\n                    }\n                    if (callback) callback(node);\n                    canvas.graph.afterChange();\n                },\n            };\n\n            entries.push(entry);\n        });\n\n        new LiteGraph.ContextMenu(entries, {\n            event: e,\n            parentMenu: prev_menu,\n        }, ref_window);\n    }\n\n    inner_onMenuAdded(\"\", prev_menu);\n    return false;\n};\n\nLGraphCanvas.onMenuCollapseAll = function () {\n};\n\nLGraphCanvas.onMenuNodeEdit = function () {\n};\n\nLGraphCanvas.showMenuNodeOptionalInputs = function (\n    v,\n    options,\n    e,\n    prev_menu,\n    node,\n) {\n    if (!node) {\n        return;\n    }\n\n    const that = this;\n    const canvas = LGraphCanvas.active_canvas;\n    const ref_window = canvas.getCanvasWindow();\n\n    var options = node.optional_inputs;\n    if (node.onGetInputs) {\n        options = node.onGetInputs();\n    }\n\n    let entries = [];\n    if (options) {\n        for (let i = 0; i < options.length; i++) {\n            const entry = options[i];\n            if (!entry) {\n                entries.push(null);\n                continue;\n            }\n            let label = entry[0];\n            if (entry[2] && entry[2].label) {\n                label = entry[2].label;\n            }\n            const data = {\n                content: label,\n                value: entry,\n            };\n            if (entry[1] == LiteGraph.ACTION) {\n                data.className = \"event\";\n            }\n            entries.push(data);\n        }\n    }\n\n    if (this.onMenuNodeInputs) {\n        entries = this.onMenuNodeInputs(entries);\n    }\n\n    if (!entries.length) {\n        console.log(\"no input entries\");\n        return;\n    }\n\n    const menu = new LiteGraph.ContextMenu(\n        entries,\n        {\n            event: e,\n            callback: inner_clicked,\n            parentMenu: prev_menu,\n            node,\n        },\n        ref_window,\n    );\n\n    function inner_clicked(v, e, prev) {\n        if (!node) {\n            return;\n        }\n\n        if (v.callback) {\n            v.callback.call(that, node, v, e, prev);\n        }\n\n        if (v.value) {\n            node.graph.beforeChange();\n            node.addInput(v.value[0], v.value[1], v.value[2]);\n            node.setDirtyCanvas(true, true);\n            node.graph.afterChange();\n        }\n    }\n\n    return false;\n};\n\nLGraphCanvas.showMenuNodeOptionalOutputs = function (\n    v,\n    options,\n    e,\n    prev_menu,\n    node,\n) {\n    if (!node) {\n        return;\n    }\n\n    const that = this;\n    const canvas = LGraphCanvas.active_canvas;\n    const ref_window = canvas.getCanvasWindow();\n\n    var options = node.optional_outputs;\n    if (node.onGetOutputs) {\n        options = node.onGetOutputs();\n    }\n\n    let entries = [];\n    if (options) {\n        for (let i = 0; i < options.length; i++) {\n            const entry = options[i];\n            if (!entry) {\n                // separator?\n                entries.push(null);\n                continue;\n            }\n\n            if (\n                node.flags\n                && node.flags.skip_repeated_outputs\n                && node.findOutputSlot(entry[0]) != -1\n            ) {\n                continue;\n            } // skip the ones already on\n            let label = entry[0];\n            if (entry[2] && entry[2].label) {\n                label = entry[2].label;\n            }\n            const data = {\n                content: label,\n                value: entry,\n            };\n            if (entry[1] == LiteGraph.EVENT) {\n                data.className = \"event\";\n            }\n            entries.push(data);\n        }\n    }\n\n    if (this.onMenuNodeOutputs) {\n        entries = this.onMenuNodeOutputs(entries);\n    }\n\n    if (!entries.length) {\n        return;\n    }\n\n    const menu = new LiteGraph.ContextMenu(\n        entries,\n        {\n            event: e,\n            callback: inner_clicked,\n            parentMenu: prev_menu,\n            node,\n        },\n        ref_window,\n    );\n\n    function inner_clicked(v, e, prev) {\n        if (!node) {\n            return;\n        }\n\n        if (v.callback) {\n            v.callback.call(that, node, v, e, prev);\n        }\n\n        if (!v.value) {\n            return;\n        }\n\n        const value = v.value[1];\n\n        if (\n            value\n            && (value.constructor === Object || value.constructor === Array)\n        ) {\n            // submenu why?\n            const entries = [];\n            for (const i in value) {\n                entries.push({\n                    content: i,\n                    value: value[i],\n                });\n            }\n            new LiteGraph.ContextMenu(entries, {\n                event: e,\n                callback: inner_clicked,\n                parentMenu: prev_menu,\n                node,\n            });\n            return false;\n        }\n        node.graph.beforeChange();\n        node.addOutput(v.value[0], v.value[1], v.value[2]);\n        node.setDirtyCanvas(true, true);\n        node.graph.afterChange();\n    }\n\n    return false;\n};\n\nLGraphCanvas.onShowMenuNodeProperties = function (\n    value,\n    options,\n    e,\n    prev_menu,\n    node,\n) {\n    if (!node || !node.properties) {\n        return;\n    }\n\n    const that = this;\n    const canvas = LGraphCanvas.active_canvas;\n    const ref_window = canvas.getCanvasWindow();\n\n    const entries = [];\n    for (const i in node.properties) {\n        var value = node.properties[i] !== undefined ? node.properties[i] : \" \";\n        if (typeof value === \"object\") value = JSON.stringify(value);\n        const info = node.getPropertyInfo(i);\n        if (info.type == \"enum\" || info.type == \"combo\") value = LGraphCanvas.getPropertyPrintableValue(value, info.values);\n\n        // value could contain invalid html characters, clean that\n        value = LGraphCanvas.decodeHTML(value);\n        entries.push({\n            content:\n                `<span class=\"property_name\">${\n                    info.label ? info.label : i\n                }</span>`\n                + `<span class=\"property_value\">${\n                    value\n                }</span>`,\n            value: i,\n        });\n    }\n    if (!entries.length) {\n        return;\n    }\n\n    const menu = new LiteGraph.ContextMenu(\n        entries,\n        {\n            event: e,\n            callback: inner_clicked,\n            parentMenu: prev_menu,\n            allow_html: true,\n            node,\n        },\n        ref_window,\n    );\n\n    function inner_clicked(v, options, e, prev) {\n        if (!node) {\n            return;\n        }\n        const rect = this.getBoundingClientRect();\n        canvas.showEditPropertyValue(node, v.value, {\n            position: [rect.left, rect.top],\n        });\n    }\n\n    return false;\n};\n\nLGraphCanvas.decodeHTML = function (str) {\n    const e = document.createElement(\"div\");\n    e.innerText = str;\n    return e.innerHTML;\n};\n\nLGraphCanvas.onResizeNode = function (value, options, e, menu, node) {\n    if (!node) {\n        return;\n    }\n    node.size = node.computeSize();\n    if (node.onResize) node.onResize(node.size);\n    node.setDirtyCanvas(true, true);\n};\n\nLGraphCanvas.prototype.showLinkMenu = function (link, e) {\n    const that = this;\n    console.log(link);\n    const options = [\"Add Node\", null, \"Delete\"];\n    const menu = new LiteGraph.ContextMenu(options, {\n        event: e,\n        title: link.data != null ? link.data.constructor.name : null,\n        callback: inner_clicked,\n    });\n\n    function inner_clicked(v, options, e) {\n        switch (v) {\n            case \"Add Node\":\n                LGraphCanvas.onMenuAdd(null, null, e, menu, (node) => {\n                    console.log(\"node autoconnect\");\n                    const node_left = that.graph.getNodeById(link.origin_id);\n                    const node_right = that.graph.getNodeById(link.target_id);\n                    if (!node.inputs || !node.inputs.length || !node.outputs || !node.outputs.length) return;\n                    if (node_left.outputs[link.origin_slot].type == node.inputs[0].type && node.outputs[0].type == node_right.inputs[0].type) {\n                        node_left.connect(link.origin_slot, node, 0);\n                        node.connect(0, node_right, link.target_slot);\n                        node.pos[0] -= node.size[0] * 0.5;\n                    }\n                });\n                break;\n            case \"Delete\":\n                that.graph.removeLink(link.id);\n                break;\n            default:\n        }\n    }\n\n    return false;\n};\n\nLGraphCanvas.onShowPropertyEditor = function (item, options, e, menu, node) {\n    const input_html = \"\";\n    const property = item.property || \"title\";\n    const value = node[property];\n\n    const dialog = document.createElement(\"div\");\n    dialog.className = \"graphdialog\";\n    dialog.innerHTML = \"<span class='name'></span><input autofocus type='text' class='value'/><button>OK</button>\";\n    // dialog.innerHTML = \"<span class='name'></span><textarea autofocus\n    // class='value'></textarea><button>OK</button>\";\n    const title = dialog.querySelector(\".name\");\n    title.innerText = property;\n    const input = dialog.querySelector(\".value\");\n    if (input) {\n        input.value = value;\n        input.addEventListener(\"blur\", function (e) {\n            this.focus();\n        });\n        input.addEventListener(\"keydown\", (e) => {\n            if (e.keyCode != 13 && e.target.localName != \"textarea\") {\n                return;\n            }\n            inner();\n            e.preventDefault();\n            e.stopPropagation();\n        });\n    }\n\n    const graphcanvas = LGraphCanvas.active_canvas;\n    const { canvas } = graphcanvas;\n\n    const rect = canvas.getBoundingClientRect();\n    let offsetx = -20;\n    let offsety = -20;\n    if (rect) {\n        offsetx -= rect.left;\n        offsety -= rect.top;\n    }\n\n    if (event) {\n        dialog.style.left = `${event.clientX + offsetx}px`;\n        dialog.style.top = `${event.clientY + offsety}px`;\n    } else {\n        dialog.style.left = `${canvas.width * 0.5 + offsetx}px`;\n        dialog.style.top = `${canvas.height * 0.5 + offsety}px`;\n    }\n\n    const button = dialog.querySelector(\"button\");\n    button.addEventListener(\"click\", inner);\n    canvas.parentNode.appendChild(dialog);\n\n    function inner() {\n        setValue(input.value);\n    }\n\n    function setValue(value) {\n        if (item.type == \"Number\") {\n            value = Number(value);\n        } else if (item.type == \"Boolean\") {\n            value = Boolean(value);\n        }\n        node[property] = value;\n        if (dialog.parentNode) {\n            dialog.parentNode.removeChild(dialog);\n        }\n        node.setDirtyCanvas(true, true);\n    }\n};\n\nLGraphCanvas.prototype.prompt = function (title, value, callback, event, multiline) {\n    const that = this;\n    const input_html = \"\";\n    title = title || \"\";\n\n    let modified = false;\n\n    const dialog = document.createElement(\"div\");\n    dialog.className = \"graphdialog rounded\";\n    if (multiline) {\n        dialog.innerHTML = \"<span class='name'></span> <textarea autofocus class='value'></textarea><button class='rounded'>OK</button>\";\n    } else {\n        dialog.innerHTML = \"<span class='name'></span> <input autofocus type='text' class='value'/><button class='rounded'>OK</button>\";\n    }\n    dialog.close = function () {\n        that.prompt_box = null;\n        if (dialog.parentNode) {\n            dialog.parentNode.removeChild(dialog);\n        }\n    };\n\n    if (this.ds.scale > 1) {\n        dialog.style.transform = `scale(${this.ds.scale})`;\n    }\n\n    dialog.addEventListener(\"mouseleave\", (e) => {\n        if (!modified) {\n            dialog.close();\n        }\n    });\n\n    if (that.prompt_box) {\n        that.prompt_box.close();\n    }\n    that.prompt_box = dialog;\n\n    const first = null;\n    const timeout = null;\n    const selected = null;\n\n    const name_element = dialog.querySelector(\".name\");\n    name_element.innerText = title;\n    const value_element = dialog.querySelector(\".value\");\n    value_element.value = value;\n\n    const input = value_element;\n    input.addEventListener(\"keydown\", function (e) {\n        modified = true;\n        if (e.keyCode == 27) {\n            // ESC\n            dialog.close();\n        } else if (e.keyCode == 13 && e.target.localName != \"textarea\") {\n            if (callback) {\n                callback(this.value);\n            }\n            dialog.close();\n        } else {\n            return;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    const button = dialog.querySelector(\"button\");\n    button.addEventListener(\"click\", (e) => {\n        if (callback) {\n            callback(input.value);\n        }\n        that.setDirty(true);\n        dialog.close();\n    });\n\n    const graphcanvas = LGraphCanvas.active_canvas;\n    const { canvas } = graphcanvas;\n\n    const rect = canvas.getBoundingClientRect();\n    let offsetx = -20;\n    let offsety = -20;\n    if (rect) {\n        offsetx -= rect.left;\n        offsety -= rect.top;\n    }\n\n    if (event) {\n        dialog.style.left = `${event.clientX + offsetx}px`;\n        dialog.style.top = `${event.clientY + offsety}px`;\n    } else {\n        dialog.style.left = `${canvas.width * 0.5 + offsetx}px`;\n        dialog.style.top = `${canvas.height * 0.5 + offsety}px`;\n    }\n\n    canvas.parentNode.appendChild(dialog);\n    setTimeout(() => {\n        input.focus();\n    }, 10);\n\n    return dialog;\n};\n\nLGraphCanvas.search_limit = -1;\nLGraphCanvas.prototype.showSearchBox = function (event) {\n    const that = this;\n    const input_html = \"\";\n    const graphcanvas = LGraphCanvas.active_canvas;\n    const { canvas } = graphcanvas;\n    const root_document = canvas.ownerDocument || document;\n\n    const dialog = document.createElement(\"div\");\n    dialog.className = \"litegraph litesearchbox graphdialog rounded\";\n    dialog.innerHTML = \"<span class='name'>Search</span> <input autofocus type='text' class='value rounded'/><div class='helper'></div>\";\n    dialog.close = function () {\n        that.search_box = null;\n        root_document.body.focus();\n        root_document.body.style.overflow = \"\";\n\n        setTimeout(() => {\n            that.canvas.focus();\n        }, 20); // important, if canvas loses focus keys wont be captured\n        if (dialog.parentNode) {\n            dialog.parentNode.removeChild(dialog);\n        }\n    };\n\n    let timeout_close = null;\n\n    if (this.ds.scale > 1) {\n        dialog.style.transform = `scale(${this.ds.scale})`;\n    }\n\n    dialog.addEventListener(\"mouseenter\", (e) => {\n        if (timeout_close) {\n            clearTimeout(timeout_close);\n            timeout_close = null;\n        }\n    });\n\n    dialog.addEventListener(\"mouseleave\", (e) => {\n        // dialog.close();\n        timeout_close = setTimeout(() => {\n            dialog.close();\n        }, 500);\n    });\n\n    if (that.search_box) {\n        that.search_box.close();\n    }\n    that.search_box = dialog;\n\n    const helper = dialog.querySelector(\".helper\");\n\n    let first = null;\n    let timeout = null;\n    let selected = null;\n\n    const input = dialog.querySelector(\"input\");\n    if (input) {\n        input.addEventListener(\"blur\", function (e) {\n            this.focus();\n        });\n        input.addEventListener(\"keydown\", (e) => {\n            if (e.keyCode == 38) {\n                // UP\n                changeSelection(false);\n            } else if (e.keyCode == 40) {\n                // DOWN\n                changeSelection(true);\n            } else if (e.keyCode == 27) {\n                // ESC\n                dialog.close();\n            } else if (e.keyCode == 13) {\n                if (selected) {\n                    select(selected.innerHTML);\n                } else if (first) {\n                    select(first);\n                } else {\n                    dialog.close();\n                }\n            } else {\n                if (timeout) {\n                    clearInterval(timeout);\n                }\n                timeout = setTimeout(refreshHelper, 10);\n                return;\n            }\n            e.preventDefault();\n            e.stopPropagation();\n            e.stopImmediatePropagation();\n            return true;\n        });\n    }\n\n    if (root_document.fullscreenElement) {\n        root_document.fullscreenElement.appendChild(dialog);\n    } else {\n        root_document.body.appendChild(dialog);\n        root_document.body.style.overflow = \"hidden\";\n    }\n\n    // compute best position\n    const rect = canvas.getBoundingClientRect();\n\n    const left = (event ? event.clientX : (rect.left + rect.width * 0.5)) - 80;\n    const top = (event ? event.clientY : (rect.top + rect.height * 0.5)) - 20;\n    dialog.style.left = `${left}px`;\n    dialog.style.top = `${top}px`;\n\n    // To avoid out of screen problems\n    if (event.layerY > (rect.height - 200)) {\n        helper.style.maxHeight = `${rect.height - event.layerY - 20}px`;\n    }\n\n    /*\n    var offsetx = -20;\n    var offsety = -20;\n    if (rect) {\n        offsetx -= rect.left;\n        offsety -= rect.top;\n    }\n\n    if (event) {\n        dialog.style.left = event.clientX + offsetx + \"px\";\n        dialog.style.top = event.clientY + offsety + \"px\";\n    } else {\n        dialog.style.left = canvas.width * 0.5 + offsetx + \"px\";\n        dialog.style.top = canvas.height * 0.5 + offsety + \"px\";\n    }\n    canvas.parentNode.appendChild(dialog);\n*/\n\n    input.focus();\n\n    function select(name) {\n        if (name) {\n            if (that.onSearchBoxSelection) {\n                that.onSearchBoxSelection(name, event, graphcanvas);\n            } else {\n                const extra = LiteGraph.searchbox_extras[name.toLowerCase()];\n                if (extra) {\n                    name = extra.type;\n                }\n\n                graphcanvas.graph.beforeChange();\n                const node = LiteGraph.createNode(name);\n                if (node) {\n                    node.pos = graphcanvas.convertEventToCanvasOffset(\n                        event,\n                    );\n                    graphcanvas.graph.add(node);\n                }\n\n                if (extra && extra.data) {\n                    if (extra.data.properties) {\n                        for (var i in extra.data.properties) {\n                            node.addProperty(i, extra.data.properties[i]);\n                        }\n                    }\n                    if (extra.data.inputs) {\n                        node.inputs = [];\n                        for (var i in extra.data.inputs) {\n                            node.addOutput(\n                                extra.data.inputs[i][0],\n                                extra.data.inputs[i][1],\n                            );\n                        }\n                    }\n                    if (extra.data.outputs) {\n                        node.outputs = [];\n                        for (var i in extra.data.outputs) {\n                            node.addOutput(\n                                extra.data.outputs[i][0],\n                                extra.data.outputs[i][1],\n                            );\n                        }\n                    }\n                    if (extra.data.title) {\n                        node.title = extra.data.title;\n                    }\n                    if (extra.data.json) {\n                        node.configure(extra.data.json);\n                    }\n\n                    graphcanvas.graph.afterChange();\n                }\n            }\n        }\n\n        dialog.close();\n    }\n\n    function changeSelection(forward) {\n        const prev = selected;\n        if (selected) {\n            selected.classList.remove(\"selected\");\n        }\n        if (!selected) {\n            selected = forward\n                ? helper.childNodes[0]\n                : helper.childNodes[helper.childNodes.length];\n        } else {\n            selected = forward\n                ? selected.nextSibling\n                : selected.previousSibling;\n            if (!selected) {\n                selected = prev;\n            }\n        }\n        if (!selected) {\n            return;\n        }\n        selected.classList.add(\"selected\");\n        selected.scrollIntoView({\n            block: \"end\",\n            behavior: \"smooth\",\n        });\n    }\n\n    function refreshHelper() {\n        timeout = null;\n        let str = input.value;\n        first = null;\n        helper.innerHTML = \"\";\n        if (!str) {\n            return;\n        }\n\n        if (that.onSearchBox) {\n            const list = that.onSearchBox(helper, str, graphcanvas);\n            if (list) {\n                for (var i = 0; i < list.length; ++i) {\n                    addResult(list[i]);\n                }\n            }\n        } else {\n            let c = 0;\n            str = str.toLowerCase();\n            const filter = graphcanvas.filter || graphcanvas.graph.filter;\n\n            // extras\n            for (var i in LiteGraph.searchbox_extras) {\n                const extra = LiteGraph.searchbox_extras[i];\n                if (extra.desc.toLowerCase()\n                    .indexOf(str) === -1) {\n                    continue;\n                }\n                const ctor = LiteGraph.registered_node_types[extra.type];\n                if (ctor && ctor.filter != filter) continue;\n                addResult(extra.desc, \"searchbox_extra\");\n                if (LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit) {\n                    break;\n                }\n            }\n\n            var filtered = null;\n            if (Array.prototype.filter) { // filter supported\n                const keys = Object.keys(LiteGraph.registered_node_types); // types\n                var filtered = keys.filter(inner_test_filter);\n            } else {\n                filtered = [];\n                for (var i in LiteGraph.registered_node_types) {\n                    if (inner_test_filter(i)) filtered.push(i);\n                }\n            }\n\n            for (var i = 0; i < filtered.length; i++) {\n                addResult(filtered[i]);\n                if (LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit) {\n                    break;\n                }\n            }\n\n            function inner_test_filter(type) {\n                const ctor = LiteGraph.registered_node_types[type];\n                if (filter && ctor.filter != filter) return false;\n                return type.toLowerCase()\n                    .indexOf(str) !== -1;\n            }\n        }\n\n        function addResult(type, className) {\n            const help = document.createElement(\"div\");\n            if (!first) {\n                first = type;\n            }\n            help.innerText = type;\n            help.dataset.type = escape(type);\n            help.className = \"litegraph lite-search-item\";\n            if (className) {\n                help.className += ` ${className}`;\n            }\n            help.addEventListener(\"click\", function (e) {\n                select(unescape(this.dataset.type));\n            });\n            helper.appendChild(help);\n        }\n    }\n\n    return dialog;\n};\n\nLGraphCanvas.prototype.showEditPropertyValue = function (node, property, options) {\n    if (!node || node.properties[property] === undefined) {\n        return;\n    }\n\n    options = options || {};\n    const that = this;\n\n    const info = node.getPropertyInfo(property);\n    const { type } = info;\n\n    let input_html = \"\";\n\n    if (type == \"string\" || type == \"number\" || type == \"array\" || type == \"object\") {\n        input_html = \"<input autofocus type='text' class='value'/>\";\n    } else if ((type == \"enum\" || type == \"combo\") && info.values) {\n        input_html = \"<select autofocus type='text' class='value'>\";\n        for (const i in info.values) {\n            var v = i;\n            if (info.values.constructor === Array) v = info.values[i];\n\n            input_html\n                += `<option value=\"${\n                    v\n                }\" ${\n                    v == node.properties[property] ? \"selected\" : \"\"\n                }>${\n                    info.values[i]\n                }</option>`;\n        }\n        input_html += \"</select>\";\n    } else if (type == \"boolean\") {\n        input_html = `<input autofocus type=\"checkbox\" class=\"value\" ${\n            node.properties[property] ? \"checked\" : \"\"\n        }/>`;\n    } else {\n        console.warn(`unknown type: ${type}`);\n        return;\n    }\n\n    const dialog = this.createDialog(\n        `<span class=\"name\">${\n            info.label ? info.label : property\n        }</span>${\n            input_html\n        }<button>OK</button>`,\n        options,\n    );\n\n    if ((type == \"enum\" || type == \"combo\") && info.values) {\n        var input = dialog.querySelector(\"select\");\n        input.addEventListener(\"change\", (e) => {\n            setValue(e.target.value);\n            // var index = e.target.value;\n            // setValue( e.options[e.selectedIndex].value );\n        });\n    } else if (type == \"boolean\") {\n        var input = dialog.querySelector(\"input\");\n        if (input) {\n            input.addEventListener(\"click\", (e) => {\n                setValue(!!input.checked);\n            });\n        }\n    } else {\n        var input = dialog.querySelector(\"input\");\n        if (input) {\n            input.addEventListener(\"blur\", function (e) {\n                this.focus();\n            });\n\n            var v = node.properties[property] !== undefined ? node.properties[property] : \"\";\n            if (type !== \"string\") {\n                v = JSON.stringify(v);\n            }\n\n            input.value = v;\n            input.addEventListener(\"keydown\", (e) => {\n                if (e.keyCode != 13) {\n                    return;\n                }\n                inner();\n                e.preventDefault();\n                e.stopPropagation();\n            });\n        }\n    }\n\n    const button = dialog.querySelector(\"button\");\n    button.addEventListener(\"click\", inner);\n\n    function inner() {\n        setValue(input.value);\n    }\n\n    function setValue(value) {\n        if (info && info.values && info.values.constructor === Object && info.values[value] != undefined) value = info.values[value];\n\n        if (typeof node.properties[property] === \"number\") {\n            value = Number(value);\n        }\n        if (type == \"array\" || type == \"object\") {\n            value = JSON.parse(value);\n        }\n        node.properties[property] = value;\n        if (node.graph) {\n            node.graph._version++;\n        }\n        if (node.onPropertyChanged) {\n            node.onPropertyChanged(property, value);\n        }\n        if (options.onclose) options.onclose();\n        dialog.close();\n        node.setDirtyCanvas(true, true);\n    }\n\n    return dialog;\n};\n\nLGraphCanvas.prototype.createDialog = function (html, options) {\n    options = options || {};\n\n    const dialog = document.createElement(\"div\");\n    dialog.className = \"graphdialog\";\n    dialog.innerHTML = html;\n\n    const rect = this.canvas.getBoundingClientRect();\n    let offsetx = -20;\n    let offsety = -20;\n    if (rect) {\n        offsetx -= rect.left;\n        offsety -= rect.top;\n    }\n\n    if (options.position) {\n        offsetx += options.position[0];\n        offsety += options.position[1];\n    } else if (options.event) {\n        offsetx += options.event.clientX;\n        offsety += options.event.clientY;\n    } // centered\n    else {\n        offsetx += this.canvas.width * 0.5;\n        offsety += this.canvas.height * 0.5;\n    }\n\n    dialog.style.left = `${offsetx}px`;\n    dialog.style.top = `${offsety}px`;\n\n    this.canvas.parentNode.appendChild(dialog);\n\n    dialog.close = function () {\n        if (this.parentNode) {\n            this.parentNode.removeChild(this);\n        }\n    };\n\n    return dialog;\n};\n\nLGraphCanvas.prototype.createPanel = function (title, options) {\n    options = options || {};\n\n    const ref_window = options.window || window;\n    const root = document.createElement(\"div\");\n    root.className = \"litegraph dialog\";\n    root.innerHTML = \"<div class='dialog-header'><span class='dialog-title'></span></div><div class='dialog-content'></div><div class='dialog-footer'></div>\";\n    root.header = root.querySelector(\".dialog-header\");\n\n    if (options.width) root.style.width = options.width + (options.width.constructor === Number ? \"px\" : \"\");\n    if (options.height) root.style.height = options.height + (options.height.constructor === Number ? \"px\" : \"\");\n    if (options.closable) {\n        const close = document.createElement(\"span\");\n        close.innerHTML = \"&#10005;\";\n        close.classList.add(\"close\");\n        close.addEventListener(\"click\", () => {\n            root.close();\n        });\n        root.header.appendChild(close);\n    }\n    root.title_element = root.querySelector(\".dialog-title\");\n    root.title_element.innerText = title;\n    root.content = root.querySelector(\".dialog-content\");\n    root.footer = root.querySelector(\".dialog-footer\");\n\n    root.close = function () {\n        this.parentNode.removeChild(this);\n    };\n\n    root.clear = function () {\n        this.content.innerHTML = \"\";\n    };\n\n    root.addHTML = function (code, classname, on_footer) {\n        const elem = document.createElement(\"div\");\n        if (classname) elem.className = classname;\n        elem.innerHTML = code;\n        if (on_footer) {\n            root.footer.appendChild(elem);\n        } else {\n            root.content.appendChild(elem);\n        }\n        return elem;\n    };\n\n    root.addButton = function (name, callback, options) {\n        const elem = document.createElement(\"button\");\n        elem.innerText = name;\n        elem.options = options;\n        elem.classList.add(\"btn\");\n        elem.addEventListener(\"click\", callback);\n        root.footer.appendChild(elem);\n        return elem;\n    };\n\n    root.addSeparator = function () {\n        const elem = document.createElement(\"div\");\n        elem.className = \"separator\";\n        root.content.appendChild(elem);\n    };\n\n    root.addWidget = function (type, name, value, options, callback) {\n        options = options || {};\n        var str_value = String(value);\n        type = type.toLowerCase();\n        if (type == \"number\") str_value = value.toFixed(3);\n\n        const elem = document.createElement(\"div\");\n        elem.className = \"property\";\n        elem.innerHTML = \"<span class='property_name'></span><span class='property_value'></span>\";\n        elem.querySelector(\".property_name\").innerText = name;\n        const value_element = elem.querySelector(\".property_value\");\n        value_element.innerText = str_value;\n        elem.dataset.property = name;\n        elem.dataset.type = options.type || type;\n        elem.options = options;\n        elem.value = value;\n\n        // if( type == \"code\" )\n        //\telem.addEventListener(\"click\", function(){ inner_showCodePad( node,\n        // this.dataset[\"property\"] ); });\n        if (type == \"boolean\") {\n            elem.classList.add(\"boolean\");\n            if (value) elem.classList.add(\"bool-on\");\n            elem.addEventListener(\"click\", function () {\n                // var v = node.properties[this.dataset[\"property\"]];\n                // node.setProperty(this.dataset[\"property\"],!v); this.innerText = v ? \"true\" :\n                // \"false\";\n                const propname = this.dataset.property;\n                this.value = !this.value;\n                this.classList.toggle(\"bool-on\");\n                this.querySelector(\".property_value\").innerText = this.value ? \"true\" : \"false\";\n                innerChange(propname, this.value);\n            });\n        } else if (type == \"string\" || type == \"number\") {\n            value_element.setAttribute(\"contenteditable\", true);\n            value_element.addEventListener(\"keydown\", function (e) {\n                if (e.code == \"Enter\") {\n                    e.preventDefault();\n                    this.blur();\n                }\n            });\n            value_element.addEventListener(\"blur\", function () {\n                let v = this.innerText;\n                const propname = this.parentNode.dataset.property;\n                const proptype = this.parentNode.dataset.type;\n                if (proptype == \"number\") v = Number(v);\n                innerChange(propname, v);\n            });\n        } else if (type == \"enum\" || type == \"combo\") var str_value = LGraphCanvas.getPropertyPrintableValue(value, options.values);\n        value_element.innerText = str_value;\n\n        value_element.addEventListener(\"click\", function (event) {\n            const values = options.values || [];\n            const propname = this.parentNode.dataset.property;\n            const elem_that = this;\n            const menu = new LiteGraph.ContextMenu(values, {\n                event,\n                className: \"dark\",\n                callback: inner_clicked,\n            },\n            ref_window);\n\n            function inner_clicked(v, option, event) {\n                // node.setProperty(propname,v);\n                // graphcanvas.dirty_canvas = true;\n                elem_that.innerText = v;\n                innerChange(propname, v);\n                return false;\n            }\n        });\n\n        root.content.appendChild(elem);\n\n        function innerChange(name, value) {\n            console.log(\"change\", name, value);\n            // that.dirty_canvas = true;\n            if (options.callback) options.callback(name, value);\n            if (callback) callback(name, value);\n        }\n\n        return elem;\n    };\n\n    return root;\n};\n\nLGraphCanvas.getPropertyPrintableValue = function (value, values) {\n    if (!values) return String(value);\n\n    if (values.constructor === Array) {\n        return String(value);\n    }\n\n    if (values.constructor === Object) {\n        let desc_value = \"\";\n        for (const k in values) {\n            if (values[k] != value) continue;\n            desc_value = k;\n            break;\n        }\n        return `${String(value)} (${desc_value})`;\n    }\n};\n\nLGraphCanvas.prototype.showShowNodePanel = function (node) {\n    window.SELECTED_NODE = node;\n    let panel = document.querySelector(\"#node-panel\");\n    if (panel) panel.close();\n    const ref_window = this.getCanvasWindow();\n    panel = this.createPanel(node.title || \"\", {\n        closable: true,\n        window: ref_window,\n    });\n    panel.id = \"node-panel\";\n    panel.node = node;\n    panel.classList.add(\"settings\");\n    const that = this;\n    const graphcanvas = this;\n\n    function inner_refresh() {\n        panel.content.innerHTML = \"\"; // clear\n        panel.addHTML(`<span class=\"node_type\">${node.type}</span><span class=\"node_desc\">${node.constructor.desc || \"\"}</span><span class=\"separator\"></span>`);\n\n        panel.addHTML(\"<h3>Properties</h3>\");\n\n        for (const i in node.properties) {\n            const value = node.properties[i];\n            const info = node.getPropertyInfo(i);\n            const type = info.type || \"string\";\n\n            // in case the user wants control over the side panel widget\n            if (node.onAddPropertyToPanel && node.onAddPropertyToPanel(i, panel)) continue;\n\n            panel.addWidget(info.widget || info.type, i, value, info, (name, value) => {\n                graphcanvas.graph.beforeChange(node);\n                node.setProperty(name, value);\n                graphcanvas.graph.afterChange();\n                graphcanvas.dirty_canvas = true;\n            });\n        }\n\n        panel.addSeparator();\n\n        if (node.onShowCustomPanelInfo) node.onShowCustomPanelInfo(panel);\n\n        /*\n  panel.addHTML(\"<h3>Connections</h3>\");\n  var connection_containers = panel.addHTML(\"<div class='inputs connections_side'></div><div class='outputs connections_side'></div>\",\"connections\");\n  var inputs = connection_containers.querySelector(\".inputs\");\n  var outputs = connection_containers.querySelector(\".outputs\");\n  */\n\n        panel.addButton(\"Delete\", () => {\n            if (node.block_delete) return;\n            node.graph.remove(node);\n            panel.close();\n        })\n            .classList\n            .add(\"delete\");\n    }\n\n    function inner_showCodePad(node, propname) {\n        panel.style.top = \"calc( 50% - 250px)\";\n        panel.style.left = \"calc( 50% - 400px)\";\n        panel.style.width = \"800px\";\n        panel.style.height = \"500px\";\n\n        if (window.CodeFlask) // disabled for now\n        {\n            panel.content.innerHTML = \"<div class='code'></div>\";\n            const flask = new CodeFlask(\"div.code\", { language: \"js\" });\n            flask.updateCode(node.properties[propname]);\n            flask.onUpdate((code) => {\n                node.setProperty(propname, code);\n            });\n        } else {\n            panel.content.innerHTML = \"<textarea class='code'></textarea>\";\n            var textarea = panel.content.querySelector(\"textarea\");\n            textarea.value = node.properties[propname];\n            textarea.addEventListener(\"keydown\", (e) => {\n                // console.log(e);\n                if (e.code == \"Enter\" && e.ctrlKey) {\n                    console.log(\"Assigned\");\n                    node.setProperty(propname, textarea.value);\n                }\n            });\n            textarea.style.height = \"calc(100% - 40px)\";\n        }\n        const assign = that.createButton(\"Assign\", null, () => {\n            node.setProperty(propname, textarea.value);\n        });\n        panel.content.appendChild(assign);\n        const button = that.createButton(\"Close\", null, () => {\n            panel.style.height = \"\";\n            inner_refresh();\n        });\n        button.style.float = \"right\";\n        panel.content.appendChild(button);\n    }\n\n    inner_refresh();\n\n    this.canvas.parentNode.appendChild(panel);\n};\n\nLGraphCanvas.prototype.showSubgraphPropertiesDialog = function (node) {\n    console.log(\"showing subgraph properties dialog\");\n\n    const old_panel = this.canvas.parentNode.querySelector(\".subgraph_dialog\");\n    if (old_panel) old_panel.close();\n\n    const panel = this.createPanel(\"Subgraph Inputs\", {\n        closable: true,\n        width: 500,\n    });\n    panel.node = node;\n    panel.classList.add(\"subgraph_dialog\");\n\n    function inner_refresh() {\n        panel.clear();\n\n        // show currents\n        if (node.inputs) {\n            for (let i = 0; i < node.inputs.length; ++i) {\n                const input = node.inputs[i];\n                if (input.not_subgraph_input) continue;\n                const html = \"<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>\";\n                const elem = panel.addHTML(html, \"subgraph_property\");\n                elem.dataset.name = input.name;\n                elem.dataset.slot = i;\n                elem.querySelector(\".name\").innerText = input.name;\n                elem.querySelector(\".type\").innerText = input.type;\n                elem.querySelector(\"button\")\n                    .addEventListener(\"click\", function (e) {\n                        node.removeInput(Number(this.parentNode.dataset.slot));\n                        inner_refresh();\n                    });\n            }\n        }\n    }\n\n    // add extra\n    const html = \" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>\";\n    const elem = panel.addHTML(html, \"subgraph_property extra\", true);\n    elem.querySelector(\"button\")\n        .addEventListener(\"click\", function (e) {\n            const elem = this.parentNode;\n            const name = elem.querySelector(\".name\").value;\n            const type = elem.querySelector(\".type\").value;\n            if (!name || node.findInputSlot(name) != -1) return;\n            node.addInput(name, type);\n            elem.querySelector(\".name\").value = \"\";\n            elem.querySelector(\".type\").value = \"\";\n            inner_refresh();\n        });\n\n    inner_refresh();\n    this.canvas.parentNode.appendChild(panel);\n    return panel;\n};\n\nLGraphCanvas.prototype.checkPanels = function () {\n    if (!this.canvas) return;\n    const panels = this.canvas.parentNode.querySelectorAll(\".litegraph.dialog\");\n    for (let i = 0; i < panels.length; ++i) {\n        const panel = panels[i];\n        if (!panel.node) continue;\n        if (!panel.node.graph || panel.graph != this.graph) panel.close();\n    }\n};\n\nLGraphCanvas.onMenuNodeCollapse = function (value, options, e, menu, node) {\n    node.graph.beforeChange(node);\n    node.collapse();\n    node.graph.afterChange(node);\n};\n\nLGraphCanvas.onMenuNodePin = function (value, options, e, menu, node) {\n    node.pin();\n};\n\nLGraphCanvas.onMenuNodeMode = function (value, options, e, menu, node) {\n    new LiteGraph.ContextMenu(\n        [\"Always\", \"On Event\", \"On Trigger\", \"Never\"],\n        {\n            event: e,\n            callback: inner_clicked,\n            parentMenu: menu,\n            node,\n        },\n    );\n\n    function inner_clicked(v) {\n        if (!node) {\n            return;\n        }\n        switch (v) {\n            case \"On Event\":\n                node.mode = LiteGraph.ON_EVENT;\n                break;\n            case \"On Trigger\":\n                node.mode = LiteGraph.ON_TRIGGER;\n                break;\n            case \"Never\":\n                node.mode = LiteGraph.NEVER;\n                break;\n            case \"Always\":\n            default:\n                node.mode = LiteGraph.ALWAYS;\n                break;\n        }\n    }\n\n    return false;\n};\n\nLGraphCanvas.onMenuNodeColors = function (value, options, e, menu, node) {\n    if (!node) {\n        throw \"no node for color\";\n    }\n\n    const values = [];\n    values.push({\n        value: null,\n        content:\n            \"<span style='display: block; padding-left: 4px;'>No color</span>\",\n    });\n\n    for (const i in LGraphCanvas.node_colors) {\n        const color = LGraphCanvas.node_colors[i];\n        var value = {\n            value: i,\n            content:\n                `<span style=\"display: block; color: #999; padding-left: 4px; border-left: 8px solid ${\n                    color.color\n                }; background-color:${\n                    color.bgcolor\n                }\">${\n                    i\n                }</span>`,\n        };\n        values.push(value);\n    }\n    new LiteGraph.ContextMenu(values, {\n        event: e,\n        callback: inner_clicked,\n        parentMenu: menu,\n        node,\n    });\n\n    function inner_clicked(v) {\n        if (!node) {\n            return;\n        }\n\n        const color = v.value ? LGraphCanvas.node_colors[v.value] : null;\n        if (color) {\n            if (node.constructor === LiteGraph.LGraphGroup) {\n                node.color = color.groupcolor;\n            } else {\n                node.color = color.color;\n                node.bgcolor = color.bgcolor;\n            }\n        } else {\n            delete node.color;\n            delete node.bgcolor;\n        }\n        node.setDirtyCanvas(true, true);\n    }\n\n    return false;\n};\n\nLGraphCanvas.onMenuNodeShapes = function (value, options, e, menu, node) {\n    if (!node) {\n        throw \"no node passed\";\n    }\n\n    new LiteGraph.ContextMenu(LiteGraph.VALID_SHAPES, {\n        event: e,\n        callback: inner_clicked,\n        parentMenu: menu,\n        node,\n    });\n\n    function inner_clicked(v) {\n        if (!node) {\n            return;\n        }\n        node.graph.beforeChange(node);\n        node.shape = v;\n        node.graph.afterChange(node);\n        node.setDirtyCanvas(true);\n    }\n\n    return false;\n};\n\nLGraphCanvas.onMenuNodeRemove = function (value, options, e, menu, node) {\n    if (!node) {\n        throw \"no node passed\";\n    }\n\n    if (node.removable === false) {\n        return;\n    }\n\n    const { graph } = node;\n    graph.beforeChange();\n    graph.remove(node);\n    graph.afterChange();\n    node.setDirtyCanvas(true, true);\n};\n\nLGraphCanvas.onMenuNodeToSubgraph = function (value, options, e, menu, node) {\n    const { graph } = node;\n    const graphcanvas = LGraphCanvas.active_canvas;\n    if (!graphcanvas) // ??\n    {\n        return;\n    }\n\n    let nodes_list = Object.values(graphcanvas.selected_nodes || {});\n    if (!nodes_list.length) nodes_list = [node];\n\n    const subgraph_node = LiteGraph.createNode(\"graph/subgraph\");\n    subgraph_node.pos = node.pos.concat();\n    graph.add(subgraph_node);\n\n    subgraph_node.buildFromNodes(nodes_list);\n\n    graphcanvas.deselectAllNodes();\n    node.setDirtyCanvas(true, true);\n};\n\nLGraphCanvas.onMenuNodeClone = function (value, options, e, menu, node) {\n    if (node.clonable == false) {\n        return;\n    }\n    const newnode = node.clone();\n    if (!newnode) {\n        return;\n    }\n    newnode.pos = [node.pos[0] + 5, node.pos[1] + 5];\n\n    node.graph.beforeChange();\n    node.graph.add(newnode);\n    node.graph.afterChange();\n\n    node.setDirtyCanvas(true, true);\n};\n\nLGraphCanvas.node_colors = {\n    red: {\n        color: \"#322\",\n        bgcolor: \"#533\",\n        groupcolor: \"#A88\",\n    },\n    brown: {\n        color: \"#332922\",\n        bgcolor: \"#593930\",\n        groupcolor: \"#b06634\",\n    },\n    green: {\n        color: \"#232\",\n        bgcolor: \"#353\",\n        groupcolor: \"#8A8\",\n    },\n    blue: {\n        color: \"#223\",\n        bgcolor: \"#335\",\n        groupcolor: \"#88A\",\n    },\n    pale_blue: {\n        color: \"#2a363b\",\n        bgcolor: \"#3f5159\",\n        groupcolor: \"#3f789e\",\n    },\n    cyan: {\n        color: \"#233\",\n        bgcolor: \"#355\",\n        groupcolor: \"#8AA\",\n    },\n    purple: {\n        color: \"#323\",\n        bgcolor: \"#535\",\n        groupcolor: \"#a1309b\",\n    },\n    yellow: {\n        color: \"#432\",\n        bgcolor: \"#653\",\n        groupcolor: \"#b58b2a\",\n    },\n    black: {\n        color: \"#222\",\n        bgcolor: \"#000\",\n        groupcolor: \"#444\",\n    },\n};\n\nLGraphCanvas.prototype.getCanvasMenuOptions = function () {\n    let options = null;\n    if (this.getMenuOptions) {\n        options = this.getMenuOptions();\n    } else {\n        options = [\n            {\n                content: \"Add Node\",\n                has_submenu: true,\n                callback: LGraphCanvas.onMenuAdd,\n            },\n            {\n                content: \"Add Group\",\n                callback: LGraphCanvas.onGroupAdd,\n            },\n            // {content:\"Collapse All\", callback: LGraphCanvas.onMenuCollapseAll }\n        ];\n\n        if (this._graph_stack && this._graph_stack.length > 0) {\n            options.push(null, {\n                content: \"Close subgraph\",\n                callback: this.closeSubgraph.bind(this),\n            });\n        }\n    }\n\n    if (this.getExtraMenuOptions) {\n        const extra = this.getExtraMenuOptions(this, options);\n        if (extra) {\n            options = options.concat(extra);\n        }\n    }\n\n    return options;\n};\n\n// called by processContextMenu to extract the menu list\nLGraphCanvas.prototype.getNodeMenuOptions = function (node) {\n    let options = null;\n\n    if (node.getMenuOptions) {\n        options = node.getMenuOptions(this);\n    } else {\n        options = [\n            {\n                content: \"Inputs\",\n                has_submenu: true,\n                disabled: true,\n                callback: LGraphCanvas.showMenuNodeOptionalInputs,\n            },\n            {\n                content: \"Outputs\",\n                has_submenu: true,\n                disabled: true,\n                callback: LGraphCanvas.showMenuNodeOptionalOutputs,\n            },\n            null,\n            {\n                content: \"Properties\",\n                has_submenu: true,\n                callback: LGraphCanvas.onShowMenuNodeProperties,\n            },\n            null,\n            {\n                content: \"Title\",\n                callback: LGraphCanvas.onShowPropertyEditor,\n            },\n            {\n                content: \"Mode\",\n                has_submenu: true,\n                callback: LGraphCanvas.onMenuNodeMode,\n            },\n            {\n                content: \"Resize\",\n                callback() {\n                    if (node.resizable) {\n                        return LGraphCanvas.onResizeNode;\n                    }\n                },\n            },\n            {\n                content: \"Collapse\",\n                callback: LGraphCanvas.onMenuNodeCollapse,\n            },\n            {\n                content: \"Pin\",\n                callback: LGraphCanvas.onMenuNodePin,\n            },\n            {\n                content: \"Colors\",\n                has_submenu: true,\n                callback: LGraphCanvas.onMenuNodeColors,\n            },\n            {\n                content: \"Shapes\",\n                has_submenu: true,\n                callback: LGraphCanvas.onMenuNodeShapes,\n            },\n            null,\n        ];\n    }\n\n    if (node.onGetInputs) {\n        const inputs = node.onGetInputs();\n        if (inputs && inputs.length) {\n            options[0].disabled = false;\n        }\n    }\n\n    if (node.onGetOutputs) {\n        const outputs = node.onGetOutputs();\n        if (outputs && outputs.length) {\n            options[1].disabled = false;\n        }\n    }\n\n    if (node.getExtraMenuOptions) {\n        const extra = node.getExtraMenuOptions(this, options);\n        if (extra) {\n            extra.push(null);\n            options = extra.concat(options);\n        }\n    }\n\n    if (node.clonable !== false) {\n        options.push({\n            content: \"Clone\",\n            callback: LGraphCanvas.onMenuNodeClone,\n        });\n    }\n\n    if (0) // TODO\n    {\n        options.push({\n            content: \"To Subgraph\",\n            callback: LGraphCanvas.onMenuNodeToSubgraph,\n        });\n    }\n\n    options.push(null, {\n        content: \"Remove\",\n        disabled: !(node.removable !== false && !node.block_delete),\n        callback: LGraphCanvas.onMenuNodeRemove,\n    });\n\n    if (node.graph && node.graph.onGetNodeMenuOptions) {\n        node.graph.onGetNodeMenuOptions(options, node);\n    }\n\n    return options;\n};\n\nLGraphCanvas.prototype.getGroupMenuOptions = function (node) {\n    const o = [\n        {\n            content: \"Title\",\n            callback: LGraphCanvas.onShowPropertyEditor,\n        },\n        {\n            content: \"Color\",\n            has_submenu: true,\n            callback: LGraphCanvas.onMenuNodeColors,\n        },\n        {\n            content: \"Font size\",\n            property: \"font_size\",\n            type: \"Number\",\n            callback: LGraphCanvas.onShowPropertyEditor,\n        },\n        null,\n        {\n            content: \"Remove\",\n            callback: LGraphCanvas.onMenuNodeRemove,\n        },\n    ];\n\n    return o;\n};\n\nLGraphCanvas.prototype.processContextMenu = function (node, event) {\n    const that = this;\n    const canvas = LGraphCanvas.active_canvas;\n    const ref_window = canvas.getCanvasWindow();\n\n    let menu_info = null;\n    const options = {\n        event,\n        callback: inner_option_clicked,\n        extra: node,\n    };\n\n    if (node) options.title = node.type;\n\n    // check if mouse is in input\n    let slot = null;\n    if (node) {\n        slot = node.getSlotInPosition(event.canvasX, event.canvasY);\n        LGraphCanvas.active_node = node;\n    }\n\n    if (slot) {\n        // on slot\n        menu_info = [];\n        if (node.getSlotMenuOptions) {\n            menu_info = node.getSlotMenuOptions(slot);\n        } else {\n            if (\n                slot\n                && slot.output\n                && slot.output.links\n                && slot.output.links.length\n            ) {\n                menu_info.push({\n                    content: \"Disconnect Links\",\n                    slot,\n                });\n            }\n            const _slot = slot.input || slot.output;\n            menu_info.push(\n                _slot.locked\n                    ? \"Cannot remove\"\n                    : {\n                        content: \"Remove Slot\",\n                        slot,\n                    },\n            );\n            menu_info.push(\n                _slot.nameLocked\n                    ? \"Cannot rename\"\n                    : {\n                        content: \"Rename Slot\",\n                        slot,\n                    },\n            );\n        }\n        options.title = (slot.input ? slot.input.type : slot.output.type) || \"*\";\n        if (slot.input && slot.input.type == LiteGraph.ACTION) {\n            options.title = \"Action\";\n        }\n        if (slot.output && slot.output.type == LiteGraph.EVENT) {\n            options.title = \"Event\";\n        }\n    } else if (node) {\n        // on node\n        menu_info = this.getNodeMenuOptions(node);\n    } else {\n        menu_info = this.getCanvasMenuOptions();\n        const group = this.graph.getGroupOnPos(\n            event.canvasX,\n            event.canvasY,\n        );\n        if (group) {\n            // on group\n            menu_info.push(null, {\n                content: \"Edit Group\",\n                has_submenu: true,\n                submenu: {\n                    title: \"Group\",\n                    extra: group,\n                    options: this.getGroupMenuOptions(group),\n                },\n            });\n        }\n    }\n\n    // show menu\n    if (!menu_info) {\n        return;\n    }\n\n    const menu = new LiteGraph.ContextMenu(menu_info, options, ref_window);\n\n    function inner_option_clicked(v, options, e) {\n        if (!v) {\n            return;\n        }\n\n        if (v.content == \"Remove Slot\") {\n            var info = v.slot;\n            if (info.input) {\n                node.removeInput(info.slot);\n            } else if (info.output) {\n                node.removeOutput(info.slot);\n            }\n        } else if (v.content == \"Disconnect Links\") {\n            var info = v.slot;\n            if (info.output) {\n                node.disconnectOutput(info.slot);\n            } else if (info.input) {\n                node.disconnectInput(info.slot);\n            }\n        } else if (v.content == \"Rename Slot\") {\n            var info = v.slot;\n            const slot_info = info.input\n                ? node.getInputInfo(info.slot)\n                : node.getOutputInfo(info.slot);\n            const dialog = that.createDialog(\n                \"<span class='name'>Name</span><input autofocus type='text'/><button>OK</button>\",\n                options,\n            );\n            const input = dialog.querySelector(\"input\");\n            if (input && slot_info) {\n                input.value = slot_info.label || \"\";\n            }\n            dialog\n                .querySelector(\"button\")\n                .addEventListener(\"click\", (e) => {\n                    if (input.value) {\n                        if (slot_info) {\n                            slot_info.label = input.value;\n                        }\n                        that.setDirty(true);\n                    }\n                    dialog.close();\n                });\n        }\n\n        // if(v.callback)\n        //\treturn v.callback.call(that, node, options, e, menu, that, event );\n    }\n};\n\n// API *************************************************\n// like rect but rounded corners\nif (typeof (window) !== \"undefined\" && window.CanvasRenderingContext2D) {\n    window.CanvasRenderingContext2D.prototype.roundRect = function (\n        x,\n        y,\n        width,\n        height,\n        radius,\n        radius_low,\n    ) {\n        if (radius === undefined) {\n            radius = 5;\n        }\n\n        if (radius_low === undefined) {\n            radius_low = radius;\n        }\n\n        this.moveTo(x + radius, y);\n        this.lineTo(x + width - radius, y);\n        this.quadraticCurveTo(x + width, y, x + width, y + radius);\n\n        this.lineTo(x + width, y + height - radius_low);\n        this.quadraticCurveTo(\n            x + width,\n            y + height,\n            x + width - radius_low,\n            y + height,\n        );\n        this.lineTo(x + radius_low, y + height);\n        this.quadraticCurveTo(x, y + height, x, y + height - radius_low);\n        this.lineTo(x, y + radius);\n        this.quadraticCurveTo(x, y, x + radius, y);\n    };\n}\n\nfunction compareObjects(a, b) {\n    for (const i in a) {\n        if (a[i] != b[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nLiteGraph.compareObjects = compareObjects;\n\nfunction distance(a, b) {\n    return Math.sqrt(\n        (b[0] - a[0]) * (b[0] - a[0]) + (b[1] - a[1]) * (b[1] - a[1]),\n    );\n}\n\nLiteGraph.distance = distance;\n\nfunction colorToString(c) {\n    return (\n        `rgba(${\n            Math.round(c[0] * 255)\n                .toFixed()\n        },${\n            Math.round(c[1] * 255)\n                .toFixed()\n        },${\n            Math.round(c[2] * 255)\n                .toFixed()\n        },${\n            c.length == 4 ? c[3].toFixed(2) : \"1.0\"\n        })`\n    );\n}\n\nLiteGraph.colorToString = colorToString;\n\nfunction isInsideRectangle(x, y, left, top, width, height) {\n    if (left < x && left + width > x && top < y && top + height > y) {\n        return true;\n    }\n    return false;\n}\n\nLiteGraph.isInsideRectangle = isInsideRectangle;\n\n// [minx,miny,maxx,maxy]\nfunction growBounding(bounding, x, y) {\n    if (x < bounding[0]) {\n        bounding[0] = x;\n    } else if (x > bounding[2]) {\n        bounding[2] = x;\n    }\n\n    if (y < bounding[1]) {\n        bounding[1] = y;\n    } else if (y > bounding[3]) {\n        bounding[3] = y;\n    }\n}\n\nLiteGraph.growBounding = growBounding;\n\n// point inside bounding box\nfunction isInsideBounding(p, bb) {\n    if (\n        p[0] < bb[0][0]\n        || p[1] < bb[0][1]\n        || p[0] > bb[1][0]\n        || p[1] > bb[1][1]\n    ) {\n        return false;\n    }\n    return true;\n}\n\nLiteGraph.isInsideBounding = isInsideBounding;\n\n// bounding overlap, format: [ startx, starty, width, height ]\nfunction overlapBounding(a, b) {\n    const A_end_x = a[0] + a[2];\n    const A_end_y = a[1] + a[3];\n    const B_end_x = b[0] + b[2];\n    const B_end_y = b[1] + b[3];\n\n    if (\n        a[0] > B_end_x\n        || a[1] > B_end_y\n        || A_end_x < b[0]\n        || A_end_y < b[1]\n    ) {\n        return false;\n    }\n    return true;\n}\n\nLiteGraph.overlapBounding = overlapBounding;\n\n// Convert a hex value to its decimal value - the inputted hex must be in the\n//\tformat of a hex triplet - the kind we use for HTML colours. The function\n//\twill return an array with three values.\nfunction hex2num(hex) {\n    if (hex.charAt(0) == \"#\") {\n        hex = hex.slice(1);\n    } // Remove the '#' char - if there is one.\n    hex = hex.toUpperCase();\n    const hex_alphabets = \"0123456789ABCDEF\";\n    const value = new Array(3);\n    let k = 0;\n    let int1;\n    let\n        int2;\n    for (let i = 0; i < 6; i += 2) {\n        int1 = hex_alphabets.indexOf(hex.charAt(i));\n        int2 = hex_alphabets.indexOf(hex.charAt(i + 1));\n        value[k] = int1 * 16 + int2;\n        k++;\n    }\n    return value;\n}\n\nLiteGraph.hex2num = hex2num;\n\n// Give a array with three values as the argument and the function will return\n//\tthe corresponding hex triplet.\nfunction num2hex(triplet) {\n    const hex_alphabets = \"0123456789ABCDEF\";\n    let hex = \"#\";\n    let int1;\n    let\n        int2;\n    for (let i = 0; i < 3; i++) {\n        int1 = triplet[i] / 16;\n        int2 = triplet[i] % 16;\n\n        hex += hex_alphabets.charAt(int1) + hex_alphabets.charAt(int2);\n    }\n    return hex;\n}\n\nLiteGraph.num2hex = num2hex;\n\n/* LiteGraph GUI elements used for canvas editing ************************************ */\n\n/**\n * ContextMenu from LiteGUI\n *\n * @class ContextMenu\n * @constructor\n * @param {Array} values (allows object { title: \"Nice text\", callback: function ... })\n * @param {Object} options [optional] Some options:\\\n * - title: title to show on top of the menu\n * - callback: function to call when an option is clicked, it receives the item information\n * - ignore_item_callbacks: ignores the callback inside the item, it just calls the\n *     options.callback\n * - event: you can pass a MouseEvent, this way the ContextMenu appears in that position\n */\nfunction ContextMenu(values, options) {\n    options = options || {};\n    this.options = options;\n    const that = this;\n\n    // to link a menu with its parent\n    if (options.parentMenu) {\n        if (options.parentMenu.constructor !== this.constructor) {\n            console.error(\n                \"parentMenu must be of class ContextMenu, ignoring it\",\n            );\n            options.parentMenu = null;\n        } else {\n            this.parentMenu = options.parentMenu;\n            this.parentMenu.lock = true;\n            this.parentMenu.current_submenu = this;\n        }\n    }\n\n    let eventClass = null;\n    if (options.event) // use strings because comparing classes between windows doesnt work\n    {\n        eventClass = options.event.constructor.name;\n    }\n    if (eventClass !== \"MouseEvent\"\n        && eventClass !== \"CustomEvent\"\n        && eventClass !== \"PointerEvent\"\n    ) {\n        console.error(\n            \"Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it.\",\n        );\n        options.event = null;\n    }\n\n    const root = document.createElement(\"div\");\n    root.className = \"litegraph litecontextmenu litemenubar-panel\";\n    if (options.className) {\n        root.className += ` ${options.className}`;\n    }\n    root.style.minWidth = 100;\n    root.style.minHeight = 100;\n    root.style.pointerEvents = \"none\";\n    setTimeout(() => {\n        root.style.pointerEvents = \"auto\";\n    }, 100); // delay so the mouse up event is not caught by this element\n\n    // this prevents the default context browser menu to open in case this menu was created\n    // when pressing right button\n    root.addEventListener(\n        \"mouseup\",\n        (e) => {\n            e.preventDefault();\n            return true;\n        },\n        true,\n    );\n    root.addEventListener(\n        \"contextmenu\",\n        (e) => {\n            if (e.button != 2) {\n                // right button\n                return false;\n            }\n            e.preventDefault();\n            return false;\n        },\n        true,\n    );\n\n    root.addEventListener(\n        \"mousedown\",\n        (e) => {\n            if (e.button == 2) {\n                that.close();\n                e.preventDefault();\n                return true;\n            }\n        },\n        true,\n    );\n\n    function on_mouse_wheel(e) {\n        const pos = parseInt(root.style.top);\n        root.style.top = `${(pos + e.deltaY * options.scroll_speed).toFixed()}px`;\n        e.preventDefault();\n        return true;\n    }\n\n    if (!options.scroll_speed) {\n        options.scroll_speed = 0.1;\n    }\n\n    root.addEventListener(\"wheel\", on_mouse_wheel, true);\n    root.addEventListener(\"mousewheel\", on_mouse_wheel, true);\n\n    this.root = root;\n\n    // title\n    if (options.title) {\n        const element = document.createElement(\"div\");\n        element.className = \"litemenu-title\";\n        element.innerHTML = options.title;\n        root.appendChild(element);\n    }\n\n    // entries\n    let num = 0;\n    for (let i = 0; i < values.length; i++) {\n        let name = values.constructor == Array ? values[i] : i;\n        if (name != null && name.constructor !== String) {\n            name = name.content === undefined ? String(name) : name.content;\n        }\n        const value = values[i];\n        this.addItem(name, value, options);\n        num++;\n    }\n\n    // close on leave\n    root.addEventListener(\"mouseleave\", (e) => {\n        if (that.lock) {\n            return;\n        }\n        if (root.closing_timer) {\n            clearTimeout(root.closing_timer);\n        }\n        root.closing_timer = setTimeout(that.close.bind(that, e), 500);\n        // that.close(e);\n    });\n\n    root.addEventListener(\"mouseenter\", (e) => {\n        if (root.closing_timer) {\n            clearTimeout(root.closing_timer);\n        }\n    });\n\n    // insert before checking position\n    let root_document = document;\n    if (options.event) {\n        root_document = options.event.target.ownerDocument;\n    }\n\n    if (!root_document) {\n        root_document = document;\n    }\n\n    if (root_document.fullscreenElement) {\n        root_document.fullscreenElement.appendChild(root);\n    } else {\n        root_document.body.appendChild(root);\n    }\n\n    // compute best position\n    let left = options.left || 0;\n    let top = options.top || 0;\n    if (options.event) {\n        left = options.event.clientX - 10;\n        top = options.event.clientY - 10;\n        if (options.title) {\n            top -= 20;\n        }\n\n        if (options.parentMenu) {\n            const rect = options.parentMenu.root.getBoundingClientRect();\n            left = rect.left + rect.width;\n        }\n\n        const body_rect = document.body.getBoundingClientRect();\n        const root_rect = root.getBoundingClientRect();\n        if (body_rect.height == 0) console.error(\"document.body height is 0. That is dangerous, set html,body { height: 100%; }\");\n\n        if (body_rect.width && left > body_rect.width - root_rect.width - 10) {\n            left = body_rect.width - root_rect.width - 10;\n        }\n        if (body_rect.height && top > body_rect.height - root_rect.height - 10) {\n            top = body_rect.height - root_rect.height - 10;\n        }\n    }\n\n    root.style.left = `${left}px`;\n    root.style.top = `${top}px`;\n\n    if (options.scale) {\n        root.style.transform = `scale(${options.scale})`;\n    }\n}\n\nContextMenu.prototype.addItem = function (name, value, options) {\n    const that = this;\n    options = options || {};\n\n    const element = document.createElement(\"div\");\n    element.className = \"litemenu-entry submenu\";\n\n    let disabled = false;\n\n    if (value === null) {\n        element.classList.add(\"separator\");\n        // element.innerHTML = \"<hr/>\"\n        // continue;\n    } else {\n        element.innerHTML = value && value.title ? value.title : name;\n        element.value = value;\n\n        if (value) {\n            if (value.disabled) {\n                disabled = true;\n                element.classList.add(\"disabled\");\n            }\n            if (value.submenu || value.has_submenu) {\n                element.classList.add(\"has_submenu\");\n            }\n        }\n\n        if (typeof value === \"function\") {\n            element.dataset.value = name;\n            element.onclick_callback = value;\n        } else {\n            element.dataset.value = value;\n        }\n\n        if (value.className) {\n            element.className += ` ${value.className}`;\n        }\n    }\n\n    this.root.appendChild(element);\n    if (!disabled) {\n        element.addEventListener(\"click\", inner_onclick);\n    }\n    if (options.autoopen) {\n        element.addEventListener(\"mouseenter\", inner_over);\n    }\n\n    function inner_over(e) {\n        const { value } = this;\n        if (!value || !value.has_submenu) {\n            return;\n        }\n        // if it is a submenu, autoopen like the item was clicked\n        inner_onclick.call(this, e);\n    }\n\n    // menu option clicked\n    function inner_onclick(e) {\n        const { value } = this;\n        let close_parent = true;\n\n        if (that.current_submenu) {\n            that.current_submenu.close(e);\n        }\n\n        // global callback\n        if (options.callback) {\n            var r = options.callback.call(\n                this,\n                value,\n                options,\n                e,\n                that,\n                options.node,\n            );\n            if (r === true) {\n                close_parent = false;\n            }\n        }\n\n        // special cases\n        if (value) {\n            if (\n                value.callback\n                && !options.ignore_item_callbacks\n                && value.disabled !== true\n            ) {\n                // item callback\n                var r = value.callback.call(\n                    this,\n                    value,\n                    options,\n                    e,\n                    that,\n                    options.extra,\n                );\n                if (r === true) {\n                    close_parent = false;\n                }\n            }\n            if (value.submenu) {\n                if (!value.submenu.options) {\n                    throw \"ContextMenu submenu needs options\";\n                }\n                const submenu = new that.constructor(value.submenu.options, {\n                    callback: value.submenu.callback,\n                    event: e,\n                    parentMenu: that,\n                    ignore_item_callbacks:\n                    value.submenu.ignore_item_callbacks,\n                    title: value.submenu.title,\n                    extra: value.submenu.extra,\n                    autoopen: options.autoopen,\n                });\n                close_parent = false;\n            }\n        }\n\n        if (close_parent && !that.lock) {\n            that.close();\n        }\n    }\n\n    return element;\n};\n\nContextMenu.prototype.close = function (e, ignore_parent_menu) {\n    if (this.root.parentNode) {\n        this.root.parentNode.removeChild(this.root);\n    }\n    if (this.parentMenu && !ignore_parent_menu) {\n        this.parentMenu.lock = false;\n        this.parentMenu.current_submenu = null;\n        if (e === undefined) {\n            this.parentMenu.close();\n        } else if (\n            e\n            && !ContextMenu.isCursorOverElement(e, this.parentMenu.root)\n        ) {\n            ContextMenu.trigger(this.parentMenu.root, \"mouseleave\", e);\n        }\n    }\n    if (this.current_submenu) {\n        this.current_submenu.close(e, true);\n    }\n\n    if (this.root.closing_timer) {\n        clearTimeout(this.root.closing_timer);\n    }\n};\n\n// this code is used to trigger events easily (used in the context menu mouseleave\nContextMenu.trigger = function (element, event_name, params, origin) {\n    const evt = document.createEvent(\"CustomEvent\");\n    evt.initCustomEvent(event_name, true, true, params); // canBubble, cancelable, detail\n    evt.srcElement = origin;\n    if (element.dispatchEvent) {\n        element.dispatchEvent(evt);\n    } else if (element.__events) {\n        element.__events.dispatchEvent(evt);\n    }\n    // else nothing seems binded here so nothing to do\n    return evt;\n};\n\n// returns the top most menu\nContextMenu.prototype.getTopMenu = function () {\n    if (this.options.parentMenu) {\n        return this.options.parentMenu.getTopMenu();\n    }\n    return this;\n};\n\nContextMenu.prototype.getFirstEvent = function () {\n    if (this.options.parentMenu) {\n        return this.options.parentMenu.getFirstEvent();\n    }\n    return this.options.event;\n};\n\nContextMenu.isCursorOverElement = function (event, element) {\n    const left = event.clientX;\n    const top = event.clientY;\n    const rect = element.getBoundingClientRect();\n    if (!rect) {\n        return false;\n    }\n    if (\n        top > rect.top\n        && top < rect.top + rect.height\n        && left > rect.left\n        && left < rect.left + rect.width\n    ) {\n        return true;\n    }\n    return false;\n};\n\nLiteGraph.ContextMenu = ContextMenu;\n\nLiteGraph.closeAllContextMenus = function (ref_window) {\n    ref_window = ref_window || window;\n\n    const elements = ref_window.document.querySelectorAll(\".litecontextmenu\");\n    if (!elements.length) {\n        return;\n    }\n\n    const result = [];\n    for (var i = 0; i < elements.length; i++) {\n        result.push(elements[i]);\n    }\n\n    for (var i = 0; i < result.length; i++) {\n        if (result[i].close) {\n            result[i].close();\n        } else if (result[i].parentNode) {\n            result[i].parentNode.removeChild(result[i]);\n        }\n    }\n};\n\nLiteGraph.extendClass = function (target, origin) {\n    for (var i in origin) {\n        // copy class properties\n        if (target.hasOwnProperty(i)) {\n            continue;\n        }\n        target[i] = origin[i];\n    }\n\n    if (origin.prototype) {\n        // copy prototype properties\n        for (var i in origin.prototype) {\n            // only enumerable\n            if (!origin.prototype.hasOwnProperty(i)) {\n                continue;\n            }\n\n            if (target.prototype.hasOwnProperty(i)) {\n                // avoid overwriting existing ones\n                continue;\n            }\n\n            // copy getters\n            if (origin.prototype.__lookupGetter__(i)) {\n                target.prototype.__defineGetter__(\n                    i,\n                    origin.prototype.__lookupGetter__(i),\n                );\n            } else {\n                target.prototype[i] = origin.prototype[i];\n            }\n\n            // and setters\n            if (origin.prototype.__lookupSetter__(i)) {\n                target.prototype.__defineSetter__(\n                    i,\n                    origin.prototype.__lookupSetter__(i),\n                );\n            }\n        }\n    }\n};\n\n// used by some widgets to render a curve editor\nfunction CurveEditor(points) {\n    this.points = points;\n    this.selected = -1;\n    this.nearest = -1;\n    this.size = null; // stores last size used\n    this.must_update = true;\n    this.margin = 5;\n}\n\nCurveEditor.sampleCurve = function (f, points) {\n    if (!points) return;\n    for (let i = 0; i < points.length - 1; ++i) {\n        const p = points[i];\n        const pn = points[i + 1];\n        if (pn[0] < f) continue;\n        const r = (pn[0] - p[0]);\n        if (Math.abs(r) < 0.00001) return p[1];\n        const local_f = (f - p[0]) / r;\n        return p[1] * (1.0 - local_f) + pn[1] * local_f;\n    }\n    return 0;\n};\n\nCurveEditor.prototype.draw = function (ctx, size, graphcanvas, background_color, line_color, inactive) {\n    const { points } = this;\n    if (!points) return;\n    this.size = size;\n    const w = size[0] - this.margin * 2;\n    const h = size[1] - this.margin * 2;\n\n    line_color = line_color || \"#666\";\n\n    ctx.save();\n    ctx.translate(this.margin, this.margin);\n\n    if (background_color) {\n        ctx.fillStyle = \"#111\";\n        ctx.fillRect(0, 0, w, h);\n        ctx.fillStyle = \"#222\";\n        ctx.fillRect(w * 0.5, 0, 1, h);\n        ctx.strokeStyle = \"#333\";\n        ctx.strokeRect(0, 0, w, h);\n    }\n    ctx.strokeStyle = line_color;\n    if (inactive) ctx.globalAlpha = 0.5;\n    ctx.beginPath();\n    for (var i = 0; i < points.length; ++i) {\n        var p = points[i];\n        ctx.lineTo(p[0] * w, (1.0 - p[1]) * h);\n    }\n    ctx.stroke();\n    ctx.globalAlpha = 1;\n    if (!inactive) {\n        for (var i = 0; i < points.length; ++i) {\n            var p = points[i];\n            ctx.fillStyle = this.selected == i ? \"#FFF\" : (this.nearest == i ? \"#DDD\" : \"#AAA\");\n            ctx.beginPath();\n            ctx.arc(p[0] * w, (1.0 - p[1]) * h, 2, 0, Math.PI * 2);\n            ctx.fill();\n        }\n    }\n    ctx.restore();\n};\n\n// localpos is mouse in curve editor space\nCurveEditor.prototype.onMouseDown = function (localpos, graphcanvas) {\n    const { points } = this;\n    if (!points) return;\n    if (localpos[1] < 0) return;\n\n    // this.captureInput(true);\n    const w = this.size[0] - this.margin * 2;\n    const h = this.size[1] - this.margin * 2;\n    const x = localpos[0] - this.margin;\n    const y = localpos[1] - this.margin;\n    const pos = [x, y];\n    const max_dist = 30 / graphcanvas.ds.scale;\n    // search closer one\n    this.selected = this.getCloserPoint(pos, max_dist);\n    // create one\n    if (this.selected == -1) {\n        const point = [x / w, 1 - y / h];\n        points.push(point);\n        points.sort((a, b) => a[0] - b[0]);\n        this.selected = points.indexOf(point);\n        this.must_update = true;\n    }\n    if (this.selected != -1) return true;\n};\n\nCurveEditor.prototype.onMouseMove = function (localpos, graphcanvas) {\n    const { points } = this;\n    if (!points) return;\n    const s = this.selected;\n    if (s < 0) return;\n    const x = (localpos[0] - this.margin) / (this.size[0] - this.margin * 2);\n    const y = (localpos[1] - this.margin) / (this.size[1] - this.margin * 2);\n    const curvepos = [(localpos[0] - this.margin), (localpos[1] - this.margin)];\n    const max_dist = 30 / graphcanvas.ds.scale;\n    this._nearest = this.getCloserPoint(curvepos, max_dist);\n    const point = points[s];\n    if (point) {\n        const is_edge_point = s == 0 || s == points.length - 1;\n        if (!is_edge_point && (localpos[0] < -10 || localpos[0] > this.size[0] + 10 || localpos[1] < -10 || localpos[1] > this.size[1] + 10)) {\n            points.splice(s, 1);\n            this.selected = -1;\n            return;\n        }\n        if (!is_edge_point) // not edges\n        {\n            point[0] = Math.clamp(x, 0, 1);\n        } else {\n            point[0] = s == 0 ? 0 : 1;\n        }\n        point[1] = 1.0 - Math.clamp(y, 0, 1);\n        points.sort((a, b) => a[0] - b[0]);\n        this.selected = points.indexOf(point);\n        this.must_update = true;\n    }\n};\n\nCurveEditor.prototype.onMouseUp = function (localpos, graphcanvas) {\n    this.selected = -1;\n    return false;\n};\n\nCurveEditor.prototype.getCloserPoint = function (pos, max_dist) {\n    const { points } = this;\n    if (!points) return -1;\n    max_dist = max_dist || 30;\n    const w = (this.size[0] - this.margin * 2);\n    const h = (this.size[1] - this.margin * 2);\n    const num = points.length;\n    const p2 = [0, 0];\n    let min_dist = 1000000;\n    let closest = -1;\n    let last_valid = -1;\n    for (let i = 0; i < num; ++i) {\n        const p = points[i];\n        p2[0] = p[0] * w;\n        p2[1] = (1.0 - p[1]) * h;\n        if (p2[0] < pos[0]) last_valid = i;\n        const dist = vec2.distance(pos, p2);\n        if (dist > min_dist || dist > max_dist) continue;\n        closest = i;\n        min_dist = dist;\n    }\n    return closest;\n};\n\nLiteGraph.CurveEditor = CurveEditor;\n\n// used to create nodes from wrapping functions\nLiteGraph.getParameterNames = function (func) {\n    return (`${func}`)\n        .replace(/[/][/].*$/gm, \"\") // strip single-line comments\n        .replace(/\\s+/g, \"\") // strip white space\n        .replace(/[/][*][^/*]*[*][/]/g, \"\") // strip multi-line comments  /**/\n        .split(\"){\", 1)[0]\n        .replace(/^[^(]*[(]/, \"\") // extract the parameters\n        .replace(/=[^,]+/g, \"\") // strip any ES6 defaults\n        .split(\",\")\n        .filter(Boolean); // split & filter [\"\"]\n};\n\nMath.clamp = function (v, a, b) {\n    return a > v ? a : b < v ? b : v;\n};\n\nif (typeof window !== \"undefined\" && !window.requestAnimationFrame) {\n    window.requestAnimationFrame = window.webkitRequestAnimationFrame\n        || window.mozRequestAnimationFrame\n        || function (callback) {\n            window.setTimeout(callback, 1000 / 60);\n        };\n}\n\nexport default LiteGraph\n","import LiteGraph from \"./litegraph\";\n\n/**\n * LGraph is the class that contain a full graph.\n * We instantiate one and add nodes to it, and then we can run the execution loop.\n * supported callbacks:\n + onNodeAdded: when a new node is added to the graph\n + onNodeRemoved: when a node inside this graph is removed\n + onNodeConnectionChange: some connection has changed in the graph (connected or disconnected)\n *\n * @class LGraph\n * @constructor\n * @param {Object} o data from previous serialization [optional]\n */\nexport default class LGraph {\n    constructor(o) {\n        if (LiteGraph.debug) {\n            console.log(\"Graph created\");\n        }\n        this.list_of_graphcanvas = null;\n        this.clear();\n\n        if (o) {\n            this.configure(o);\n        }\n    }\n\n    getSupportedTypes() {\n        return this.supportedTypes || LGraph.supportedTypes;\n    }\n\n    STATUS_STOPPED = 1;\n\n    STATUS_RUNNING = 2;\n\n    supportedTypes = [\"number\", \"string\", \"boolean\"];\n\n    static supportedTypes = [\"number\", \"string\", \"boolean\"];\n    // used to know which types of connections support this graph (some graphs do not allow certain\n    // types)\n\n    /**\n     * Removes all nodes from this graph\n     * @method clear\n     */\n    clear() {\n        this.stop();\n        this.status = LGraph.STATUS_STOPPED;\n\n        this.last_node_id = 0;\n        this.last_link_id = 0;\n\n        this._version = -1; // used to detect changes\n\n        // safe clear\n        if (this._nodes) {\n            for (const node of this._nodes) {\n                if (node.onRemoved) node.onRemoved();\n            }\n        }\n\n        // nodes\n        this._nodes = [];\n        this._nodes_by_id = {};\n        this._nodes_in_order = []; // nodes sorted in execution order\n        this._nodes_executable = null; // nodes that contain onExecute sorted in execution order\n\n        // other scene stuff\n        this._groups = [];\n\n        // links\n        this.links = {}; // container with all the links\n\n        // iterations\n        this.iteration = 0;\n\n        // custom data\n        this.config = {};\n        this.vars = {};\n        this.extra = {}; // to store custom data\n\n        // timing\n        this.globaltime = 0;\n        this.runningtime = 0;\n        this.fixedtime = 0;\n        this.fixedtime_lapse = 0.01;\n        this.elapsed_time = 0.01;\n        this.last_update_time = 0;\n        this.starttime = 0;\n\n        this.catch_errors = true;\n\n        // subgraph_data\n        this.inputs = {};\n        this.outputs = {};\n\n        // notify canvas to redraw\n        this.change();\n\n        this.sendActionToCanvas(\"clear\");\n    }\n\n    /**\n     * Attach Canvas to this graph\n     * @method attachCanvas\n     * @param {GraphCanvas} graphcanvas\n     */\n    attachCanvas(graphcanvas) {\n        if (graphcanvas.constructor !== LGraphCanvas) {\n            throw new Error(\"attachCanvas expects a LGraphCanvas instance\");\n        }\n        if (graphcanvas.graph && graphcanvas.graph !== this) {\n            graphcanvas.graph.detachCanvas(graphcanvas);\n        }\n\n        graphcanvas.graph = this;\n\n        if (!this.list_of_graphcanvas) this.list_of_graphcanvas = [];\n        this.list_of_graphcanvas.push(graphcanvas);\n    }\n\n    /**\n     * Detach Canvas from this graph\n     * @method detachCanvas\n     * @param {GraphCanvas} graphcanvas\n     */\n    detachCanvas(graphcanvas) {\n        if (!this.list_of_graphcanvas) {\n            return;\n        }\n\n        const pos = this.list_of_graphcanvas.indexOf(graphcanvas);\n        if (pos === -1) {\n            return;\n        }\n        graphcanvas.graph = null;\n        this.list_of_graphcanvas.splice(pos, 1);\n    }\n\n    /**\n     * Starts running this graph every interval milliseconds.\n     * @method start\n     * @param {number} interval amount of milliseconds between executions, if 0 then it renders to\n     *     the monitor refresh rate\n     */\n    start(interval) {\n        if (this.status === LGraph.STATUS_RUNNING) {\n            return;\n        }\n        this.status = LGraph.STATUS_RUNNING;\n\n        if (this.onPlayEvent) {\n            this.onPlayEvent();\n        }\n\n        this.sendEventToAllNodes(\"onStart\");\n\n        // launch\n        this.starttime = LiteGraph.getTime();\n        this.last_update_time = this.starttime;\n        interval = interval || 0;\n        const that = this;\n\n        // execute once per frame\n        if (interval === 0 && typeof window !== \"undefined\" && window.requestAnimationFrame) {\n            // eslint-disable-next-line no-inner-declarations\n            function onFrame() {\n                if (that.execution_timer_id !== -1) {\n                    return;\n                }\n                window.requestAnimationFrame(onFrame);\n                if (that.onBeforeStep) that.onBeforeStep();\n                that.runStep(1, !that.catch_errors);\n                if (that.onAfterStep) that.onAfterStep();\n            }\n\n            this.execution_timer_id = -1;\n            onFrame();\n        } else { // execute every 'interval' ms\n            this.execution_timer_id = setInterval(() => {\n                // execute\n                if (that.onBeforeStep) that.onBeforeStep();\n                that.runStep(1, !that.catch_errors);\n                if (that.onAfterStep) that.onAfterStep();\n            }, interval);\n        }\n    }\n\n    /**\n     * Stops the execution loop of the graph\n     * @method stop execution\n     */\n    stop() {\n        if (this.status === LGraph.STATUS_STOPPED) {\n            return;\n        }\n\n        this.status = LGraph.STATUS_STOPPED;\n\n        if (this.onStopEvent) {\n            this.onStopEvent();\n        }\n\n        if (this.execution_timer_id !== null) {\n            if (this.execution_timer_id !== -1) {\n                clearInterval(this.execution_timer_id);\n            }\n            this.execution_timer_id = null;\n        }\n\n        this.sendEventToAllNodes(\"onStop\");\n    }\n\n    /**\n     * Run N steps (cycles) of the graph\n     * @method runStep\n     * @param {number} num number of steps to run, default is 1\n     * @param {Boolean} doNotCatchError [optional] if you want to try/catch errors\n     * @param {number} limit max number of nodes to execute (used to execute from start to a node)\n     */\n    runStep(num, doNotCatchError, limit) {\n        num = num || 1;\n\n        const start = LiteGraph.getTime();\n        this.globaltime = 0.001 * (start - this.starttime);\n\n        const nodes = this._nodes_executable\n            ? this._nodes_executable\n            : this._nodes;\n        if (!nodes) {\n            return;\n        }\n\n        limit = limit || nodes.length;\n\n        if (doNotCatchError) {\n            // iterations\n            for (let i = 0; i < num; i++) {\n                for (let j = 0; j < limit; j++) {\n                    const node = nodes[j];\n                    if (node.mode === LiteGraph.ALWAYS && node.onExecute) {\n                        node.onExecute(); // hard to send elapsed time\n                    }\n                }\n\n                this.fixedtime += this.fixedtime_lapse;\n                if (this.onExecuteStep) {\n                    this.onExecuteStep();\n                }\n            }\n\n            if (this.onAfterExecute) {\n                this.onAfterExecute();\n            }\n        } else {\n            try {\n                // iterations\n                for (let i = 0; i < num; i++) {\n                    for (let j = 0; j < limit; ++j) {\n                        const node = nodes[j];\n                        if (node.mode === LiteGraph.ALWAYS && node.onExecute) {\n                            node.onExecute();\n                        }\n                    }\n\n                    this.fixedtime += this.fixedtime_lapse;\n                    if (this.onExecuteStep) {\n                        this.onExecuteStep();\n                    }\n                }\n\n                if (this.onAfterExecute) {\n                    this.onAfterExecute();\n                }\n                this.errors_in_execution = false;\n            } catch (err) {\n                this.errors_in_execution = true;\n                if (LiteGraph.throw_errors) {\n                    throw err;\n                }\n                if (LiteGraph.debug) {\n                    console.log(`Error during execution: ${err}`);\n                }\n                this.stop();\n            }\n        }\n\n        const now = LiteGraph.getTime();\n        let elapsed = now - start;\n        if (elapsed === 0) {\n            elapsed = 1;\n        }\n        this.execution_time = 0.001 * elapsed;\n        this.globaltime += 0.001 * elapsed;\n        this.iteration += 1;\n        this.elapsed_time = (now - this.last_update_time) * 0.001;\n        this.last_update_time = now;\n    }\n\n    /**\n     * Updates the graph execution order according to relevance of the nodes (nodes with only\n     * outputs have more relevance than nodes with only inputs.\n     * @method updateExecutionOrder\n     */\n    updateExecutionOrder() {\n        this._nodes_in_order = this.computeExecutionOrder(false);\n        this._nodes_executable = [];\n        for (const node of this._nodes_in_order) {\n            if (node.onExecute) {\n                this._nodes_executable.push(node);\n            }\n        }\n    }\n\n    /**\n     * It computes the executable nodes in order and returns it\n     * @param onlyOnExecute\n     * @param setLevel\n     * @returns {this}\n     * @internal\n     */\n    computeExecutionOrder(onlyOnExecute, setLevel) {\n        let L = [];\n        const S = [];\n        const M = {};\n        const visitedLinks = {}; // to avoid repeating links\n        const remainingLinks = {}; // to a\n\n        // search for the nodes without inputs (starting nodes)\n        for (const node of this._nodes) {\n            if (onlyOnExecute && !node.onExecute) {\n                continue;\n            }\n\n            M[node.id] = node; // add to pending nodes\n\n            let num = 0; // num of input connections\n            if (node.inputs) {\n                for (let j = 0, l2 = node.inputs.length; j < l2; j++) {\n                    if (node.inputs[j] && node.inputs[j].link != null) {\n                        num += 1;\n                    }\n                }\n            }\n\n            if (num === 0) {\n                // is a starting node\n                S.push(node);\n                if (setLevel) {\n                    node._level = 1;\n                }\n            } else {\n                if (setLevel) {\n                    node._level = 0;\n                }\n                remainingLinks[node.id] = num;\n            }\n        }\n\n        while (true) {\n            if (S.length === 0) {\n                break;\n            }\n\n            // get an starting node\n            const node = S.shift();\n            L.push(node); // add to ordered list\n            delete M[node.id]; // remove from the pending nodes\n\n            if (!node.outputs) {\n                continue;\n            }\n\n            // for every output\n            for (const output of node.outputs) {\n                if (\n                    output == null\n                    || output.links == null\n                    || output.links.length === 0\n                ) {\n                    continue;\n                }\n\n                // for every connection\n                for (const linkId of output.links) {\n                    const link = this.links[linkId];\n                    if (!link) {\n                        continue;\n                    }\n\n                    // already visited link (ignore it)\n                    if (visitedLinks[link.id]) {\n                        continue;\n                    }\n\n                    const targetNode = this.getNodeById(link.target_id);\n                    if (targetNode == null) {\n                        visitedLinks[link.id] = true;\n                        continue;\n                    }\n\n                    if (\n                        setLevel\n                        && (!targetNode._level\n                        || targetNode._level <= node._level)\n                    ) {\n                        targetNode._level = node._level + 1;\n                    }\n\n                    visitedLinks[link.id] = true; // mark as visited\n                    remainingLinks[targetNode.id] -= 1; // reduce the number of links remaining\n                    if (remainingLinks[targetNode.id] === 0) {\n                        S.push(targetNode);\n                    } // if no more links, then add to starters array\n                }\n            }\n        }\n\n        // the remaining ones (loops)\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const i in M) L.push(M[i]);\n\n        if (L.length !== this._nodes.length && LiteGraph.debug) {\n            console.warn(\"something went wrong, nodes missing\");\n        }\n\n        const l = L.length;\n\n        // save order number in the node\n        for (let i = 0; i < l; i++) L[i].order = i;\n\n        // sort now by priority\n        L = L.sort((A, B) => {\n            const Ap = A.constructor.priority || A.priority || 0;\n            const Bp = B.constructor.priority || B.priority || 0;\n            if (Ap === Bp) {\n                // if same priority, sort by order\n                return A.order - B.order;\n            }\n            return Ap - Bp; // sort by priority\n        });\n\n        // save order number in the node, again...\n        for (let i = 0; i < l; ++i) L[i].order = i;\n\n        return L;\n    }\n\n    /**\n     * Returns all the nodes that could affect this one (ancestors) by crawling all the inputs\n     * recursively. It doesn't include the node itself\n     * @method getAncestors\n     * @return {Array} an array with all the LGraphNodes that affect this node, in order of\n     *     execution\n     */\n    // eslint-disable-next-line class-methods-use-this\n    getAncestors(node) {\n        const ancestors = [];\n        const pending = [node];\n        const visited = {};\n\n        while (pending.length) {\n            const current = pending.shift();\n            if (!current.inputs) {\n                continue;\n            }\n            if (!visited[current.id] && current !== node) {\n                visited[current.id] = true;\n                ancestors.push(current);\n            }\n\n            for (let i = 0; i < current.inputs.length; ++i) {\n                const input = current.getInputNode(i);\n                if (input && ancestors.indexOf(input) === -1) {\n                    pending.push(input);\n                }\n            }\n        }\n\n        ancestors.sort((a, b) => a.order - b.order);\n        return ancestors;\n    }\n\n    /**\n     * Positions every node in a more readable manner\n     * @method arrange\n     */\n    arrange(margin) {\n        margin = margin || 100;\n\n        const nodes = this.computeExecutionOrder(false, true);\n        const columns = [];\n        for (const node of nodes) {\n            const col = node._level || 1;\n            if (!columns[col]) {\n                columns[col] = [];\n            }\n            columns[col].push(node);\n        }\n\n        let x = margin;\n\n        for (const column of columns) {\n            if (!column) {\n                continue;\n            }\n            let maxSize = 100;\n            let y = margin + LiteGraph.NODE_TITLE_HEIGHT;\n            for (const node of column) {\n                node.pos[0] = x;\n                node.pos[1] = y;\n                if (node.size[0] > maxSize) maxSize = node.size[0];\n                y += node.size[1] + margin + LiteGraph.NODE_TITLE_HEIGHT;\n            }\n            x += maxSize + margin;\n        }\n\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * Returns the amount of time the graph has been running in milliseconds\n     * @method getTime\n     * @return {number} number of milliseconds the graph has been running\n     */\n    getTime() {\n        return this.globaltime;\n    }\n\n    /**\n     * Returns the amount of time accumulated using the fixedtime_lapse var. This is used in\n     * context where the time increments should be constant\n     * @method getFixedTime\n     * @return {number} number of milliseconds the graph has been running\n     */\n\n    getFixedTime() {\n        return this.fixedtime;\n    }\n\n    /**\n     * Returns the amount of time it took to compute the latest iteration. Take into account that\n     * this number could be not correct if the nodes are using graphical actions\n     * @method getElapsedTime\n     * @return {number} number of milliseconds it took the last cycle\n     */\n\n    getElapsedTime() {\n        return this.elapsed_time;\n    }\n\n    /**\n     * Sends an event to all the nodes, useful to trigger stuff\n     * @method sendEventToAllNodes\n     * @param {String} eventname the name of the event (function to be called)\n     * @param {Array} params parameters in array format\n     */\n    sendEventToAllNodes(eventname, params, mode) {\n        mode = mode || LiteGraph.ALWAYS;\n\n        const nodes = this._nodes_in_order ? this._nodes_in_order : this._nodes;\n        if (!nodes) {\n            return;\n        }\n\n        for (let j = 0, l = nodes.length; j < l; ++j) {\n            const node = nodes[j];\n\n            if (\n                node.constructor === LiteGraph.Subgraph\n                && eventname !== \"onExecute\"\n            ) {\n                if (node.mode === mode) {\n                    node.sendEventToAllNodes(eventname, params, mode);\n                }\n                continue;\n            }\n\n            if (!node[eventname] || node.mode !== mode) {\n                continue;\n            }\n            if (params === undefined) {\n                node[eventname]();\n            } else if (params && params.constructor === Array) {\n                node[eventname](...params);\n            } else {\n                node[eventname](params);\n            }\n        }\n    }\n\n    sendActionToCanvas(action, params) {\n        if (!this.list_of_graphcanvas) {\n            return;\n        }\n\n        for (let i = 0; i < this.list_of_graphcanvas.length; ++i) {\n            const c = this.list_of_graphcanvas[i];\n            if (c[action]) {\n                c[action](...params);\n            }\n        }\n    }\n\n    /**\n     * Adds a new node instance to this graph\n     * @method add\n     * @param {LGraphNode} node the instance of the node\n     * @param {boolean} skipComputeOrder\n     */\n\n    add(node, skipComputeOrder) {\n        if (!node) {\n            return;\n        }\n\n        // groups\n        if (node.constructor === LGraphGroup) {\n            this._groups.push(node);\n            this.setDirtyCanvas(true);\n            this.change();\n            node.graph = this;\n            this._version++;\n            return;\n        }\n\n        // nodes\n        if (node.id !== -1 && this._nodes_by_id[node.id] != null) {\n            console.warn(\n                \"LiteGraph: there is already a node with this ID, changing it\",\n            );\n            node.id = ++this.last_node_id;\n        }\n\n        if (this._nodes.length >= LiteGraph.MAX_NUMBER_OF_NODES) {\n            throw new Error(\"LiteGraph: max number of nodes in a graph reached\");\n        }\n\n        // give him an id\n        if (node.id == null || node.id === -1) {\n            node.id = ++this.last_node_id;\n        } else if (this.last_node_id < node.id) {\n            this.last_node_id = node.id;\n        }\n\n        node.graph = this;\n        this._version++;\n\n        this._nodes.push(node);\n        this._nodes_by_id[node.id] = node;\n\n        if (node.onAdded) node.onAdded(this);\n\n        if (this.config.align_to_grid) node.alignToGrid();\n\n        if (!skipComputeOrder) this.updateExecutionOrder();\n\n        if (this.onNodeAdded) this.onNodeAdded(node);\n\n        this.setDirtyCanvas(true);\n        this.change();\n\n        return node; // to chain actions\n    }\n\n    /**\n     * Removes a node from the graph\n     * @method remove\n     * @param {LGraphNode} node the instance of the node\n     */\n\n    remove(node) {\n        if (node.constructor === LiteGraph.LGraphGroup) {\n            const index = this._groups.indexOf(node);\n            if (index !== -1) {\n                this._groups.splice(index, 1);\n            }\n            node.graph = null;\n            this._version++;\n            this.setDirtyCanvas(true, true);\n            this.change();\n            return;\n        }\n\n        if (this._nodes_by_id[node.id] == null) {\n            return;\n        } // not found\n\n        if (node.ignore_remove) {\n            return;\n        } // cannot be removed\n\n        this.beforeChange(); // sure?\n\n        // disconnect inputs\n        if (node.inputs) {\n            for (let i = 0; i < node.inputs.length; i++) {\n                const slot = node.inputs[i];\n                if (slot.link != null) {\n                    node.disconnectInput(i);\n                }\n            }\n        }\n\n        // disconnect outputs\n        if (node.outputs) {\n            for (let i = 0; i < node.outputs.length; i++) {\n                const slot = node.inputs[i];\n                if (slot.links != null && slot.links.length) {\n                    node.disconnectOutput(i);\n                }\n            }\n        }\n\n        // node.id = -1; //why?\n\n        // callback\n        if (node.onRemoved) {\n            node.onRemoved();\n        }\n\n        node.graph = null;\n        this._version++;\n\n        // remove from canvas render\n        if (this.list_of_graphcanvas) {\n            for (const canvas of this.list_of_graphcanvas) {\n                if (canvas.selected_nodes[node.id]) {\n                    delete canvas.selected_nodes[node.id];\n                }\n                if (canvas.node_dragged === node) {\n                    canvas.node_dragged = null;\n                }\n            }\n        }\n\n        // remove from containers\n        const pos = this._nodes.indexOf(node);\n        if (pos !== -1) {\n            this._nodes.splice(pos, 1);\n        }\n        delete this._nodes_by_id[node.id];\n\n        if (this.onNodeRemoved) {\n            this.onNodeRemoved(node);\n        }\n\n        // close panels\n        this.sendActionToCanvas(\"checkPanels\");\n\n        this.setDirtyCanvas(true, true);\n        this.afterChange(); // sure?\n        this.change();\n\n        this.updateExecutionOrder();\n    }\n\n    /**\n     * Returns a node by its id.\n     * @method getNodeById\n     * @param {Number} id\n     */\n\n    getNodeById(id) {\n        if (id == null) {\n            return null;\n        }\n        return this._nodes_by_id[id];\n    }\n\n    /**\n     * Returns a list of nodes that matches a class\n     * @method findNodesByClass\n     * @param {Class} classObject the class itself (not an string)\n     * @param {Array} result\n     * @return {Array} a list with all the nodes of this type\n     */\n    findNodesByClass(classObject, result = []) {\n        result.length = 0;\n        for (const node of this._nodes) {\n            if (node.constructor === classObject) result.push(node);\n        }\n        return result;\n    }\n\n    /**\n     * Returns a list of nodes that matches a type\n     * @method findNodesByType\n     * @param {String} type the name of the node type\n     * @param {Array} result\n     * @return {Array} a list with all the nodes of this type\n     */\n    findNodesByType(type, result = []) {\n        type = type.toLowerCase();\n        result = result || [];\n        result.length = 0;\n        for (const node of this._nodes) {\n            if (node.type.toLowerCase() === type) result.push(node);\n        }\n        return result;\n    }\n\n    /**\n     * Returns the first node that matches a name in its title\n     * @method findNodeByTitle\n     * @param {String} title the name of the node to search\n     * @return {Node} the node or null\n     */\n    findNodeByTitle(title) {\n        for (const node of this._nodes) {\n            if (node.title === title) return node;\n        }\n        return null;\n    }\n\n    /**\n     * Returns a list of nodes that matches a name\n     * @method findNodesByTitle\n     * @param {String} title the name of the node to search\n     * @return {Array} a list with all the nodes with this name\n     */\n    findNodesByTitle(title) {\n        const result = [];\n        for (const node of this._nodes) {\n            if (node.title === title) result.push(node);\n        }\n        return result;\n    }\n\n    /**\n     * Returns the top-most node in this position of the canvas\n     * @method getNodeOnPos\n     * @param {number} x the x coordinate in canvas space\n     * @param {number} y the y coordinate in canvas space\n     * @param {Array} nodesList a list with all the nodes to search from, by default is all the\n     *     nodes in the graph\n     * @param {number} margin\n     * @return {LGraphNode} the node at this position or null\n     */\n    getNodeOnPos(x, y, nodesList = this._nodes, margin) {\n        for (const n of nodesList) {\n            if (n.isPointInside(x, y, margin)) return n;\n        }\n        return null;\n    }\n\n    /**\n     * Returns the top-most group in that position\n     * @method getGroupOnPos\n     * @param {number} x the x coordinate in canvas space\n     * @param {number} y the y coordinate in canvas space\n     * @return {LGraphGroup} the group or null\n     */\n    getGroupOnPos(x, y) {\n        for (const g of this._groups) {\n            if (g.isPointInside(x, y, 2, true)) return g;\n        }\n        return null;\n    }\n\n    /**\n     * Checks that the node type matches the node type registered, used when replacing a nodetype\n     * by a newer version during execution this replaces the ones using the old version with the\n     * new version\n     * @method checkNodeTypes\n     */\n    checkNodeTypes() {\n        for (let node of this._nodes) {\n            const ctor = LiteGraph.registered_node_types[node.type];\n            if (node.constructor === ctor) {\n                continue;\n            }\n            console.log(`node being replaced by newer version: ${node.type}`);\n            const newnode = LiteGraph.createNode(node.type);\n            node = newnode;\n            newnode.configure(node.serialize());\n            newnode.graph = this;\n            this._nodes_by_id[newnode.id] = newnode;\n            if (node.inputs) {\n                newnode.inputs = node.inputs.concat();\n            }\n            if (node.outputs) {\n                newnode.outputs = node.outputs.concat();\n            }\n        }\n        this.updateExecutionOrder();\n    }\n\n    // ********** GLOBALS *****************\n\n    onAction(action, param) {\n        this._input_nodes = this.findNodesByClass(\n            LiteGraph.GraphInput,\n            this._input_nodes,\n        );\n        for (const node of this._input_nodes) {\n            if (node.properties.name !== action) {\n                continue;\n            }\n            node.onAction(action, param);\n            break;\n        }\n    }\n\n    trigger(action, param) {\n        if (this.onTrigger) {\n            this.onTrigger(action, param);\n        }\n    }\n\n    /**\n     * Tell this graph it has a global graph input of this type\n     * @method addGlobalInput\n     * @param {String} name\n     * @param {String} type\n     * @param {*} value [optional]\n     */\n    addInput(name, type, value) {\n        const input = this.inputs[name];\n        if (input) {\n            // already exist\n            return;\n        }\n\n        this.beforeChange();\n        this.inputs[name] = {\n            name,\n            type,\n            value,\n        };\n        this._version++;\n        this.afterChange();\n\n        if (this.onInputAdded) {\n            this.onInputAdded(name, type);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    }\n\n    /**\n     * Assign a data to the global graph input\n     * @method setGlobalInputData\n     * @param {String} name\n     * @param {*} data\n     */\n    setInputData(name, data) {\n        const input = this.inputs[name];\n        if (!input) {\n            return;\n        }\n        input.value = data;\n    }\n\n    /**\n     * Returns the current value of a global graph input\n     * @method getInputData\n     * @param {String} name\n     * @return {*} the data\n     */\n    getInputData(name) {\n        const input = this.inputs[name];\n        if (!input) {\n            return null;\n        }\n        return input.value;\n    }\n\n    /**\n     * Changes the newName of a global graph input\n     * @method renameInput\n     * @param {String} oldName\n     * @param {String} new_name\n     */\n    renameInput(oldName, newName) {\n        if (newName === oldName) {\n            return;\n        }\n\n        if (!this.inputs[oldName]) {\n            return false;\n        }\n\n        if (this.inputs[newName]) {\n            console.error(\"there is already one input with that newName\");\n            return false;\n        }\n\n        this.inputs[newName] = this.inputs[oldName];\n        delete this.inputs[oldName];\n        this._version++;\n\n        if (this.onInputRenamed) {\n            this.onInputRenamed(oldName, newName);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    }\n\n    /**\n     * Changes the type of a global graph input\n     * @method changeInputType\n     * @param {String} name\n     * @param {String} type\n     */\n    changeInputType(name, type) {\n        if (!this.inputs[name]) {\n            return false;\n        }\n\n        if (\n            this.inputs[name].type\n            && String(this.inputs[name].type).toLowerCase()\n            === String(type).toLowerCase()\n        ) {\n            return;\n        }\n\n        this.inputs[name].type = type;\n        this._version++;\n        if (this.onInputTypeChanged) {\n            this.onInputTypeChanged(name, type);\n        }\n    }\n\n    /**\n     * Removes a global graph input\n     * @method removeInput\n     * @param {String} name\n     */\n    removeInput(name) {\n        if (!this.inputs[name]) {\n            return false;\n        }\n\n        delete this.inputs[name];\n        this._version++;\n\n        if (this.onInputRemoved) {\n            this.onInputRemoved(name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n        return true;\n    }\n\n    /**\n     * Creates a global graph output\n     * @method addOutput\n     * @param {String} name\n     * @param {String} type\n     * @param {*} value\n     */\n    addOutput(name, type, value) {\n        this.outputs[name] = {\n            name,\n            type,\n            value,\n        };\n        this._version++;\n\n        if (this.onOutputAdded) {\n            this.onOutputAdded(name, type);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    }\n\n    /**\n     * Assign a data to the global output\n     * @method setOutputData\n     * @param {String} name\n     * @param {String} value\n     */\n    setOutputData(name, value) {\n        const output = this.outputs[name];\n        if (!output) {\n            return;\n        }\n        output.value = value;\n    }\n\n    /**\n     * Returns the current value of a global graph output\n     * @method getOutputData\n     * @param {String} name\n     * @return {*} the data\n     */\n    getOutputData(name) {\n        const output = this.outputs[name];\n        if (!output) {\n            return null;\n        }\n        return output.value;\n    }\n\n    /**\n     * Renames a global graph output\n     * @method renameOutput\n     * @param {String} oldName\n     * @param {String} newName\n     */\n    renameOutput(oldName, newName) {\n        if (!this.outputs[oldName]) {\n            return false;\n        }\n\n        if (this.outputs[newName]) {\n            console.error(\"there is already one output with that newName\");\n            return false;\n        }\n\n        this.outputs[newName] = this.outputs[oldName];\n        delete this.outputs[oldName];\n        this._version++;\n\n        if (this.onOutputRenamed) {\n            this.onOutputRenamed(oldName, newName);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    }\n\n    /**\n     * Changes the type of a global graph output\n     * @method changeOutputType\n     * @param {String} name\n     * @param {String} type\n     */\n    changeOutputType(name, type) {\n        if (!this.outputs[name]) {\n            return false;\n        }\n\n        if (\n            this.outputs[name].type\n            && String(this.outputs[name].type).toLowerCase()\n            === String(type).toLowerCase()\n        ) {\n            return;\n        }\n\n        this.outputs[name].type = type;\n        this._version++;\n        if (this.onOutputTypeChanged) {\n            this.onOutputTypeChanged(name, type);\n        }\n    }\n\n    /**\n     * Removes a global graph output\n     * @method removeOutput\n     * @param {String} name\n     */\n    removeOutput(name) {\n        if (!this.outputs[name]) {\n            return false;\n        }\n        delete this.outputs[name];\n        this._version++;\n\n        if (this.onOutputRemoved) {\n            this.onOutputRemoved(name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n        return true;\n    }\n\n    triggerInput(name, value) {\n        const nodes = this.findNodesByTitle(name);\n        for (let i = 0; i < nodes.length; ++i) {\n            nodes[i].onTrigger(value);\n        }\n    }\n\n    setCallback(name, func) {\n        const nodes = this.findNodesByTitle(name);\n        for (let i = 0; i < nodes.length; ++i) {\n            nodes[i].setTrigger(func);\n        }\n    }\n\n    // used for undo, called before any change is made to the graph\n    beforeChange(info) {\n        if (this.onBeforeChange) {\n            this.onBeforeChange(this, info);\n        }\n        this.sendActionToCanvas(\"onBeforeChange\", this);\n    }\n\n    // used to resend actions, called after any change is made to the graph\n    afterChange(info) {\n        if (this.onAfterChange) {\n            this.onAfterChange(this, info);\n        }\n        this.sendActionToCanvas(\"onAfterChange\", this);\n    }\n\n    connectionChange(node) {\n        this.updateExecutionOrder();\n        if (this.onConnectionChange) {\n            this.onConnectionChange(node);\n        }\n        this._version++;\n        this.sendActionToCanvas(\"onConnectionChange\");\n    }\n\n    /**\n     * returns if the graph is in live mode\n     * @method isLive\n     */\n\n    isLive() {\n        if (!this.list_of_graphcanvas) {\n            return false;\n        }\n\n        for (let i = 0; i < this.list_of_graphcanvas.length; ++i) {\n            const c = this.list_of_graphcanvas[i];\n            if (c.live_mode) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * clears the triggered slot animation in all links (stop visual animation)\n     * @method clearTriggeredSlots\n     */\n    clearTriggeredSlots() {\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const i in this.links) {\n            const linkInfo = this.links[i];\n            if (!linkInfo) {\n                continue;\n            }\n            if (linkInfo._last_time) {\n                linkInfo._last_time = 0;\n            }\n        }\n    }\n\n    /* Called when something visually changed (not the graph!) */\n    change() {\n        if (LiteGraph.debug) {\n            console.log(\"Graph changed\");\n        }\n        this.sendActionToCanvas(\"setDirty\", [true, true]);\n        if (this.on_change) {\n            this.on_change(this);\n        }\n    }\n\n    setDirtyCanvas(fg, bg) {\n        this.sendActionToCanvas(\"setDirty\", [fg, bg]);\n    }\n\n    /**\n     * Destroys a link\n     * @method removeLink\n     * @param {Number} linkId\n     */\n    removeLink(linkId) {\n        const link = this.links[linkId];\n        if (!link) {\n            return;\n        }\n        const node = this.getNodeById(link.target_id);\n        if (node) {\n            node.disconnectInput(link.target_slot);\n        }\n    }\n\n    // save and recover app state ***************************************\n    /**\n     * Creates a Object containing all the info about this graph, it can be serialized\n     * @method serialize\n     * @return {Object} value of the node\n     */\n    serialize() {\n        const nodesInfo = [];\n        for (const node of this._nodes) {\n            nodesInfo.push(node.serialize());\n        }\n\n        // pack link info into a non-verbose format\n        const links = [];\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const i in this.links) {\n            // links is an OBJECT\n            let link = this.links[i];\n            if (!link.serialize) {\n                // weird bug I havent solved yet\n                console.warn(\n                    \"weird LLink bug, link info is not a LLink but a regular object\",\n                );\n                const link2 = new LLink();\n                // eslint-disable-next-line guard-for-in,no-restricted-syntax\n                for (const j in link) {\n                    link2[j] = link[j];\n                }\n                this.links[i] = link2;\n                link = link2;\n            }\n\n            links.push(link.serialize());\n        }\n\n        const groupsInfo = [];\n        for (const group of this._groups) groupsInfo.push(group.serialize());\n\n        const data = {\n            last_node_id: this.last_node_id,\n            last_link_id: this.last_link_id,\n            nodes: nodesInfo,\n            links,\n            groups: groupsInfo,\n            config: this.config,\n            extra: this.extra,\n            version: LiteGraph.VERSION,\n        };\n\n        if (this.onSerialize) this.onSerialize(data);\n\n        return data;\n    }\n\n    /**\n     * Configure a graph from a JSON string\n     * @method configure\n     * @param {String} str configure a graph from a JSON string\n     * @param {Boolean} returns if there was any error parsing\n     */\n    configure(data, keepOld) {\n        if (!data) {\n            return;\n        }\n\n        if (!keepOld) this.clear();\n\n        const { nodes } = data;\n\n        // decode links info (they are very verbose)\n        if (data.links && data.links.constructor === Array) {\n            const links = [];\n            for (const linkData of data.links) {\n                if (!linkData) {\n                    console.warn(\"serialized graph link data contains errors, skipping.\");\n                    continue;\n                }\n                const link = new LLink();\n                link.configure(linkData);\n                links[link.id] = link;\n            }\n            data.links = links;\n        }\n\n        // copy all stored fields\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const i in data) {\n            if (i === \"nodes\" || i === \"groups\") {\n                continue;\n            }\n            this[i] = data[i];\n        }\n\n        let error = false;\n\n        // create nodes\n        this._nodes = [];\n        if (nodes) {\n            for (const nInfo of nodes) {\n                let node = LiteGraph.createNode(nInfo.type, nInfo.title);\n                if (!node) {\n                    if (LiteGraph.debug) {\n                        console.log(\n                            `Node not found or has errors: ${nInfo.type}`,\n                        );\n                    }\n\n                    // in case of error we create a replacement node to avoid losing info\n                    node = new LGraphNode();\n                    node.last_serialization = nInfo;\n                    node.has_errors = true;\n                    error = true;\n                    // continue;\n                }\n\n                node.id = nInfo.id; // id it or it will create a new id\n                this.add(node, true); // add before configure, otherwise configure cannot create\n                // links\n            }\n\n            // configure nodes afterwards so they can reach each other\n            for (const nInfo of nodes) {\n                const node = this.getNodeById(nInfo.id);\n                if (node) {\n                    node.configure(nInfo);\n                }\n            }\n        }\n\n        // groups\n        this._groups.length = 0;\n        if (data.groups) {\n            for (const dataGroup of data.groups) {\n                const group = new LiteGraph.LGraphGroup();\n                group.configure(dataGroup);\n                this.add(group);\n            }\n        }\n\n        this.updateExecutionOrder();\n\n        this.extra = data.extra || {};\n\n        if (this.onConfigure) this.onConfigure(data);\n\n        this._version++;\n        this.setDirtyCanvas(true, true);\n        return error;\n    }\n\n    load(url, callback) {\n        const that = this;\n\n        // from file\n        if (url.constructor === File || url.constructor === Blob) {\n            const reader = new FileReader();\n            reader.addEventListener(\"load\", (event) => {\n                const data = JSON.parse(event.target.result);\n                that.configure(data);\n                if (callback) callback();\n            });\n\n            reader.readAsText(url);\n            return;\n        }\n\n        // is a string, then an URL\n        const req = new XMLHttpRequest();\n        req.open(\"GET\", url, true);\n        req.send(null);\n        req.onload(() => {\n            if (req.status !== 200) {\n                console.error(\"Error loading graph:\", req.status, req.response);\n                return;\n            }\n            const data = JSON.parse(req.response);\n            that.configure(data);\n            if (callback) callback();\n        });\n        req.onerror((err) => {\n            console.error(\"Error loading graph:\", err);\n        });\n    }\n\n    /**\n     * Node event manager\n     * @todo\n     * @param node\n     * @param msg\n     * @param color\n     */\n    onNodeTrace(node, msg, color) {\n        // TODO\n    }\n}\n","export default class LLink {\n    constructor(id, type, origin_id, origin_slot, target_id, target_slot) {\n        this.id = id;\n        this.type = type;\n        this.origin_id = origin_id;\n        this.origin_slot = origin_slot;\n        this.target_id = target_id;\n        this.target_slot = target_slot;\n\n        this._data = null;\n        this._pos = new Float32Array(2); // center\n    }\n\n    configure(o) {\n        if (o.constructor === Array) {\n            this.id = o[0];\n            this.origin_id = o[1];\n            this.origin_slot = o[2];\n            this.target_id = o[3];\n            this.target_slot = o[4];\n            this.type = o[5];\n        } else {\n            this.id = o.id;\n            this.type = o.type;\n            this.origin_id = o.origin_id;\n            this.origin_slot = o.origin_slot;\n            this.target_id = o.target_id;\n            this.target_slot = o.target_slot;\n        }\n    }\n\n    serialize() {\n        return [\n            this.id,\n            this.origin_id,\n            this.origin_slot,\n            this.target_id,\n            this.target_slot,\n            this.type,\n        ];\n    }\n}\n","import LiteGraph from \"./litegraph\";\n\n/*\ntitle: string\npos: [x,y]\nsize: [x,y]\n\ninput|output: every connection\n+  { name:string, type:string, pos: [x,y]=Optional, direction: \"input\"|\"output\", links: Array });\n\ngeneral properties:\n+ clip_area: if you render outside the node, it will be clipped\n+ unsafe_execution: not allowed for safe execution\n+ skip_repeated_outputs: when adding new outputs, it wont show if there is one already connected\n+ resizable: if set to false it wont be resizable with the mouse\n+ horizontal: slots are distributed horizontally\n+ widgets_start_y: widgets start at y distance from the top of the node\n\nflags object:\n+ collapsed: if it is collapsed\n\nsupported callbacks:\n+ onAdded: when added to graph (warning: this is called BEFORE the node is configured when loading)\n+ onRemoved: when removed from graph\n+ onStart:\twhen the graph starts playing\n+ onStop:\twhen the graph stops playing\n+ onDrawForeground: render the inside widgets inside the node\n+ onDrawBackground: render the background area inside the node (only in edit mode)\n+ onMouseDown\n+ onMouseMove\n+ onMouseUp\n+ onMouseEnter\n+ onMouseLeave\n+ onExecute: execute the node\n+ onPropertyChanged: when a property is changed in the panel (return true to skip default behaviour)\n+ onGetInputs: returns an array of possible inputs\n+ onGetOutputs: returns an array of possible outputs\n+ onBounding: in case this node has a bigger bounding than the node itself (the callback receives the bounding as [x,y,w,h])\n+ onDblClick: double clicked in the node\n+ onInputDblClick: input slot double clicked (can be used to automatically create a node connected)\n+ onOutputDblClick: output slot double clicked (can be used to automatically create a node connected)\n+ onConfigure: called after the node has been configured\n+ onSerialize: to add extra info when serializing (the callback receives the object that should be filled with the data)\n+ onSelected\n+ onDeselected\n+ onDropItem : DOM item dropped over the node\n+ onDropFile : file dropped over the node\n+ onConnectInput : if returns false the incoming connection will be canceled\n+ onConnectionsChange : a connection changed (new one or removed) (LiteGraph.INPUT or LiteGraph.OUTPUT, slot, true if connected, link_info, input_info )\n+ onAction: action slot triggered\n+ getExtraMenuOptions: to add option to context menu\n*/\n\n/**\n * Base Class for all the node type classes\n * @class LGraphNode\n * @param {String} title a name for the node\n */\n\nexport default class LGraphNode {\n    constructor(title) {\n        this._ctor(title);\n        this.title = title || \"Unnamed\";\n        this.size = [LiteGraph.NODE_WIDTH, 60];\n        this.graph = null;\n        this.id = -1; // not know till not added\n        this.type = null;\n        // inputs available: array of inputs\n        this.inputs = [];\n        this.outputs = [];\n        this.connections = [];\n\n        // local data\n        this.properties = {}; // for the values\n        this.properties_info = []; // for the info\n\n        this.flags = {};\n    }\n\n    /**\n     * Internal position array\n     * @internal\n     * @type {Float32Array}\n     * @private\n     */\n    _pos = new Float32Array(10, 10)\n\n    set pos(v) {\n        if (!v || v.length < 2) {\n            return;\n        }\n        this._pos[0] = v[0];\n        this._pos[1] = v[1];\n    }\n\n    get pos() {\n        return this._pos;\n    }\n\n    /**\n     * configure a node from an object containing the serialized info\n     * @method configure\n     */\n    configure(info) {\n        if (this.graph) {\n            this.graph._version++;\n        }\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const j in info) {\n            if (j === \"properties\") {\n                // i don't want to clone properties, I want to reuse the old container\n                // eslint-disable-next-line guard-for-in,no-restricted-syntax\n                for (const k in info.properties) {\n                    this.properties[k] = info.properties[k];\n                    if (this.onPropertyChanged) {\n                        this.onPropertyChanged(k, info.properties[k]);\n                    }\n                }\n                continue;\n            }\n\n            if (info[j] == null) {\n                continue;\n            } else if (typeof info[j] === \"object\") {\n                // object\n                if (this[j] && this[j].configure) {\n                    this[j].configure(info[j]);\n                } else {\n                    this[j] = LiteGraph.cloneObject(info[j], this[j]);\n                }\n            } else {\n                this[j] = info[j];\n            }\n        }\n\n        if (!info.title) {\n            this.title = this.constructor.title;\n        }\n\n        if (this.onConnectionsChange) {\n            if (this.inputs) {\n                for (let i = 0; i < this.inputs.length; ++i) {\n                    const input = this.inputs[i];\n                    const linkInfo = this.graph\n                        ? this.graph.links[input.link]\n                        : null;\n                    this.onConnectionsChange(\n                        LiteGraph.INPUT,\n                        i,\n                        true,\n                        linkInfo,\n                        input,\n                    ); // linkInfo has been created now, so its updated\n                }\n            }\n\n            if (this.outputs) {\n                for (let i = 0; i < this.outputs.length; ++i) {\n                    const output = this.outputs[i];\n                    if (!output.links) {\n                        continue;\n                    }\n                    for (let j = 0; j < output.links.length; ++j) {\n                        const linkInfo = this.graph\n                            ? this.graph.links[output.links[j]]\n                            : null;\n                        this.onConnectionsChange(\n                            LiteGraph.OUTPUT,\n                            i,\n                            true,\n                            linkInfo,\n                            output,\n                        ); // link_info has been created now, so its updated\n                    }\n                }\n            }\n        }\n\n        if (this.widgets) {\n            for (const widget of this.widgets) {\n                if (!widget) continue;\n                if (widget.options\n                    && widget.options.property\n                    // eslint-disable-next-line max-len\n                    && this.properties[widget.options.property]) widget.value = JSON.parse(JSON.stringify(this.properties[widget.options.property]));\n            }\n            if (info.widgets_values) {\n                for (let i = 0; i < info.widgets_values.length; ++i) {\n                    if (this.widgets[i]) {\n                        this.widgets[i].value = info.widgets_values[i];\n                    }\n                }\n            }\n        }\n\n        if (this.onConfigure) {\n            this.onConfigure(info);\n        }\n    }\n\n    /**\n     * serialize the content\n     * @method serialize\n     */\n\n    serialize() {\n        // create serialization object\n        const o = {\n            id: this.id,\n            type: this.type,\n            pos: this.pos,\n            size: this.size,\n            flags: LiteGraph.cloneObject(this.flags),\n            order: this.order,\n            mode: this.mode,\n        };\n\n        // special case for when there were errors\n        if (this.constructor === LGraphNode && this.last_serialization) {\n            return this.last_serialization;\n        }\n\n        if (this.inputs) {\n            o.inputs = this.inputs;\n        }\n\n        if (this.outputs) {\n            // clear outputs last data (because data in connections is never serialized but stored\n            // inside the outputs info)\n            for (let i = 0; i < this.outputs.length; i++) {\n                delete this.outputs[i]._data;\n            }\n            o.outputs = this.outputs;\n        }\n\n        if (this.title && this.title != this.constructor.title) {\n            o.title = this.title;\n        }\n\n        if (this.properties) {\n            o.properties = LiteGraph.cloneObject(this.properties);\n        }\n\n        if (this.widgets && this.serialize_widgets) {\n            o.widgets_values = [];\n            for (let i = 0; i < this.widgets.length; ++i) {\n                if (this.widgets[i]) {\n                    o.widgets_values[i] = this.widgets[i].value;\n                } else {\n                    o.widgets_values[i] = null;\n                }\n            }\n        }\n\n        if (!o.type) o.type = this.constructor.type;\n\n        if (this.color) o.color = this.color;\n        if (this.bgcolor) o.bgcolor = this.bgcolor;\n        if (this.boxcolor) o.boxcolor = this.boxcolor;\n        if (this.shape) o.shape = this.shape;\n\n        if (this.onSerialize) {\n            if (this.onSerialize(o)) {\n                console.warn(\n                    \"node onSerialize shouldnt return anything, data should be stored in the object pass in the first parameter\",\n                );\n            }\n        }\n\n        return o;\n    }\n\n    /* Creates a clone of this node */\n    clone() {\n        const node = LiteGraph.createNode(this.type);\n        if (!node) {\n            return null;\n        }\n\n        // we clone it because serialize returns shared containers\n        const data = LiteGraph.cloneObject(this.serialize());\n\n        // remove links\n        if (data.inputs) {\n            for (let i = 0; i < data.inputs.length; ++i) {\n                data.inputs[i].link = null;\n            }\n        }\n\n        if (data.outputs) {\n            for (let i = 0; i < data.outputs.length; ++i) {\n                if (data.outputs[i].links) {\n                    data.outputs[i].links.length = 0;\n                }\n            }\n        }\n\n        delete data.id;\n        // remove links\n        node.configure(data);\n\n        return node;\n    }\n\n    /**\n     * serialize and stringify\n     * @method toString\n     */\n\n    toString() {\n        return JSON.stringify(this.serialize());\n    }\n    // deserialize = function(info) {} //this cannot be done from within, must\n    // be done in LiteGraph\n\n    /**\n     * get the title string\n     * @method getTitle\n     */\n\n    getTitle() {\n        return this.title || this.constructor.title;\n    }\n\n    /**\n     * sets the value of a property\n     * @method setProperty\n     * @param {String} name\n     * @param {*} value\n     */\n    setProperty(name, value) {\n        if (!this.properties) {\n            this.properties = {};\n        }\n        if (value === this.properties[name]) return;\n        const prevValue = this.properties[name];\n        this.properties[name] = value;\n        if (this.onPropertyChanged) {\n            if (this.onPropertyChanged(name, value, prevValue) === false) {\n                this.properties[name] = prevValue;\n            }\n        }\n        if (this.widgets) {\n            for (let i = 0; i < this.widgets.length; ++i) {\n                const w = this.widgets[i];\n                if (!w) continue;\n                if (w.options.property == name) {\n                    w.value = value;\n                    break;\n                }\n            }\n        }\n    }\n\n    // Execution *************************\n    /**\n     * sets the output data\n     * @method setOutputData\n     * @param {number} slot\n     * @param {*} data\n     */\n    setOutputData(slot, data) {\n        if (!this.outputs) {\n            return;\n        }\n\n        // this maybe slow and a niche case\n        // if(slot && slot.constructor === String)\n        //\tslot = this.findOutputSlot(slot);\n\n        if (slot == -1 || slot >= this.outputs.length) {\n            return;\n        }\n\n        const output_info = this.outputs[slot];\n        if (!output_info) {\n            return;\n        }\n\n        // store data in the output itself in case we want to debug\n        output_info._data = data;\n\n        // if there are connections, pass the data to the connections\n        if (this.outputs[slot].links) {\n            for (let i = 0; i < this.outputs[slot].links.length; i++) {\n                const link_id = this.outputs[slot].links[i];\n                const link = this.graph.links[link_id];\n                if (link) link.data = data;\n            }\n        }\n    }\n\n    /**\n     * sets the output data type, useful when you want to be able to overwrite the data type\n     * @method setOutputDataType\n     * @param {number} slot\n     * @param {String} datatype\n     */\n    setOutputDataType(slot, type) {\n        if (!this.outputs) {\n            return;\n        }\n        if (slot == -1 || slot >= this.outputs.length) {\n            return;\n        }\n        const output_info = this.outputs[slot];\n        if (!output_info) {\n            return;\n        }\n        // store data in the output itself in case we want to debug\n        output_info.type = type;\n\n        // if there are connections, pass the data to the connections\n        if (this.outputs[slot].links) {\n            for (let i = 0; i < this.outputs[slot].links.length; i++) {\n                const link_id = this.outputs[slot].links[i];\n                this.graph.links[link_id].type = type;\n            }\n        }\n    }\n\n    /**\n     * Retrieves the input data (data traveling through the connection) from one slot\n     * @method getInputData\n     * @param {number} slot\n     * @param {boolean} force_update if set to true it will force the connected node of this slot\n     *     to output data into this link\n     * @return {*} data or if it is not connected returns undefined\n     */\n    getInputData(slot, force_update) {\n        if (!this.inputs) {\n            return;\n        } // undefined;\n\n        if (slot >= this.inputs.length || this.inputs[slot].link == null) {\n            return;\n        }\n\n        const link_id = this.inputs[slot].link;\n        const link = this.graph.links[link_id];\n        if (!link) {\n            // bug: weird case but it happens sometimes\n            return null;\n        }\n\n        if (!force_update) {\n            return link.data;\n        }\n\n        // special case: used to extract data from the incoming connection before the graph has\n        // been executed\n        const node = this.graph.getNodeById(link.origin_id);\n        if (!node) {\n            return link.data;\n        }\n\n        if (node.updateOutputData) {\n            node.updateOutputData(link.origin_slot);\n        } else if (node.onExecute) {\n            node.onExecute();\n        }\n\n        return link.data;\n    }\n\n    /**\n     * Retrieves the input data type (in case this supports multiple input types)\n     * @method getInputDataType\n     * @param {number} slot\n     * @return {String} datatype in string format\n     */\n    getInputDataType(slot) {\n        if (!this.inputs) {\n            return null;\n        } // undefined;\n\n        if (slot >= this.inputs.length || this.inputs[slot].link == null) {\n            return null;\n        }\n        const link_id = this.inputs[slot].link;\n        const link = this.graph.links[link_id];\n        if (!link) {\n            // bug: weird case but it happens sometimes\n            return null;\n        }\n        const node = this.graph.getNodeById(link.origin_id);\n        if (!node) {\n            return link.type;\n        }\n        const output_info = node.outputs[link.origin_slot];\n        if (output_info) {\n            return output_info.type;\n        }\n        return null;\n    }\n\n    /**\n     * Retrieves the input data from one slot using its name instead of slot number\n     * @method getInputDataByName\n     * @param {String} slot_name\n     * @param {boolean} force_update if set to true it will force the connected node of this slot\n     *     to output data into this link\n     * @return {*} data or if it is not connected returns null\n     */\n    getInputDataByName(\n        slot_name,\n        force_update,\n    ) {\n        const slot = this.findInputSlot(slot_name);\n        if (slot == -1) {\n            return null;\n        }\n        return this.getInputData(slot, force_update);\n    }\n\n    /**\n     * tells you if there is a connection in one input slot\n     * @method isInputConnected\n     * @param {number} slot\n     * @return {boolean}\n     */\n    isInputConnected(slot) {\n        if (!this.inputs) {\n            return false;\n        }\n        return slot < this.inputs.length && this.inputs[slot].link != null;\n    }\n\n    /**\n     * tells you info about an input connection (which node, type, etc)\n     * @method getInputInfo\n     * @param {number} slot\n     * @return {Object} object or null { link: id, name: string, type: string or 0 }\n     */\n    getInputInfo(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot < this.inputs.length) {\n            return this.inputs[slot];\n        }\n        return null;\n    }\n\n    /**\n     * Returns the link info in the connection of an input slot\n     * @method getInputLink\n     * @param {number} slot\n     * @return {LLink} object or null\n     */\n    getInputLink(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot < this.inputs.length) {\n            const slot_info = this.inputs[slot];\n            return this.graph.links[slot_info.link];\n        }\n        return null;\n    }\n\n    /**\n     * returns the node connected in the input slot\n     * @method getInputNode\n     * @param {number} slot\n     * @return {LGraphNode} node or null\n     */\n    getInputNode(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot >= this.inputs.length) {\n            return null;\n        }\n        const input = this.inputs[slot];\n        if (!input || input.link === null) {\n            return null;\n        }\n        const link_info = this.graph.links[input.link];\n        if (!link_info) {\n            return null;\n        }\n        return this.graph.getNodeById(link_info.origin_id);\n    }\n\n    /**\n     * returns the value of an input with this name, otherwise checks if there is a property with\n     * that name\n     * @method getInputOrProperty\n     * @param {string} name\n     * @return {*} value\n     */\n    getInputOrProperty(name) {\n        if (!this.inputs || !this.inputs.length) {\n            return this.properties ? this.properties[name] : null;\n        }\n\n        for (let i = 0, l = this.inputs.length; i < l; ++i) {\n            const input_info = this.inputs[i];\n            if (name == input_info.name && input_info.link != null) {\n                const link = this.graph.links[input_info.link];\n                if (link) {\n                    return link.data;\n                }\n            }\n        }\n        return this.properties[name];\n    }\n\n    /**\n     * tells you the last output data that went in that slot\n     * @method getOutputData\n     * @param {number} slot\n     * @return {Object}  object or null\n     */\n    getOutputData(slot) {\n        if (!this.outputs) {\n            return null;\n        }\n        if (slot >= this.outputs.length) {\n            return null;\n        }\n\n        const info = this.outputs[slot];\n        return info._data;\n    }\n\n    /**\n     * tells you info about an output connection (which node, type, etc)\n     * @method getOutputInfo\n     * @param {number} slot\n     * @return {Object}  object or null { name: string, type: string, links: [ ids of links in\n     *     number ] }\n     */\n    getOutputInfo(slot) {\n        if (!this.outputs) {\n            return null;\n        }\n        if (slot < this.outputs.length) {\n            return this.outputs[slot];\n        }\n        return null;\n    }\n\n    /**\n     * tells you if there is a connection in one output slot\n     * @method isOutputConnected\n     * @param {number} slot\n     * @return {boolean}\n     */\n    isOutputConnected(slot) {\n        if (!this.outputs) {\n            return false;\n        }\n        return (\n            slot < this.outputs.length\n            && this.outputs[slot].links\n            && this.outputs[slot].links.length\n        );\n    }\n\n    /**\n     * tells you if there is any connection in the output slots\n     * @method isAnyOutputConnected\n     * @return {boolean}\n     */\n    isAnyOutputConnected() {\n        if (!this.outputs) {\n            return false;\n        }\n        for (let i = 0; i < this.outputs.length; ++i) {\n            if (this.outputs[i].links && this.outputs[i].links.length) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * retrieves all the nodes connected to this output slot\n     * @method getOutputNodes\n     * @param {number} slot\n     * @return {array}\n     */\n    getOutputNodes(slot) {\n        if (!this.outputs || this.outputs.length == 0) {\n            return null;\n        }\n\n        if (slot >= this.outputs.length) {\n            return null;\n        }\n\n        const output = this.outputs[slot];\n        if (!output.links || output.links.length == 0) {\n            return null;\n        }\n\n        const r = [];\n        for (let i = 0; i < output.links.length; i++) {\n            const link_id = output.links[i];\n            const link = this.graph.links[link_id];\n            if (link) {\n                const target_node = this.graph.getNodeById(link.target_id);\n                if (target_node) {\n                    r.push(target_node);\n                }\n            }\n        }\n        return r;\n    }\n\n    /**\n     * Triggers an event in this node, this will trigger any output with the same name\n     * @method trigger\n     * @param {String} event name ( \"on_play\", ... ) if action is equivalent to false then the\n     *     event is send to all\n     * @param {*} param\n     */\n    trigger(action, param) {\n        if (!this.outputs || !this.outputs.length) {\n            return;\n        }\n\n        if (this.graph) this.graph._last_trigger_time = LiteGraph.getTime();\n\n        for (let i = 0; i < this.outputs.length; ++i) {\n            const output = this.outputs[i];\n            if (!output || output.type !== LiteGraph.EVENT || (action && output.name != action)) continue;\n            this.triggerSlot(i, param);\n        }\n    }\n\n    /**\n     * Triggers an slot event in this node\n     * @method triggerSlot\n     * @param {Number} slot the index of the output slot\n     * @param {*} param\n     * @param {Number} link_id [optional] in case you want to trigger and specific output link in a\n     *     slot\n     */\n    triggerSlot(slot, param, link_id) {\n        if (!this.outputs) {\n            return;\n        }\n\n        const output = this.outputs[slot];\n        if (!output) {\n            return;\n        }\n\n        const { links } = output;\n        if (!links || !links.length) {\n            return;\n        }\n\n        if (this.graph) {\n            this.graph._last_trigger_time = LiteGraph.getTime();\n        }\n\n        // for every link attached here\n        for (let k = 0; k < links.length; ++k) {\n            const id = links[k];\n            if (link_id != null && link_id != id) {\n                // to skip links\n                continue;\n            }\n            const link_info = this.graph.links[links[k]];\n            if (!link_info) {\n                // not connected\n                continue;\n            }\n            link_info._last_time = LiteGraph.getTime();\n            const node = this.graph.getNodeById(link_info.target_id);\n            if (!node) {\n                // node not found?\n                continue;\n            }\n\n            // used to mark events in graph\n            const target_connection = node.inputs[link_info.target_slot];\n\n            if (node.mode === LiteGraph.ON_TRIGGER) {\n                if (node.onExecute) {\n                    node.onExecute(param);\n                }\n            } else if (node.onAction) {\n                node.onAction(target_connection.name, param);\n            }\n        }\n    }\n\n    /**\n     * clears the trigger slot animation\n     * @method clearTriggeredSlot\n     * @param {Number} slot the index of the output slot\n     * @param {Number} link_id [optional] in case you want to trigger and specific output link in a\n     *     slot\n     */\n    clearTriggeredSlot(slot, link_id) {\n        if (!this.outputs) {\n            return;\n        }\n\n        const output = this.outputs[slot];\n        if (!output) {\n            return;\n        }\n\n        const { links } = output;\n        if (!links || !links.length) {\n            return;\n        }\n\n        // for every link attached here\n        for (let k = 0; k < links.length; ++k) {\n            const id = links[k];\n            if (link_id != null && link_id != id) {\n                // to skip links\n                continue;\n            }\n            const link_info = this.graph.links[links[k]];\n            if (!link_info) {\n                // not connected\n                continue;\n            }\n            link_info._last_time = 0;\n        }\n    }\n\n    /**\n     * changes node size and triggers callback\n     * @method setSize\n     * @param {vec2} size\n     */\n    setSize(size) {\n        this.size = size;\n        if (this.onResize) this.onResize(this.size);\n    }\n\n    /**\n     * add a new property to this node\n     * @method addProperty\n     * @param {string} name\n     * @param {*} default_value\n     * @param {string} type string defining the output type (\"vec3\",\"number\",...)\n     * @param {Object} extra_info this can be used to have special properties of the property (like\n     *     values, etc)\n     */\n    addProperty(\n        name,\n        default_value,\n        type,\n        extra_info,\n    ) {\n        const o = {\n            name,\n            type,\n            default_value,\n        };\n        if (extra_info) {\n            for (const i in extra_info) {\n                o[i] = extra_info[i];\n            }\n        }\n        if (!this.properties_info) {\n            this.properties_info = [];\n        }\n        this.properties_info.push(o);\n        if (!this.properties) {\n            this.properties = {};\n        }\n        this.properties[name] = default_value;\n        return o;\n    }\n\n    // connections\n\n    /**\n     * add a new output slot to use in this node\n     * @method addOutput\n     * @param {string} name\n     * @param {string} type string defining the output type (\"vec3\",\"number\",...)\n     * @param {Object} extra_info this can be used to have special properties of an output (label,\n     *     special color, position, etc)\n     */\n    addOutput(name, type, extra_info) {\n        const o = {\n            name,\n            type,\n            links: null,\n        };\n        if (extra_info) {\n            for (const i in extra_info) {\n                o[i] = extra_info[i];\n            }\n        }\n\n        if (!this.outputs) {\n            this.outputs = [];\n        }\n        this.outputs.push(o);\n        if (this.onOutputAdded) {\n            this.onOutputAdded(o);\n        }\n        this.setSize(this.computeSize());\n        this.setDirtyCanvas(true, true);\n        return o;\n    }\n\n    /**\n     * add a new output slot to use in this node\n     * @method addOutputs\n     * @param {Array} array of triplets like [[name,type,extra_info],[...]]\n     */\n    addOutputs(array) {\n        for (let i = 0; i < array.length; ++i) {\n            const info = array[i];\n            const o = {\n                name: info[0],\n                type: info[1],\n                link: null,\n            };\n            if (array[2]) {\n                for (const j in info[2]) {\n                    o[j] = info[2][j];\n                }\n            }\n\n            if (!this.outputs) {\n                this.outputs = [];\n            }\n            this.outputs.push(o);\n            if (this.onOutputAdded) {\n                this.onOutputAdded(o);\n            }\n        }\n\n        this.setSize(this.computeSize());\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * remove an existing output slot\n     * @method removeOutput\n     * @param {number} slot\n     */\n    removeOutput(slot) {\n        this.disconnectOutput(slot);\n        this.outputs.splice(slot, 1);\n        for (let i = slot; i < this.outputs.length; ++i) {\n            if (!this.outputs[i] || !this.outputs[i].links) {\n                continue;\n            }\n            const { links } = this.outputs[i];\n            for (let j = 0; j < links.length; ++j) {\n                const link = this.graph.links[links[j]];\n                if (!link) {\n                    continue;\n                }\n                link.origin_slot -= 1;\n            }\n        }\n\n        this.setSize(this.computeSize());\n        if (this.onOutputRemoved) {\n            this.onOutputRemoved(slot);\n        }\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * add a new input slot to use in this node\n     * @method addInput\n     * @param {string} name\n     * @param {string} type string defining the input type (\"vec3\",\"number\",...), it its a generic\n     *     one use 0\n     * @param {Object} extra_info this can be used to have special properties of an input (label,\n     *     color, position, etc)\n     */\n    addInput(name, type, extra_info) {\n        type = type || 0;\n        const o = {\n            name,\n            type,\n            link: null,\n        };\n        if (extra_info) {\n            for (const i in extra_info) {\n                o[i] = extra_info[i];\n            }\n        }\n\n        if (!this.inputs) {\n            this.inputs = [];\n        }\n\n        this.inputs.push(o);\n        this.setSize(this.computeSize());\n\n        if (this.onInputAdded) {\n            this.onInputAdded(o);\n        }\n\n        this.setDirtyCanvas(true, true);\n        return o;\n    }\n\n    /**\n     * add several new input slots in this node\n     * @method addInputs\n     * @param {Array} array of triplets like [[name,type,extra_info],[...]]\n     */\n    addInputs(array) {\n        for (let i = 0; i < array.length; ++i) {\n            const info = array[i];\n            const o = {\n                name: info[0],\n                type: info[1],\n                link: null,\n            };\n            if (array[2]) {\n                for (const j in info[2]) {\n                    o[j] = info[2][j];\n                }\n            }\n\n            if (!this.inputs) {\n                this.inputs = [];\n            }\n            this.inputs.push(o);\n            if (this.onInputAdded) {\n                this.onInputAdded(o);\n            }\n        }\n\n        this.setSize(this.computeSize());\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * remove an existing input slot\n     * @method removeInput\n     * @param {number} slot\n     */\n    removeInput(slot) {\n        this.disconnectInput(slot);\n        const slot_info = this.inputs.splice(slot, 1);\n        for (let i = slot; i < this.inputs.length; ++i) {\n            if (!this.inputs[i]) {\n                continue;\n            }\n            const link = this.graph.links[this.inputs[i].link];\n            if (!link) {\n                continue;\n            }\n            link.target_slot -= 1;\n        }\n        this.setSize(this.computeSize());\n        if (this.onInputRemoved) {\n            this.onInputRemoved(slot, slot_info[0]);\n        }\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * add an special connection to this node (used for special kinds of graphs)\n     * @method addConnection\n     * @param {string} name\n     * @param {string} type string defining the input type (\"vec3\",\"number\",...)\n     * @param {[x,y]} pos position of the connection inside the node\n     * @param {string} direction if is input or output\n     */\n    addConnection(name, type, pos, direction) {\n        const o = {\n            name,\n            type,\n            pos,\n            direction,\n            links: null,\n        };\n        this.connections.push(o);\n        return o;\n    }\n\n    /**\n     * computes the minimum size of a node according to its inputs and output slots\n     * @method computeSize\n     * @param {number} minHeight\n     * @return {number} the total size\n     */\n    computeSize(out) {\n        if (this.constructor.size) {\n            return this.constructor.size.concat();\n        }\n\n        let rows = Math.max(\n            this.inputs ? this.inputs.length : 1,\n            this.outputs ? this.outputs.length : 1,\n        );\n        const size = out || new Float32Array([0, 0]);\n        rows = Math.max(rows, 1);\n        var font_size = LiteGraph.NODE_TEXT_SIZE; // although it should be\n        // graphcanvas.inner_text_font size\n\n        var font_size = font_size;\n        const title_width = compute_text_size(this.title);\n        let input_width = 0;\n        let output_width = 0;\n\n        if (this.inputs) {\n            for (var i = 0, l = this.inputs.length; i < l; ++i) {\n                const input = this.inputs[i];\n                var text = input.label || input.name || \"\";\n                var text_width = compute_text_size(text);\n                if (input_width < text_width) {\n                    input_width = text_width;\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0, l = this.outputs.length; i < l; ++i) {\n                const output = this.outputs[i];\n                var text = output.label || output.name || \"\";\n                var text_width = compute_text_size(text);\n                if (output_width < text_width) {\n                    output_width = text_width;\n                }\n            }\n        }\n\n        size[0] = Math.max(input_width + output_width + 10, title_width);\n        size[0] = Math.max(size[0], LiteGraph.NODE_WIDTH);\n        if (this.widgets && this.widgets.length) {\n            size[0] = Math.max(size[0], LiteGraph.NODE_WIDTH * 1.5);\n        }\n\n        size[1] = (this.constructor.slot_start_y || 0) + rows * LiteGraph.NODE_SLOT_HEIGHT;\n\n        let widgets_height = 0;\n        if (this.widgets && this.widgets.length) {\n            for (var i = 0, l = this.widgets.length; i < l; ++i) {\n                if (this.widgets[i].computeSize) {\n                    widgets_height += this.widgets[i].computeSize(size[0])[1] + 4;\n                } else {\n                    widgets_height += LiteGraph.NODE_WIDGET_HEIGHT + 4;\n                }\n            }\n            widgets_height += 8;\n        }\n\n        // compute height using widgets height\n        if (this.widgets_up) {\n            size[1] = Math.max(size[1], widgets_height);\n        } else if (this.widgets_start_y != null) {\n            size[1] = Math.max(size[1], widgets_height + this.widgets_start_y);\n        } else {\n            size[1] += widgets_height;\n        }\n\n        function compute_text_size(text) {\n            if (!text) {\n                return 0;\n            }\n            return font_size * text.length * 0.6;\n        }\n\n        if (\n            this.constructor.min_height\n            && size[1] < this.constructor.min_height\n        ) {\n            size[1] = this.constructor.min_height;\n        }\n\n        size[1] += 6; // margin\n\n        return size;\n    }\n\n    /**\n     * returns all the info available about a property of this node.\n     *\n     * @method getPropertyInfo\n     * @param {String} property name of the property\n     * @return {Object} the object with all the available info\n     */\n    getPropertyInfo(property) {\n        let info = null;\n\n        // there are several ways to define info about a property\n        // legacy mode\n        if (this.properties_info) {\n            for (let i = 0; i < this.properties_info.length; ++i) {\n                if (this.properties_info[i].name == property) {\n                    info = this.properties_info[i];\n                    break;\n                }\n            }\n        }\n        // litescene mode using the constructor\n        if (this.constructor[`@${property}`]) info = this.constructor[`@${property}`];\n\n        if (this.constructor.widgets_info && this.constructor.widgets_info[property]) info = this.constructor.widgets_info[property];\n\n        // litescene mode using the constructor\n        if (!info && this.onGetPropertyInfo) {\n            info = this.onGetPropertyInfo(property);\n        }\n\n        if (!info) info = {};\n        if (!info.type) info.type = typeof this.properties[property];\n        if (info.widget == \"combo\") info.type = \"enum\";\n\n        return info;\n    }\n\n    /**\n     * Defines a widget inside the node, it will be rendered on top of the node, you can control\n     * lots of properties\n     *\n     * @method addWidget\n     * @param {String} type the widget type (could be \"number\",\"string\",\"combo\"\n     * @param {String} name the text to show on the widget\n     * @param {String} value the default value\n     * @param {Function|String} callback function to call when it changes (optionally, it can be\n     *     the name of the property to modify)\n     * @param {Object} options the object that contains special properties of this widget\n     * @return {Object} the created widget object\n     */\n    addWidget(type, name, value, callback, options) {\n        if (!this.widgets) {\n            this.widgets = [];\n        }\n\n        if (!options && callback && callback.constructor === Object) {\n            options = callback;\n            callback = null;\n        }\n\n        if (options && options.constructor === String) // options can be the property name\n        {\n            options = { property: options };\n        }\n\n        if (callback && callback.constructor === String) // callback can be the property name\n        {\n            if (!options) options = {};\n            options.property = callback;\n            callback = null;\n        }\n\n        if (callback && callback.constructor !== Function) {\n            console.warn(\"addWidget: callback must be a function\");\n            callback = null;\n        }\n\n        const w = {\n            type: type.toLowerCase(),\n            name,\n            value,\n            callback,\n            options: options || {},\n        };\n\n        if (w.options.y !== undefined) {\n            w.y = w.options.y;\n        }\n\n        if (!callback && !w.options.callback && !w.options.property) {\n            console.warn(\"LiteGraph addWidget(...) without a callback or property assigned\");\n        }\n        if (type == \"combo\" && !w.options.values) {\n            throw \"LiteGraph addWidget('combo',...) requires to pass values in options: { values:['red','blue'] }\";\n        }\n        this.widgets.push(w);\n        this.setSize(this.computeSize());\n        return w;\n    }\n\n    addCustomWidget(custom_widget) {\n        if (!this.widgets) {\n            this.widgets = [];\n        }\n        this.widgets.push(custom_widget);\n        return custom_widget;\n    }\n\n    /**\n     * returns the bounding of the object, used for rendering purposes\n     * bounding is: [topleft_cornerx, topleft_cornery, width, height]\n     * @method getBounding\n     * @return {Float32Array[4]} the total size\n     */\n    getBounding(out) {\n        out = out || new Float32Array(4);\n        out[0] = this.pos[0] - 4;\n        out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT;\n        out[2] = this.size[0] + 4;\n        out[3] = this.size[1] + LiteGraph.NODE_TITLE_HEIGHT;\n\n        if (this.onBounding) {\n            this.onBounding(out);\n        }\n        return out;\n    }\n\n    /**\n     * checks if a point is inside the shape of a node\n     * @method isPointInside\n     * @param {number} x\n     * @param {number} y\n     * @return {boolean}\n     */\n    isPointInside(x, y, margin, skip_title) {\n        margin = margin || 0;\n\n        let margin_top = this.graph && this.graph.isLive() ? 0 : LiteGraph.NODE_TITLE_HEIGHT;\n        if (skip_title) {\n            margin_top = 0;\n        }\n        if (this.flags && this.flags.collapsed) {\n            // if ( distance([x,y], [this.pos[0] + this.size[0]*0.5, this.pos[1] +\n            // this.size[1]*0.5]) < LiteGraph.NODE_COLLAPSED_RADIUS)\n            if (\n                isInsideRectangle(\n                    x,\n                    y,\n                    this.pos[0] - margin,\n                    this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT - margin,\n                    (this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH)\n                    + 2 * margin,\n                    LiteGraph.NODE_TITLE_HEIGHT + 2 * margin,\n                )\n            ) {\n                return true;\n            }\n        } else if (\n            this.pos[0] - 4 - margin < x\n            && this.pos[0] + this.size[0] + 4 + margin > x\n            && this.pos[1] - margin_top - margin < y\n            && this.pos[1] + this.size[1] + margin > y\n        ) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * checks if a point is inside a node slot, and returns info about which slot\n     * @method getSlotInPosition\n     * @param {number} x\n     * @param {number} y\n     * @return {Object} if found the object contains { input|output: slot object, slot: number,\n     *     link_pos: [x,y] }\n     */\n    getSlotInPosition(x, y) {\n        // search for inputs\n        const link_pos = new Float32Array(2);\n        if (this.inputs) {\n            for (var i = 0, l = this.inputs.length; i < l; ++i) {\n                const input = this.inputs[i];\n                this.getConnectionPos(true, i, link_pos);\n                if (\n                    isInsideRectangle(\n                        x,\n                        y,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        20,\n                        10,\n                    )\n                ) {\n                    return {\n                        input,\n                        slot: i,\n                        link_pos,\n                    };\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0, l = this.outputs.length; i < l; ++i) {\n                const output = this.outputs[i];\n                this.getConnectionPos(false, i, link_pos);\n                if (\n                    isInsideRectangle(\n                        x,\n                        y,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        20,\n                        10,\n                    )\n                ) {\n                    return {\n                        output,\n                        slot: i,\n                        link_pos,\n                    };\n                }\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * returns the input slot with a given name (used for dynamic slots), -1 if not found\n     * @method findInputSlot\n     * @param {string} name the name of the slot\n     * @return {number} the slot (-1 if not found)\n     */\n    findInputSlot(name) {\n        if (!this.inputs) {\n            return -1;\n        }\n        for (let i = 0, l = this.inputs.length; i < l; ++i) {\n            if (name == this.inputs[i].name) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    /**\n     * returns the output slot with a given name (used for dynamic slots), -1 if not found\n     * @method findOutputSlot\n     * @param {string} name the name of the slot\n     * @return {number} the slot (-1 if not found)\n     */\n    findOutputSlot(name) {\n        if (!this.outputs) {\n            return -1;\n        }\n        for (let i = 0, l = this.outputs.length; i < l; ++i) {\n            if (name == this.outputs[i].name) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    /**\n     * connect this node output to the input of another node\n     * @method connect\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name\n     *     of the slot)\n     * @param {LGraphNode} node the target node\n     * @param {number_or_string} target_slot the input slot of the target node (could be the number\n     *     of the slot or the string with the name of the slot, or -1 to connect a trigger)\n     * @return {Object} the link_info is created, otherwise null\n     */\n    connect(slot, target_node, target_slot) {\n        target_slot = target_slot || 0;\n\n        if (!this.graph) {\n            // could be connected before adding it to a graph\n            console.log(\n                \"Connect: Error, node doesn't belong to any graph. Nodes must be added first to a graph before connecting them.\",\n            ); // due to link ids being associated with graphs\n            return null;\n        }\n\n        // seek for the output slot\n        if (slot.constructor === String) {\n            slot = this.findOutputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(`Connect: Error, no slot of name ${slot}`);\n                }\n                return null;\n            }\n        } else if (!this.outputs || slot >= this.outputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return null;\n        }\n\n        if (target_node && target_node.constructor === Number) {\n            target_node = this.graph.getNodeById(target_node);\n        }\n        if (!target_node) {\n            throw \"target node is null\";\n        }\n\n        // avoid loopback\n        if (target_node == this) {\n            return null;\n        }\n\n        // you can specify the slot by name\n        if (target_slot.constructor === String) {\n            target_slot = target_node.findInputSlot(target_slot);\n            if (target_slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\n                        `Connect: Error, no slot of name ${target_slot}`,\n                    );\n                }\n                return null;\n            }\n        } else if (target_slot === LiteGraph.EVENT) {\n            // search for first slot with event?\n            /*\n    //create input for trigger\n    var input = target_node.addInput(\"onTrigger\", LiteGraph.EVENT );\n    target_slot = target_node.inputs.length - 1; //last one is the one created\n    target_node.mode = LiteGraph.ON_TRIGGER;\n    */\n            return null;\n        } else if (\n            !target_node.inputs\n            || target_slot >= target_node.inputs.length\n        ) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return null;\n        }\n\n        let changed = false;\n\n        // if there is something already plugged there, disconnect\n        if (target_node.inputs[target_slot].link != null) {\n            this.graph.beforeChange();\n            target_node.disconnectInput(target_slot);\n            changed = true;\n        }\n\n        // why here??\n        // this.setDirtyCanvas(false,true);\n        // this.graph.connectionChange( this );\n\n        const output = this.outputs[slot];\n\n        // allows nodes to block connection\n        if (target_node.onConnectInput) {\n            if (target_node.onConnectInput(target_slot, output.type, output, this, slot) === false) {\n                return null;\n            }\n        }\n\n        const input = target_node.inputs[target_slot];\n        let link_info = null;\n\n        // this slots cannot be connected (different types)\n        if (!LiteGraph.isValidConnection(output.type, input.type)) {\n            this.setDirtyCanvas(false, true);\n            if (changed) this.graph.connectionChange(this, link_info);\n            return null;\n        }\n\n        if (!changed) this.graph.beforeChange();\n\n        // create link class\n        link_info = new LLink(\n            ++this.graph.last_link_id,\n            input.type,\n            this.id,\n            slot,\n            target_node.id,\n            target_slot,\n        );\n\n        // add to graph links list\n        this.graph.links[link_info.id] = link_info;\n\n        // connect in output\n        if (output.links == null) {\n            output.links = [];\n        }\n        output.links.push(link_info.id);\n        // connect in input\n        target_node.inputs[target_slot].link = link_info.id;\n        if (this.graph) {\n            this.graph._version++;\n        }\n        if (this.onConnectionsChange) {\n            this.onConnectionsChange(\n                LiteGraph.OUTPUT,\n                slot,\n                true,\n                link_info,\n                output,\n            );\n        } // link_info has been created now, so its updated\n        if (target_node.onConnectionsChange) {\n            target_node.onConnectionsChange(\n                LiteGraph.INPUT,\n                target_slot,\n                true,\n                link_info,\n                input,\n            );\n        }\n        if (this.graph && this.graph.onNodeConnectionChange) {\n            this.graph.onNodeConnectionChange(\n                LiteGraph.INPUT,\n                target_node,\n                target_slot,\n                this,\n                slot,\n            );\n            this.graph.onNodeConnectionChange(\n                LiteGraph.OUTPUT,\n                this,\n                slot,\n                target_node,\n                target_slot,\n            );\n        }\n\n        this.setDirtyCanvas(false, true);\n        this.graph.afterChange();\n        this.graph.connectionChange(this, link_info);\n\n        return link_info;\n    }\n\n    /**\n     * disconnect one output to an specific node\n     * @method disconnectOutput\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name\n     *     of the slot)\n     * @param {LGraphNode} target_node the target node to which this slot is connected [Optional,\n     *     if not target_node is specified all nodes will be disconnected]\n     * @return {boolean} if it was disconnected successfully\n     */\n    disconnectOutput(slot, target_node) {\n        if (slot.constructor === String) {\n            slot = this.findOutputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(`Connect: Error, no slot of name ${slot}`);\n                }\n                return false;\n            }\n        } else if (!this.outputs || slot >= this.outputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return false;\n        }\n\n        // get output slot\n        const output = this.outputs[slot];\n        if (!output || !output.links || output.links.length == 0) {\n            return false;\n        }\n\n        // one of the output links in this slot\n        if (target_node) {\n            if (target_node.constructor === Number) {\n                target_node = this.graph.getNodeById(target_node);\n            }\n            if (!target_node) {\n                throw \"Target Node not found\";\n            }\n\n            for (var i = 0, l = output.links.length; i < l; i++) {\n                var link_id = output.links[i];\n                var link_info = this.graph.links[link_id];\n\n                // is the link we are searching for...\n                if (link_info.target_id == target_node.id) {\n                    output.links.splice(i, 1); // remove here\n                    var input = target_node.inputs[link_info.target_slot];\n                    input.link = null; // remove there\n                    delete this.graph.links[link_id]; // remove the link from the links pool\n                    if (this.graph) {\n                        this.graph._version++;\n                    }\n                    if (target_node.onConnectionsChange) {\n                        target_node.onConnectionsChange(\n                            LiteGraph.INPUT,\n                            link_info.target_slot,\n                            false,\n                            link_info,\n                            input,\n                        );\n                    } // link_info hasn't been modified so its ok\n                    if (this.onConnectionsChange) {\n                        this.onConnectionsChange(\n                            LiteGraph.OUTPUT,\n                            slot,\n                            false,\n                            link_info,\n                            output,\n                        );\n                    }\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.OUTPUT,\n                            this,\n                            slot,\n                        );\n                    }\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.OUTPUT,\n                            this,\n                            slot,\n                        );\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.INPUT,\n                            target_node,\n                            link_info.target_slot,\n                        );\n                    }\n                    break;\n                }\n            }\n        } // all the links in this output slot\n        else {\n            for (var i = 0, l = output.links.length; i < l; i++) {\n                var link_id = output.links[i];\n                var link_info = this.graph.links[link_id];\n                if (!link_info) {\n                    // bug: it happens sometimes\n                    continue;\n                }\n\n                var target_node = this.graph.getNodeById(link_info.target_id);\n                var input = null;\n                if (this.graph) {\n                    this.graph._version++;\n                }\n                if (target_node) {\n                    input = target_node.inputs[link_info.target_slot];\n                    input.link = null; // remove other side link\n                    if (target_node.onConnectionsChange) {\n                        target_node.onConnectionsChange(\n                            LiteGraph.INPUT,\n                            link_info.target_slot,\n                            false,\n                            link_info,\n                            input,\n                        );\n                    } // link_info hasn't been modified so its ok\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.INPUT,\n                            target_node,\n                            link_info.target_slot,\n                        );\n                    }\n                }\n                delete this.graph.links[link_id]; // remove the link from the links pool\n                if (this.onConnectionsChange) {\n                    this.onConnectionsChange(\n                        LiteGraph.OUTPUT,\n                        slot,\n                        false,\n                        link_info,\n                        output,\n                    );\n                }\n                if (this.graph && this.graph.onNodeConnectionChange) {\n                    this.graph.onNodeConnectionChange(\n                        LiteGraph.OUTPUT,\n                        this,\n                        slot,\n                    );\n                    this.graph.onNodeConnectionChange(\n                        LiteGraph.INPUT,\n                        target_node,\n                        link_info.target_slot,\n                    );\n                }\n            }\n            output.links = null;\n        }\n\n        this.setDirtyCanvas(false, true);\n        this.graph.connectionChange(this);\n        return true;\n    }\n\n    /**\n     * disconnect one input\n     * @method disconnectInput\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name\n     *     of the slot)\n     * @return {boolean} if it was disconnected successfully\n     */\n    disconnectInput(slot) {\n        // seek for the output slot\n        if (slot.constructor === String) {\n            slot = this.findInputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(`Connect: Error, no slot of name ${slot}`);\n                }\n                return false;\n            }\n        } else if (!this.inputs || slot >= this.inputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return false;\n        }\n\n        const input = this.inputs[slot];\n        if (!input) {\n            return false;\n        }\n\n        const link_id = this.inputs[slot].link;\n        if (link_id != null) {\n            this.inputs[slot].link = null;\n\n            // remove other side\n            const link_info = this.graph.links[link_id];\n            if (link_info) {\n                const target_node = this.graph.getNodeById(link_info.origin_id);\n                if (!target_node) {\n                    return false;\n                }\n\n                const output = target_node.outputs[link_info.origin_slot];\n                if (!output || !output.links || output.links.length == 0) {\n                    return false;\n                }\n\n                // search in the inputs list for this link\n                for (var i = 0, l = output.links.length; i < l; i++) {\n                    if (output.links[i] == link_id) {\n                        output.links.splice(i, 1);\n                        break;\n                    }\n                }\n\n                delete this.graph.links[link_id]; // remove from the pool\n                if (this.graph) {\n                    this.graph._version++;\n                }\n                if (this.onConnectionsChange) {\n                    this.onConnectionsChange(\n                        LiteGraph.INPUT,\n                        slot,\n                        false,\n                        link_info,\n                        input,\n                    );\n                }\n                if (target_node.onConnectionsChange) {\n                    target_node.onConnectionsChange(\n                        LiteGraph.OUTPUT,\n                        i,\n                        false,\n                        link_info,\n                        output,\n                    );\n                }\n                if (this.graph && this.graph.onNodeConnectionChange) {\n                    this.graph.onNodeConnectionChange(\n                        LiteGraph.OUTPUT,\n                        target_node,\n                        i,\n                    );\n                    this.graph.onNodeConnectionChange(LiteGraph.INPUT, this, slot);\n                }\n            }\n        } // link != null\n\n        this.setDirtyCanvas(false, true);\n        if (this.graph) this.graph.connectionChange(this);\n        return true;\n    }\n\n    /**\n     * returns the center of a connection point in canvas coords\n     * @method getConnectionPos\n     * @param {boolean} is_input true if if a input slot, false if it is an output\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name\n     *     of the slot)\n     * @param {vec2} out [optional] a place to store the output, to free garbage\n     * @return {[x,y]} the position\n     * */\n    getConnectionPos(\n        is_input,\n        slot_number,\n        out,\n    ) {\n        out = out || new Float32Array(2);\n        let num_slots = 0;\n        if (is_input && this.inputs) {\n            num_slots = this.inputs.length;\n        }\n        if (!is_input && this.outputs) {\n            num_slots = this.outputs.length;\n        }\n\n        const offset = LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n\n        if (this.flags.collapsed) {\n            const w = this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH;\n            if (this.horizontal) {\n                out[0] = this.pos[0] + w * 0.5;\n                if (is_input) {\n                    out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT;\n                } else {\n                    out[1] = this.pos[1];\n                }\n            } else {\n                if (is_input) {\n                    out[0] = this.pos[0];\n                } else {\n                    out[0] = this.pos[0] + w;\n                }\n                out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            }\n            return out;\n        }\n\n        // weird feature that never got finished\n        if (is_input && slot_number == -1) {\n            out[0] = this.pos[0] + LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            out[1] = this.pos[1] + LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            return out;\n        }\n\n        // hard-coded pos\n        if (\n            is_input\n            && num_slots > slot_number\n            && this.inputs[slot_number].pos\n        ) {\n            out[0] = this.pos[0] + this.inputs[slot_number].pos[0];\n            out[1] = this.pos[1] + this.inputs[slot_number].pos[1];\n            return out;\n        }\n        if (\n            !is_input\n            && num_slots > slot_number\n            && this.outputs[slot_number].pos\n        ) {\n            out[0] = this.pos[0] + this.outputs[slot_number].pos[0];\n            out[1] = this.pos[1] + this.outputs[slot_number].pos[1];\n            return out;\n        }\n\n        // horizontal distributed slots\n        if (this.horizontal) {\n            out[0] = this.pos[0] + (slot_number + 0.5) * (this.size[0] / num_slots);\n            if (is_input) {\n                out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT;\n            } else {\n                out[1] = this.pos[1] + this.size[1];\n            }\n            return out;\n        }\n\n        // default vertical slots\n        if (is_input) {\n            out[0] = this.pos[0] + offset;\n        } else {\n            out[0] = this.pos[0] + this.size[0] + 1 - offset;\n        }\n        out[1] = this.pos[1]\n            + (slot_number + 0.7) * LiteGraph.NODE_SLOT_HEIGHT\n            + (this.constructor.slot_start_y || 0);\n        return out;\n    }\n\n    /* Force align to grid */\n    alignToGrid() {\n        this.pos[0] = LiteGraph.CANVAS_GRID_SIZE\n            * Math.round(this.pos[0] / LiteGraph.CANVAS_GRID_SIZE);\n        this.pos[1] = LiteGraph.CANVAS_GRID_SIZE\n            * Math.round(this.pos[1] / LiteGraph.CANVAS_GRID_SIZE);\n    }\n\n    /* Console output */\n    trace(msg) {\n        if (!this.console) {\n            this.console = [];\n        }\n\n        this.console.push(msg);\n        if (this.console.length > LGraphNode.MAX_CONSOLE) {\n            this.console.shift();\n        }\n\n        if (this.graph.onNodeTrace) this.graph.onNodeTrace(this, msg);\n    }\n\n    /* Forces to redraw or the main canvas (LGraphNode) or the bg canvas (links) */\n    setDirtyCanvas(\n        dirty_foreground,\n        dirty_background,\n    ) {\n        if (!this.graph) {\n            return;\n        }\n        this.graph.sendActionToCanvas(\"setDirty\", [\n            dirty_foreground,\n            dirty_background,\n        ]);\n    }\n\n    loadImage(url) {\n        const img = new Image();\n        img.src = LiteGraph.node_images_path + url;\n        img.ready = false;\n\n        img.onload = () => {\n            img.ready = true;\n            this.setDirtyCanvas(true);\n        };\n        return img;\n    }\n\n    // safe LGraphNode action execution (not sure if safe)\n    /*\n    executeAction = function(action)\n    {\n    if(action == \"\") return false;\n\n    if( action.indexOf(\";\") != -1 || action.indexOf(\"}\") != -1)\n    {\n    this.trace(\"Error: Action contains unsafe characters\");\n    return false;\n    }\n\n    var tokens = action.split(\"(\");\n    var func_name = tokens[0];\n    if( typeof(this[func_name]) != \"function\")\n    {\n    this.trace(\"Error: Action not found on node: \" + func_name);\n    return false;\n    }\n\n    var code = action;\n\n    try\n    {\n    var _foo = eval;\n    eval = null;\n    (new Function(\"with(this) { \" + code + \"}\")).call(this);\n    eval = _foo;\n    }\n    catch (err)\n    {\n    this.trace(\"Error executing action {\" + action + \"} :\" + err);\n    return false;\n    }\n\n    return true;\n    }\n    */\n\n    /* Allows to get onMouseMove and onMouseUp events even if the mouse is out of focus */\n    captureInput(v) {\n        if (!this.graph || !this.graph.list_of_graphcanvas) {\n            return;\n        }\n\n        const list = this.graph.list_of_graphcanvas;\n\n        for (let i = 0; i < list.length; ++i) {\n            const c = list[i];\n            // releasing somebody elses capture?!\n            if (!v && c.node_capturing_input != this) {\n                continue;\n            }\n\n            // change\n            c.node_capturing_input = v ? this : null;\n        }\n    }\n\n    /**\n     * Collapse the node to make it smaller on the canvas\n     * @method collapse\n     * */\n    collapse(force) {\n        this.graph._version++;\n        if (this.constructor.collapsable === false && !force) {\n            return;\n        }\n        this.flags.collapsed = !this.flags.collapsed;\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * Forces the node to do not move or realign on Z\n     * @method pin\n     * */\n\n    pin(v) {\n        this.graph._version++;\n        if (v === undefined) {\n            this.flags.pinned = !this.flags.pinned;\n        } else {\n            this.flags.pinned = v;\n        }\n    }\n\n    localToScreen(x, y, graphcanvas) {\n        return [\n            (x + this.pos[0]) * graphcanvas.scale + graphcanvas.offset[0],\n            (y + this.pos[1]) * graphcanvas.scale + graphcanvas.offset[1],\n        ];\n    }\n}\n","import LGraphNode from \"./LGraphNode\";\n\nexport default class LGraphGroup {\n    constructor(title) {\n        this._ctor(title);\n    }\n\n    _ctor(title) {\n        this.title = title || \"Group\";\n        this.font_size = 24;\n        this.color = LGraphCanvas.node_colors.pale_blue\n            ? LGraphCanvas.node_colors.pale_blue.groupcolor\n            : \"#AAA\";\n        this._bounding = new Float32Array([10, 10, 140, 80]);\n        this._pos = this._bounding.subarray(0, 2);\n        this._size = this._bounding.subarray(2, 4);\n        this._nodes = [];\n        this.graph = null;\n\n        Object.defineProperty(this, \"pos\", {\n            set(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._pos[0] = v[0];\n                this._pos[1] = v[1];\n            },\n            get() {\n                return this._pos;\n            },\n            enumerable: true,\n        });\n\n        Object.defineProperty(this, \"size\", {\n            set(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._size[0] = Math.max(140, v[0]);\n                this._size[1] = Math.max(80, v[1]);\n            },\n            get() {\n                return this._size;\n            },\n            enumerable: true,\n        });\n    }\n\n    recomputeInsideNodes() {\n        this._nodes.length = 0;\n        const nodes = this.graph._nodes;\n        const node_bounding = new Float32Array(4);\n\n        for (let i = 0; i < nodes.length; ++i) {\n            const node = nodes[i];\n            node.getBounding(node_bounding);\n            if (!overlapBounding(this._bounding, node_bounding)) {\n                continue;\n            } // out of the visible area\n            this._nodes.push(node);\n        }\n    }\n\n    move(deltax, deltay, ignore_nodes) {\n        this._pos[0] += deltax;\n        this._pos[1] += deltay;\n        if (ignore_nodes) {\n            return;\n        }\n        for (let i = 0; i < this._nodes.length; ++i) {\n            const node = this._nodes[i];\n            node.pos[0] += deltax;\n            node.pos[1] += deltay;\n        }\n    }\n\n    serialize() {\n        const b = this._bounding;\n        return {\n            title: this.title,\n            bounding: [\n                Math.round(b[0]),\n                Math.round(b[1]),\n                Math.round(b[2]),\n                Math.round(b[3]),\n            ],\n            color: this.color,\n            font: this.font,\n        };\n    }\n\n    configure(o) {\n        this.title = o.title;\n        this._bounding.set(o.bounding);\n        this.color = o.color;\n        this.font = o.font;\n    }\n\n    isPointInside = LGraphNode.prototype.isPointInside\n\n    setDirtyCanvas = LGraphNode.prototype.setDirtyCanvas\n}\n","// Creates an interface to access extra features from a graph (like play, stop, live, etc)\nimport LGraph from \"./LGraph\";\n\nexport default class Editor {\n    constructor(containerId, options) {\n        options = options || {};\n\n        // fill container\n        const html = \"<div class='content'><div class='editor-area'><canvas class='graphcanvas' width='1000' height='500' tabindex=10></canvas></div></div>\";\n\n        const root = document.createElement(\"div\");\n        this.root = root;\n        root.className = \"litegraph litegraph-editor\";\n        root.innerHTML = html;\n\n        this.content = root.querySelector(\".content\");\n        this.footer = root.querySelector(\".footer\");\n\n        const canvas = root.querySelector(\".graphcanvas\");\n\n        // create graph\n        const graph = (this.graph = new LGraph());\n        const graphcanvas = (this.graphcanvas = new LGraphCanvas(canvas, graph));\n        graphcanvas.background_image = \"imgs/grid.png\";\n        graph.onAfterExecute = function () {\n            graphcanvas.draw(true);\n        };\n\n        graphcanvas.onDropItem = this.onDropItem.bind(this);\n\n        if (options.miniwindow) {\n            this.addMiniWindow(300, 200);\n        }\n\n        // append to DOM\n        const parent = document.getElementById(containerId);\n        if (parent) {\n            parent.appendChild(root);\n        }\n\n        graphcanvas.resize();\n        // graphcanvas.draw(true,true);\n    }\n\n    onDropItem(e) {\n        for (const file of e.dataTransfer.files) {\n            const ext = LGraphCanvas.getFileExtension(file.name);\n            const reader = new FileReader();\n            if (ext === \"json\") {\n                reader.onload = (event) => {\n                    this.graph.configure(JSON.parse(event.target.result));\n                };\n                reader.readAsText(file);\n            }\n        }\n    }\n\n    addMiniWindow(w, h) {\n        const miniwindow = document.createElement(\"div\");\n        miniwindow.className = \"litegraph miniwindow\";\n        miniwindow.innerHTML = `<canvas class='graphcanvas' width='${\n            w\n        }' height='${\n            h\n        }' tabindex=10></canvas>`;\n        const canvas = miniwindow.querySelector(\"canvas\");\n        const that = this;\n\n        const graphcanvas = new LGraphCanvas(canvas, this.graph);\n        graphcanvas.show_info = false;\n        graphcanvas.background_image = \"imgs/grid.png\";\n        graphcanvas.scale = 0.25;\n        graphcanvas.allow_dragnodes = false;\n        graphcanvas.allow_interaction = false;\n        graphcanvas.render_shadows = false;\n        graphcanvas.max_zoom = 0.25;\n        this.miniwindow_graphcanvas = graphcanvas;\n        graphcanvas.onClear = function () {\n            graphcanvas.scale = 0.25;\n            graphcanvas.allow_dragnodes = false;\n            graphcanvas.allow_interaction = false;\n        };\n        graphcanvas.onRenderBackground = function (canvas, ctx) {\n            ctx.strokeStyle = \"#567\";\n            let tl = that.graphcanvas.convertOffsetToCanvas([0, 0]);\n            let br = that.graphcanvas.convertOffsetToCanvas([\n                that.graphcanvas.canvas.width,\n                that.graphcanvas.canvas.height,\n            ]);\n            tl = this.convertCanvasToOffset(tl);\n            br = this.convertCanvasToOffset(br);\n            ctx.lineWidth = 1;\n            ctx.strokeRect(\n                Math.floor(tl[0]) + 0.5,\n                Math.floor(tl[1]) + 0.5,\n                Math.floor(br[0] - tl[0]),\n                Math.floor(br[1] - tl[1]),\n            );\n        };\n\n        miniwindow.style.position = \"absolute\";\n        miniwindow.style.top = \"4px\";\n        miniwindow.style.right = \"4px\";\n\n        const close_button = document.createElement(\"div\");\n        close_button.className = \"corner-button\";\n        close_button.innerHTML = \"&#10060;\";\n        close_button.addEventListener(\"click\", (e) => {\n            graphcanvas.setGraph(null);\n            miniwindow.parentNode.removeChild(miniwindow);\n        });\n        miniwindow.appendChild(close_button);\n\n        this.root.querySelector(\".content\").appendChild(miniwindow);\n    }\n}\n"],"names":["LiteGraph","VERSION","CANVAS_GRID_SIZE","NODE_TITLE_HEIGHT","NODE_TITLE_TEXT_Y","NODE_SLOT_HEIGHT","NODE_WIDGET_HEIGHT","NODE_WIDTH","NODE_MIN_WIDTH","NODE_COLLAPSED_RADIUS","NODE_COLLAPSED_WIDTH","NODE_TITLE_COLOR","NODE_SELECTED_TITLE_COLOR","NODE_TEXT_SIZE","NODE_TEXT_COLOR","NODE_SUBTEXT_SIZE","NODE_DEFAULT_COLOR","NODE_DEFAULT_BGCOLOR","NODE_DEFAULT_BOXCOLOR","NODE_DEFAULT_SHAPE","NODE_BOX_OUTLINE_COLOR","DEFAULT_SHADOW_COLOR","DEFAULT_GROUP_FONT","WIDGET_BGCOLOR","WIDGET_OUTLINE_COLOR","WIDGET_TEXT_COLOR","WIDGET_SECONDARY_TEXT_COLOR","LINK_COLOR","EVENT_LINK_COLOR","CONNECTING_LINK_COLOR","MAX_NUMBER_OF_NODES","DEFAULT_POSITION","VALID_SHAPES","BOX_SHAPE","ROUND_SHAPE","CIRCLE_SHAPE","CARD_SHAPE","ARROW_SHAPE","INPUT","OUTPUT","EVENT","ACTION","ALWAYS","ON_EVENT","NEVER","ON_TRIGGER","UP","DOWN","LEFT","RIGHT","CENTER","STRAIGHT_LINK","LINEAR_LINK","SPLINE_LINK","NORMAL_TITLE","NO_TITLE","TRANSPARENT_TITLE","AUTOHIDE_TITLE","proxy","node_images_path","debug","catch_exceptions","throw_errors","allow_scripts","registered_node_types","node_types_by_file_extension","Nodes","Globals","searchbox_extras","auto_sort_node_types","registerNodeType","type","base_class","prototype","console","log","split","classname","name","pos","lastIndexOf","category","substr","title","i","LGraphNode","prev","Object","hasOwnProperty","defineProperty","set","v","_shape","get","enumerable","configurable","onPropertyChange","warn","supported_extensions","ext","constructor","String","toLowerCase","onNodeTypeRegistered","onNodeTypeReplaced","length","unregisterNodeType","wrapFunctionAsNode","func","param_types","return_type","properties","params","Array","code","names","getParameterNames","JSON","stringify","classobj","Function","pop","desc","onExecute","getInputData","r","apply","setOutputData","clearRegisteredTypes","addNodeMethod","createNode","options","node","err","error","properties_info","flags","size","computeSize","concat","mode","getNodeType","getNodeTypesInCategory","filter","push","sort","getNodeTypesCategories","categories","skip_list","result","reloadNodes","folder_wildcard","tmp","document","getElementsByTagName","script_files","docHeadObj","location","href","src","dynamicScript","createElement","appendChild","removeChild","cloneObject","obj","target","parse","isValidConnection","type_a","type_b","indexOf","supported_types_a","supported_types_b","j","registerSearchboxExtra","node_type","description","data","fetchFile","url","on_complete","on_error","fetch","then","response","ok","Error","arrayBuffer","text","json","blob","catch","File","Blob","reader","FileReader","onload","e","readAsArrayBuffer","readAsText","readAsBinaryString","performance","getTime","now","bind","Date","process","t","hrtime","DragAndScale","element","skip_events","offset","Float32Array","scale","max_scale","min_scale","onredraw","enabled","last_mouse","visible_area","bindEvents","_binded_mouse_callback","onMouse","addEventListener","computeVisibleArea","width","height","startx","starty","endx","endy","canvas","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","canvasx","canvasy","dragging","ignore","onmouse","removeEventListener","body","deltax","deltay","mouseDrag","eventType","wheel","deltaY","wheelDeltaY","detail","delta","wheelDelta","changeDeltaScale","preventDefault","stopPropagation","toCanvasContext","ctx","translate","convertOffsetToCanvas","convertCanvasToOffset","out","changeScale","value","zooming_center","center","Math","abs","new_center","delta_offset","reset","LGraphCanvas","graph","background_image","DEFAULT_BACKGROUND_IMAGE","querySelector","ds","zoom_modify_alpha","title_text_font","inner_text_font","node_title_color","default_link_color","default_connection_color","input_off","input_on","output_off","output_on","highquality_render","use_gradients","editor_alpha","pause_rendering","clear_background","read_only","render_only_selected","live_mode","show_info","allow_dragcanvas","allow_dragnodes","allow_interaction","allow_searchbox","allow_reconnect_links","drag_mode","dragging_rectangle","set_canvas_dirty_on_mouse_event","always_render_background","render_shadows","render_canvas_border","render_connections_shadows","render_connections_border","render_curved_connections","render_connection_arrows","render_collapsed_slots","render_execution_order","render_title_colored","render_link_tooltip","links_render_mode","mouse","graph_mouse","canvas_mouse","onSearchBox","onSearchBoxSelection","onDrawBackground","onDrawForeground","onDrawOverlay","onDrawLinkTooltip","onNodeMoved","onSelectionChange","onConnectingChange","onBeforeChange","onAfterChange","connections_width","round_radius","current_node","node_widget","over_link_center","last_mouse_position","visible_links","attachCanvas","setCanvas","clear","skip_render","startRendering","autoresize","link_type_colors","number","gradients","frame","last_draw_time","render_time","fps","selected_nodes","selected_group","visible_nodes","node_dragged","node_over","node_capturing_input","connecting_node","highlighted_links","dragging_canvas","dirty_canvas","dirty_bgcanvas","dirty_area","node_in_panel","last_mouseclick","onClear","setGraph","skip_clear","detachCanvas","_graph_stack","setDirty","getTopGraph","openSubgraph","checkPanels","closeSubgraph","subgraph_node","_subgraph_node","centerOnNode","selectNodes","getCurrentGraph","getElementById","unbindEvents","className","tabindex","bgcanvas","getContext","localName","webgl_enabled","enableWebGL","_mousemove_callback","processMouseMove","_mouseup_callback","processMouseUp","_doNothing","doNothing","_doReturnTrue","_events_binded","ref_window","getCanvasWindow","_mousedown_callback","processMouseDown","_mousewheel_callback","processMouseWheel","touchHandler","_key_callback","processKey","_ondrop_callback","processDrop","getFileExtension","question","point","GL","undefined","enableWebGLCanvas","gl","webgl","bgctx","fgcanvas","window","doc","ownerDocument","defaultView","parentWindow","is_rendering","renderFrame","call","draw","requestAnimationFrame","stopRendering","blockClick","block_click","adjustMouseEvent","active_canvas","that","getNodeOnPos","canvasX","canvasY","skip_action","is_double_click","localX","localY","last_click_position","focus","closeAllContextMenus","which","ctrlKey","clicking_canvas_bg","pinned","bringToFront","collapsed","resizable","isInsideRectangle","beforeChange","resizing_node","style","cursor","outputs","l","output","link_pos","getConnectionPos","connecting_output","connecting_pos","connecting_slot","shiftKey","disconnectOutput","onOutputDblClick","onOutputClick","inputs","input","onInputDblClick","onInputClick","link","link_info","links","disconnectInput","_nodes_by_id","origin_id","origin_slot","block_drag_node","widget","processNodeWidgets","id","onDblClick","processNodeDblClicked","onMouseDown","subgraph","skip_subgraph_button","setTimeout","processNodeSelected","_pos","showLinkMenu","getGroupOnPos","selected_group_resizing","dist","distance","recomputeInsideNodes","showSearchBox","processContextMenu","last_mouse_dragging","change","activeElement","nodeName","resize","move","_nodes","mouseOver","onMouseLeave","redraw_on_mouse","onMouseEnter","onMouseMove","_highlight_input","isOverNodeBox","slot","isOverNodeInput","slot_type","over_link","n","desired_size","min_size","max","setSize","click_time","diffx","round","diffy","nodes","node_bounding","deselectAllNodes","w","h","to_select","getBounding","overlapBounding","connect","getInputInfo","afterChange","collapse","config","align_to_grid","alignToGrid","onMouseUp","title_height","slot_pos","is_inside","horizontal","block_default","keyCode","metaKey","copyToClipboard","pasteFromClipboard","deleteSelectedNodes","onKeyDown","onKeyUp","stopImmediatePropagation","clipboard_info","index","selected_nodes_array","_relative_id","cloned","clone","serialize","target_node","getNodeById","target_slot","localStorage","setItem","getItem","node_data","configure","add","origin_node","onDropItem","event","checkDropItem","onDropFile","onDropData","files","dataTransfer","file","filename","readAsDataURL","nodetype","onShowNodePanel","showShowNodePanel","onNodeDblClicked","selectNode","onNodeSelected","add_to_current_selection","is_selected","onSelected","k","deselectNode","onDeselected","onNodeDeselected","block_delete","input_link","output_link","input_node","getInputNode","output_node","getOutputNodes","remove","b","deltaX","setZoom","convertEventToCanvasOffset","splice","sendToBack","unshift","temp","computeVisibleNodes","force_canvas","force_bgcanvas","_last_trigger_time","drawBackCanvas","drawFrontCanvas","start2D","restore","setTransform","save","beginPath","clip","clearRect","drawImage","onRender","renderInfo","drawNode","drawExecutionOrder","links_ontop","drawConnections","lineWidth","link_color","renderLink","dir","shape","arc","PI","fill","fillStyle","strokeStyle","strokeRect","drawLinkTooltip","visible_rect","drawSubgraphPanel","finish2D","subnode","num","floor","globalAlpha","roundRect","font","textAlign","fillText","drawButton","not_subgraph_input","input_node_type","newnode","setProperty","tw","measureText","showSubgraphPropertiesDialog","bgcolor","hovercolor","textcolor","hover","clicked","was_clicked","isAreaClicked","hold_click","globaltime","toFixed","iteration","_version","start","getTitle","bg_already_painted","onRenderBackground","imageSmoothingEnabled","mozImageSmoothingEnabled","_bg_img","Image","pattern","_pattern","createPattern","_pattern_img","fillRect","_groups","drawGroups","onBackgroundRender","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","finish","temp_vec2","color","low_quality","onDrawCollapsed","_collapsed_width","min","clip_area","has_errors","drawNodeShape","render_text","out_slot","max_y","color_on","color_off","moveTo","lineTo","closePath","label","stroke","widgets","widgets_y","widgets_up","widgets_start_y","drawNodeWidgets","input_slot","output_slot","Number","Boolean","toToolTip","info","tmp_area","fgcolor","selected","mouse_over","title_mode","render_title","area","old_alpha","onDrawTitleBar","title_color","grad","createLinearGradient","addColorStop","box_size","onDrawTitleBox","boxcolor","onDrawTitleText","title_text_color","over","onDrawTitle","onBounding","margin_area","link_bounding","tempA","tempB","link_id","start_node","start_node_slot","start_node_slotpos","end_node_slotpos","start_slot","end_slot","start_dir","end_dir","_last_time","f","a","skip_border","flow","num_sublines","lineJoin","offsety","start_offset_x","start_offset_y","end_offset_x","end_offset_y","bezierCurveTo","start_x","start_y","end_x","end_y","computeConnectionPoint","posA","posB","posC","posD","angleA","angleB","atan2","rotate","p0","p1","p2","p3","c1","c2","c3","c4","order","posY","active_widget","H","show_text","outline_color","background_color","text_color","secondary_text_color","margin","last_y","disabled","widget_width","on","off","range","nvalue","marker","marker_nvalue","precision","values","widget_height","old_value","callback","clamp","inner_value_change","step","values_list","keys","inner_clicked","option","text_values","ContextMenu","prompt","multiline","onWidgetChanged","property","groups","group","_bounding","_size","font_size","DEFAULT_GROUP_FONT_SIZE","adjustNodesSize","parent","parentNode","offsetWidth","offsetHeight","switchLiveMode","transition","self","setInterval","clearInterval","onNodeSelectionChange","touches","changedTouches","first","simulatedEvent","createEvent","initMouseEvent","screenX","screenY","dispatchEvent","onGroupAdd","entry","mouse_event","LGraphGroup","onMenuAdd","prev_menu","inner_onMenuAdded","base_category","startsWith","entries","map","base_category_regex","RegExp","category_name","replace","category_path","findIndex","content","has_submenu","mouseEvent","contextMenu","slice","first_event","getFirstEvent","parentMenu","onMenuCollapseAll","onMenuNodeEdit","showMenuNodeOptionalInputs","optional_inputs","onGetInputs","onMenuNodeInputs","addInput","setDirtyCanvas","showMenuNodeOptionalOutputs","optional_outputs","onGetOutputs","skip_repeated_outputs","findOutputSlot","onMenuNodeOutputs","addOutput","onShowMenuNodeProperties","getPropertyInfo","getPropertyPrintableValue","decodeHTML","allow_html","showEditPropertyValue","position","str","innerText","innerHTML","onResizeNode","menu","onResize","node_left","node_right","target_id","removeLink","onShowPropertyEditor","item","dialog","inner","graphcanvas","offsetx","button","setValue","modified","close","prompt_box","transform","name_element","value_element","search_limit","root_document","search_box","overflow","timeout_close","clearTimeout","helper","timeout","changeSelection","select","refreshHelper","fullscreenElement","layerY","maxHeight","extra","addProperty","forward","classList","childNodes","nextSibling","previousSibling","scrollIntoView","block","behavior","list","addResult","inner_test_filter","ctor","c","filtered","help","dataset","escape","unescape","input_html","createDialog","checked","onPropertyChanged","onclose","html","createPanel","root","header","closable","title_element","footer","addHTML","on_footer","elem","addButton","addSeparator","addWidget","str_value","propname","toggle","innerChange","setAttribute","blur","proptype","elem_that","desc_value","SELECTED_NODE","panel","inner_refresh","onAddPropertyToPanel","onShowCustomPanelInfo","old_panel","removeInput","findInputSlot","panels","querySelectorAll","onMenuNodeCollapse","onMenuNodePin","pin","onMenuNodeMode","onMenuNodeColors","node_colors","groupcolor","onMenuNodeShapes","onMenuNodeRemove","removable","onMenuNodeToSubgraph","nodes_list","buildFromNodes","onMenuNodeClone","clonable","red","brown","green","blue","pale_blue","cyan","purple","yellow","black","getCanvasMenuOptions","getMenuOptions","getExtraMenuOptions","getNodeMenuOptions","onGetNodeMenuOptions","getGroupMenuOptions","o","menu_info","inner_option_clicked","getSlotInPosition","active_node","getSlotMenuOptions","_slot","locked","nameLocked","submenu","removeOutput","slot_info","getOutputInfo","CanvasRenderingContext2D","radius","radius_low","quadraticCurveTo","compareObjects","sqrt","colorToString","growBounding","bounding","isInsideBounding","p","bb","A_end_x","A_end_y","B_end_x","B_end_y","hex2num","hex","charAt","toUpperCase","hex_alphabets","int1","int2","num2hex","triplet","lock","current_submenu","eventClass","minWidth","minHeight","pointerEvents","on_mouse_wheel","parseInt","scroll_speed","addItem","closing_timer","body_rect","root_rect","onclick_callback","inner_onclick","autoopen","inner_over","close_parent","ignore_item_callbacks","ignore_parent_menu","isCursorOverElement","trigger","event_name","origin","evt","initCustomEvent","srcElement","__events","getTopMenu","elements","extendClass","__lookupGetter__","__defineGetter__","__lookupSetter__","__defineSetter__","CurveEditor","points","nearest","must_update","sampleCurve","pn","local_f","line_color","inactive","localpos","max_dist","getCloserPoint","s","curvepos","_nearest","is_edge_point","min_dist","closest","last_valid","vec2","webkitRequestAnimationFrame","mozRequestAnimationFrame","LGraph","list_of_graphcanvas","supportedTypes","stop","status","STATUS_STOPPED","last_node_id","last_link_id","onRemoved","_nodes_in_order","_nodes_executable","vars","runningtime","fixedtime","fixedtime_lapse","elapsed_time","last_update_time","starttime","catch_errors","sendActionToCanvas","interval","STATUS_RUNNING","onPlayEvent","sendEventToAllNodes","onFrame","execution_timer_id","onBeforeStep","runStep","onAfterStep","onStopEvent","doNotCatchError","limit","onExecuteStep","onAfterExecute","errors_in_execution","elapsed","execution_time","computeExecutionOrder","onlyOnExecute","setLevel","L","S","M","visitedLinks","remainingLinks","l2","_level","shift","linkId","targetNode","A","B","Ap","priority","Bp","ancestors","pending","visited","current","columns","col","column","maxSize","eventname","Subgraph","action","skipComputeOrder","onAdded","updateExecutionOrder","onNodeAdded","ignore_remove","onNodeRemoved","classObject","nodesList","isPointInside","g","param","_input_nodes","findNodesByClass","GraphInput","onAction","onTrigger","onInputAdded","onInputsOutputsChange","oldName","newName","onInputRenamed","onInputTypeChanged","onInputRemoved","onOutputAdded","onOutputRenamed","onOutputTypeChanged","onOutputRemoved","findNodesByTitle","setTrigger","onConnectionChange","linkInfo","on_change","fg","bg","nodesInfo","link2","LLink","groupsInfo","version","onSerialize","keepOld","linkData","nInfo","last_serialization","dataGroup","onConfigure","req","XMLHttpRequest","open","send","onerror","msg","_data","_ctor","connections","onConnectionsChange","widgets_values","serialize_widgets","prevValue","output_info","force_update","updateOutputData","slot_name","input_info","triggerSlot","target_connection","default_value","extra_info","array","direction","rows","title_width","compute_text_size","input_width","output_width","text_width","slot_start_y","widgets_height","min_height","widgets_info","onGetPropertyInfo","custom_widget","skip_title","margin_top","isLive","changed","onConnectInput","connectionChange","onNodeConnectionChange","is_input","slot_number","num_slots","MAX_CONSOLE","onNodeTrace","dirty_foreground","dirty_background","img","ready","force","collapsable","subarray","ignore_nodes","Editor","containerId","miniwindow","addMiniWindow","max_zoom","miniwindow_graphcanvas","tl","br","right","close_button"],"mappings":"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"}