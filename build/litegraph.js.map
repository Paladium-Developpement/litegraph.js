{"version":3,"file":"litegraph.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/utils/defaultConfig.js","../src/utils/time.js","../src/utils/object.js","../src/utils/registry.js","../src/utils/function.js","../src/LLink.js","../src/utils/math.js","../src/LGraphNode.js","../src/LGraphGroup.js","../src/DragAndScale.js","../src/utils/file.js","../src/ContextMenu.js","../src/LGraphCanvas.js","../src/LGraph.js","../src/CurveEditor.js","../src/litegraph-editor.js","../src/index.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","export default {\n    VERSION: 0.4,\n\n    CANVAS_GRID_SIZE: 10,\n\n    NODE_TITLE_HEIGHT: 30,\n    NODE_TITLE_TEXT_Y: 20,\n    NODE_SLOT_HEIGHT: 20,\n    NODE_WIDGET_HEIGHT: 20,\n    NODE_WIDTH: 140,\n    NODE_MIN_WIDTH: 50,\n    NODE_COLLAPSED_RADIUS: 10,\n    NODE_COLLAPSED_WIDTH: 80,\n    NODE_TITLE_COLOR: \"#999\",\n    NODE_SELECTED_TITLE_COLOR: \"#FFF\",\n    NODE_TEXT_SIZE: 14,\n    NODE_TEXT_COLOR: \"#AAA\",\n    NODE_SUBTEXT_SIZE: 12,\n    NODE_DEFAULT_COLOR: \"#333\",\n    NODE_DEFAULT_BGCOLOR: \"#353535\",\n    NODE_DEFAULT_BOXCOLOR: \"#666\",\n    NODE_DEFAULT_SHAPE: \"box\",\n    NODE_BOX_OUTLINE_COLOR: \"#FFF\",\n    DEFAULT_SHADOW_COLOR: \"rgba(0,0,0,0.5)\",\n    DEFAULT_GROUP_FONT: 24,\n\n    WIDGET_BGCOLOR: \"#222\",\n    WIDGET_OUTLINE_COLOR: \"#666\",\n    WIDGET_TEXT_COLOR: \"#DDD\",\n    WIDGET_SECONDARY_TEXT_COLOR: \"#999\",\n\n    LINK_COLOR: \"#9A9\",\n    EVENT_LINK_COLOR: \"#A86\",\n    CONNECTING_LINK_COLOR: \"#AFA\",\n\n    MAX_NUMBER_OF_NODES: 1000, // avoid infinite loops\n    DEFAULT_POSITION: [100, 100], // default node position\n    VALID_SHAPES: [\"default\", \"box\", \"round\", \"card\"], // ,\"circle\"\n\n    // shapes are used for nodes but also for slots\n    BOX_SHAPE: 1,\n    ROUND_SHAPE: 2,\n    CIRCLE_SHAPE: 3,\n    CARD_SHAPE: 4,\n    ARROW_SHAPE: 5,\n\n    // enums\n    INPUT: 1,\n    OUTPUT: 2,\n\n    EVENT: -1, // for outputs\n    ACTION: -1, // for inputs\n\n    ALWAYS: 0,\n    ON_EVENT: 1,\n    NEVER: 2,\n    ON_TRIGGER: 3,\n\n    UP: 1,\n    DOWN: 2,\n    LEFT: 3,\n    RIGHT: 4,\n    CENTER: 5,\n\n    STRAIGHT_LINK: 0,\n    LINEAR_LINK: 1,\n    SPLINE_LINK: 2,\n\n    NORMAL_TITLE: 0,\n    NO_TITLE: 1,\n    TRANSPARENT_TITLE: 2,\n    AUTOHIDE_TITLE: 3,\n\n    proxy: null, // used to redirect calls\n    node_images_path: \"\",\n\n    debug: true,\n    catch_exceptions: true,\n    throw_errors: true,\n    allow_scripts: false,\n    // if set to true some nodes like Formula would be allowed\n    // to evaluate code that comes from unsafe sources\n    // (like node configuration), which could lead to exploits\n    registered_node_types: {}, // nodetypes by string\n    node_types_by_file_extension: {}, // used for dropping files in the canvas\n    Nodes: {}, // node types by classname\n    Globals: {}, // used to store vars between graphs\n\n    searchbox_extras: {}, // used to add extra features to the search box\n    auto_sort_node_types: false,\n    // If set to true, will automatically sort node types / categories in the context menus\n};\n","/**\n * @module Time Utils\n */\n\nexport default function getTime() {\n    if (typeof performance !== \"undefined\") return performance.now();\n    if (typeof Date !== \"undefined\" && typeof Date.now !== \"undefined\") return Date.now;\n    if (typeof process !== \"undefined\") {\n        const t = process.hrtime();\n        return t[0] * 0.001 + t[1] * 1e-6;\n    }\n    return new Date().getTime();\n}\n","/**\n * @module Object Utils\n */\n\n// separated just to improve if it doesn't work\nexport default function cloneObject(obj, target) {\n    if (obj == null) return null;\n    const r = JSON.parse(JSON.stringify(obj));\n    if (!target) return r;\n\n    // eslint-disable-next-line guard-for-in,no-restricted-syntax\n    for (const i in r) target[i] = r[i];\n    return target;\n}\n","/**\n * @module Registry Manager\n */\n\n/**\n * removes a node type from the system\n * @method unregisterNodeType\n * @param {String|Object} type name of the node or the node constructor itself\n */\nimport defaultConfig from \"./defaultConfig\";\n\nexport function unregisterNodeType(type) {\n    const baseClass = type.constructor === String ? defaultConfig.registered_node_types[type] : type;\n    if (!baseClass) throw new Error(`node type not found: ${type}`);\n    delete defaultConfig.registered_node_types[baseClass.type];\n    if (baseClass.constructor.name) delete defaultConfig.Nodes[baseClass.constructor.name];\n}\n\n/**\n * Register a node class so it can be listed when the user wants to create a new one\n * @method registerNodeType\n * @param {LGraphNode} type name of the node and path\n * @param {Class} baseClass class containing the structure of a node\n */\nexport function registerNodeType(type, baseClass) {\n    if (!baseClass.prototype) {\n        throw new TypeError(\"Cannot register a simple object, it must be a class with a prototype\");\n    }\n    baseClass.type = type;\n\n    if (defaultConfig.debug) {\n        console.log(`Node registered: ${type}`);\n    }\n\n    const classname = baseClass.name;\n\n    const pos = type.lastIndexOf(\"/\");\n    baseClass.category = type.substr(0, pos);\n\n    if (!baseClass.title) {\n        baseClass.title = classname;\n    }\n\n    // info.name = name.substr(pos+1,name.length - pos);\n\n    const prev = defaultConfig.registered_node_types[type];\n    if (prev) {\n        console.log(`replacing node type: ${type}`);\n    } else {\n        if (!Object.hasOwnProperty.call(baseClass.prototype, \"shape\")) {\n            Object.defineProperty(baseClass.prototype, \"shape\", {\n                set(v) {\n                    switch (v) {\n                        case \"default\":\n                            delete this._shape;\n                            break;\n                        case \"box\":\n                            this._shape = defaultConfig.BOX_SHAPE;\n                            break;\n                        case \"round\":\n                            this._shape = defaultConfig.ROUND_SHAPE;\n                            break;\n                        case \"circle\":\n                            this._shape = defaultConfig.CIRCLE_SHAPE;\n                            break;\n                        case \"card\":\n                            this._shape = defaultConfig.CARD_SHAPE;\n                            break;\n                        default:\n                            this._shape = v;\n                    }\n                },\n                get() {\n                    return this._shape;\n                },\n                enumerable: true,\n                configurable: true,\n            });\n        }\n\n        // warnings\n        if (baseClass.prototype.onPropertyChange) {\n            console.warn(\n                `LiteGraph node class ${\n                    type\n                } has onPropertyChange method, it must be called onPropertyChanged with d at the end`,\n            );\n        }\n\n        // used to know which nodes create when dragging files to the canvas\n        if (baseClass.supported_extensions) {\n            for (const ext of baseClass.supported_extensions) {\n                if (ext && ext.constructor === String) {\n                    defaultConfig.node_types_by_file_extension[ext.toLowerCase()] = baseClass;\n                }\n            }\n        }\n    }\n\n    defaultConfig.registered_node_types[type] = baseClass;\n    if (baseClass.constructor.name) defaultConfig.Nodes[classname] = baseClass;\n\n    if (defaultConfig.onNodeTypeRegistered) defaultConfig.onNodeTypeRegistered(type, baseClass);\n    if (prev && defaultConfig.onNodeTypeReplaced) {\n        defaultConfig.onNodeTypeReplaced(type, baseClass, prev);\n    }\n\n    // warnings\n    if (baseClass.prototype.onPropertyChange) {\n        console.warn(\n            `LiteGraph node class ${\n                type\n            } has onPropertyChange method, it must be called onPropertyChanged with d at the end`,\n        );\n    }\n\n    // used to know which nodes create when dragging files to the canvas\n    if (baseClass.supported_extensions) {\n        for (const ext of baseClass.supported_extensions) {\n            if (ext && ext.constructor === String) {\n                defaultConfig.node_types_by_file_extension[ext.toLowerCase()] = baseClass;\n            }\n        }\n    }\n}\n\n/**\n * Removes all previously registered node's types\n */\nexport function clearRegisteredTypes() {\n    defaultConfig.registered_node_types = {};\n    defaultConfig.node_types_by_file_extension = {};\n    defaultConfig.Nodes = {};\n    defaultConfig.searchbox_extras = {};\n}\n\n/**\n * Returns a registered node type with a given name\n * @method getNodeType\n * @param {String} type full name of the node class. p.e. \"math/sin\"\n * @return {Class} the node class\n */\nexport function getNodeType(type) {\n    return defaultConfig.registered_node_types[type];\n}\n\n/**\n * Returns a list of node types matching one category\n * @method getNodeType\n * @param {String} category category name\n * @return {Array} array with all the node classes\n */\nexport function getNodeTypesInCategory(category, filter) {\n    const r = [];\n    // eslint-disable-next-line\n    for (const i in defaultConfig.registered_node_types) {\n        const type = defaultConfig.registered_node_types[i];\n        if (type.filter !== filter) continue;\n\n        if (category === \"\") {\n            if (!type.category) r.push(type);\n        } else if (type.category === category) {\n            r.push(type);\n        }\n    }\n\n    return defaultConfig.auto_sort_node_types ? r.sort() : r;\n}\n\n/**\n * Register a string in the search box so when the user types it it will recommend this node\n * @method registerSearchboxExtra\n * @param {String} nodeType the node recommended\n * @param {String} description text to show next to it\n * @param {Object} data it could contain info of how the node should be configured\n * @return {Boolean} true if they can be connected\n */\nexport function registerSearchboxExtra(nodeType, description, data) {\n    defaultConfig.searchbox_extras[description.toLowerCase()] = {\n        type: nodeType,\n        desc: description,\n        data,\n    };\n}\n/**\n * Returns a list with all the node type categories\n * @method getNodeTypesCategories\n * @param {String} filter only nodes with ctor.filter equal can be shown\n * @return {Array} array with all the names of the categories\n */\nexport function getNodeTypesCategories(filter) {\n    const categories = { \"\": 1 };\n    // eslint-disable-next-line\n    for (const id in defaultConfig.registered_node_types) {\n        const type = defaultConfig.registered_node_types[id];\n        if (type.category && !type.skip_list) {\n            if (type.filter !== filter) continue;\n            categories[type.category] = 1;\n        }\n    }\n    const result = [];\n    // eslint-disable-next-line\n    for (const i in categories) result.push(i);\n    return defaultConfig.auto_sort_node_types ? result.sort() : result;\n}\n","/**\n * @module Function Utils\n */\nimport defaultConfig from \"./defaultConfig\";\nimport { registerNodeType } from \"./registry\";\n\n// used to create nodes from wrapping function\nexport function getParameterNames(func) {\n    return (`${func}`)\n        .replace(/[/][/].*$/gm, \"\") // strip single-line comments\n        .replace(/\\s+/g, \"\") // strip white space\n        .replace(/[/][*][^/*]*[*][/]/g, \"\") // strip multi-line comments  /**/\n        .split(\"){\", 1)[0]\n        .replace(/^[^(]*[(]/, \"\") // extract the parameters\n        .replace(/=[^,]+/g, \"\") // strip any ES6 defaults\n        .split(\",\")\n        .filter(Boolean); // split & filter [\"\"]\n}\n\n/**\n * Create a new nodetype by passing a function, it wraps it with a proper class and\n * generates inputs according to the parameters of the function. Useful to wrap simple\n * methods that do not require properties, and that only process some input to generate an\n * output.\n * @method wrapFunctionAsNode\n * @param {String} name node name with namespace (p.e.: 'math/sum')\n * @param {Function} func\n * @param {Array} paramType [optional] an array containing the type of every parameter,\n *     otherwise parameters will accept any type\n * @param {String} returnType [optional] string with the return type, otherwise it will be\n *     generic\n * @param {Object} properties [optional] properties to be configurable\n */\nexport function wrapFunctionAsNode(\n    name,\n    func,\n    paramType,\n    returnType,\n    properties,\n) {\n    const params = Array(func.length);\n    let code = \"\";\n    const names = getParameterNames(func);\n    for (let i = 0; i < names.length; ++i) {\n        code += `this.addInput('${names[i]}',${paramType && paramType[i] ? `'${paramType[i]}'` : \"0\"});\\n`;\n    }\n    code += `this.addOutput('out',${returnType ? `'${returnType}'` : 0});\\n`;\n    if (properties) code += `this.properties = ${JSON.stringify(properties)};\\n`;\n    const classobj = Function(\"code\");\n    classobj.title = name.split(\"/\").pop();\n    classobj.desc = `Generated from ${func.name}`;\n    classobj.prototype.onExecute = function onExecute() {\n        for (let i = 0; i < params.length; ++i) {\n            params[i] = this.getInputData(i);\n        }\n        const r = func.apply(this, params);\n        this.setOutputData(0, r);\n    };\n    registerNodeType(name, classobj);\n}\n/**\n * Returns if the types of two slots are compatible (taking into account wildcards, etc)\n * @method isValidConnection\n * @param {String} typeA\n * @param {String} typeB\n * @return {Boolean} true if they can be connected\n */\nexport function isValidConnection(typeA, typeB) {\n    if (\n        !typeA\n        || !typeB\n        || typeA === typeB\n        || (typeA === defaultConfig.EVENT && typeB === defaultConfig.ACTION)\n    ) {\n        return true;\n    }\n\n    // Enforce string type to handle toLowerCase call (-1 number not ok)\n    typeA = String(typeA);\n    typeB = String(typeB);\n    typeA = typeA.toLowerCase();\n    typeB = typeB.toLowerCase();\n\n    // For nodes supporting multiple connection types\n    if (typeA.indexOf(\",\") === -1 && typeB.indexOf(\",\") === -1) return typeA === typeB;\n\n    // Check all permutations to see if one is valid\n    const supportedTypesA = typeA.split(\",\");\n    const supportedTypesB = typeB.split(\",\");\n    for (let i = 0; i < supportedTypesA.length; ++i) {\n        for (let j = 0; j < supportedTypesB.length; ++j) {\n            if (supportedTypesA[i] === supportedTypesB[j]) {\n                return true;\n            }\n        }\n    }\n\n    return false;\n}\n","/**\n * @class LLink\n * @param id\n * @param type\n * @param origin_id\n * @param origin_slot\n * @param target_id\n * @param target_slot\n */\nexport default class LLink {\n    constructor(id, type, origin_id, origin_slot, target_id, target_slot) {\n        this.id = id;\n        this.type = type;\n        this.origin_id = origin_id;\n        this.origin_slot = origin_slot;\n        this.target_id = target_id;\n        this.target_slot = target_slot;\n\n        this._data = null;\n        this._pos = new Float32Array(2); // center\n    }\n\n    configure(o) {\n        if (o.constructor === Array) {\n            this.id = o[0];\n            this.origin_id = o[1];\n            this.origin_slot = o[2];\n            this.target_id = o[3];\n            this.target_slot = o[4];\n            this.type = o[5];\n        } else {\n            this.id = o.id;\n            this.type = o.type;\n            this.origin_id = o.origin_id;\n            this.origin_slot = o.origin_slot;\n            this.target_id = o.target_id;\n            this.target_slot = o.target_slot;\n        }\n    }\n\n    serialize() {\n        return [\n            this.id,\n            this.origin_id,\n            this.origin_slot,\n            this.target_id,\n            this.target_slot,\n            this.type,\n        ];\n    }\n}\n","/**\n * @module Math Utils\n */\n\nexport function distance(a, b) {\n    return Math.sqrt(\n        (b[0] - a[0]) * (b[0] - a[0]) + (b[1] - a[1]) * (b[1] - a[1]),\n    );\n}\n\nexport function isInsideRectangle(x, y, left, top, width, height) {\n    return left < x && left + width > x && top < y && top + height > y;\n}\n\n// bounding overlap, format: [ startx, starty, width, height ]\nexport function overlapBounding(a, b) {\n    const AEndX = a[0] + a[2];\n    const AEndY = a[1] + a[3];\n    const BEndX = b[0] + b[2];\n    const BEndY = b[1] + b[3];\n\n    return !(a[0] > BEndX\n        || a[1] > BEndY\n        || AEndX < b[0]\n        || AEndY < b[1]);\n}\n\nexport function clamp(v, a, b) {\n    // eslint-disable-next-line no-nested-ternary\n    return a > v ? a : b < v ? b : v;\n}\n","import defaultConfig from \"./utils/defaultConfig\";\nimport cloneObject from \"./utils/object\";\nimport getTime from \"./utils/time\";\nimport { isValidConnection } from \"./utils/function\";\nimport LLink from \"./LLink\";\nimport { isInsideRectangle } from \"./utils/math\";\n\n/*\ntitle: string\npos: [x,y]\nsize: [x,y]\n\ninput|output: every connection\n+  { name:string, type:string, pos: [x,y]=Optional, direction: \"input\"|\"output\", links: Array });\n\ngeneral properties:\n+ clip_area: if you render outside the node, it will be clipped\n+ unsafe_execution: not allowed for safe execution\n+ skip_repeated_outputs: when adding new outputs, it wont show if there is one already connected\n+ resizable: if set to false it wont be resizable with the mouse\n+ horizontal: slots are distributed horizontally\n+ widgets_start_y: widgets start at y distance from the top of the node\n\nflags object:\n+ collapsed: if it is collapsed\n\nsupported callbacks:\n+ onAdded: when added to graph (warning: this is called BEFORE the node is configured when loading)\n+ onRemoved: when removed from graph\n+ onStart:\twhen the graph starts playing\n+ onStop:\twhen the graph stops playing\n+ onDrawForeground: render the inside widgets inside the node\n+ onDrawBackground: render the background area inside the node (only in edit mode)\n+ onMouseDown\n+ onMouseMove\n+ onMouseUp\n+ onMouseEnter\n+ onMouseLeave\n+ onExecute: execute the node\n+ onPropertyChanged: when a property is changed in the panel (return true to skip default behaviour)\n+ onGetInputs: returns an array of possible inputs\n+ onGetOutputs: returns an array of possible outputs\n+ onBounding: in case this node has a bigger bounding than the node itself (the callback receives the bounding as [x,y,w,h])\n+ onDblClick: double clicked in the node\n+ onInputDblClick: input slot double clicked (can be used to automatically create a node connected)\n+ onOutputDblClick: output slot double clicked (can be used to automatically create a node connected)\n+ onConfigure: called after the node has been configured\n+ onSerialize: to add extra info when serializing (the callback receives the object that should be filled with the data)\n+ onSelected\n+ onDeselected\n+ onDropItem : DOM item dropped over the node\n+ onDropFile : file dropped over the node\n+ onConnectInput : if returns false the incoming connection will be canceled\n+ onConnectionsChange : a connection changed (new one or removed) (LiteGraph.INPUT or LiteGraph.OUTPUT, slot, true if connected, link_info, input_info )\n+ onAction: action slot triggered\n+ getExtraMenuOptions: to add option to context menu\n*/\n\n/**\n * Base Class for all the node type classes\n * @class LGraphNode\n * @param {String} title a name for the node\n */\nexport default class LGraphNode {\n    constructor(title) {\n        this.title = title || \"Unnamed\";\n        this.size = [defaultConfig.NODE_WIDTH, 60];\n        this.graph = null;\n        this.id = -1; // not know till not added\n        this.type = null;\n        // inputs available: array of inputs\n        this.inputs = [];\n        this.outputs = [];\n        this.connections = [];\n\n        // local data\n        this.properties = {}; // for the values\n        this.properties_info = []; // for the info\n\n        this.flags = {};\n    }\n\n    /**\n     * Internal position array\n     * @internal\n     * @type {Float32Array}\n     * @private\n     * @memberOf LGraphNode\n     */\n    _pos = new Float32Array(10, 10)\n\n    set pos(v) {\n        if (!v || v.length < 2) {\n            return;\n        }\n        this._pos[0] = v[0];\n        this._pos[1] = v[1];\n    }\n\n    get pos() {\n        return this._pos;\n    }\n\n    /**\n     * configure a node from an object containing the serialized info\n     * @method configure\n     * @memberOf LGraphNode\n     */\n    configure(info) {\n        if (this.graph) {\n            this.graph._version++;\n        }\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const j in info) {\n            if (j === \"properties\") {\n                // i don't want to clone properties, I want to reuse the old container\n                // eslint-disable-next-line guard-for-in,no-restricted-syntax\n                for (const k in info.properties) {\n                    this.properties[k] = info.properties[k];\n                    if (this.onPropertyChanged) {\n                        this.onPropertyChanged(k, info.properties[k]);\n                    }\n                }\n                continue;\n            }\n\n            if (info[j] == null) {\n                continue;\n            } else if (typeof info[j] === \"object\") {\n                // object\n                if (this[j] && this[j].configure) {\n                    this[j].configure(info[j]);\n                } else {\n                    this[j] = cloneObject(info[j], this[j]);\n                }\n            } else {\n                this[j] = info[j];\n            }\n        }\n\n        if (!info.title) {\n            this.title = this.constructor.title;\n        }\n\n        if (this.onConnectionsChange) {\n            if (this.inputs) {\n                for (let i = 0; i < this.inputs.length; ++i) {\n                    const input = this.inputs[i];\n                    const linkInfo = this.graph\n                        ? this.graph.links[input.link]\n                        : null;\n                    this.onConnectionsChange(\n                        defaultConfig.INPUT,\n                        i,\n                        true,\n                        linkInfo,\n                        input,\n                    ); // linkInfo has been created now, so its updated\n                }\n            }\n\n            if (this.outputs) {\n                for (let i = 0; i < this.outputs.length; ++i) {\n                    const output = this.outputs[i];\n                    if (!output.links) {\n                        continue;\n                    }\n                    for (let j = 0; j < output.links.length; ++j) {\n                        const linkInfo = this.graph\n                            ? this.graph.links[output.links[j]]\n                            : null;\n                        this.onConnectionsChange(\n                            defaultConfig.OUTPUT,\n                            i,\n                            true,\n                            linkInfo,\n                            output,\n                        ); // link_info has been created now, so its updated\n                    }\n                }\n            }\n        }\n\n        if (this.widgets) {\n            for (const widget of this.widgets) {\n                if (!widget) continue;\n                if (widget.options\n                    && widget.options.property\n                    // eslint-disable-next-line max-len\n                    && this.properties[widget.options.property]) widget.value = JSON.parse(JSON.stringify(this.properties[widget.options.property]));\n            }\n            if (info.widgets_values) {\n                for (let i = 0; i < info.widgets_values.length; ++i) {\n                    if (this.widgets[i]) {\n                        this.widgets[i].value = info.widgets_values[i];\n                    }\n                }\n            }\n        }\n\n        if (this.onConfigure) {\n            this.onConfigure(info);\n        }\n    }\n\n    /**\n     * serialize the content\n     * @method serialize\n     * @memberOf LGraphNode\n     */\n\n    serialize() {\n        // create serialization object\n        const o = {\n            id: this.id,\n            type: this.type,\n            pos: this.pos,\n            size: this.size,\n            flags: cloneObject(this.flags),\n            order: this.order,\n            mode: this.mode,\n        };\n\n        // special case for when there were errors\n        if (this.constructor === LGraphNode && this.last_serialization) {\n            return this.last_serialization;\n        }\n\n        if (this.inputs) {\n            o.inputs = this.inputs;\n        }\n\n        if (this.outputs) {\n            // clear outputs last data (because data in connections is never serialized but stored\n            // inside the outputs info)\n            for (let i = 0; i < this.outputs.length; i++) {\n                delete this.outputs[i]._data;\n            }\n            o.outputs = this.outputs;\n        }\n\n        if (this.title && this.title != this.constructor.title) {\n            o.title = this.title;\n        }\n\n        if (this.properties) {\n            o.properties = cloneObject(this.properties);\n        }\n\n        if (this.widgets && this.serialize_widgets) {\n            o.widgets_values = [];\n            for (let i = 0; i < this.widgets.length; ++i) {\n                if (this.widgets[i]) {\n                    o.widgets_values[i] = this.widgets[i].value;\n                } else {\n                    o.widgets_values[i] = null;\n                }\n            }\n        }\n\n        if (!o.type) o.type = this.constructor.type;\n\n        if (this.color) o.color = this.color;\n        if (this.bgcolor) o.bgcolor = this.bgcolor;\n        if (this.boxcolor) o.boxcolor = this.boxcolor;\n        if (this.shape) o.shape = this.shape;\n\n        if (this.onSerialize) {\n            if (this.onSerialize(o)) {\n                console.warn(\n                    \"node onSerialize shouldnt return anything, data should be stored in the object pass in the first parameter\",\n                );\n            }\n        }\n\n        return o;\n    }\n\n    /* Creates a clone of this node */\n    clone() {\n        const node = LGraphNode.createNode(this.type);\n        if (!node) {\n            return null;\n        }\n\n        // we clone it because serialize returns shared containers\n        const data = LGraphNode.cloneObject(this.serialize());\n\n        // remove links\n        if (data.inputs) {\n            for (let i = 0; i < data.inputs.length; ++i) {\n                data.inputs[i].link = null;\n            }\n        }\n\n        if (data.outputs) {\n            for (let i = 0; i < data.outputs.length; ++i) {\n                if (data.outputs[i].links) {\n                    data.outputs[i].links.length = 0;\n                }\n            }\n        }\n\n        delete data.id;\n        // remove links\n        node.configure(data);\n\n        return node;\n    }\n\n    /**\n     * serialize and stringify\n     * @method toString\n     * @memberOf LGraphNode\n     */\n\n    toString() {\n        return JSON.stringify(this.serialize());\n    }\n\n    // deserialize = function(info) {} //this cannot be done from within, must\n    // be done in LiteGraph\n\n    /**\n     * get the title string\n     * @method getTitle\n     * @memberOf LGraphNode\n     */\n\n    getTitle() {\n        return this.title || this.constructor.title;\n    }\n\n    /**\n     * sets the value of a property\n     * @method setProperty\n     * @param {String} name\n     * @param {*} value\n     * @memberOf LGraphNode\n     */\n    setProperty(name, value) {\n        if (!this.properties) {\n            this.properties = {};\n        }\n        if (value === this.properties[name]) return;\n        const prevValue = this.properties[name];\n        this.properties[name] = value;\n        if (this.onPropertyChanged && this.onPropertyChanged(name, value, prevValue) === false) {\n            this.properties[name] = prevValue;\n        }\n        if (this.widgets) {\n            for (let i = 0; i < this.widgets.length; ++i) {\n                const w = this.widgets[i];\n                if (!w) continue;\n                if (w.options.property == name) {\n                    w.value = value;\n                    break;\n                }\n            }\n        }\n    }\n\n    // Execution *************************\n    /**\n     * sets the output data\n     * @method setOutputData\n     * @param {number} slot\n     * @param {*} data\n     * @memberOf LGraphNode\n     */\n    setOutputData(slot, data) {\n        if (!this.outputs) {\n            return;\n        }\n\n        // this maybe slow and a niche case\n        // if(slot && slot.constructor === String)\n        //\tslot = this.findOutputSlot(slot);\n\n        if (slot == -1 || slot >= this.outputs.length) {\n            return;\n        }\n\n        const output_info = this.outputs[slot];\n        if (!output_info) {\n            return;\n        }\n\n        // store data in the output itself in case we want to debug\n        output_info._data = data;\n\n        // if there are connections, pass the data to the connections\n        if (this.outputs[slot].links) {\n            for (let i = 0; i < this.outputs[slot].links.length; i++) {\n                const link_id = this.outputs[slot].links[i];\n                const link = this.graph.links[link_id];\n                if (link) link.data = data;\n            }\n        }\n    }\n\n    /**\n     * sets the output data type, useful when you want to be able to overwrite the data type\n     * @method setOutputDataType\n     * @param {number} slot\n     * @param {String} datatype\n     * @memberOf LGraphNode\n     */\n    setOutputDataType(slot, type) {\n        if (!this.outputs) {\n            return;\n        }\n        if (slot == -1 || slot >= this.outputs.length) {\n            return;\n        }\n        const output_info = this.outputs[slot];\n        if (!output_info) {\n            return;\n        }\n        // store data in the output itself in case we want to debug\n        output_info.type = type;\n\n        // if there are connections, pass the data to the connections\n        if (this.outputs[slot].links) {\n            for (let i = 0; i < this.outputs[slot].links.length; i++) {\n                const link_id = this.outputs[slot].links[i];\n                this.graph.links[link_id].type = type;\n            }\n        }\n    }\n\n    /**\n     * Retrieves the input data (data traveling through the connection) from one slot\n     * @method getInputData\n     * @param {number} slot\n     * @param {boolean} forceUpdate if set to true it will force the connected node of this slot\n     *     to output data into this link\n     * @return {*} data or if it is not connected returns undefined\n     * @memberOf LGraphNode\n     */\n    getInputData(slot, forceUpdate) {\n        if (!this.inputs) {\n            return;\n        } // undefined;\n\n        if (slot >= this.inputs.length || this.inputs[slot].link == null) {\n            return;\n        }\n\n        const linkId = this.inputs[slot].link;\n        const link = this.graph.links[linkId];\n        if (!link) {\n            // bug: weird case but it happens sometimes\n            return null;\n        }\n\n        if (link.data && !forceUpdate) {\n            return link.data;\n        }\n\n        // special case: used to extract data from the incoming connection before the graph has\n        // been executed\n        const node = this.graph.getNodeById(link.origin_id);\n        if (!node) {\n            return link.data;\n        }\n\n        if (node.updateOutputData) {\n            node.updateOutputData(link.origin_slot);\n        } else if (node.onExecute) {\n            node.onExecute();\n        }\n\n        return link.data;\n    }\n\n    /**\n     * Retrieves the input data type (in case this supports multiple input types)\n     * @method getInputDataType\n     * @param {number} slot\n     * @return {String} datatype in string format\n     * @memberOf LGraphNode\n     */\n    getInputDataType(slot) {\n        if (!this.inputs) {\n            return null;\n        } // undefined;\n\n        if (slot >= this.inputs.length || this.inputs[slot].link == null) {\n            return null;\n        }\n        const link_id = this.inputs[slot].link;\n        const link = this.graph.links[link_id];\n        if (!link) {\n            // bug: weird case but it happens sometimes\n            return null;\n        }\n        const node = this.graph.getNodeById(link.origin_id);\n        if (!node) {\n            return link.type;\n        }\n        const output_info = node.outputs[link.origin_slot];\n        if (output_info) {\n            return output_info.type;\n        }\n        return null;\n    }\n\n    /**\n     * Retrieves the input data from one slot using its name instead of slot number\n     * @method getInputDataByName\n     * @param {String} slot_name\n     * @param {boolean} force_update if set to true it will force the connected node of this slot\n     *     to output data into this link\n     * @return {*} data or if it is not connected returns null\n     * @memberOf LGraphNode\n     */\n    getInputDataByName(\n        slot_name,\n        force_update,\n    ) {\n        const slot = this.findInputSlot(slot_name);\n        if (slot == -1) {\n            return null;\n        }\n        return this.getInputData(slot, force_update);\n    }\n\n    /**\n     * tells you if there is a connection in one input slot\n     * @method isInputConnected\n     * @param {number} slot\n     * @return {boolean}\n     * @memberOf LGraphNode\n     */\n    isInputConnected(slot) {\n        if (!this.inputs) {\n            return false;\n        }\n        return slot < this.inputs.length && this.inputs[slot].link != null;\n    }\n\n    /**\n     * tells you info about an input connection (which node, type, etc)\n     * @method getInputInfo\n     * @param {number} slot\n     * @return {Object} object or null { link: id, name: string, type: string or 0 }\n     * @memberOf LGraphNode\n     */\n    getInputInfo(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot < this.inputs.length) {\n            return this.inputs[slot];\n        }\n        return null;\n    }\n\n    /**\n     * Returns the link info in the connection of an input slot\n     * @method getInputLink\n     * @param {number} slot\n     * @return {LLink} object or null\n     * @memberOf LGraphNode\n     */\n    getInputLink(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot < this.inputs.length) {\n            const slot_info = this.inputs[slot];\n            return this.graph.links[slot_info.link];\n        }\n        return null;\n    }\n\n    /**\n     * returns the node connected in the input slot\n     * @method getInputNode\n     * @param {number} slot\n     * @return {LGraphNode} node or null\n     * @memberOf LGraphNode\n     */\n    getInputNode(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot >= this.inputs.length) {\n            return null;\n        }\n        const input = this.inputs[slot];\n        if (!input || input.link === null) {\n            return null;\n        }\n        const link_info = this.graph.links[input.link];\n        if (!link_info) {\n            return null;\n        }\n        return this.graph.getNodeById(link_info.origin_id);\n    }\n\n    /**\n     * returns the value of an input with this name, otherwise checks if there is a property with\n     * that name\n     * @method getInputOrProperty\n     * @param {string} name\n     * @return {*} value\n     * @memberOf LGraphNode\n     */\n    getInputOrProperty(name) {\n        if (!this.inputs || !this.inputs.length) {\n            return this.properties ? this.properties[name] : null;\n        }\n\n        for (let i = 0, l = this.inputs.length; i < l; ++i) {\n            const input_info = this.inputs[i];\n            if (name == input_info.name && input_info.link != null) {\n                const link = this.graph.links[input_info.link];\n                if (link) {\n                    return link.data;\n                }\n            }\n        }\n        return this.properties[name];\n    }\n\n    /**\n     * tells you the last output data that went in that slot\n     * @method getOutputData\n     * @param {number} slot\n     * @return {Object}  object or null\n     * @memberOf LGraphNode\n     */\n    getOutputData(slot) {\n        if (!this.outputs) {\n            return null;\n        }\n        if (slot >= this.outputs.length) {\n            return null;\n        }\n\n        const info = this.outputs[slot];\n        return info._data;\n    }\n\n    /**\n     * tells you info about an output connection (which node, type, etc)\n     * @method getOutputInfo\n     * @param {number} slot\n     * @return {Object}  object or null { name: string, type: string, links: [ ids of links in\n     *     number ] }\n     * @memberOf LGraphNode\n     */\n    getOutputInfo(slot) {\n        if (!this.outputs) {\n            return null;\n        }\n        if (slot < this.outputs.length) {\n            return this.outputs[slot];\n        }\n        return null;\n    }\n\n    /**\n     * tells you if there is a connection in one output slot\n     * @method isOutputConnected\n     * @param {number} slot\n     * @return {boolean}\n     * @memberOf LGraphNode\n     */\n    isOutputConnected(slot) {\n        if (!this.outputs) {\n            return false;\n        }\n        return (\n            slot < this.outputs.length\n            && this.outputs[slot].links\n            && this.outputs[slot].links.length\n        );\n    }\n\n    /**\n     * tells you if there is any connection in the output slots\n     * @method isAnyOutputConnected\n     * @return {boolean}\n     * @memberOf LGraphNode\n     */\n    isAnyOutputConnected() {\n        if (!this.outputs) {\n            return false;\n        }\n        for (let i = 0; i < this.outputs.length; ++i) {\n            if (this.outputs[i].links && this.outputs[i].links.length) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * retrieves all the nodes connected to this output slot\n     * @method getOutputNodes\n     * @param {number} slot\n     * @return {array}\n     * @memberOf LGraphNode\n     */\n    getOutputNodes(slot) {\n        if (!this.outputs || this.outputs.length == 0) {\n            return null;\n        }\n\n        if (slot >= this.outputs.length) {\n            return null;\n        }\n\n        const output = this.outputs[slot];\n        if (!output.links || output.links.length == 0) {\n            return null;\n        }\n\n        const r = [];\n        for (let i = 0; i < output.links.length; i++) {\n            const link_id = output.links[i];\n            const link = this.graph.links[link_id];\n            if (link) {\n                const target_node = this.graph.getNodeById(link.target_id);\n                if (target_node) {\n                    r.push(target_node);\n                }\n            }\n        }\n        return r;\n    }\n\n    /**\n     * Triggers an event in this node, this will trigger any output with the same name\n     * @method trigger\n     * @param {String} event name ( \"on_play\", ... ) if action is equivalent to false then the\n     *     event is send to all\n     * @param {*} param\n     * @memberOf LGraphNode\n     */\n    trigger(action, param) {\n        if (!this.outputs || !this.outputs.length) {\n            return;\n        }\n\n        if (this.graph) this.graph._last_trigger_time = getTime();\n\n        for (let i = 0; i < this.outputs.length; ++i) {\n            const output = this.outputs[i];\n            if (!output || output.type !== defaultConfig.EVENT || (action && output.name != action)) continue;\n            this.triggerSlot(i, param);\n        }\n    }\n\n    /**\n     * Triggers an slot event in this node\n     * @method triggerSlot\n     * @param {Number} slot the index of the output slot\n     * @param {*} param\n     * @param {Number} link_id [optional] in case you want to trigger and specific output link in a\n     *     slot\n     * @memberOf LGraphNode\n     */\n    triggerSlot(slot, param, link_id) {\n        if (!this.outputs) {\n            return;\n        }\n\n        const output = this.outputs[slot];\n        if (!output) {\n            return;\n        }\n\n        const { links } = output;\n        if (!links || !links.length) {\n            return;\n        }\n\n        if (this.graph) {\n            this.graph._last_trigger_time = getTime();\n        }\n\n        // for every link attached here\n        for (let k = 0; k < links.length; ++k) {\n            const id = links[k];\n            if (link_id != null && link_id != id) {\n                // to skip links\n                continue;\n            }\n            const link_info = this.graph.links[links[k]];\n            if (!link_info) {\n                // not connected\n                continue;\n            }\n            link_info._last_time = getTime();\n            const node = this.graph.getNodeById(link_info.target_id);\n            if (!node) {\n                // node not found?\n                continue;\n            }\n\n            // used to mark events in graph\n            const target_connection = node.inputs[link_info.target_slot];\n\n            if (node.mode === defaultConfig.ON_TRIGGER) {\n                if (node.onExecute) {\n                    node.onExecute(param);\n                }\n            } else if (node.onAction) {\n                node.onAction(target_connection.name, param);\n            }\n        }\n    }\n\n    /**\n     * clears the trigger slot animation\n     * @method clearTriggeredSlot\n     * @param {Number} slot the index of the output slot\n     * @param {Number} link_id [optional] in case you want to trigger and specific output link in a\n     *     slot\n     * @memberOf LGraphNode\n     */\n    clearTriggeredSlot(slot, link_id) {\n        if (!this.outputs) {\n            return;\n        }\n\n        const output = this.outputs[slot];\n        if (!output) {\n            return;\n        }\n\n        const { links } = output;\n        if (!links || !links.length) {\n            return;\n        }\n\n        // for every link attached here\n        for (let k = 0; k < links.length; ++k) {\n            const id = links[k];\n            if (link_id != null && link_id != id) {\n                // to skip links\n                continue;\n            }\n            const link_info = this.graph.links[links[k]];\n            if (!link_info) {\n                // not connected\n                continue;\n            }\n            link_info._last_time = 0;\n        }\n    }\n\n    /**\n     * changes node size and triggers callback\n     * @method setSize\n     * @param {vec2} size\n     * @memberOf LGraphNode\n     */\n    setSize(size) {\n        this.size = size;\n        if (this.onResize) this.onResize(this.size);\n    }\n\n    /**\n     * add a new property to this node\n     * @method addProperty\n     * @param {string} name\n     * @param {*} default_value\n     * @param {string} type string defining the output type (\"vec3\",\"number\",...)\n     * @param {Object} extra_info this can be used to have special properties of the property (like\n     *     values, etc)\n     * @memberOf LGraphNode\n     */\n    addProperty(\n        name,\n        default_value,\n        type,\n        extra_info,\n    ) {\n        const o = {\n            name,\n            type,\n            default_value,\n        };\n        if (extra_info) {\n            for (const i in extra_info) {\n                o[i] = extra_info[i];\n            }\n        }\n        if (!this.properties_info) {\n            this.properties_info = [];\n        }\n        this.properties_info.push(o);\n        if (!this.properties) {\n            this.properties = {};\n        }\n        this.properties[name] = default_value;\n        return o;\n    }\n\n    // connections\n\n    /**\n     * add a new output slot to use in this node\n     * @method addOutput\n     * @param {string} name\n     * @param {string} type string defining the output type (\"vec3\",\"number\",...)\n     * @param {Object} extra_info this can be used to have special properties of an output (label,\n     *     special color, position, etc)\n     * @memberOf LGraphNode\n     */\n    addOutput(name, type, extra_info) {\n        const o = {\n            name,\n            type,\n            links: null,\n        };\n        if (extra_info) {\n            for (const i in extra_info) {\n                o[i] = extra_info[i];\n            }\n        }\n\n        if (!this.outputs) {\n            this.outputs = [];\n        }\n        this.outputs.push(o);\n        if (this.onOutputAdded) {\n            this.onOutputAdded(o);\n        }\n        this.setSize(this.computeSize());\n        this.setDirtyCanvas(true, true);\n        return o;\n    }\n\n    /**\n     * add a new output slot to use in this node\n     * @method addOutputs\n     * @param {Array} array of triplets like [[name,type,extra_info],[...]]\n     * @memberOf LGraphNode\n     */\n    addOutputs(array) {\n        for (let i = 0; i < array.length; ++i) {\n            const info = array[i];\n            const o = {\n                name: info[0],\n                type: info[1],\n                link: null,\n            };\n            if (array[2]) {\n                for (const j in info[2]) {\n                    o[j] = info[2][j];\n                }\n            }\n\n            if (!this.outputs) {\n                this.outputs = [];\n            }\n            this.outputs.push(o);\n            if (this.onOutputAdded) {\n                this.onOutputAdded(o);\n            }\n        }\n\n        this.setSize(this.computeSize());\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * remove an existing output slot\n     * @method removeOutput\n     * @param {number} slot\n     * @memberOf LGraphNode\n     */\n    removeOutput(slot) {\n        this.disconnectOutput(slot);\n        this.outputs.splice(slot, 1);\n        for (let i = slot; i < this.outputs.length; ++i) {\n            if (!this.outputs[i] || !this.outputs[i].links) {\n                continue;\n            }\n            const { links } = this.outputs[i];\n            for (let j = 0; j < links.length; ++j) {\n                const link = this.graph.links[links[j]];\n                if (!link) {\n                    continue;\n                }\n                link.origin_slot -= 1;\n            }\n        }\n\n        this.setSize(this.computeSize());\n        if (this.onOutputRemoved) {\n            this.onOutputRemoved(slot);\n        }\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * add a new input slot to use in this node\n     * @method addInput\n     * @param {string} name\n     * @param {string} type string defining the input type (\"vec3\",\"number\",...), it its a generic\n     *     one use 0\n     * @param {Object} extra_info this can be used to have special properties of an input (label,\n     *     color, position, etc)\n     * @memberOf LGraphNode\n     */\n    addInput(name, type, extra_info) {\n        type = type || 0;\n        const o = {\n            name,\n            type,\n            link: null,\n        };\n        if (extra_info) {\n            for (const i in extra_info) {\n                o[i] = extra_info[i];\n            }\n        }\n\n        if (!this.inputs) {\n            this.inputs = [];\n        }\n\n        this.inputs.push(o);\n        this.setSize(this.computeSize());\n\n        if (this.onInputAdded) {\n            this.onInputAdded(o);\n        }\n\n        this.setDirtyCanvas(true, true);\n        return o;\n    }\n\n    /**\n     * add several new input slots in this node\n     * @method addInputs\n     * @param {Array} array of triplets like [[name,type,extra_info],[...]]\n     * @memberOf LGraphNode\n     */\n    addInputs(array) {\n        for (let i = 0; i < array.length; ++i) {\n            const info = array[i];\n            const o = {\n                name: info[0],\n                type: info[1],\n                link: null,\n            };\n            if (array[2]) {\n                for (const j in info[2]) {\n                    o[j] = info[2][j];\n                }\n            }\n\n            if (!this.inputs) {\n                this.inputs = [];\n            }\n            this.inputs.push(o);\n            if (this.onInputAdded) {\n                this.onInputAdded(o);\n            }\n        }\n\n        this.setSize(this.computeSize());\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * remove an existing input slot\n     * @method removeInput\n     * @param {number} slot\n     * @memberOf LGraphNode\n     */\n    removeInput(slot) {\n        this.disconnectInput(slot);\n        const slot_info = this.inputs.splice(slot, 1);\n        for (let i = slot; i < this.inputs.length; ++i) {\n            if (!this.inputs[i]) {\n                continue;\n            }\n            const link = this.graph.links[this.inputs[i].link];\n            if (!link) {\n                continue;\n            }\n            link.target_slot -= 1;\n        }\n        this.setSize(this.computeSize());\n        if (this.onInputRemoved) {\n            this.onInputRemoved(slot, slot_info[0]);\n        }\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * add an special connection to this node (used for special kinds of graphs)\n     * @method addConnection\n     * @param {string} name\n     * @param {string} type string defining the input type (\"vec3\",\"number\",...)\n     * @param {number[]} pos position of the connection inside the node\n     * @param {string} direction if is input or output\n     * @memberOf LGraphNode\n     */\n    addConnection(name, type, pos, direction) {\n        const o = {\n            name,\n            type,\n            pos,\n            direction,\n            links: null,\n        };\n        this.connections.push(o);\n        return o;\n    }\n\n    /**\n     * computes the minimum size of a node according to its inputs and output slots\n     * @method computeSize\n     * @param {number} minHeight\n     * @return {number} the total size\n     * @memberOf LGraphNode\n     */\n    computeSize(out) {\n        if (this.constructor.size) {\n            return this.constructor.size.concat();\n        }\n\n        let rows = Math.max(\n            this.inputs ? this.inputs.length : 1,\n            this.outputs ? this.outputs.length : 1,\n        );\n        const size = out || new Float32Array([0, 0]);\n        rows = Math.max(rows, 1);\n        var font_size = defaultConfig.NODE_TEXT_SIZE; // although it should be\n        // graphcanvas.inner_text_font size\n\n        var font_size = font_size;\n        const title_width = compute_text_size(this.title);\n        let input_width = 0;\n        let output_width = 0;\n\n        if (this.inputs) {\n            for (var i = 0, l = this.inputs.length; i < l; ++i) {\n                const input = this.inputs[i];\n                var text = input.label || input.name || \"\";\n                var text_width = compute_text_size(text);\n                if (input_width < text_width) {\n                    input_width = text_width;\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0, l = this.outputs.length; i < l; ++i) {\n                const output = this.outputs[i];\n                var text = output.label || output.name || \"\";\n                var text_width = compute_text_size(text);\n                if (output_width < text_width) {\n                    output_width = text_width;\n                }\n            }\n        }\n\n        size[0] = Math.max(input_width + output_width + 10, title_width);\n        size[0] = Math.max(size[0], defaultConfig.NODE_WIDTH);\n        if (this.widgets && this.widgets.length) {\n            size[0] = Math.max(size[0], defaultConfig.NODE_WIDTH * 1.5);\n        }\n\n        size[1] = (this.constructor.slot_start_y || 0) + rows * defaultConfig.NODE_SLOT_HEIGHT;\n\n        let widgets_height = 0;\n        if (this.widgets && this.widgets.length) {\n            for (var i = 0, l = this.widgets.length; i < l; ++i) {\n                if (this.widgets[i].computeSize) {\n                    widgets_height += this.widgets[i].computeSize(size[0])[1] + 4;\n                } else {\n                    widgets_height += defaultConfig.NODE_WIDGET_HEIGHT + 4;\n                }\n            }\n            widgets_height += 8;\n        }\n\n        // compute height using widgets height\n        if (this.widgets_up) {\n            size[1] = Math.max(size[1], widgets_height);\n        } else if (this.widgets_start_y != null) {\n            size[1] = Math.max(size[1], widgets_height + this.widgets_start_y);\n        } else {\n            size[1] += widgets_height;\n        }\n\n        function compute_text_size(text) {\n            if (!text) {\n                return 0;\n            }\n            return font_size * text.length * 0.6;\n        }\n\n        if (\n            this.constructor.min_height\n            && size[1] < this.constructor.min_height\n        ) {\n            size[1] = this.constructor.min_height;\n        }\n\n        size[1] += 6; // margin\n\n        return size;\n    }\n\n    /**\n     * returns all the info available about a property of this node.\n     *\n     * @method getPropertyInfo\n     * @param {String} property name of the property\n     * @return {Object} the object with all the available info\n     * @memberOf LGraphNode\n     */\n    getPropertyInfo(property) {\n        let info = null;\n\n        // there are several ways to define info about a property\n        // legacy mode\n        if (this.properties_info) {\n            for (let i = 0; i < this.properties_info.length; ++i) {\n                if (this.properties_info[i].name == property) {\n                    info = this.properties_info[i];\n                    break;\n                }\n            }\n        }\n        // litescene mode using the constructor\n        if (this.constructor[`@${property}`]) info = this.constructor[`@${property}`];\n\n        if (this.constructor.widgets_info && this.constructor.widgets_info[property]) info = this.constructor.widgets_info[property];\n\n        // litescene mode using the constructor\n        if (!info && this.onGetPropertyInfo) {\n            info = this.onGetPropertyInfo(property);\n        }\n\n        if (!info) info = {};\n        if (!info.type) info.type = typeof this.properties[property];\n        if (info.widget == \"combo\") info.type = \"enum\";\n\n        return info;\n    }\n\n    /**\n     * Defines a widget inside the node, it will be rendered on top of the node, you can control\n     * lots of properties\n     *\n     * @method addWidget\n     * @param {String} type the widget type (could be \"number\",\"string\",\"combo\"\n     * @param {String} name the text to show on the widget\n     * @param {String} value the default value\n     * @param {Function|String} callback function to call when it changes (optionally, it can be\n     *     the name of the property to modify)\n     * @param {Object} options the object that contains special properties of this widget\n     * @return {Object} the created widget object\n     * @memberOf LGraphNode\n     */\n    addWidget(type, name, value, callback, options) {\n        if (!this.widgets) {\n            this.widgets = [];\n        }\n\n        if (!options && callback && callback.constructor === Object) {\n            options = callback;\n            callback = null;\n        }\n\n        if (options && options.constructor === String) // options can be the property name\n        {\n            options = { property: options };\n        }\n\n        if (callback && callback.constructor === String) // callback can be the property name\n        {\n            if (!options) options = {};\n            options.property = callback;\n            callback = null;\n        }\n\n        if (callback && callback.constructor !== Function) {\n            console.warn(\"addWidget: callback must be a function\");\n            callback = null;\n        }\n\n        const w = {\n            type: type.toLowerCase(),\n            name,\n            value,\n            callback,\n            options: options || {},\n        };\n\n        if (w.options.y) {\n            w.y = w.options.y;\n        }\n\n        if (!callback && !w.options.callback && !w.options.property) {\n            console.warn(\"LiteGraph addWidget(...) without a callback or property assigned\");\n        }\n        if (type == \"combo\" && !w.options.values) {\n            throw \"LiteGraph addWidget('combo',...) requires to pass values in options: { values:['red','blue'] }\";\n        }\n        this.widgets.push(w);\n        this.setSize(this.computeSize());\n        return w;\n    }\n\n    addCustomWidget(custom_widget) {\n        if (!this.widgets) {\n            this.widgets = [];\n        }\n        this.widgets.push(custom_widget);\n        return custom_widget;\n    }\n\n    /**\n     * returns the bounding of the object, used for rendering purposes\n     * bounding is: [topleft_cornerx, topleft_cornery, width, height]\n     * @method getBounding\n     * @return {Float32Array} the total size\n     * @memberOf LGraphNode\n     */\n    getBounding(out) {\n        out = out || new Float32Array(4);\n        out[0] = this.pos[0] - 4;\n        out[1] = this.pos[1] - defaultConfig.NODE_TITLE_HEIGHT;\n        out[2] = this.size[0] + 4;\n        out[3] = this.size[1] + defaultConfig.NODE_TITLE_HEIGHT;\n\n        if (this.onBounding) {\n            this.onBounding(out);\n        }\n        return out;\n    }\n\n    /**\n     * checks if a point is inside the shape of a node\n     * @method isPointInside\n     * @param {number} x\n     * @param {number} y\n     * @return {boolean}\n     * @memberOf LGraphNode\n     */\n    isPointInside(x, y, margin, skip_title) {\n        margin = margin || 0;\n\n        let margin_top = this.graph && this.graph.isLive() ? 0 : defaultConfig.NODE_TITLE_HEIGHT;\n        if (skip_title) {\n            margin_top = 0;\n        }\n        if (this.flags && this.flags.collapsed) {\n            // if ( distance([x,y], [this.pos[0] + this.size[0]*0.5, this.pos[1] +\n            // this.size[1]*0.5]) < LiteGraph.NODE_COLLAPSED_RADIUS)\n            if (\n                isInsideRectangle(\n                    x,\n                    y,\n                    this.pos[0] - margin,\n                    this.pos[1] - defaultConfig.NODE_TITLE_HEIGHT - margin,\n                    (this._collapsed_width || defaultConfig.NODE_COLLAPSED_WIDTH)\n                    + 2 * margin,\n                    defaultConfig.NODE_TITLE_HEIGHT + 2 * margin,\n                )\n            ) {\n                return true;\n            }\n        } else if (\n            this.pos[0] - 4 - margin < x\n            && this.pos[0] + this.size[0] + 4 + margin > x\n            && this.pos[1] - margin_top - margin < y\n            && this.pos[1] + this.size[1] + margin > y\n        ) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * checks if a point is inside a node slot, and returns info about which slot\n     * @method getSlotInPosition\n     * @param {number} x\n     * @param {number} y\n     * @return {Object} if found the object contains { input|output: slot object, slot: number,\n     *     link_pos: [x,y] }\n     * @memberOf LGraphNode\n     */\n    getSlotInPosition(x, y) {\n        // search for inputs\n        const link_pos = new Float32Array(2);\n        if (this.inputs) {\n            for (var i = 0, l = this.inputs.length; i < l; ++i) {\n                const input = this.inputs[i];\n                this.getConnectionPos(true, i, link_pos);\n                if (\n                    isInsideRectangle(\n                        x,\n                        y,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        20,\n                        10,\n                    )\n                ) {\n                    return {\n                        input,\n                        slot: i,\n                        link_pos,\n                    };\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0, l = this.outputs.length; i < l; ++i) {\n                const output = this.outputs[i];\n                this.getConnectionPos(false, i, link_pos);\n                if (\n                    isInsideRectangle(\n                        x,\n                        y,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        20,\n                        10,\n                    )\n                ) {\n                    return {\n                        output,\n                        slot: i,\n                        link_pos,\n                    };\n                }\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * returns the input slot with a given name (used for dynamic slots), -1 if not found\n     * @method findInputSlot\n     * @param {string} name the name of the slot\n     * @return {number} the slot (-1 if not found)\n     * @memberOf LGraphNode\n     */\n    findInputSlot(name) {\n        if (!this.inputs) {\n            return -1;\n        }\n        for (let i = 0, l = this.inputs.length; i < l; ++i) {\n            if (name == this.inputs[i].name) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    /**\n     * returns the output slot with a given name (used for dynamic slots), -1 if not found\n     * @method findOutputSlot\n     * @param {string} name the name of the slot\n     * @return {number} the slot (-1 if not found)\n     * @memberOf LGraphNode\n     */\n    findOutputSlot(name) {\n        if (!this.outputs) {\n            return -1;\n        }\n        for (let i = 0, l = this.outputs.length; i < l; ++i) {\n            if (name == this.outputs[i].name) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    /**\n     * connect this node output to the input of another node\n     * @method connect\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name\n     *     of the slot)\n     * @param {LGraphNode} node the target node\n     * @param {number_or_string} target_slot the input slot of the target node (could be the number\n     *     of the slot or the string with the name of the slot, or -1 to connect a trigger)\n     * @return {Object} the link_info is created, otherwise null\n     * @memberOf LGraphNode\n     */\n    connect(slot, target_node, target_slot) {\n        target_slot = target_slot || 0;\n\n        if (!this.graph) {\n            // could be connected before adding it to a graph\n            console.log(\n                \"Connect: Error, node doesn't belong to any graph. Nodes must be added first to a graph before connecting them.\",\n            ); // due to link ids being associated with graphs\n            return null;\n        }\n\n        // seek for the output slot\n        if (slot.constructor === String) {\n            slot = this.findOutputSlot(slot);\n            if (slot == -1) {\n                if (defaultConfig.debug) {\n                    console.log(`Connect: Error, no slot of name ${slot}`);\n                }\n                return null;\n            }\n        } else if (!this.outputs || slot >= this.outputs.length) {\n            if (defaultConfig.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return null;\n        }\n\n        if (target_node && target_node.constructor === Number) {\n            target_node = this.graph.getNodeById(target_node);\n        }\n        if (!target_node) {\n            throw \"target node is null\";\n        }\n\n        // avoid loopback\n        if (target_node == this) {\n            return null;\n        }\n\n        // you can specify the slot by name\n        if (target_slot.constructor === String) {\n            target_slot = target_node.findInputSlot(target_slot);\n            if (target_slot == -1) {\n                if (defaultConfig.debug) {\n                    console.log(\n                        `Connect: Error, no slot of name ${target_slot}`,\n                    );\n                }\n                return null;\n            }\n        } else if (target_slot === defaultConfig.EVENT) {\n            // search for first slot with event?\n            /*\n    //create input for trigger\n    var input = target_node.addInput(\"onTrigger\", LiteGraph.EVENT );\n    target_slot = target_node.inputs.length - 1; //last one is the one created\n    target_node.mode = LiteGraph.ON_TRIGGER;\n    */\n            return null;\n        } else if (\n            !target_node.inputs\n            || target_slot >= target_node.inputs.length\n        ) {\n            if (defaultConfig.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return null;\n        }\n\n        let changed = false;\n\n        // if there is something already plugged there, disconnect\n        if (target_node.inputs[target_slot].link != null) {\n            this.graph.beforeChange();\n            target_node.disconnectInput(target_slot);\n            changed = true;\n        }\n\n        // why here??\n        // this.setDirtyCanvas(false,true);\n        // this.graph.connectionChange( this );\n\n        const output = this.outputs[slot];\n\n        // allows nodes to block connection\n        if (target_node.onConnectInput) {\n            if (target_node.onConnectInput(target_slot, output.type, output, this, slot) === false) {\n                return null;\n            }\n        }\n\n        const input = target_node.inputs[target_slot];\n        let link_info = null;\n\n        // this slots cannot be connected (different types)\n        if (!isValidConnection(output.type, input.type)) {\n            this.setDirtyCanvas(false, true);\n            if (changed) this.graph.connectionChange(this, link_info);\n            return null;\n        }\n\n        if (!changed) this.graph.beforeChange();\n\n        // create link class\n        link_info = new LLink(\n            ++this.graph.last_link_id,\n            input.type,\n            this.id,\n            slot,\n            target_node.id,\n            target_slot,\n        );\n\n        // add to graph links list\n        this.graph.links[link_info.id] = link_info;\n\n        // connect in output\n        if (output.links == null) {\n            output.links = [];\n        }\n        output.links.push(link_info.id);\n        // connect in input\n        target_node.inputs[target_slot].link = link_info.id;\n        if (this.graph) {\n            this.graph._version++;\n        }\n        if (this.onConnectionsChange) {\n            this.onConnectionsChange(\n                defaultConfig.OUTPUT,\n                slot,\n                true,\n                link_info,\n                output,\n            );\n        } // link_info has been created now, so its updated\n        if (target_node.onConnectionsChange) {\n            target_node.onConnectionsChange(\n                defaultConfig.INPUT,\n                target_slot,\n                true,\n                link_info,\n                input,\n            );\n        }\n        if (this.graph && this.graph.onNodeConnectionChange) {\n            this.graph.onNodeConnectionChange(\n                defaultConfig.INPUT,\n                target_node,\n                target_slot,\n                this,\n                slot,\n            );\n            this.graph.onNodeConnectionChange(\n                defaultConfig.OUTPUT,\n                this,\n                slot,\n                target_node,\n                target_slot,\n            );\n        }\n\n        this.setDirtyCanvas(false, true);\n        this.graph.afterChange();\n        this.graph.connectionChange(this, link_info);\n\n        return link_info;\n    }\n\n    /**\n     * disconnect one output to an specific node\n     * @method disconnectOutput\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name\n     *     of the slot)\n     * @param {LGraphNode} target_node the target node to which this slot is connected [Optional,\n     *     if not target_node is specified all nodes will be disconnected]\n     * @return {boolean} if it was disconnected successfully\n     * @memberOf LGraphNode\n     */\n    disconnectOutput(slot, target_node) {\n        if (slot.constructor === String) {\n            slot = this.findOutputSlot(slot);\n            if (slot == -1) {\n                if (defaultConfig.debug) {\n                    console.log(`Connect: Error, no slot of name ${slot}`);\n                }\n                return false;\n            }\n        } else if (!this.outputs || slot >= this.outputs.length) {\n            if (defaultConfig.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return false;\n        }\n\n        // get output slot\n        const output = this.outputs[slot];\n        if (!output || !output.links || output.links.length == 0) {\n            return false;\n        }\n\n        // one of the output links in this slot\n        if (target_node) {\n            if (target_node.constructor === Number) {\n                target_node = this.graph.getNodeById(target_node);\n            }\n            if (!target_node) {\n                throw \"Target Node not found\";\n            }\n\n            for (var i = 0, l = output.links.length; i < l; i++) {\n                var link_id = output.links[i];\n                var link_info = this.graph.links[link_id];\n\n                // is the link we are searching for...\n                if (link_info.target_id == target_node.id) {\n                    output.links.splice(i, 1); // remove here\n                    var input = target_node.inputs[link_info.target_slot];\n                    input.link = null; // remove there\n                    delete this.graph.links[link_id]; // remove the link from the links pool\n                    if (this.graph) {\n                        this.graph._version++;\n                    }\n                    if (target_node.onConnectionsChange) {\n                        target_node.onConnectionsChange(\n                            defaultConfig.INPUT,\n                            link_info.target_slot,\n                            false,\n                            link_info,\n                            input,\n                        );\n                    } // link_info hasn't been modified so its ok\n                    if (this.onConnectionsChange) {\n                        this.onConnectionsChange(\n                            defaultConfig.OUTPUT,\n                            slot,\n                            false,\n                            link_info,\n                            output,\n                        );\n                    }\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            defaultConfig.OUTPUT,\n                            this,\n                            slot,\n                        );\n                    }\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            defaultConfig.OUTPUT,\n                            this,\n                            slot,\n                        );\n                        this.graph.onNodeConnectionChange(\n                            defaultConfig.INPUT,\n                            target_node,\n                            link_info.target_slot,\n                        );\n                    }\n                    break;\n                }\n            }\n        } // all the links in this output slot\n        else {\n            for (var i = 0, l = output.links.length; i < l; i++) {\n                var link_id = output.links[i];\n                var link_info = this.graph.links[link_id];\n                if (!link_info) {\n                    // bug: it happens sometimes\n                    continue;\n                }\n\n                var target_node = this.graph.getNodeById(link_info.target_id);\n                var input = null;\n                if (this.graph) {\n                    this.graph._version++;\n                }\n                if (target_node) {\n                    input = target_node.inputs[link_info.target_slot];\n                    input.link = null; // remove other side link\n                    if (target_node.onConnectionsChange) {\n                        target_node.onConnectionsChange(\n                            defaultConfig.INPUT,\n                            link_info.target_slot,\n                            false,\n                            link_info,\n                            input,\n                        );\n                    } // link_info hasn't been modified so its ok\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            defaultConfig.INPUT,\n                            target_node,\n                            link_info.target_slot,\n                        );\n                    }\n                }\n                delete this.graph.links[link_id]; // remove the link from the links pool\n                if (this.onConnectionsChange) {\n                    this.onConnectionsChange(\n                        defaultConfig.OUTPUT,\n                        slot,\n                        false,\n                        link_info,\n                        output,\n                    );\n                }\n                if (this.graph && this.graph.onNodeConnectionChange) {\n                    this.graph.onNodeConnectionChange(\n                        defaultConfig.OUTPUT,\n                        this,\n                        slot,\n                    );\n                    this.graph.onNodeConnectionChange(\n                        defaultConfig.INPUT,\n                        target_node,\n                        link_info.target_slot,\n                    );\n                }\n            }\n            output.links = null;\n        }\n\n        this.setDirtyCanvas(false, true);\n        this.graph.connectionChange(this);\n        return true;\n    }\n\n    /**\n     * disconnect one input\n     * @method disconnectInput\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name\n     *     of the slot)\n     * @return {boolean} if it was disconnected successfully\n     * @memberOf LGraphNode\n     */\n    disconnectInput(slot) {\n        // seek for the output slot\n        if (slot.constructor === String) {\n            slot = this.findInputSlot(slot);\n            if (slot == -1) {\n                if (defaultConfig.debug) {\n                    console.log(`Connect: Error, no slot of name ${slot}`);\n                }\n                return false;\n            }\n        } else if (!this.inputs || slot >= this.inputs.length) {\n            if (defaultConfig.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return false;\n        }\n\n        const input = this.inputs[slot];\n        if (!input) {\n            return false;\n        }\n\n        const link_id = this.inputs[slot].link;\n        if (link_id != null) {\n            this.inputs[slot].link = null;\n\n            // remove other side\n            const link_info = this.graph.links[link_id];\n            if (link_info) {\n                const target_node = this.graph.getNodeById(link_info.origin_id);\n                if (!target_node) {\n                    return false;\n                }\n\n                const output = target_node.outputs[link_info.origin_slot];\n                if (!output || !output.links || output.links.length == 0) {\n                    return false;\n                }\n\n                // search in the inputs list for this link\n                for (var i = 0, l = output.links.length; i < l; i++) {\n                    if (output.links[i] == link_id) {\n                        output.links.splice(i, 1);\n                        break;\n                    }\n                }\n\n                delete this.graph.links[link_id]; // remove from the pool\n                if (this.graph) {\n                    this.graph._version++;\n                }\n                if (this.onConnectionsChange) {\n                    this.onConnectionsChange(\n                        defaultConfig.INPUT,\n                        slot,\n                        false,\n                        link_info,\n                        input,\n                    );\n                }\n                if (target_node.onConnectionsChange) {\n                    target_node.onConnectionsChange(\n                        defaultConfig.OUTPUT,\n                        i,\n                        false,\n                        link_info,\n                        output,\n                    );\n                }\n                if (this.graph && this.graph.onNodeConnectionChange) {\n                    this.graph.onNodeConnectionChange(\n                        defaultConfig.OUTPUT,\n                        target_node,\n                        i,\n                    );\n                    this.graph.onNodeConnectionChange(defaultConfig.INPUT, this, slot);\n                }\n            }\n        } // link != null\n\n        this.setDirtyCanvas(false, true);\n        if (this.graph) this.graph.connectionChange(this);\n        return true;\n    }\n\n    /**\n     * returns the center of a connection point in canvas coords\n     * @method getConnectionPos\n     * @param {boolean} is_input true if if a input slot, false if it is an output\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name\n     *     of the slot)\n     * @param {vec2} out [optional] a place to store the output, to free garbage\n     * @return {number[]} the position\n     * @memberOf LGraphNode\n     * */\n    getConnectionPos(\n        is_input,\n        slot_number,\n        out,\n    ) {\n        out = out || new Float32Array(2);\n        let num_slots = 0;\n        if (is_input && this.inputs) {\n            num_slots = this.inputs.length;\n        }\n        if (!is_input && this.outputs) {\n            num_slots = this.outputs.length;\n        }\n\n        const offset = defaultConfig.NODE_SLOT_HEIGHT * 0.5;\n\n        if (this.flags.collapsed) {\n            const w = this._collapsed_width || defaultConfig.NODE_COLLAPSED_WIDTH;\n            if (this.horizontal) {\n                out[0] = this.pos[0] + w * 0.5;\n                if (is_input) {\n                    out[1] = this.pos[1] - defaultConfig.NODE_TITLE_HEIGHT;\n                } else {\n                    out[1] = this.pos[1];\n                }\n            } else {\n                if (is_input) {\n                    out[0] = this.pos[0];\n                } else {\n                    out[0] = this.pos[0] + w;\n                }\n                out[1] = this.pos[1] - defaultConfig.NODE_TITLE_HEIGHT * 0.5;\n            }\n            return out;\n        }\n\n        // weird feature that never got finished\n        if (is_input && slot_number == -1) {\n            out[0] = this.pos[0] + defaultConfig.NODE_TITLE_HEIGHT * 0.5;\n            out[1] = this.pos[1] + defaultConfig.NODE_TITLE_HEIGHT * 0.5;\n            return out;\n        }\n\n        // hard-coded pos\n        if (\n            is_input\n            && num_slots > slot_number\n            && this.inputs[slot_number].pos\n        ) {\n            out[0] = this.pos[0] + this.inputs[slot_number].pos[0];\n            out[1] = this.pos[1] + this.inputs[slot_number].pos[1];\n            return out;\n        }\n        if (\n            !is_input\n            && num_slots > slot_number\n            && this.outputs[slot_number].pos\n        ) {\n            out[0] = this.pos[0] + this.outputs[slot_number].pos[0];\n            out[1] = this.pos[1] + this.outputs[slot_number].pos[1];\n            return out;\n        }\n\n        // horizontal distributed slots\n        if (this.horizontal) {\n            out[0] = this.pos[0] + (slot_number + 0.5) * (this.size[0] / num_slots);\n            if (is_input) {\n                out[1] = this.pos[1] - defaultConfig.NODE_TITLE_HEIGHT;\n            } else {\n                out[1] = this.pos[1] + this.size[1];\n            }\n            return out;\n        }\n\n        // default vertical slots\n        if (is_input) {\n            out[0] = this.pos[0] + offset;\n        } else {\n            out[0] = this.pos[0] + this.size[0] + 1 - offset;\n        }\n        out[1] = this.pos[1]\n            + (slot_number + 0.7) * defaultConfig.NODE_SLOT_HEIGHT\n            + (this.constructor.slot_start_y || 0);\n        return out;\n    }\n\n    /* Force align to grid */\n    alignToGrid() {\n        this.pos[0] = defaultConfig.CANVAS_GRID_SIZE\n            * Math.round(this.pos[0] / defaultConfig.CANVAS_GRID_SIZE);\n        this.pos[1] = defaultConfig.CANVAS_GRID_SIZE\n            * Math.round(this.pos[1] / defaultConfig.CANVAS_GRID_SIZE);\n    }\n\n    /* Console output */\n    trace(msg) {\n        if (!this.console) {\n            this.console = [];\n        }\n\n        this.console.push(msg);\n        if (this.console.length > LGraphNode.MAX_CONSOLE) {\n            this.console.shift();\n        }\n\n        if (this.graph.onNodeTrace) this.graph.onNodeTrace(this, msg);\n    }\n\n    /* Forces to redraw or the main canvas (LGraphNode) or the bg canvas (links) */\n    setDirtyCanvas(\n        dirty_foreground,\n        dirty_background,\n    ) {\n        if (!this.graph) {\n            return;\n        }\n        this.graph.sendActionToCanvas(\"setDirty\", [\n            dirty_foreground,\n            dirty_background,\n        ]);\n    }\n\n    loadImage(url) {\n        const img = new Image();\n        img.src = defaultConfig.node_images_path + url;\n        img.ready = false;\n\n        img.onload = () => {\n            img.ready = true;\n            this.setDirtyCanvas(true);\n        };\n        return img;\n    }\n\n    // safe LGraphNode action execution (not sure if safe)\n    /*\n    executeAction = function(action)\n    {\n    if(action == \"\") return false;\n\n    if( action.indexOf(\";\") != -1 || action.indexOf(\"}\") != -1)\n    {\n    this.trace(\"Error: Action contains unsafe characters\");\n    return false;\n    }\n\n    var tokens = action.split(\"(\");\n    var func_name = tokens[0];\n    if( typeof(this[func_name]) != \"function\")\n    {\n    this.trace(\"Error: Action not found on node: \" + func_name);\n    return false;\n    }\n\n    var code = action;\n\n    try\n    {\n    var _foo = eval;\n    eval = null;\n    (new Function(\"with(this) { \" + code + \"}\")).call(this);\n    eval = _foo;\n    }\n    catch (err)\n    {\n    this.trace(\"Error executing action {\" + action + \"} :\" + err);\n    return false;\n    }\n\n    return true;\n    }\n    */\n\n    /* Allows to get onMouseMove and onMouseUp events even if the mouse is out of focus */\n    captureInput(v) {\n        if (!this.graph || !this.graph.list_of_graphcanvas) {\n            return;\n        }\n\n        const list = this.graph.list_of_graphcanvas;\n\n        for (let i = 0; i < list.length; ++i) {\n            const c = list[i];\n            // releasing somebody elses capture?!\n            if (!v && c.node_capturing_input != this) {\n                continue;\n            }\n\n            // change\n            c.node_capturing_input = v ? this : null;\n        }\n    }\n\n    /**\n     * Collapse the node to make it smaller on the canvas\n     * @method collapse\n     * @memberOf LGraphNode\n     * */\n    collapse(force) {\n        this.graph._version++;\n        if (this.constructor.collapsable === false && !force) {\n            return;\n        }\n        this.flags.collapsed = !this.flags.collapsed;\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * Forces the node to do not move or realign on Z\n     * @method pin\n     * @memberOf LGraphNode\n     * */\n\n    pin(v) {\n        this.graph._version++;\n        if (v === undefined) {\n            this.flags.pinned = !this.flags.pinned;\n        } else {\n            this.flags.pinned = v;\n        }\n    }\n\n    localToScreen(x, y, graphcanvas) {\n        return [\n            (x + this.pos[0]) * graphcanvas.scale + graphcanvas.offset[0],\n            (y + this.pos[1]) * graphcanvas.scale + graphcanvas.offset[1],\n        ];\n    }\n\n    /**\n     * Create a node of a given type with a name. The node is not attached to any graph yet.\n     * @method createNode\n     * @param {String} type full name of the node class. p.e. \"math/sin\"\n     * @param {String} name a name to distinguish from other nodes\n     * @param {Object} options to set options\n     * @memberOf LGraphNode\n     */\n    static createNode(type, title, options) {\n        const baseClass = defaultConfig.registered_node_types[type];\n        if (!baseClass) {\n            if (defaultConfig.debug) console.log(`GraphNode type \"${type}\" not registered.`);\n            return null;\n        }\n\n        const prototype = baseClass.prototype || baseClass;\n\n        title = title || baseClass.title || type;\n\n        let node = null;\n\n        if (defaultConfig.catch_exceptions) {\n            try {\n                node = new baseClass(title);\n            } catch (err) {\n                console.error(err);\n                return null;\n            }\n        } else {\n            node = new baseClass(title);\n        }\n\n        node.type = type;\n\n        if (!node.title && title) {\n            node.title = title;\n        }\n        if (!node.properties) {\n            node.properties = {};\n        }\n        if (!node.properties_info) {\n            node.properties_info = [];\n        }\n        if (!node.flags) {\n            node.flags = {};\n        }\n        if (!node.size) {\n            node.size = node.computeSize();\n            // call onresize?\n        }\n        if (!node.pos) {\n            node.pos = defaultConfig.DEFAULT_POSITION.concat();\n        }\n        if (!node.mode) {\n            node.mode = defaultConfig.ALWAYS;\n        }\n\n        // extra options\n        if (options) {\n            // eslint-disable-next-line\n            for (const i in options) node[i] = options[i];\n        }\n\n        return node;\n    }\n\n    // debug purposes: reloads all the js scripts that matches a wildcard\n    static reloadNodes(folderWildcard) {\n        const tmp = document.getElementsByTagName(\"script\");\n        // weird, this array changes by its own, so we use a copy\n        const scriptFiles = [];\n        for (const t of tmp) scriptFiles.push(t);\n\n        const docHeadObj = document.getElementsByTagName(\"head\")[0];\n        folderWildcard = document.location.href + folderWildcard;\n\n        for (const script of scriptFiles) {\n            const { src } = script;\n            if (\n                !src\n                || src.substr(0, folderWildcard.length) !== folderWildcard\n            ) continue;\n\n            try {\n                if (defaultConfig.debug) {\n                    console.log(`Reloading: ${src}`);\n                }\n                const dynamicScript = document.createElement(\"script\");\n                dynamicScript.type = \"text/javascript\";\n                dynamicScript.src = src;\n                docHeadObj.appendChild(dynamicScript);\n                docHeadObj.removeChild(scriptFiles[i]);\n            } catch (err) {\n                if (defaultConfig.throw_errors) {\n                    throw err;\n                }\n                if (defaultConfig.debug) console.log(`Error while reloading ${src}`);\n            }\n        }\n\n        if (defaultConfig.debug) {\n            console.log(\"Nodes reloaded\");\n        }\n    }\n\n    /**\n     * Adds this method to all nodetypes, existing and to be created\n     * (You can add it to LGraphNode.prototype but then existing node types wont have it)\n     * @method addNodeMethod\n     * @param {Function} func\n     * @memberOf LGraphNode\n     */\n    static addNodeMethod(name, func) {\n        LGraphNode.prototype[name] = func;\n        for (const i in defaultConfig.registered_node_types) {\n            const type = defaultConfig.registered_node_types[i];\n            if (type.prototype[name]) type.prototype[`_${name}`] = type.prototype[name];\n            type.prototype[name] = func;\n        }\n    }\n\n    static extendNode(object) {\n        for (const i of Object.getOwnPropertyNames(LGraphNode.prototype)) {\n            if (!object.prototype[i]) {\n                object.prototype[i] = LGraphNode.prototype[i];\n            }\n        }\n    }\n\n}\n","import LGraphNode from \"./LGraphNode\";\nimport { overlapBounding } from \"./utils/math\";\n\n/**\n * @class LGraphGroup\n * @param title\n */\nexport default class LGraphGroup {\n    constructor(title) {\n        this._ctor(title);\n    }\n\n    _ctor(title) {\n        this.title = title || \"Group\";\n        this.font_size = 24;\n        this.color = \"#AAA\";\n        this._bounding = new Float32Array([10, 10, 140, 80]);\n        this._pos = this._bounding.subarray(0, 2);\n        this._size = this._bounding.subarray(2, 4);\n        this._nodes = [];\n        this.graph = null;\n\n        Object.defineProperty(this, \"pos\", {\n            set(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._pos[0] = v[0];\n                this._pos[1] = v[1];\n            },\n            get() {\n                return this._pos;\n            },\n            enumerable: true,\n        });\n\n        Object.defineProperty(this, \"size\", {\n            set(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._size[0] = Math.max(140, v[0]);\n                this._size[1] = Math.max(80, v[1]);\n            },\n            get() {\n                return this._size;\n            },\n            enumerable: true,\n        });\n    }\n\n    recomputeInsideNodes() {\n        this._nodes.length = 0;\n        const nodes = this.graph._nodes;\n        const node_bounding = new Float32Array(4);\n\n        for (let i = 0; i < nodes.length; ++i) {\n            const node = nodes[i];\n            node.getBounding(node_bounding);\n            if (!overlapBounding(this._bounding, node_bounding)) {\n                continue;\n            } // out of the visible area\n            this._nodes.push(node);\n        }\n    }\n\n    move(deltax, deltay, ignore_nodes) {\n        this._pos[0] += deltax;\n        this._pos[1] += deltay;\n        if (ignore_nodes) {\n            return;\n        }\n        for (let i = 0; i < this._nodes.length; ++i) {\n            const node = this._nodes[i];\n            node.pos[0] += deltax;\n            node.pos[1] += deltay;\n        }\n    }\n\n    serialize() {\n        const b = this._bounding;\n        return {\n            title: this.title,\n            bounding: [\n                Math.round(b[0]),\n                Math.round(b[1]),\n                Math.round(b[2]),\n                Math.round(b[3]),\n            ],\n            color: this.color,\n            font: this.font,\n        };\n    }\n\n    configure(o) {\n        this.title = o.title;\n        this._bounding.set(o.bounding);\n        this.color = o.color;\n        this.font = o.font;\n    }\n\n    isPointInside = LGraphNode.prototype.isPointInside\n\n    setDirtyCanvas = LGraphNode.prototype.setDirtyCanvas\n}\n","/**\n * @class DragAndScale\n * @param element\n * @param skipEvents\n */\nexport default class DragAndScale {\n    constructor(element, skipEvents) {\n        this.offset = new Float32Array([0, 0]);\n        this.scale = 1;\n        this.max_scale = 10;\n        this.min_scale = 0.1;\n        this.onredraw = null;\n        this.enabled = true;\n        this.last_mouse = [0, 0];\n        this.element = null;\n        this.visible_area = new Float32Array(4);\n\n        if (element) {\n            this.element = element;\n            if (!skipEvents) {\n                this.bindEvents(element);\n            }\n        }\n    }\n\n    bindEvents(element) {\n        this.last_mouse = new Float32Array(2);\n\n        this._binded_mouse_callback = this.onMouse.bind(this);\n\n        element.addEventListener(\"mousedown\", this._binded_mouse_callback);\n        element.addEventListener(\"mousemove\", this._binded_mouse_callback);\n\n        element.addEventListener(\n            \"mousewheel\",\n            this._binded_mouse_callback,\n            false,\n        );\n        element.addEventListener(\"wheel\", this._binded_mouse_callback, false);\n    }\n\n    computeVisibleArea() {\n        if (!this.element) {\n            // eslint-disable-next-line\n            this.visible_area[0] = this.visible_area[1] = this.visible_area[2] = this.visible_area[3] = 0;\n            return;\n        }\n        const { width } = this.element;\n        const { height } = this.element;\n        const startx = -this.offset[0];\n        const starty = -this.offset[1];\n        const endx = startx + width / this.scale;\n        const endy = starty + height / this.scale;\n        this.visible_area[0] = startx;\n        this.visible_area[1] = starty;\n        this.visible_area[2] = endx - startx;\n        this.visible_area[3] = endy - starty;\n    }\n\n    onMouse(e) {\n        if (!this.enabled) {\n            return;\n        }\n\n        const canvas = this.element;\n        const rect = canvas.getBoundingClientRect();\n        const x = e.clientX - rect.left;\n        const y = e.clientY - rect.top;\n        e.canvasx = x;\n        e.canvasy = y;\n        e.dragging = this.dragging;\n\n        let ignore = false;\n        if (this.onmouse) {\n            ignore = this.onmouse(e);\n        }\n\n        if (e.type === \"mousedown\") {\n            this.dragging = true;\n            canvas.removeEventListener(\n                \"mousemove\",\n                this._binded_mouse_callback,\n            );\n            document.body.addEventListener(\n                \"mousemove\",\n                this._binded_mouse_callback,\n            );\n            document.body.addEventListener(\n                \"mouseup\",\n                this._binded_mouse_callback,\n            );\n        } else if (e.type === \"mousemove\") {\n            if (!ignore) {\n                const deltax = x - this.last_mouse[0];\n                const deltay = y - this.last_mouse[1];\n                if (this.dragging) {\n                    this.mouseDrag(deltax, deltay);\n                }\n            }\n        } else if (e.type === \"mouseup\") {\n            this.dragging = false;\n            document.body.removeEventListener(\n                \"mousemove\",\n                this._binded_mouse_callback,\n            );\n            document.body.removeEventListener(\n                \"mouseup\",\n                this._binded_mouse_callback,\n            );\n            canvas.addEventListener(\"mousemove\", this._binded_mouse_callback);\n        } else if (\n            e.type === \"mousewheel\"\n            || e.type === \"wheel\"\n            || e.type === \"DOMMouseScroll\"\n        ) {\n            e.eventType = \"mousewheel\";\n            if (e.type === \"wheel\") {\n                e.wheel = -e.deltaY;\n            } else {\n                e.wheel = e.wheelDeltaY != null ? e.wheelDeltaY : e.detail * -60;\n            }\n\n            // from stack overflow\n            if (e.wheelDelta) {\n                e.delta = e.wheelDelta / 40;\n            } else if (e.deltaY) {\n                e.delta = -e.deltaY / 3;\n            } else {\n                e.delta = 0;\n            }\n            this.changeDeltaScale(1.0 + e.delta * 0.05);\n        }\n\n        this.last_mouse[0] = x;\n        this.last_mouse[1] = y;\n\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n    }\n\n    toCanvasContext(ctx) {\n        ctx.scale(this.scale, this.scale);\n        ctx.translate(this.offset[0], this.offset[1]);\n    }\n\n    convertOffsetToCanvas(pos) {\n        // return [pos[0] / this.scale - this.offset[0], pos[1] / this.scale - this.offset[1]];\n        return [\n            (pos[0] + this.offset[0]) * this.scale,\n            (pos[1] + this.offset[1]) * this.scale,\n        ];\n    }\n\n    convertCanvasToOffset(pos, out) {\n        out = out || [0, 0];\n        out[0] = pos[0] / this.scale - this.offset[0];\n        out[1] = pos[1] / this.scale - this.offset[1];\n        return out;\n    }\n\n    mouseDrag(x, y) {\n        this.offset[0] += x / this.scale;\n        this.offset[1] += y / this.scale;\n\n        if (this.onredraw) {\n            this.onredraw(this);\n        }\n    }\n\n    changeScale(value, zoomingCenter) {\n        if (value < this.min_scale) {\n            value = this.min_scale;\n        } else if (value > this.max_scale) {\n            value = this.max_scale;\n        }\n\n        if (value === this.scale) {\n            return;\n        }\n\n        if (!this.element) {\n            return;\n        }\n\n        const rect = this.element.getBoundingClientRect();\n        if (!rect) {\n            return;\n        }\n\n        zoomingCenter = zoomingCenter || [\n            rect.width * 0.5,\n            rect.height * 0.5,\n        ];\n        const center = this.convertCanvasToOffset(zoomingCenter);\n        this.scale = value;\n        if (Math.abs(this.scale - 1) < 0.01) {\n            this.scale = 1;\n        }\n\n        const newCenter = this.convertCanvasToOffset(zoomingCenter);\n        const deltaOffset = [\n            newCenter[0] - center[0],\n            newCenter[1] - center[1],\n        ];\n\n        this.offset[0] += deltaOffset[0];\n        this.offset[1] += deltaOffset[1];\n\n        if (this.onredraw) {\n            this.onredraw(this);\n        }\n    }\n\n    changeDeltaScale(value, zoomingCenter) {\n        this.changeScale(this.scale * value, zoomingCenter);\n    }\n\n    reset() {\n        this.scale = 1;\n        this.offset[0] = 0;\n        this.offset[1] = 0;\n    }\n}\n","/**\n * @module File Utils\n */\nimport defaultConfig from \"./defaultConfig\";\n\nexport function getFileExtension(url) {\n    const question = url.indexOf(\"?\");\n    if (question !== -1) {\n        url = url.substr(0, question);\n    }\n    const point = url.lastIndexOf(\".\");\n    if (point === -1) {\n        return \"\";\n    }\n    return url.substr(point + 1).toLowerCase();\n}\n\n/**\n * Wrapper to load files (from url using fetch or from file using FileReader)\n * @method fetchFile\n * @param {String|File|Blob} url the url of the file (or the file itself)\n * @param {String} type an string to know how to fetch it:\n *     \"text\",\"arraybuffer\",\"json\",\"blob\"\n * @param {Function} onComplete callback(data)\n * @param {Function} onError in case of an error\n * @return {FileReader|Promise|void} returns the object used to\n */\nexport function fetchFile(url, type = \"text\", onComplete, onError) {\n    if (!url) return null;\n\n    if (url.constructor === String) {\n        if (url.substr(0, 4) === \"http\" && defaultConfig.proxy) {\n            url = defaultConfig.proxy + url.substr(url.indexOf(\":\") + 3);\n        }\n        return fetch(url)\n            .then((response) => {\n                if (!response.ok) throw new Error(\"File not found\"); // it will be catch\n                // below\n                if (type === \"arraybuffer\") return response.arrayBuffer();\n                if ([\"string\", \"text\"].includes(type)) return response.text();\n                if (type === \"json\") return response.json();\n                if (type === \"blob\") return response.blob();\n            })\n            .then((data) => {\n                if (onComplete) onComplete(data);\n            })\n            .catch((error) => {\n                console.error(\"error fetching file:\", url);\n                if (onError) onError(error);\n            });\n    }\n    if (url.constructor === File || url.constructor === Blob) {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n            let v = e.target.result;\n            if (type === \"json\") v = JSON.parse(v);\n            if (onComplete) onComplete(v);\n        };\n        if (type === \"arraybuffer\") return reader.readAsArrayBuffer(url);\n        if ([\"string\", \"text\"].includes(type)) return reader.readAsText(url);\n        if (type === \"blob\") return reader.readAsBinaryString(url);\n    }\n    return null;\n}\n","/**\n * ContextMenu from LiteGUI\n * @class ContextMenu\n * @constructor\n * @param {Array} values (allows object { title: \"Nice text\", callback: function ... })\n * @param {Object} options [optional] Some options:\\\n * - title: title to show on top of the menu\n * - callback: function to call when an option is clicked, it receives the item information\n * - ignore_item_callbacks: ignores the callback inside the item, it just calls the\n *     options.callback\n * - event: you can pass a MouseEvent, this way the ContextMenu appears in that position\n */\nexport default class ContextMenu {\n    constructor(values, options = {}) {\n        this.options = options;\n        const that = this;\n\n        // to link a menu with its parent\n        if (options.parentMenu) {\n            if (options.parentMenu.constructor !== this.constructor) {\n                console.error(\"parentMenu must be of class ContextMenu, ignoring it\");\n                options.parentMenu = null;\n            } else {\n                this.parentMenu = options.parentMenu;\n                this.parentMenu.lock = true;\n                this.parentMenu.current_submenu = this;\n            }\n        }\n\n        let eventClass = null;\n        if (options.event) eventClass = options.event.constructor.name;\n        if (eventClass !== \"MouseEvent\"\n            && eventClass !== \"CustomEvent\"\n            && eventClass !== \"PointerEvent\"\n        ) {\n            console.error(\n                \"Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it.\",\n            );\n            options.event = null;\n        }\n\n        const root = document.createElement(\"div\");\n        root.className = \"litegraph litecontextmenu litemenubar-panel\";\n        if (options.className) root.className += ` ${options.className}`;\n        root.style.minWidth = 100;\n        root.style.minHeight = 100;\n        root.style.pointerEvents = \"none\";\n        setTimeout(() => {\n            root.style.pointerEvents = \"auto\";\n        }, 100); // delay so the mouse up event is not caught by this element\n\n        // this prevents the default context browser menu to open in case this menu was created\n        // when pressing right button\n        root.addEventListener(\"mouseup\", (e) => {\n            e.preventDefault();\n            return true;\n        },\n        true);\n        root.addEventListener(\n            \"contextmenu\",\n            (e) => {\n                if (e.button !== 2) {\n                    // right button\n                    return false;\n                }\n                e.preventDefault();\n                return false;\n            },\n            true,\n        );\n\n        root.addEventListener(\n            \"mousedown\",\n            (e) => {\n                if (e.button === 2) {\n                    that.close();\n                    e.preventDefault();\n                    return true;\n                }\n            },\n            true,\n        );\n\n        function on_mouse_wheel(e) {\n            const pos = parseInt(root.style.top, 10);\n            root.style.top = `${(pos + e.deltaY * options.scroll_speed).toFixed()}px`;\n            e.preventDefault();\n            return true;\n        }\n\n        if (!options.scroll_speed) options.scroll_speed = 0.1;\n\n        root.addEventListener(\"wheel\", on_mouse_wheel, true);\n        root.addEventListener(\"mousewheel\", on_mouse_wheel, true);\n\n        this.root = root;\n\n        // title\n        if (options.title) {\n            const element = document.createElement(\"div\");\n            element.className = \"litemenu-title\";\n            element.innerHTML = options.title;\n            root.appendChild(element);\n        }\n\n        // entries\n        for (let i = 0; i < values.length; i++) {\n            let name = values.constructor === Array ? values[i] : i;\n            if (name && name.constructor !== String) {\n                name = name.content === undefined ? String(name) : name.content;\n            }\n            const value = values[i];\n            this.addItem(name, value, options);\n        }\n\n        // close on leave\n        root.addEventListener(\"mouseleave\", (e) => {\n            if (that.lock) return;\n            if (root.closing_timer) clearTimeout(root.closing_timer);\n            root.closing_timer = setTimeout(that.close.bind(that, e), 500);\n            // that.close(e);\n        });\n\n        root.addEventListener(\"mouseenter\", (e) => {\n            if (root.closing_timer) clearTimeout(root.closing_timer);\n        });\n\n        // insert before checking position\n        let rootDocument = document;\n        if (options.event) {\n            rootDocument = options.event.target.ownerDocument;\n        }\n\n        if (!rootDocument) {\n            rootDocument = document;\n        }\n\n        if (rootDocument.fullscreenElement) {\n            rootDocument.fullscreenElement.appendChild(root);\n        } else {\n            rootDocument.body.appendChild(root);\n        }\n\n        // compute best position\n        let left = options.left || 0;\n        let top = options.top || 0;\n        if (options.event) {\n            left = options.event.clientX - 10;\n            top = options.event.clientY - 10;\n            if (options.title) top -= 20;\n\n            if (options.parentMenu) {\n                const rect = options.parentMenu.root.getBoundingClientRect();\n                left = rect.left + rect.width;\n            }\n\n            const bodyRect = document.body.getBoundingClientRect();\n            const rootRect = root.getBoundingClientRect();\n            if (bodyRect.height === 0) console.error(\"document.body height is 0. That is dangerous, set html,body { height: 100%; }\");\n\n            if (bodyRect.width && left > bodyRect.width - rootRect.width - 10) {\n                left = bodyRect.width - rootRect.width - 10;\n            }\n            if (bodyRect.height && top > bodyRect.height - rootRect.height - 10) {\n                top = bodyRect.height - rootRect.height - 10;\n            }\n        }\n\n        root.style.left = `${left}px`;\n        root.style.top = `${top}px`;\n\n        if (options.scale) root.style.transform = `scale(${options.scale})`;\n    }\n\n    addItem(name, value, options = {}) {\n        const that = this;\n\n        const element = document.createElement(\"div\");\n        element.className = \"litemenu-entry submenu\";\n\n        let disabled = false;\n\n        if (value === null) element.classList.add(\"separator\");\n        else {\n            element.innerHTML = value && value.title ? value.title : name;\n            element.value = value;\n\n            if (value) {\n                if (value.disabled) {\n                    disabled = true;\n                    element.classList.add(\"disabled\");\n                }\n                if (value.submenu || value.has_submenu) element.classList.add(\"has_submenu\");\n            }\n\n            if (typeof value === \"function\") {\n                element.dataset.value = name;\n                element.onclick_callback = value;\n            } else element.dataset.value = value;\n\n            if (value.className) element.className += ` ${value.className}`;\n        }\n\n        this.root.appendChild(element);\n        if (!disabled) element.addEventListener(\"click\", inner_onclick);\n        if (options.autoopen) element.addEventListener(\"mouseenter\", inner_over);\n\n        function inner_over(e) {\n            const { value } = this;\n            if (!value || !value.has_submenu) return;\n            // if it is a submenu, autoopen like the item was clicked\n            inner_onclick.call(this, e);\n        }\n\n        // menu option clicked\n        function inner_onclick(e) {\n            const { value } = this;\n            let closeParent = true;\n\n            if (that.current_submenu) that.current_submenu.close(e);\n\n            // global callback\n            if (options.callback) {\n                const r = options.callback.call(\n                    this,\n                    value,\n                    options,\n                    e,\n                    that,\n                    options.node,\n                );\n                if (r === true) closeParent = false;\n            }\n\n            // special cases\n            if (value) {\n                if (\n                    value.callback\n                    && !options.ignore_item_callbacks\n                    && value.disabled !== true\n                ) {\n                    // item callback\n                    const r = value.callback.call(\n                        this,\n                        value,\n                        options,\n                        e,\n                        that,\n                        options.extra,\n                    );\n                    if (r === true) closeParent = false;\n                }\n                if (value.submenu) {\n                    if (!value.submenu.options) {\n                        throw new Error(\"ContextMenu submenu needs options\");\n                    }\n                    const submenu = new that.constructor(value.submenu.options, {\n                        callback: value.submenu.callback,\n                        event: e,\n                        parentMenu: that,\n                        ignore_item_callbacks:\n                        value.submenu.ignore_item_callbacks,\n                        title: value.submenu.title,\n                        extra: value.submenu.extra,\n                        autoopen: options.autoopen,\n                    });\n                    closeParent = false;\n                }\n            }\n\n            if (closeParent && !that.lock) that.close();\n        }\n\n        return element;\n    }\n\n    close(e, ignoreParentMenu) {\n        if (this.root.parentNode) {\n            this.root.remove()\n        }\n        if (this.parentMenu && !ignoreParentMenu) {\n            this.parentMenu.lock = false;\n            this.parentMenu.current_submenu = null;\n            if (e === undefined) this.parentMenu.close();\n            else if (e && !ContextMenu.isCursorOverElement(e, this.parentMenu.root)) {\n                ContextMenu.trigger(this.parentMenu.root, \"mouseleave\", e);\n            }\n        }\n        if (this.current_submenu) this.current_submenu.close(e, true);\n\n        if (this.root.closing_timer) clearTimeout(this.root.closing_timer);\n    }\n\n    // this code is used to trigger events easily (used in the context menu mouseleave\n    static trigger(element, eventName, params) {\n        const evt = document.createEvent(\"CustomEvent\");\n        evt.initCustomEvent(eventName, true, true, params); // canBubble, cancelable, detail\n        if (element.dispatchEvent) element.dispatchEvent(evt);\n        else if (element.__events) element.__events.dispatchEvent(evt);\n        // else nothing seems binded here so nothing to do\n        return evt;\n    }\n\n    // returns the top most menu\n    getTopMenu() {\n        if (this.options.parentMenu) return this.options.parentMenu.getTopMenu();\n        return this;\n    }\n\n    getFirstEvent() {\n        if (this.options.parentMenu) return this.options.parentMenu.getFirstEvent();\n        return this.options.event;\n    }\n\n    static closeAllContextMenus(ref_window = window) {\n        const elements = ref_window.document.querySelectorAll(\".litecontextmenu\");\n        if (!elements.length) {\n            return;\n        }\n\n        const result = [];\n        for (const el of elements) result.push(el);\n        for (const re of result) {\n            if (re.close) re.close();\n            else if (re.parentNode) re.remove();\n        }\n    }\n\n    static isCursorOverElement(event, element) {\n        const left = event.clientX;\n        const top = event.clientY;\n        const rect = element.getBoundingClientRect();\n        if (!rect) return false;\n        return top > rect.top\n            && top < rect.top + rect.height\n            && left > rect.left\n            && left < rect.left + rect.width;\n    }\n}\n","import DragAndScale from \"./DragAndScale\";\nimport { getFileExtension } from \"./utils/file\";\nimport ContextMenu from \"./ContextMenu\";\nimport { isValidConnection } from \"./utils/function\";\nimport LGraphNode from \"./LGraphNode\";\nimport { distance, isInsideRectangle, overlapBounding, clamp } from \"./utils/math\";\nimport LGraphGroup from \"./LGraphGroup\";\nimport * as registry from \"./utils/registry\";\nimport defaultConfig from \"./utils/defaultConfig\";\nimport getTime from \"./utils/time\";\n\nconst temp = new Float32Array(4);\nconst tempVC2 = new Float32Array(2);\nconst tempArea = new Float32Array(4);\nconst marginArea = new Float32Array(4);\nconst linkBounding = new Float32Array(4);\nconst tempA = new Float32Array(2);\nconst tempB = new Float32Array(2);\n\n/**\n * This class is in charge of rendering one graph inside a canvas. And provides all the\n * interaction required. Valid callbacks are: onNodeSelected, onNodeDeselected,\n * onShowNodePanel, onNodeDblClicked\n * @class LGraphCanvas\n * @constructor\n * @param {HTMLCanvasElement} canvas the canvas where you want to render\n *  (it accepts a selector in string format or the canvas element itself)\n * @param {LGraph} graph [optional]\n * @param {Object} options [optional] { skip_rendering, autoresize }\n */\nexport default class LGraphCanvas {\n    constructor(canvas, graph, options = {}) {\n        // if(graph === undefined)\n        // throw (\"No graph assigned\");\n        this.background_image = LGraphCanvas.DEFAULT_BACKGROUND_IMAGE;\n\n        if (canvas && canvas.constructor === String) {\n            canvas = document.querySelector(canvas);\n        }\n\n        this.ds = new DragAndScale();\n        this.zoom_modify_alpha = true; // otherwise it generates ugly patterns when scaling down\n        // too much\n\n        this.title_text_font = `${defaultConfig.NODE_TEXT_SIZE}px Arial`;\n        this.inner_text_font = `normal ${defaultConfig.NODE_SUBTEXT_SIZE}px Arial`;\n        this.node_title_color = defaultConfig.NODE_TITLE_COLOR;\n        this.default_link_color = defaultConfig.LINK_COLOR;\n        this.default_connection_color = {\n            input_off: \"#778\",\n            input_on: \"#7F7\",\n            output_off: \"#778\",\n            output_on: \"#7F7\",\n        };\n\n        this.highquality_render = true;\n        this.use_gradients = false; // set to true to render titlebar with gradients\n        this.editor_alpha = 1; // used for transition\n        this.pause_rendering = false;\n        this.clear_background = true;\n\n        this.read_only = false; // if set to true users cannot modify the graph\n        this.render_only_selected = true;\n        this.live_mode = false;\n        this.show_info = true;\n        this.allow_dragcanvas = true;\n        this.allow_dragnodes = true;\n        this.allow_interaction = true; // allow to control widgets, buttons, collapse, etc\n        this.allow_searchbox = true;\n        this.allow_reconnect_links = false; // allows to change a connection with having to redo it\n        // again\n\n        this.drag_mode = false;\n        this.dragging_rectangle = null;\n\n        this.filter = null; // allows to filter to only accept some type of nodes in a graph\n\n        this.set_canvas_dirty_on_mouse_event = true; // forces to redraw the canvas if the mouse\n        // does anything\n        this.always_render_background = false;\n        this.render_shadows = true;\n        this.render_canvas_border = true;\n        this.render_connections_shadows = false; // too much cpu\n        this.render_connections_border = true;\n        this.render_curved_connections = false;\n        this.render_connection_arrows = false;\n        this.render_collapsed_slots = true;\n        this.render_execution_order = false;\n        this.render_title_colored = true;\n        this.render_link_tooltip = true;\n\n        this.links_render_mode = defaultConfig.SPLINE_LINK;\n\n        this.mouse = [0, 0]; // mouse in canvas coordinates, where 0,0 is the top-left corner of\n        // the blue rectangle\n        this.graph_mouse = [0, 0]; // mouse in graph coordinates, where 0,0 is the top-left corner\n        // of the blue rectangle\n        this.canvas_mouse = this.graph_mouse; // LEGACY: REMOVE THIS, USE GRAPH_MOUSE INSTEAD\n\n        // to personalize the search box\n        this.onSearchBox = null;\n        this.onSearchBoxSelection = null;\n\n        // callbacks\n        this.onMouse = null;\n        this.onDrawBackground = null; // to render background objects (behind nodes and\n        // connections) in the canvas affected by transform\n        this.onDrawForeground = null; // to render foreground objects (above nodes and connections)\n        // in the canvas affected by transform\n        this.onDrawOverlay = null; // to render foreground objects not affected by transform (for\n        // GUIs)\n        this.onDrawLinkTooltip = null; // called when rendering a tooltip\n        this.onNodeMoved = null; // called after moving a node\n        this.onSelectionChange = null; // called if the selection changes\n        this.onConnectingChange = null; // called before any link changes\n        this.onBeforeChange = null; // called before modifying the graph\n        this.onAfterChange = null; // called after modifying the graph\n\n        this.connections_width = 3;\n        this.round_radius = 8;\n\n        this.current_node = null;\n        this.node_widget = null; // used for widgets\n        this.over_link_center = null;\n        this.last_mouse_position = [0, 0];\n        this.visible_area = this.ds.visible_area;\n        this.visible_links = [];\n\n        // link canvas and graph\n        if (graph) {\n            graph.attachCanvas(this);\n        }\n\n        this.setCanvas(canvas);\n        this.clear();\n\n        if (!options.skip_render) {\n            this.startRendering();\n        }\n\n        this.autoresize = options.autoresize;\n    }\n\n    static DEFAULT_BACKGROUND_IMAGE = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQBJREFUeNrs1rEKwjAUhlETUkj3vP9rdmr1Ysammk2w5wdxuLgcMHyptfawuZX4pJSWZTnfnu/lnIe/jNNxHHGNn//HNbbv+4dr6V+11uF527arU7+u63qfa/bnmh8sWLBgwYJlqRf8MEptXPBXJXa37BSl3ixYsGDBMliwFLyCV/DeLIMFCxYsWLBMwSt4Be/NggXLYMGCBUvBK3iNruC9WbBgwYJlsGApeAWv4L1ZBgsWLFiwYJmCV/AK3psFC5bBggULloJX8BpdwXuzYMGCBctgwVLwCl7Be7MMFixYsGDBsu8FH1FaSmExVfAxBa/gvVmwYMGCZbBg/W4vAQYA5tRF9QYlv/QAAAAASUVORK5CYII=\";\n\n    static link_type_colors = {\n        \"-1\": defaultConfig.EVENT_LINK_COLOR,\n        number: \"#AAA\",\n        node: \"#DCA\",\n    }\n\n    static gradients = {}\n\n    /**\n     * clears all the data inside\n     *\n     * @method clear\n     * @memberOf LGraphCanvas\n     */\n    clear() {\n        this.frame = 0;\n        this.last_draw_time = 0;\n        this.render_time = 0;\n        this.fps = 0;\n\n        // this.scale = 1;\n        // this.offset = [0,0];\n\n        this.dragging_rectangle = null;\n\n        this.selected_nodes = {};\n        this.selected_group = null;\n\n        this.visible_nodes = [];\n        this.node_dragged = null;\n        this.node_over = null;\n        this.node_capturing_input = null;\n        this.connecting_node = null;\n        this.highlighted_links = {};\n\n        this.dragging_canvas = false;\n\n        this.dirty_canvas = true;\n        this.dirty_bgcanvas = true;\n        this.dirty_area = null;\n\n        this.node_in_panel = null;\n        this.node_widget = null;\n\n        this.last_mouse = [0, 0];\n        this.last_mouseclick = 0;\n        this.visible_area.set([0, 0, 0, 0]);\n\n        if (this.onClear) this.onClear();\n    }\n\n    /**\n     * assigns a graph, you can reassign graphs to the same canvas\n     *\n     * @method setGraph\n     * @param {LGraph} graph\n     * @param {boolean=} skipClear\n     * @memberOf LGraphCanvas\n     */\n    setGraph(graph, skipClear) {\n        if (this.graph === graph) {\n            return;\n        }\n\n        if (!skipClear) this.clear();\n\n        if (!graph && this.graph) {\n            this.graph.detachCanvas(this);\n            return;\n        }\n\n        graph.attachCanvas(this);\n\n        // remove the graph stack in case a subgraph was open\n        if (this._graph_stack) this._graph_stack = null;\n\n        this.setDirty(true, true);\n    }\n\n    /**\n     * returns the top level graph (in case there are subgraphs open on the canvas)\n     *\n     * @method getTopGraph\n     * @return {LGraph} graph\n     * @memberOf LGraphCanvas\n     */\n    getTopGraph() {\n        if (this._graph_stack.length) return this._graph_stack[0];\n        return this.graph;\n    }\n\n    /**\n     * opens a graph contained inside a node in the current graph\n     *\n     * @method openSubgraph\n     * @param {LGraph} graph\n     * @memberOf LGraphCanvas\n     */\n    openSubgraph(graph) {\n        if (!graph) {\n            throw new Error(\"graph cannot be null\");\n        }\n\n        if (this.graph === graph) {\n            throw new Error(\"graph cannot be the same\");\n        }\n\n        this.clear();\n\n        if (this.graph) {\n            if (!this._graph_stack) {\n                this._graph_stack = [];\n            }\n            this._graph_stack.push(this.graph);\n        }\n\n        graph.attachCanvas(this);\n        this.checkPanels();\n        this.setDirty(true, true);\n    }\n\n    /**\n     * closes a subgraph contained inside a node\n     *\n     * @method closeSubgraph\n     * @memberOf LGraphCanvas\n     */\n    closeSubgraph() {\n        if (!this._graph_stack || this._graph_stack.length === 0) {\n            return;\n        }\n        const subgraphNode = this.graph._subgraph_node;\n        const graph = this._graph_stack.pop();\n        this.selected_nodes = {};\n        this.highlighted_links = {};\n        graph.attachCanvas(this);\n        this.setDirty(true, true);\n        if (subgraphNode) {\n            this.centerOnNode(subgraphNode);\n            this.selectNodes([subgraphNode]);\n        }\n    }\n\n    /**\n     * returns the visualy active graph (in case there are more in the stack)\n     * @method getCurrentGraph\n     * @return {LGraph} the active graph\n     * @memberOf LGraphCanvas\n     */\n    getCurrentGraph() {\n        return this.graph;\n    }\n\n    /**\n     * assigns a canvas\n     *\n     * @method setCanvas\n     * @param {HTMLCanvasElement | string | HTMLElement} canvas assigns a canvas\n     *  (also accepts the ID of the element (not a selector))\n     * @param {boolean} skipEvents\n     * @memberOf LGraphCanvas\n     */\n    setCanvas(canvas, skipEvents) {\n        if (canvas?.constructor === String) {\n            canvas = document.getElementById(canvas);\n            if (!canvas) {\n                throw new Error(\"Error creating LiteGraph canvas: Canvas not found\");\n            }\n        }\n\n        if (canvas === this.canvas) {\n            return;\n        }\n\n        if (!canvas && this.canvas) {\n            // maybe detach events from old_canvas\n            if (!skipEvents) {\n                this.unbindEvents();\n            }\n        }\n\n        this.canvas = canvas;\n        this.ds.element = canvas;\n\n        if (!canvas) return;\n\n        // this.canvas.tabindex = \"1000\";\n        canvas.className += \" lgraphcanvas\";\n        canvas.data = this;\n        canvas.tabindex = \"1\"; // to allow key events\n\n        // bg canvas: used for non changing stuff\n        this.bgcanvas = null;\n        this.bgcanvas = document.createElement(\"canvas\");\n        this.bgcanvas.width = this.canvas.width;\n        this.bgcanvas.height = this.canvas.height;\n\n        if (canvas.getContext === null) {\n            if (canvas.localName !== \"canvas\") {\n                throw new Error(`Element supplied for LGraphCanvas must be a <canvas> element, you passed a ${\n                    canvas.localName}`);\n            }\n            throw new Error(\"This browser doesn't support Canvas\");\n        }\n\n        this.ctx = canvas.getContext(\"2d\");\n        if (this.ctx == null) {\n            if (!canvas.webgl_enabled) {\n                console.warn(\n                    \"This canvas seems to be WebGL, enabling WebGL renderer\",\n                );\n            }\n            this.enableWebGL();\n        }\n\n        // input:  (move and up could be unbinded)\n        this._mousemove_callback = this.processMouseMove.bind(this);\n        this._mouseup_callback = this.processMouseUp.bind(this);\n\n        if (!skipEvents) this.bindEvents();\n    }\n\n    _doNothing(e) {\n        e.preventDefault();\n        return false;\n    }\n\n    _doReturnTrue(e) {\n        e.preventDefault();\n        return true;\n    }\n\n    /**\n     * binds mouse, keyboard, touch and drag events to the canvas\n     * @method bindEvents\n     * @memberOf LGraphCanvas\n     * */\n    bindEvents() {\n        if (this._events_binded) {\n            console.warn(\"LGraphCanvas: events already binded\");\n            return;\n        }\n\n        const { canvas } = this;\n\n        const refWindow = this.getCanvasWindow();\n        const { document } = refWindow; // hack used when moving canvas between windows\n\n        this._mousedown_callback = this.processMouseDown.bind(this);\n        this._mousewheel_callback = this.processMouseWheel.bind(this);\n\n        canvas.addEventListener(\"mousedown\", this._mousedown_callback, true); // down do not need\n        // to store the binded\n        canvas.addEventListener(\"mousemove\", this._mousemove_callback);\n        canvas.addEventListener(\"mousewheel\", this._mousewheel_callback);\n\n        canvas.addEventListener(\"contextmenu\", this._doNothing);\n        canvas.addEventListener(\"DOMMouseScroll\", this._mousewheel_callback);\n\n        canvas.addEventListener(\"touchstart\", this.touchHandler, true);\n        canvas.addEventListener(\"touchmove\", this.touchHandler, true);\n        canvas.addEventListener(\"touchend\", this.touchHandler, true);\n        canvas.addEventListener(\"touchcancel\", this.touchHandler, true);\n\n        // Keyboard ******************\n        this._key_callback = this.processKey.bind(this);\n\n        canvas.addEventListener(\"keydown\", this._key_callback, true);\n        document.addEventListener(\"keyup\", this._key_callback, true); // in document, otherwise it\n        // doesn't fire keyup\n\n        // Dropping Stuff over nodes ************************************\n        this._ondrop_callback = this.processDrop.bind(this);\n\n        canvas.addEventListener(\"dragover\", this._doNothing, false);\n        canvas.addEventListener(\"dragend\", this._doNothing, false);\n        canvas.addEventListener(\"drop\", this._ondrop_callback, false);\n        canvas.addEventListener(\"dragenter\", this._doReturnTrue, false);\n\n        this._events_binded = true;\n    }\n\n    /**\n     * unbinds mouse events from the canvas\n     * @method unbindEvents\n     * @memberOf LGraphCanvas\n     * */\n    unbindEvents() {\n        if (!this._events_binded) {\n            console.warn(\"LGraphCanvas: no events binded\");\n            return;\n        }\n\n        const refWindow = this.getCanvasWindow();\n        const { document } = refWindow;\n\n        this.canvas.removeEventListener(\"mousedown\", this._mousedown_callback);\n        this.canvas.removeEventListener(\n            \"mousewheel\",\n            this._mousewheel_callback,\n        );\n        this.canvas.removeEventListener(\n            \"DOMMouseScroll\",\n            this._mousewheel_callback,\n        );\n        this.canvas.removeEventListener(\"keydown\", this._key_callback);\n        document.removeEventListener(\"keyup\", this._key_callback);\n        this.canvas.removeEventListener(\"contextmenu\", this._doNothing);\n        this.canvas.removeEventListener(\"drop\", this._ondrop_callback);\n        this.canvas.removeEventListener(\"dragenter\", this._doReturnTrue);\n\n        this.canvas.removeEventListener(\"touchstart\", this.touchHandler);\n        this.canvas.removeEventListener(\"touchmove\", this.touchHandler);\n        this.canvas.removeEventListener(\"touchend\", this.touchHandler);\n        this.canvas.removeEventListener(\"touchcancel\", this.touchHandler);\n\n        this._mousedown_callback = null;\n        this._mousewheel_callback = null;\n        this._key_callback = null;\n        this._ondrop_callback = null;\n\n        this._events_binded = false;\n    }\n\n    /**\n     * this function allows to render the canvas using WebGL instead of Canvas2D\n     * this is useful if you plant to render 3D objects inside your nodes, it uses litegl.js for\n     * webgl and canvas2DtoWebGL to emulate the Canvas2D calls in webGL\n     * @method enableWebGL\n     * @memberOf LGraphCanvas\n     * */\n    enableWebGL() {\n        if (!GL) throw new Error(\"litegl.js must be included to use a WebGL canvas\");\n        if (!enableWebGLCanvas) throw new Error(\"webglCanvas.js must be included to use this feature\");\n\n        this.ctx = enableWebGLCanvas(this.canvas);\n        this.gl = this.ctx;\n        this.ctx.webgl = true;\n        this.bgcanvas = this.canvas;\n        this.bgctx = this.gl;\n        this.canvas.webgl_enabled = true;\n    }\n\n    /**\n     * marks as dirty the canvas, this way it will be rendered again\n     *\n     * @class LGraphCanvas\n     * @method setDirty\n     * @param {boolean} [fgcanvas] if the foreground canvas is dirty (the one containing the nodes)\n     * @param {boolean} [bgcanvas] if the background canvas is dirty (the one containing the wires)\n     * @memberOf LGraphCanvas\n     */\n    setDirty(fgcanvas, bgcanvas) {\n        if (fgcanvas) this.dirty_canvas = true;\n        if (bgcanvas) this.dirty_bgcanvas = true;\n    }\n\n    /**\n     * Used to attach the canvas in a popup\n     *\n     * @method getCanvasWindow\n     * @return {Window} returns the window where the canvas is attached (the DOM root node)\n     * @memberOf LGraphCanvas\n     */\n    getCanvasWindow() {\n        if (!this.canvas) return window;\n        const doc = this.canvas.ownerDocument;\n        return doc.defaultView;\n    }\n\n    /**\n     * starts rendering the content of the canvas when needed\n     *\n     * @method startRendering\n     * @memberOf LGraphCanvas\n     */\n    startRendering() {\n        if (this.is_rendering) return;\n\n        this.is_rendering = true;\n        this.renderFrame();\n    }\n\n    /**\n     * render a frame\n     *\n     * @method renderFrame\n     * @memberOf LGraphCanvas\n     */\n    renderFrame() {\n        if (!this.pause_rendering) this.draw();\n\n        const window = this.getCanvasWindow();\n        if (this.is_rendering) window.requestAnimationFrame(() => this.renderFrame());\n    }\n\n    /**\n     * stops rendering the content of the canvas (to save resources)\n     *\n     * @method stopRendering\n     * @memberOf LGraphCanvas\n     */\n    stopRendering() {\n        this.is_rendering = false;\n    }\n\n    /* LiteGraphCanvas input */\n\n    /**\n     * used to block future mouse events (because of im gui)\n     *\n     * @method blockClick\n     * @memberOf LGraphCanvas\n     */\n    blockClick() {\n        this.block_click = true;\n        this.last_mouseclick = 0;\n    }\n\n    processMouseDown(e) {\n        if (this.set_canvas_dirty_on_mouse_event) this.dirty_canvas = true;\n\n        if (!this.graph) return;\n\n        this.adjustMouseEvent(e);\n\n        const refWindow = this.getCanvasWindow();\n        LGraphCanvas.active_canvas = this;\n\n        // move mouse move event to the window in case it drags outside of the canvas\n        this.canvas.removeEventListener(\"mousemove\", this._mousemove_callback);\n        refWindow.document.addEventListener(\"mousemove\", this._mousemove_callback, true); // catch for the entire window\n        refWindow.document.addEventListener(\"mouseup\", this._mouseup_callback, true);\n\n        const node = this.graph.getNodeOnPos(e.canvasX, e.canvasY, this.visible_nodes, 5);\n        let skipAction = false;\n        const now = getTime();\n        const isDoubleClick = now - this.last_mouseclick < 300;\n        this.mouse[0] = e.localX;\n        this.mouse[1] = e.localY;\n        this.graph_mouse[0] = e.canvasX;\n        this.graph_mouse[1] = e.canvasY;\n        this.last_click_position = [this.mouse[0], this.mouse[1]];\n\n        this.canvas.focus();\n\n        ContextMenu.closeAllContextMenus(refWindow);\n\n        if (this.onMouse) {\n            if (this.onMouse(e)) return;\n        }\n\n        // left button mouse\n        if (e.which === 1) {\n            if (e.ctrlKey) {\n                this.dragging_rectangle = new Float32Array(4);\n                this.dragging_rectangle[0] = e.canvasX;\n                this.dragging_rectangle[1] = e.canvasY;\n                this.dragging_rectangle[2] = 1;\n                this.dragging_rectangle[3] = 1;\n                skipAction = true;\n            }\n\n            let clickingCanvasBg = false;\n\n            // when clicked on top of a node\n            // and it is not interactive\n            if (node && this.allow_interaction && !skipAction && !this.read_only) {\n                if (!this.live_mode && !node.flags.pinned) {\n                    this.bringToFront(node);\n                } // if it wasn't selected?\n\n                // not dragging mouse to connect two slots\n                if (!this.connecting_node && !node.flags.collapsed && !this.live_mode) {\n                // Search for corner for resize\n                    if (!skipAction\n                    && node.resizable\n                    && isInsideRectangle(\n                        e.canvasX,\n                        e.canvasY,\n                        node.pos[0] + node.size[0] - 5,\n                        node.pos[1] + node.size[1] - 5,\n                        1010,\n                    )\n                    ) {\n                        this.graph.beforeChange();\n                        this.resizing_node = node;\n                        this.canvas.style.cursor = \"se-resize\";\n                        skipAction = true;\n                    } else {\n                    // search for outputs\n                        if (node.outputs) {\n                            for (let i = 0, l = node.outputs.length; i < l; i++) {\n                                const output = node.outputs[i];\n                                const linkPos = node.getConnectionPos(false, i);\n                                if (isInsideRectangle(\n                                    e.canvasX,\n                                    e.canvasY,\n                                    linkPos[0] - 15,\n                                    linkPos[1] - 10,\n                                    30,\n                                    20,\n                                )) {\n                                    this.connecting_node = node;\n                                    this.connecting_output = output;\n                                    this.connecting_pos = node.getConnectionPos(false, i);\n                                    this.connecting_slot = i;\n                                    if (e.shiftKey) {\n                                        node.disconnectOutput(i);\n                                    }\n\n                                    if (isDoubleClick) {\n                                        if (node.onOutputDblClick) {\n                                            node.onOutputDblClick(i, e);\n                                        }\n                                    } else if (node.onOutputClick) {\n                                        node.onOutputClick(i, e);\n                                    }\n\n                                    skipAction = true;\n                                    break;\n                                }\n                            }\n                        }\n\n                        // search for inputs\n                        if (node.inputs) {\n                            for (let i = 0, l = node.inputs.length; i < l; i++) {\n                                const input = node.inputs[i];\n                                const linkPos = node.getConnectionPos(true, i);\n                                if (isInsideRectangle(\n                                    e.canvasX,\n                                    e.canvasY,\n                                    linkPos[0] - 15,\n                                    linkPos[1] - 10,\n                                    30, 20,\n                                )) {\n                                    if (isDoubleClick) {\n                                        if (node.onInputDblClick) {\n                                            node.onInputDblClick(i, e);\n                                        }\n                                    } else if (node.onInputClick) {\n                                        node.onInputClick(i, e);\n                                    }\n\n                                    if (input.link) {\n                                        const linkInfo = this.graph.links[\n                                            input.link\n                                        ]; // before disconnecting\n                                        node.disconnectInput(i);\n\n                                        if (\n                                            this.allow_reconnect_links\n                                            || e.shiftKey\n                                        ) {\n                                            this.connecting_node = this.graph._nodes_by_id[\n                                                linkInfo.origin_id\n                                            ];\n                                            this.connecting_slot = linkInfo.origin_slot;\n                                            this.connecting_output = this.connecting_node.outputs[\n                                                this.connecting_slot\n                                            ];\n\n                                            this.connecting_pos = this.connecting_node\n                                                .getConnectionPos(false, this.connecting_slot);\n                                        }\n\n                                        this.dirty_bgcanvas = true;\n                                        skipAction = true;\n                                    }\n                                }\n                            }\n                        }\n                    } // not resizing\n                }\n\n                // it wasn't clicked on the links boxes\n                if (!skipAction) {\n                    let blockDragNote = false;\n                    const pos = [e.canvasX - node.pos[0], e.canvasY - node.pos[1]];\n\n                    // widgets\n                    const widget = this.processNodeWidgets(node, this.graph_mouse, e);\n                    if (widget) {\n                        blockDragNote = true;\n                        this.node_widget = [node, widget];\n                    }\n\n                    // double clicking\n                    if (isDoubleClick && this.selected_nodes[node.id]) {\n                        // double click node\n                        if (node.onDblClick) {\n                            node.onDblClick(e, pos, this);\n                        }\n                        this.processNodeDblClicked(node);\n                        blockDragNote = true;\n                    }\n\n                    // if do not capture mouse\n                    if (node.onMouseDown && node.onMouseDown(e, pos, this)) {\n                        blockDragNote = true;\n                    } else {\n                        // open subgraph button\n                        if (node.subgraph && !node.skip_subgraph_button) {\n                            if (!node.flags.collapsed && pos[0]\n                                > node.size[0] - defaultConfig.NODE_TITLE_HEIGHT\n                                && pos[1] < 0) {\n                                setTimeout(() => {\n                                    this.openSubgraph(node.subgraph);\n                                }, 10);\n                            }\n                        }\n\n                        if (this.live_mode) {\n                            clickingCanvasBg = true;\n                            blockDragNote = true;\n                        }\n                    }\n\n                    if (!blockDragNote) {\n                        if (this.allow_dragnodes) {\n                            this.graph.beforeChange();\n                            this.node_dragged = node;\n                        }\n                        if (!this.selected_nodes[node.id]) {\n                            this.processNodeSelected(node, e);\n                        }\n                    }\n\n                    this.dirty_canvas = true;\n                }\n            } else {\n                // search for link connector\n                if (!this.read_only) {\n                    for (const link of this.visible_links) {\n                        const center = link._pos;\n                        if (\n                            !center\n                            || e.canvasX < center[0] - 4\n                            || e.canvasX > center[0] + 4\n                            || e.canvasY < center[1] - 4\n                            || e.canvasY > center[1] + 4\n                        ) {\n                            continue;\n                        }\n                        // link clicked\n                        this.showLinkMenu(link, e);\n                        this.over_link_center = null; // clear tooltip\n                        break;\n                    }\n                }\n\n                this.selected_group = this.graph.getGroupOnPos(e.canvasX, e.canvasY);\n                this.selected_group_resizing = false;\n                if (this.selected_group && !this.read_only) {\n                    if (e.ctrlKey) this.dragging_rectangle = null;\n\n                    const dist = distance([e.canvasX, e.canvasY],\n                        [this.selected_group.pos[0] + this.selected_group.size[0],\n                            this.selected_group.pos[1] + this.selected_group.size[1]]);\n                    if (dist * this.ds.scale < 10) {\n                        this.selected_group_resizing = true;\n                    } else {\n                        this.selected_group.recomputeInsideNodes();\n                    }\n                }\n\n                if (isDoubleClick && !this.read_only && this.allow_searchbox) {\n                    this.showSearchBox(e);\n                }\n\n                clickingCanvasBg = true;\n            }\n\n            if (!skipAction && clickingCanvasBg && this.allow_dragcanvas) {\n                this.dragging_canvas = true;\n            }\n        } else if (e.which === 2) {\n            // middle button\n        } else if (e.which === 3) {\n            // right button\n            if (!this.read_only) this.processContextMenu(node, e);\n        }\n\n        // TODO\n        // if(this.node_selected != prev_selected)\n        //\tthis.onNodeSelectionChange(this.node_selected);\n\n        this.last_mouse[0] = e.localX;\n        this.last_mouse[1] = e.localY;\n        this.last_mouseclick = getTime();\n        this.last_mouse_dragging = true;\n\n        /*\n    if( (this.dirty_canvas || this.dirty_bgcanvas) && this.rendering_timer_id == null)\n    this.draw();\n    */\n\n        this.graph.change();\n\n        // this is to ensure to defocus(blur) if a text input element is on focus\n        if (\n            !refWindow.document.activeElement\n            || (refWindow.document.activeElement.nodeName.toLowerCase()\n            !== \"input\"\n            && refWindow.document.activeElement.nodeName.toLowerCase()\n            !== \"textarea\")) {\n            e.preventDefault();\n        }\n        e.stopPropagation();\n\n        if (this.onMouseDown) {\n            this.onMouseDown(e);\n        }\n\n        return false;\n    }\n\n    /**\n     * Called when a mouse move event has to be processed\n     * @method processMouseMove\n     * @memberOf LGraphCanvas\n     * */\n    processMouseMove(e) {\n        if (this.autoresize) this.resize();\n\n        if (this.set_canvas_dirty_on_mouse_event) this.dirty_canvas = true;\n\n        if (!this.graph) return;\n\n        LGraphCanvas.active_canvas = this;\n        this.adjustMouseEvent(e);\n        const mouse = [e.localX, e.localY];\n        this.mouse[0] = mouse[0];\n        this.mouse[1] = mouse[1];\n        const delta = [\n            mouse[0] - this.last_mouse[0],\n            mouse[1] - this.last_mouse[1],\n        ];\n        this.last_mouse = mouse;\n        this.graph_mouse[0] = e.canvasX;\n        this.graph_mouse[1] = e.canvasY;\n\n        if (this.block_click) {\n            e.preventDefault();\n            return false;\n        }\n\n        e.dragging = this.last_mouse_dragging;\n\n        if (this.node_widget) {\n            this.processNodeWidgets(this.node_widget[0], this.graph_mouse, e, this.node_widget[1]);\n            this.dirty_canvas = true;\n        }\n\n        if (this.dragging_rectangle) {\n            this.dragging_rectangle[2] = e.canvasX - this.dragging_rectangle[0];\n            this.dragging_rectangle[3] = e.canvasY - this.dragging_rectangle[1];\n            this.dirty_canvas = true;\n        } else if (this.selected_group && !this.read_only) {\n            // moving/resizing a group\n            if (this.selected_group_resizing) {\n                this.selected_group.size = [\n                    e.canvasX - this.selected_group.pos[0],\n                    e.canvasY - this.selected_group.pos[1],\n                ];\n            } else {\n                const deltax = delta[0] / this.ds.scale;\n                const deltay = delta[1] / this.ds.scale;\n                this.selected_group.move(deltax, deltay, e.ctrlKey);\n                if (this.selected_group._nodes.length) this.dirty_canvas = true;\n            }\n            this.dirty_bgcanvas = true;\n        } else if (this.dragging_canvas) {\n            this.ds.offset[0] += delta[0] / this.ds.scale;\n            this.ds.offset[1] += delta[1] / this.ds.scale;\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n        } else if (this.allow_interaction && !this.read_only) {\n            if (this.connecting_node) this.dirty_canvas = true;\n\n            // get node over\n            const node = this.graph.getNodeOnPos(e.canvasX, e.canvasY, this.visible_nodes);\n\n            // remove mouseover flag\n            for (const _node of this.graph._nodes) {\n                if (_node.mouseOver && node !== _node) {\n                    // mouse leave\n                    _node.mouseOver = false;\n                    if (this.node_over && this.node_over.onMouseLeave) {\n                        this.node_over.onMouseLeave(e);\n                    }\n                    this.node_over = null;\n                    this.dirty_canvas = true;\n                }\n            }\n\n            // mouse over a node\n            if (node) {\n                if (node.redraw_on_mouse) this.dirty_canvas = true;\n\n                // this.canvas.style.cursor = \"move\";\n                if (!node.mouseOver) {\n                    // mouse enter\n                    node.mouseOver = true;\n                    this.node_over = node;\n                    this.dirty_canvas = true;\n\n                    if (node.onMouseEnter) node.onMouseEnter(e);\n                }\n\n                // in case the node wants to do something\n                if (node.onMouseMove) {\n                    node.onMouseMove(e, [e.canvasX - node.pos[0], e.canvasY - node.pos[1]], this);\n                }\n\n                // if dragging a link\n                if (this.connecting_node) {\n                    const pos = this._highlight_input || [0, 0];\n\n                    // on top of input\n                    if (this.isOverNodeBox(node, e.canvasX, e.canvasY)) {\n                        // mouse on top of the corner box, don't know what to do\n                    } else {\n                        // check if I have a slot below de mouse\n                        const slot = this.isOverNodeInput(node, e.canvasX, e.canvasY, pos);\n                        if (slot !== -1 && node.inputs[slot]) {\n                            const slotType = node.inputs[slot].type;\n                            if (isValidConnection(this.connecting_output.type, slotType)) {\n                                this._highlight_input = pos;\n                            }\n                        } else this._highlight_input = null;\n                    }\n                }\n\n                // Search for corner\n                if (this.canvas) {\n                    if (isInsideRectangle(\n                        e.canvasX,\n                        e.canvasY,\n                        node.pos[0] + node.size[0] - 5,\n                        node.pos[1] + node.size[1] - 5,\n                        5,\n                        5,\n                    )) {\n                        this.canvas.style.cursor = \"se-resize\";\n                    } else this.canvas.style.cursor = \"crosshair\";\n                }\n            } else { // not over a node\n                // search for link connector\n                let overLink = null;\n                for (const link of this.visible_links) {\n                    const center = link._pos;\n                    if (!center\n                        || e.canvasX < center[0] - 4\n                        || e.canvasX > center[0] + 4\n                        || e.canvasY < center[1] - 4\n                        || e.canvasY > center[1] + 4) {\n                        continue;\n                    }\n                    overLink = link;\n                    break;\n                }\n                if (overLink !== this.over_link_center) {\n                    this.over_link_center = overLink;\n                    this.dirty_canvas = true;\n                }\n\n                if (this.canvas) this.canvas.style.cursor = \"\";\n            } // end\n\n            // send event to node if capturing input (used with widgets that allow drag outside of\n            // the area of the node)\n            if (this.node_capturing_input && this.node_capturing_input !== node && this.node_capturing_input.onMouseMove) {\n                this.node_capturing_input.onMouseMove(e, [e.canvasX - this.node_capturing_input.pos[0], e.canvasY - this.node_capturing_input.pos[1]], this);\n            }\n\n            // node being dragged\n            if (this.node_dragged && !this.live_mode) {\n                for (const nKeys of Object.keys(this.selected_nodes)) {\n                    const n = this.selected_nodes[nKeys];\n                    n.pos[0] += delta[0] / this.ds.scale;\n                    n.pos[1] += delta[1] / this.ds.scale;\n                }\n\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n            }\n\n            if (this.resizing_node && !this.live_mode) {\n                // convert mouse to node space\n                const desiredSize = [\n                    e.canvasX - this.resizing_node.pos[0],\n                    e.canvasY - this.resizing_node.pos[1],\n                ];\n                const minSize = this.resizing_node.computeSize();\n                desiredSize[0] = Math.max(minSize[0], desiredSize[0]);\n                desiredSize[1] = Math.max(minSize[1], desiredSize[1]);\n                this.resizing_node.setSize(desiredSize);\n\n                this.canvas.style.cursor = \"se-resize\";\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n            }\n        }\n\n        e.preventDefault();\n        return false;\n    }\n\n    /**\n     * Called when a mouse up event has to be processed\n     * @method processMouseUp\n     * @memberOf LGraphCanvas\n     * */\n    processMouseUp(e) {\n        if (this.set_canvas_dirty_on_mouse_event) this.dirty_canvas = true;\n\n        if (!this.graph) return;\n\n        const window = this.getCanvasWindow();\n        const { document } = window;\n        LGraphCanvas.active_canvas = this;\n\n        // restore the mousemove event back to the canvas\n        document.removeEventListener(\"mousemove\", this._mousemove_callback, true);\n        this.canvas.addEventListener(\"mousemove\", this._mousemove_callback, true);\n        document.removeEventListener(\"mouseup\", this._mouseup_callback, true);\n\n        this.adjustMouseEvent(e);\n        const now = getTime();\n        e.click_time = now - this.last_mouseclick;\n        this.last_mouse_dragging = false;\n        this.last_click_position = null;\n\n        if (this.block_click) this.block_click = false;\n        // used to avoid sending twice a click in a immediate button\n\n        if (e.which === 1) {\n            if (this.node_widget) this.processNodeWidgets(this.node_widget[0], this.graph_mouse, e);\n\n            // left button\n            this.node_widget = null;\n\n            if (this.selected_group) {\n                const diffx = this.selected_group.pos[0]\n                    - Math.round(this.selected_group.pos[0]);\n                const diffy = this.selected_group.pos[1]\n                    - Math.round(this.selected_group.pos[1]);\n\n                this.selected_group.move(diffx, diffy, e.ctrlKey);\n\n                this.selected_group.pos[0] = Math.round(this.selected_group.pos[0]);\n                this.selected_group.pos[1] = Math.round(this.selected_group.pos[1]);\n\n                if (this.selected_group._nodes.length) this.dirty_canvas = true;\n                this.selected_group = null;\n            }\n            this.selected_group_resizing = false;\n\n            if (this.dragging_rectangle) {\n                if (this.graph) {\n                    const nodes = this.graph._nodes;\n                    const nodeBounding = new Float32Array(4);\n                    this.deselectAllNodes();\n                    // compute bounding and flip if left to right\n                    const w = Math.abs(this.dragging_rectangle[2]);\n                    const h = Math.abs(this.dragging_rectangle[3]);\n                    const startx = this.dragging_rectangle[2] < 0\n                        ? this.dragging_rectangle[0] - w\n                        : this.dragging_rectangle[0];\n                    const starty = this.dragging_rectangle[3] < 0\n                        ? this.dragging_rectangle[1] - h\n                        : this.dragging_rectangle[1];\n                    this.dragging_rectangle[0] = startx;\n                    this.dragging_rectangle[1] = starty;\n                    this.dragging_rectangle[2] = w;\n                    this.dragging_rectangle[3] = h;\n\n                    // test against all nodes (not visible because the rectangle maybe start outside\n                    const toSelect = [];\n\n                    for (const node of nodes) {\n                        node.getBounding(nodeBounding);\n                        if (\n                            !overlapBounding(\n                                this.dragging_rectangle,\n                                nodeBounding,\n                            )\n                        ) {\n                            continue;\n                        } // out of the visible area\n                        toSelect.push(node);\n                    }\n                    if (toSelect.length) {\n                        this.selectNodes(toSelect);\n                    }\n                }\n                this.dragging_rectangle = null;\n            } else if (this.connecting_node) {\n                // dragging a connection\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n\n                const node = this.graph.getNodeOnPos(\n                    e.canvasX,\n                    e.canvasY,\n                    this.visible_nodes,\n                );\n\n                // node below mouse\n                if (node) {\n                    if (\n                        this.connecting_output.type === defaultConfig.EVENT\n                        && this.isOverNodeBox(node, e.canvasX, e.canvasY)\n                    ) {\n                        this.connecting_node.connect(this.connecting_slot, node, defaultConfig.EVENT);\n                    } else {\n                        // slot below mouse? connect\n                        const slot = this.isOverNodeInput(node, e.canvasX, e.canvasY);\n                        if (slot !== -1) {\n                            this.connecting_node.connect(this.connecting_slot, node, slot);\n                        } else {\n                            // not on top of an input\n                            const input = node.getInputInfo(0);\n                            // auto connect\n                            if (this.connecting_output.type === defaultConfig.EVENT) {\n                                this.connecting_node.connect(\n                                    this.connecting_slot, node,\n                                    defaultConfig.EVENT,\n                                );\n                            } else if (\n                                input\n                                && !input.link\n                                && isValidConnection(\n                                    input.type && this.connecting_output.type,\n                                )\n                            ) {\n                                this.connecting_node.connect(this.connecting_slot, node, 0);\n                            }\n                        }\n                    }\n                }\n\n                this.connecting_output = null;\n                this.connecting_pos = null;\n                this.connecting_node = null;\n                this.connecting_slot = -1;\n            } else if (this.resizing_node) {\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n                this.graph.afterChange(this.resizing_node);\n                this.resizing_node = null;\n            } else if (this.node_dragged) {\n                // node being dragged?\n                const node = this.node_dragged;\n                if (\n                    node\n                    && e.click_time < 300\n                    && isInsideRectangle(\n                        e.canvasX,\n                        e.canvasY,\n                        node.pos[0],\n                        node.pos[1] - defaultConfig.NODE_TITLE_HEIGHT,\n                        defaultConfig.NODE_TITLE_HEIGHT,\n                        defaultConfig.NODE_TITLE_HEIGHT,\n                    )\n                ) {\n                    node.collapse();\n                }\n\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n                this.node_dragged.pos[0] = Math.round(this.node_dragged.pos[0]);\n                this.node_dragged.pos[1] = Math.round(this.node_dragged.pos[1]);\n                if (this.graph.config.align_to_grid) {\n                    this.node_dragged.alignToGrid();\n                }\n                if (this.onNodeMoved) this.onNodeMoved(this.node_dragged);\n                this.graph.afterChange(this.node_dragged);\n                this.node_dragged = null;\n            } else {\n                // get node over\n                const node = this.graph.getNodeOnPos(\n                    e.canvasX,\n                    e.canvasY,\n                    this.visible_nodes,\n                );\n\n                if (!node && e.click_time < 300) {\n                    this.deselectAllNodes();\n                }\n\n                this.dirty_canvas = true;\n                this.dragging_canvas = false;\n\n                if (this.node_over && this.node_over.onMouseUp) {\n                    this.node_over.onMouseUp(e, [e.canvasX - this.node_over.pos[0], e.canvasY - this.node_over.pos[1]], this);\n                }\n                if (\n                    this.node_capturing_input\n                    && this.node_capturing_input.onMouseUp\n                ) {\n                    this.node_capturing_input.onMouseUp(e, [\n                        e.canvasX - this.node_capturing_input.pos[0],\n                        e.canvasY - this.node_capturing_input.pos[1],\n                    ]);\n                }\n            }\n        } else if (e.which === 2) {\n            // middle button\n            // trace(\"middle\");\n            this.dirty_canvas = true;\n            this.dragging_canvas = false;\n        } else if (e.which === 3) {\n            // right button\n            // trace(\"right\");\n            this.dirty_canvas = true;\n            this.dragging_canvas = false;\n        }\n\n        this.graph.change();\n\n        e.stopPropagation();\n        e.preventDefault();\n        return false;\n    }\n\n    /**\n     * Called when a mouse wheel event has to be processed\n     * @method processMouseWheel\n     * @memberOf LGraphCanvas\n     * */\n    processMouseWheel(e) {\n        if (!this.graph || !this.allow_dragcanvas) {\n            return;\n        }\n\n        const delta = e.wheelDeltaY ?? e.detail * -60;\n\n        this.adjustMouseEvent(e);\n\n        let { scale } = this.ds;\n\n        if (delta > 0) {\n            scale *= 1.1;\n        } else if (delta < 0) {\n            scale *= 1 / 1.1;\n        }\n\n        // this.setZoom( scale, [ e.localX, e.localY ] );\n        this.ds.changeScale(scale, [e.localX, e.localY]);\n\n        this.graph.change();\n\n        e.preventDefault();\n        return false; // prevent default\n    }\n\n    /**\n     * returns true if a position (in graph space) is on top of a node little corner box\n     * @method isOverNodeBox\n     * @memberOf LGraphCanvas\n     * */\n    isOverNodeBox(node, canvasx, canvasy) {\n        const titleHeight = defaultConfig.NODE_TITLE_HEIGHT;\n        return !!isInsideRectangle(\n            canvasx,\n            canvasy,\n            node.pos[0] + 2,\n            node.pos[1] + 2 - titleHeight,\n            titleHeight - 4,\n            titleHeight - 4,\n        );\n    }\n\n    /**\n     * returns true if a position (in graph space) is on top of a node input slot\n     * @method isOverNodeInput\n     * @memberOf LGraphCanvas\n     * */\n    isOverNodeInput(\n        node,\n        canvasx,\n        canvasy,\n        slotPos,\n    ) {\n        if (node.inputs) {\n            for (let i = 0, l = node.inputs.length; i < l; ++i) {\n                const linkPos = node.getConnectionPos(true, i);\n                let isInside = false;\n                if (node.horizontal) {\n                    isInside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        linkPos[0] - 5,\n                        linkPos[1] - 10,\n                        10,\n                        20,\n                    );\n                } else {\n                    isInside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        linkPos[0] - 10,\n                        linkPos[1] - 5,\n                        40,\n                        10,\n                    );\n                }\n                if (isInside) {\n                    if (slotPos) {\n                        slotPos[0] = linkPos[0];\n                        slotPos[1] = linkPos[1];\n                    }\n                    return i;\n                }\n            }\n        }\n        return -1;\n    }\n\n    /**\n     * process a key event\n     * @method processKey\n     * @memberOf LGraphCanvas\n     * */\n    processKey(e) {\n        if (!this.graph) return;\n\n        let blockDefault = false;\n\n        if (e.target.localName === \"input\") {\n            return;\n        }\n\n        if (e.type === \"keydown\") {\n            if (e.keyCode === 32) {\n                // esc\n                this.dragging_canvas = true;\n                blockDefault = true;\n            }\n\n            // select all Control A\n            if (e.keyCode === 65 && e.ctrlKey) {\n                this.selectNodes();\n                blockDefault = true;\n            }\n\n            if (e.code === \"KeyC\" && (e.metaKey || e.ctrlKey) && !e.shiftKey) {\n                // copy\n                if (this.selected_nodes) {\n                    this.copyToClipboard();\n                    blockDefault = true;\n                }\n            }\n\n            if (e.code === \"KeyV\" && (e.metaKey || e.ctrlKey) && !e.shiftKey) {\n                // paste\n                this.pasteFromClipboard();\n            }\n\n            // delete or backspace\n            if ((e.keyCode === 46 || e.keyCode === 8)\n                && (e.target.localName !== \"input\" && e.target.localName !== \"textarea\")) {\n                this.deleteSelectedNodes();\n                blockDefault = true;\n            }\n\n            // collapse\n            // ...\n\n            // TODO\n            if (this.selected_nodes) {\n                for (var i in this.selected_nodes) {\n                    if (this.selected_nodes[i].onKeyDown) {\n                        this.selected_nodes[i].onKeyDown(e);\n                    }\n                }\n            }\n        } else if (e.type == \"keyup\") {\n            if (e.keyCode == 32) {\n                this.dragging_canvas = false;\n            }\n\n            if (this.selected_nodes) {\n                for (var i in this.selected_nodes) {\n                    if (this.selected_nodes[i].onKeyUp) {\n                        this.selected_nodes[i].onKeyUp(e);\n                    }\n                }\n            }\n        }\n\n        this.graph.change();\n\n        if (blockDefault) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            return false;\n        }\n    }\n\n    pasteFromClipboard() {\n        const data = localStorage.getItem(\"litegrapheditor_clipboard\");\n        if (!data) return;\n\n        this.graph.beforeChange();\n\n        // create nodes\n        const clipboardInfo = JSON.parse(data);\n        const nodes = [];\n        for (const node_data of clipboardInfo.nodes) {\n            const node = LGraphNode.createNode(node_data.type);\n            if (node) {\n                node.configure(node_data);\n                node.pos[0] += 5;\n                node.pos[1] += 5;\n                this.graph.add(node);\n                nodes.push(node);\n            }\n        }\n\n        for (const link_info of clipboardInfo.links) {\n            const origin_node = nodes[link_info[0]];\n            const target_node = nodes[link_info[2]];\n            if (origin_node && target_node) origin_node.connect(link_info[1], target_node, link_info[3]);\n            else console.warn(\"Warning, nodes missing on pasting\");\n        }\n\n        this.selectNodes(nodes);\n\n        this.graph.afterChange();\n    }\n\n    copyToClipboard() {\n        const clipboardInfo = {\n            nodes: [],\n            links: [],\n        };\n        let index = 0;\n        const selectedNodesArray = [];\n\n        // eslint-disable-next-line guard-for-in, no-restricted-syntax\n        for (const i in this.selected_nodes) {\n            const node = this.selected_nodes[i];\n            node.relative_id = index;\n            selectedNodesArray.push(node);\n            index += 1;\n        }\n\n        for (const node of selectedNodesArray) {\n            const cloned = node.clone();\n            if (!cloned) {\n                console.warn(`node type not found: ${node.type}`);\n                continue;\n            }\n            clipboardInfo.nodes.push(cloned.serialize());\n            if (node.inputs && node.inputs.length) {\n                for (let j = 0; j < node.inputs.length; ++j) {\n                    const input = node.inputs[j];\n                    if (!input || input.link == null) {\n                        continue;\n                    }\n                    const link_info = this.graph.links[input.link];\n                    if (!link_info) {\n                        continue;\n                    }\n                    const target_node = this.graph.getNodeById(\n                        link_info.origin_id,\n                    );\n                    if (!target_node || !this.selected_nodes[target_node.id]) {\n                        // improve this by allowing connections to non-selected nodes\n                        continue;\n                    } // not selected\n                    clipboardInfo.links.push([\n                        target_node._relative_id,\n                        link_info.origin_slot, // j,\n                        node._relative_id,\n                        link_info.target_slot,\n                    ]);\n                }\n            }\n        }\n\n        localStorage.setItem(\"litegrapheditor_clipboard\", JSON.stringify(clipboardInfo));\n    }\n\n    /**\n     * process a item drop event on top the canvas\n     * @method processDrop\n     * @memberOf LGraphCanvas\n     * */\n    processDrop(e) {\n        e.preventDefault();\n        this.adjustMouseEvent(e);\n\n        const pos = [e.canvasX, e.canvasY];\n        const node = this.graph ? this.graph.getNodeOnPos(pos[0], pos[1]) : null;\n\n        if (!node) {\n            let r = null;\n            if (this.onDropItem) r = this.onDropItem(e);\n            if (!r) {\n                this.checkDropItem(e);\n            }\n            return;\n        }\n\n        if (node.onDropFile || node.onDropData) {\n            const { files } = e.dataTransfer;\n            if (files && files.length) {\n                for (const file of files) {\n                    const filename = file.name;\n                    // console.log(file);\n\n                    if (node.onDropFile) {\n                        node.onDropFile(file);\n                    }\n\n                    if (node.onDropData) {\n                        // prepare reader\n                        const reader = new FileReader();\n                        reader.onload = (event) => {\n                            // console.log(event.target);\n                            const data = event.target.result;\n                            node.onDropData(data, filename, file);\n                        };\n\n                        // read data\n                        const type = file.type.split(\"/\")[0];\n                        if (type === \"text\" || type === \"\") {\n                            reader.readAsText(file);\n                        } else if (type === \"image\") {\n                            reader.readAsDataURL(file);\n                        } else {\n                            reader.readAsArrayBuffer(file);\n                        }\n                    }\n                }\n            }\n        }\n\n        if (node.onDropItem) {\n            if (node.onDropItem(e)) {\n                return true;\n            }\n        }\n\n        if (this.onDropItem) {\n            return this.onDropItem(e);\n        }\n\n        return false;\n    }\n\n    checkDropItem(e) {\n        if (e.dataTransfer.files.length) {\n            const file = e.dataTransfer.files[0];\n            const ext = getFileExtension(file.name).toLowerCase();\n            const nodetype = defaultConfig.node_types_by_file_extension[ext];\n            if (nodetype) {\n                this.graph.beforeChange();\n                const node = LGraphNode.createNode(nodetype.type);\n                node.pos = [e.canvasX, e.canvasY];\n                this.graph.add(node);\n                if (node.onDropFile) {\n                    node.onDropFile(file);\n                }\n                this.graph.afterChange();\n            }\n        }\n    }\n\n    processNodeDblClicked(n) {\n        if (this.onShowNodePanel) this.onShowNodePanel(n);\n        else this.showShowNodePanel(n);\n\n        if (this.onNodeDblClicked) this.onNodeDblClicked(n);\n\n        this.setDirty(true);\n    }\n\n    processNodeSelected(node, e) {\n        this.selectNode(node, e && e.shiftKey);\n        if (this.onNodeSelected) {\n            this.onNodeSelected(node);\n        }\n    }\n\n    /**\n     * selects a given node (or adds it to the current selection)\n     * @method selectNode\n     * @param {LGraphNode} node\n     * @param {boolean} addToCurrentSelection\n     * @memberOf LGraphCanvas\n     * */\n    selectNode(node, addToCurrentSelection) {\n        if (node == null) {\n            this.deselectAllNodes();\n        } else {\n            this.selectNodes([node], addToCurrentSelection);\n        }\n    }\n\n    /**\n     * selects several nodes (or adds them to the current selection)\n     * @method selectNodes\n     * @memberOf LGraphCanvas\n     * */\n    selectNodes(nodes = this.graph._nodes, addToCurrentSelection) {\n        if (!addToCurrentSelection) this.deselectAllNodes();\n\n        for (const node of nodes) {\n            if (node.is_selected) continue;\n\n            if (!node.is_selected && node.onSelected) node.onSelected();\n            node.is_selected = true;\n            this.selected_nodes[node.id] = node;\n\n            if (node.inputs) {\n                for (const input of node.inputs) this.highlighted_links[input.link] = true;\n            }\n\n            if (node.outputs) {\n                for (const out of node.outputs) {\n                    if (out.links) {\n                        for (const link of out.links) this.highlighted_links[link] = true;\n                    }\n                }\n            }\n        }\n\n        if (this.onSelectionChange) this.onSelectionChange(this.selected_nodes);\n\n        this.setDirty(true);\n    }\n\n    /**\n     * removes a node from the current selection\n     * @method deselectNode\n     * @memberOf LGraphCanvas\n     * */\n    deselectNode(node) {\n        if (!node.is_selected) return;\n        if (node.onDeselected) {\n            node.onDeselected();\n        }\n        node.is_selected = false;\n\n        if (this.onNodeDeselected) {\n            this.onNodeDeselected(node);\n        }\n\n        // remove highlighted\n        if (node.inputs) {\n            for (const input of node.inputs) delete this.highlighted_links[input.link];\n        }\n        if (node.outputs) {\n            for (const out of node.outputs) {\n                if (out.links) {\n                    for (const link of out.links) delete this.highlighted_links[link];\n                }\n            }\n        }\n    }\n\n    /**\n     * removes all nodes from the current selection\n     * @method deselectAllNodes\n     * @memberOf LGraphCanvas\n     * */\n    deselectAllNodes() {\n        if (!this.graph) return;\n        for (const node of this.graph._nodes) {\n            if (!node.is_selected) {\n                continue;\n            }\n            if (node.onDeselected) {\n                node.onDeselected();\n            }\n            node.is_selected = false;\n            if (this.onNodeDeselected) {\n                this.onNodeDeselected(node);\n            }\n        }\n        this.selected_nodes = {};\n        this.current_node = null;\n        this.highlighted_links = {};\n        if (this.onSelectionChange) this.onSelectionChange(this.selected_nodes);\n        this.setDirty(true);\n    }\n\n    /**\n     * deletes all nodes in the current selection from the graph\n     * @method deleteSelectedNodes\n     * @memberOf LGraphCanvas\n     * */\n    deleteSelectedNodes() {\n        this.graph.beforeChange();\n\n        // eslint-disable-next-line guard-for-in, no-restricted-syntax\n        for (const i in this.selected_nodes) {\n            const node = this.selected_nodes[i];\n\n            if (node.block_delete) continue;\n\n            // autoconnect when possible (very basic, only takes into account first input-output)\n            if (node.inputs\n                && node.inputs.length\n                && node.outputs\n                && node.outputs.length\n                && isValidConnection(node.inputs[0].type, node.outputs[0].type)\n                && node.inputs[0].link\n                && node.outputs[0].links\n                && node.outputs[0].links.length) {\n                const inputLink = node.graph.links[node.inputs[0].link];\n                const outputLink = node.graph.links[node.outputs[0].links[0]];\n                const inputNode = node.getInputNode(0);\n                const outputNode = node.getOutputNodes(0)[0];\n                if (inputNode && outputNode) {\n                    inputNode.connect(inputLink.origin_slot, outputNode, outputLink.target_slot);\n                }\n            }\n            this.graph.remove(node);\n            if (this.onNodeDeselected) this.onNodeDeselected(node);\n        }\n\n        this.selected_nodes = {};\n        this.current_node = null;\n        this.highlighted_links = {};\n        this.setDirty(true);\n        this.graph.afterChange();\n    }\n\n    /**\n     * centers the camera on a given node\n     * @method centerOnNode\n     * @memberOf LGraphCanvas\n     * */\n    centerOnNode(node) {\n        this.ds.offset[0] = -node.pos[0]\n            - node.size[0] * 0.5\n            + (this.canvas.width * 0.5) / this.ds.scale;\n        this.ds.offset[1] = -node.pos[1]\n            - node.size[1] * 0.5\n            + (this.canvas.height * 0.5) / this.ds.scale;\n        this.setDirty(true, true);\n    }\n\n    /**\n     * adds some useful properties to a mouse event, like the position in graph coordinates\n     * @method adjustMouseEvent\n     * @memberOf LGraphCanvas\n     * */\n    adjustMouseEvent(e) {\n        if (this.canvas) {\n            const b = this.canvas.getBoundingClientRect();\n            e.localX = e.clientX - b.left;\n            e.localY = e.clientY - b.top;\n        } else {\n            e.localX = e.clientX;\n            e.localY = e.clientY;\n        }\n\n        e.deltaX = e.localX - this.last_mouse_position[0];\n        e.deltaY = e.localY - this.last_mouse_position[1];\n\n        this.last_mouse_position[0] = e.localX;\n        this.last_mouse_position[1] = e.localY;\n\n        e.canvasX = e.localX / this.ds.scale - this.ds.offset[0];\n        e.canvasY = e.localY / this.ds.scale - this.ds.offset[1];\n    }\n\n    /**\n     * changes the zoom level of the graph (default is 1), you can pass also a place used to pivot\n     * the zoom\n     * @method setZoom\n     * @memberOf LGraphCanvas\n     * */\n    setZoom(value, zoomingCenter) {\n        this.ds.changeScale(value, zoomingCenter);\n        this.dirty_canvas = true;\n        this.dirty_bgcanvas = true;\n    }\n\n    /**\n     * converts a coordinate from graph coordinates to canvas2D coordinates\n     * @method convertOffsetToCanvas\n     * @memberOf LGraphCanvas\n     * */\n    convertOffsetToCanvas(pos) {\n        return this.ds.convertOffsetToCanvas(pos);\n    }\n\n    /**\n     * converts a coordinate from Canvas2D coordinates to graph space\n     * @method convertCanvasToOffset\n     * @memberOf LGraphCanvas\n     * */\n    convertCanvasToOffset(pos, out) {\n        return this.ds.convertCanvasToOffset(pos, out);\n    }\n\n    /**\n     * converts event coordinates from canvas2D to graph coordinates\n     * @method convertEventToCanvasOffset\n     * @param e\n     * @returns {Array}\n     * @memberOf LGraphCanvas\n     */\n    convertEventToCanvasOffset(e) {\n        const rect = this.canvas.getBoundingClientRect();\n        return this.convertCanvasToOffset([e.clientX - rect.left, e.clientY - rect.top]);\n    }\n\n    /**\n     * brings a node to front (above all other nodes)\n     * @method bringToFront\n     * @param {LGraphNode} node\n     * @memberOf LGraphCanvas\n     * */\n    bringToFront(node) {\n        const i = this.graph._nodes.indexOf(node);\n        if (i === -1) {\n            return;\n        }\n\n        this.graph._nodes.splice(i, 1);\n        this.graph._nodes.push(node);\n    }\n\n    /**\n     * sends a node to the back (below all other nodes)\n     * @method sendToBack\n     * @param {LGraphNode} node\n     * @memberOf LGraphCanvas\n     * */\n    sendToBack(node) {\n        const i = this.graph._nodes.indexOf(node);\n        if (i === -1) {\n            return;\n        }\n\n        this.graph._nodes.splice(i, 1);\n        this.graph._nodes.unshift(node);\n    }\n\n    /**\n     * checks which nodes are visible (inside the camera area)\n     * @method computeVisibleNodes\n     * @param {LGraphNode[]} [nodes]\n     * @param {LGraphNode[]} [out]\n     * @return {LGraphNode[]}\n     * @memberOf LGraphCanvas\n     * */\n    computeVisibleNodes(nodes, out = []) {\n        const visibleNodes = out;\n        nodes = this.graph._nodes;\n        visibleNodes.length = 0;\n        for (const n of nodes) {\n            // skip rendering nodes in live mode\n            if (this.live_mode && !n.onDrawBackground && !n.onDrawForeground) {\n                continue;\n            }\n\n            if (!overlapBounding(this.visible_area, n.getBounding(temp))) {\n                continue;\n            } // out of the visible area\n\n            visibleNodes.push(n);\n        }\n        return visibleNodes;\n    }\n\n    /**\n     * renders the whole canvas content, by rendering in two separated canvas, one containing the\n     * background grid and the connections, and one containing the nodes)\n     * @method draw\n     * @param {boolean} [force_canvas]\n     * @param {boolean} [force_bgcanvas]\n     * @memberOf LGraphCanvas\n     * */\n    draw(force_canvas, force_bgcanvas) {\n        if (!this.canvas || this.canvas.width === 0 || this.canvas.height === 0) return;\n\n        // fps counting\n        const now = getTime();\n        this.render_time = (now - this.last_draw_time) * 0.001;\n        this.last_draw_time = now;\n\n        if (this.graph) this.ds.computeVisibleArea();\n\n        if (\n            this.dirty_bgcanvas\n            || force_bgcanvas\n            || this.always_render_background\n            || (this.graph\n            && this.graph._last_trigger_time\n            && now - this.graph._last_trigger_time < 1000)\n        ) this.drawBackCanvas();\n\n        if (this.dirty_canvas || force_canvas) this.drawFrontCanvas();\n\n        this.fps = this.render_time ? 1.0 / this.render_time : 0;\n        this.frame += 1;\n    }\n\n    /**\n     * draws the front canvas (the one containing all the nodes)\n     * @method drawFrontCanvas\n     * @memberOf LGraphCanvas\n     * */\n    drawFrontCanvas() {\n        this.dirty_canvas = false;\n\n        if (!this.ctx) this.ctx = this.bgcanvas.getContext(\"2d\");\n        const { ctx } = this;\n        if (!ctx) return;\n\n        if (ctx.start2D) {\n            ctx.start2D();\n        }\n\n        const { canvas } = this;\n\n        // reset in case of error\n        ctx.restore();\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\n\n        // clip dirty area if there is one, otherwise work in full canvas\n        if (this.dirty_area) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.rect(\n                this.dirty_area[0],\n                this.dirty_area[1],\n                this.dirty_area[2],\n                this.dirty_area[3],\n            );\n            ctx.clip();\n        }\n\n        if (this.clear_background) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n        // draw bg canvas\n        if (this.bgcanvas === this.canvas) {\n            this.drawBackCanvas();\n        } else {\n            ctx.drawImage(this.bgcanvas, 0, 0);\n        }\n\n        // rendering\n        if (this.onRender) this.onRender(canvas, ctx);\n\n        // info widget\n        if (this.show_info) this.renderInfo(ctx);\n\n        if (this.graph) {\n            // apply transformations\n            ctx.save();\n            this.ds.toCanvasContext(ctx);\n\n            // draw nodes\n            let drawnNodes = 0;\n            const visibleNodes = this.computeVisibleNodes(null, this.visible_nodes);\n\n            for (const node of visibleNodes) {\n                // transform coords system\n                ctx.save();\n                ctx.translate(node.pos[0], node.pos[1]);\n\n                // Draw\n                this.drawNode(node, ctx);\n                drawnNodes += 1;\n\n                // Restore\n                ctx.restore();\n            }\n\n            // on top (debug)\n            if (this.render_execution_order) this.drawExecutionOrder(ctx);\n\n            // connections ontop?\n            if (this.graph.config.links_ontop && !this.live_mode) this.drawConnections(ctx);\n\n            // current connection (the one being dragged by the mouse)\n            if (this.connecting_pos) {\n                ctx.lineWidth = this.connections_width;\n                let linkColor = null;\n                switch (this.connecting_output.type) {\n                    case defaultConfig.EVENT:\n                        linkColor = defaultConfig.EVENT_LINK_COLOR;\n                        break;\n                    default:\n                        linkColor = defaultConfig.CONNECTING_LINK_COLOR;\n                }\n\n                // the connection being dragged by the mouse\n                this.renderLink(\n                    ctx,\n                    this.connecting_pos,\n                    [this.graph_mouse[0], this.graph_mouse[1]],\n                    null,\n                    false,\n                    null,\n                    linkColor,\n                    this.connecting_output.dir\n                    || (this.connecting_node.horizontal ? defaultConfig.DOWN : defaultConfig.RIGHT),\n                    defaultConfig.CENTER,\n                );\n\n                ctx.beginPath();\n                if (\n                    this.connecting_output.type === defaultConfig.EVENT\n                    || this.connecting_output.shape === defaultConfig.BOX_SHAPE\n                ) {\n                    ctx.rect(\n                        this.connecting_pos[0] - 6 + 0.5,\n                        this.connecting_pos[1] - 5 + 0.5,\n                        14,\n                        10,\n                    );\n                } else {\n                    ctx.arc(\n                        this.connecting_pos[0],\n                        this.connecting_pos[1],\n                        4,\n                        0,\n                        Math.PI * 2,\n                    );\n                }\n                ctx.fill();\n\n                ctx.fillStyle = \"#ffcc00\";\n                if (this._highlight_input) {\n                    ctx.beginPath();\n                    ctx.arc(\n                        this._highlight_input[0],\n                        this._highlight_input[1],\n                        6,\n                        0,\n                        Math.PI * 2,\n                    );\n                    ctx.fill();\n                }\n            }\n\n            // the selection rectangle\n            if (this.dragging_rectangle) {\n                ctx.strokeStyle = \"#FFF\";\n                ctx.strokeRect(\n                    this.dragging_rectangle[0],\n                    this.dragging_rectangle[1],\n                    this.dragging_rectangle[2],\n                    this.dragging_rectangle[3],\n                );\n            }\n\n            // on top of link center\n            if (this.over_link_center && this.render_link_tooltip) {\n                this.drawLinkTooltip(ctx, this.over_link_center);\n            } else if (this.onDrawLinkTooltip) {\n                this.onDrawLinkTooltip(ctx, null);\n            }\n\n            // custom info\n            if (this.onDrawForeground) {\n                this.onDrawForeground(ctx, this.visible_rect);\n            }\n\n            ctx.restore();\n        }\n\n        // draws panel in the corner\n        if (this._graph_stack && this._graph_stack.length) this.drawSubgraphPanel(ctx);\n\n        if (this.onDrawOverlay) this.onDrawOverlay(ctx);\n\n        if (this.dirty_area) ctx.restore();\n\n        if (ctx.finish2D) ctx.finish2D();\n    }\n\n    /**\n     * draws the panel in the corner that shows subgraph properties\n     * @method drawSubgraphPanel\n     * @memberOf LGraphCanvas\n     * */\n    drawSubgraphPanel(ctx) {\n        const subgraph = this.graph;\n        const subnode = subgraph._subgraph_node;\n        if (!subnode) {\n            console.warn(\"subgraph without subnode\");\n            return;\n        }\n\n        const num = subnode.inputs ? subnode.inputs.length : 0;\n        const w = 300;\n        const h = Math.floor(defaultConfig.NODE_SLOT_HEIGHT * 1.6);\n\n        ctx.fillStyle = \"#111\";\n        ctx.globalAlpha = 0.8;\n        ctx.beginPath();\n        ctx.roundRect(10, 10, w, (num + 1) * h + 50, 8);\n        ctx.fill();\n        ctx.globalAlpha = 1;\n\n        ctx.fillStyle = \"#888\";\n        ctx.font = \"14px Arial\";\n        ctx.textAlign = \"left\";\n        ctx.fillText(\"Graph Inputs\", 20, 34);\n\n        if (this.drawButton(w - 20, 20, 20, 20, \"X\", \"#151515\")) {\n            this.closeSubgraph();\n            return;\n        }\n\n        let y = 50;\n        ctx.font = \"20px Arial\";\n        if (subnode.inputs) {\n            for (const input of subnode.inputs) {\n                if (input.not_subgraph_input) continue;\n\n                // input button clicked\n                if (this.drawButton(20, y + 2, w - 20, h - 2)) {\n                    const type = subnode.constructor.input_node_type || \"graph/input\";\n                    this.graph.beforeChange();\n                    const newnode = createNode(type);\n                    if (newnode) {\n                        subgraph.add(newnode);\n                        this.block_click = false;\n                        this.last_click_position = null;\n                        this.selectNodes([newnode]);\n                        this.node_dragged = newnode;\n                        this.dragging_canvas = false;\n                        newnode.setProperty(\"name\", input.name);\n                        newnode.setProperty(\"type\", input.type);\n                        this.node_dragged.pos[0] = this.graph_mouse[0] - 5;\n                        this.node_dragged.pos[1] = this.graph_mouse[1] - 5;\n                        this.graph.afterChange();\n                    } else {\n                        console.error(\"graph input node not found:\", type);\n                    }\n                }\n\n                ctx.fillStyle = \"#9C9\";\n                ctx.beginPath();\n                ctx.arc(w - 16, y + h * 0.5, 5, 0, 2 * Math.PI);\n                ctx.fill();\n\n                ctx.fillStyle = \"#AAA\";\n                ctx.fillText(input.name, 50, y + h * 0.75);\n                const tw = ctx.measureText(input.name);\n                ctx.fillStyle = \"#777\";\n                ctx.fillText(input.type, 50 + tw.width + 10, y + h * 0.75);\n\n                y += h;\n            }\n        }\n\n        // add + button\n        if (this.drawButton(20, y + 2, w - 20, h - 2, \"+\", \"#151515\", \"#222\")) {\n            this.showSubgraphPropertiesDialog(subnode);\n        }\n    }\n\n    /**\n     * Draws a button into the canvas overlay and computes if it was clicked using the immediate\n     * gui paradigm\n     * @method drawButton\n     * @param x\n     * @param y\n     * @param w\n     * @param h\n     * @param text\n     * @param [bgcolor]\n     * @param [hovercolor]\n     * @param [textcolor]\n     * @returns {*|boolean}\n     * @memberOf LGraphCanvas\n     */\n    drawButton(x, y, w, h, text, bgcolor = defaultConfig.NODE_DEFAULT_COLOR, hovercolor = \"#555\", textcolor = defaultConfig.NODE_TEXT_COLOR) {\n        const { ctx } = this;\n\n        let pos = this.mouse;\n        const hover = isInsideRectangle(pos[0], pos[1], x, y, w, h);\n        pos = this.last_click_position;\n        const clicked = pos && isInsideRectangle(pos[0], pos[1], x, y, w, h);\n\n        ctx.fillStyle = hover ? hovercolor : bgcolor;\n        if (clicked) ctx.fillStyle = \"#AAA\";\n        ctx.beginPath();\n        ctx.roundRect(x, y, w, h, 4);\n        ctx.fill();\n\n        if (text) {\n            if (text.constructor === String) {\n                ctx.fillStyle = textcolor;\n                ctx.textAlign = \"center\";\n                // eslint-disable-next-line\n                ctx.font = `${(h * 0.65) | 0}px Arial`;\n                ctx.fillText(text, x + w * 0.5, y + h * 0.75);\n                ctx.textAlign = \"left\";\n            }\n        }\n\n        if (clicked) this.blockClick();\n        return clicked && !this.block_click;\n    }\n\n    isAreaClicked(x, y, w, h, holdClick) {\n        const pos = this.last_click_position;\n        const clicked = pos && isInsideRectangle(pos[0], pos[1], x, y, w, h);\n        if (clicked && holdClick) this.blockClick();\n        return clicked && !this.block_click;\n    }\n\n    /**\n     * draws some useful stats in the corner of the canvas\n     * @method renderInfo\n     * @memberOf LGraphCanvas\n     * */\n    renderInfo(ctx, x = 10, y = this.canvas.height - 80) {\n        ctx.save();\n        ctx.translate(x, y);\n\n        ctx.font = \"10px Arial\";\n        ctx.fillStyle = \"#888\";\n        if (this.graph) {\n            ctx.fillText(`T: ${this.graph.globaltime.toFixed(2)}s`, 5, 13);\n            ctx.fillText(`I: ${this.graph.iteration}`, 5, 13 * 2);\n            ctx.fillText(`N: ${this.graph._nodes.length} [${this.visible_nodes.length}]`, 5, 13 * 3);\n            ctx.fillText(`V: ${this.graph._version}`, 5, 13 * 4);\n            ctx.fillText(`FPS:${this.fps.toFixed(2)}`, 5, 13 * 5);\n        } else {\n            ctx.fillText(\"No graph selected\", 5, 13);\n        }\n        ctx.restore();\n    }\n\n    /**\n     * draws the back canvas (the one containing the background and the connections)\n     * @method drawBackCanvas\n     * @memberOf LGraphCanvas\n     * */\n    drawBackCanvas() {\n        const canvas = this.bgcanvas;\n        if (canvas.width !== this.canvas.width || canvas.height !== this.canvas.height) {\n            canvas.width = this.canvas.width;\n            canvas.height = this.canvas.height;\n        }\n\n        if (!this.bgctx) this.bgctx = this.bgcanvas.getContext(\"2d\");\n        const ctx = this.bgctx;\n        if (ctx.start) ctx.start();\n\n        // clear\n        if (this.clear_background) ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n        if (this._graph_stack && this._graph_stack.length) {\n            ctx.save();\n            const subgraphNode = this.graph._subgraph_node;\n            ctx.strokeStyle = subgraphNode.bgcolor;\n            ctx.lineWidth = 10;\n            ctx.strokeRect(1, 1, canvas.width - 2, canvas.height - 2);\n            ctx.lineWidth = 1;\n            ctx.font = \"40px Arial\";\n            ctx.textAlign = \"center\";\n            ctx.fillStyle = subgraphNode.bgcolor || \"#AAA\";\n            let title = \"\";\n\n            for (const g of this._graph_stack) {\n                title += `${g._subgraph_node.getTitle()} >> `;\n            }\n\n            ctx.fillText(\n                title + subgraphNode.getTitle(),\n                canvas.width * 0.5,\n                40,\n            );\n            ctx.restore();\n        }\n\n        let bgAlreadyPainted = false;\n        if (this.onRenderBackground) {\n            bgAlreadyPainted = this.onRenderBackground(canvas, ctx);\n        }\n\n        // reset in case of error\n        ctx.restore();\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\n        this.visible_links.length = 0;\n\n        if (this.graph) {\n            // apply transformations\n            ctx.save();\n            this.ds.toCanvasContext(ctx);\n\n            // render BG\n            if (this.background_image && this.ds.scale > 0.5 && !bgAlreadyPainted) {\n                ctx.globalAlpha = this.zoom_modify_alpha\n                    ? (1.0 - 0.5 / this.ds.scale) * this.editor_alpha\n                    : this.editor_alpha;\n\n                ctx.imageSmoothingEnabled = false;\n                ctx.mozImageSmoothingEnabled = false;\n                ctx.imageSmoothingEnabled = false;\n                if (\n                    !this._bg_img\n                    || this._bg_img.id !== this.background_image\n                ) {\n                    this._bg_img = new Image();\n                    this._bg_img.id = this.background_image;\n                    this._bg_img.src = this.background_image;\n                    this._bg_img.onload = () => this.draw(true, true);\n                }\n\n                let pattern = null;\n                if (this._pattern == null && this._bg_img.width > 0) {\n                    pattern = ctx.createPattern(this._bg_img, \"repeat\");\n                    this._pattern_img = this._bg_img;\n                    this._pattern = pattern;\n                } else {\n                    pattern = this._pattern;\n                }\n                if (pattern) {\n                    ctx.fillStyle = pattern;\n                    ctx.fillRect(\n                        this.visible_area[0],\n                        this.visible_area[1],\n                        this.visible_area[2],\n                        this.visible_area[3],\n                    );\n                    ctx.fillStyle = \"transparent\";\n                }\n\n                ctx.globalAlpha = 1.0;\n                ctx.imageSmoothingEnabled = true;\n                ctx.mozImageSmoothingEnabled = true;\n                ctx.imageSmoothingEnabled = true;\n            }\n\n            // groups\n            if (this.graph._groups.length && !this.live_mode) this.drawGroups(canvas, ctx);\n\n            if (this.onDrawBackground) this.onDrawBackground(ctx, this.visible_area);\n\n            // bg\n            if (this.render_canvas_border) {\n                ctx.strokeStyle = \"#235\";\n                ctx.strokeRect(0, 0, canvas.width, canvas.height);\n            }\n\n            if (this.render_connections_shadows) {\n                ctx.shadowColor = \"#000\";\n                ctx.shadowOffsetX = 0;\n                ctx.shadowOffsetY = 0;\n                ctx.shadowBlur = 6;\n            } else {\n                ctx.shadowColor = \"rgba(0,0,0,0)\";\n            }\n\n            // draw connections\n            if (!this.live_mode) this.drawConnections(ctx);\n\n            ctx.shadowColor = \"rgba(0,0,0,0)\";\n\n            ctx.restore();\n        }\n\n        if (ctx.finish) ctx.finish();\n\n        this.dirty_bgcanvas = false;\n        this.dirty_canvas = true; // to force to repaint the front canvas with the bgcanvas\n    }\n\n    /**\n     * draws the given node inside the canvas\n     * @method drawNode\n     * @memberOf LGraphCanvas\n     * */\n    drawNode(node, ctx) {\n        let glow = false;\n        this.current_node = node;\n\n        const color = node.color || node.constructor.color || defaultConfig.NODE_DEFAULT_COLOR;\n        let bgcolor = node.bgcolor || node.constructor.bgcolor || defaultConfig.NODE_DEFAULT_BGCOLOR;\n\n        // shadow and glow\n        if (node.mouseOver) glow = true;\n\n        const lowQuality = this.ds.scale < 0.6; // zoomed out\n\n        // only render if it forces it to do it\n        if (this.live_mode) {\n            if (!node.flags.collapsed) {\n                ctx.shadowColor = \"transparent\";\n                if (node.onDrawForeground) {\n                    node.onDrawForeground(ctx, this, this.canvas);\n                }\n            }\n            return;\n        }\n\n        ctx.globalAlpha = this.editor_alpha;\n\n        if (this.render_shadows && !lowQuality) {\n            ctx.shadowColor = defaultConfig.DEFAULT_SHADOW_COLOR;\n            ctx.shadowOffsetX = 2 * this.ds.scale;\n            ctx.shadowOffsetY = 2 * this.ds.scale;\n            ctx.shadowBlur = 3 * this.ds.scale;\n        } else {\n            ctx.shadowColor = \"transparent\";\n        }\n\n        // custom draw collapsed method (draw after shadows because they are affected)\n        if (node.flags.collapsed\n            && node.onDrawCollapsed\n            && node.onDrawCollapsed(ctx, this) == true\n        ) {\n            return;\n        }\n\n        // clip if required (mask)\n        const shape = node._shape || defaultConfig.BOX_SHAPE;\n        const size = tempVC2;\n        tempVC2.set(node.size);\n        const { horizontal } = node; // || node.flags.horizontal;\n\n        if (node.flags.collapsed) {\n            ctx.font = this.inner_text_font;\n            const title = node.getTitle ? node.getTitle() : node.title;\n            if (title) {\n                node._collapsed_width = Math.min(\n                    node.size[0],\n                    ctx.measureText(title).width\n                    + defaultConfig.NODE_TITLE_HEIGHT * 2,\n                ); // LiteGraph.NODE_COLLAPSED_WIDTH;\n                size[0] = node._collapsed_width;\n                size[1] = 0;\n            }\n        }\n\n        if (node.clip_area) {\n            // Start clipping\n            ctx.save();\n            ctx.beginPath();\n            if (shape === defaultConfig.BOX_SHAPE) ctx.rect(0, 0, size[0], size[1]);\n            else if (shape === defaultConfig.ROUND_SHAPE) ctx.roundRect(0, 0, size[0], size[1], 10);\n            else if (shape === defaultConfig.CIRCLE_SHAPE) {\n                ctx.arc(\n                    size[0] * 0.5,\n                    size[1] * 0.5,\n                    size[0] * 0.5,\n                    0,\n                    Math.PI * 2,\n                );\n            }\n            ctx.clip();\n        }\n\n        // draw shape\n        if (node.has_errors) bgcolor = \"red\";\n        this.drawNodeShape(\n            node,\n            ctx,\n            size,\n            color,\n            bgcolor,\n            node.is_selected,\n            node.mouseOver,\n        );\n        ctx.shadowColor = \"transparent\";\n\n        // draw foreground\n        if (node.onDrawForeground) {\n            node.onDrawForeground(ctx, this, this.canvas);\n        }\n\n        // connection slots\n        ctx.textAlign = horizontal ? \"center\" : \"left\";\n        ctx.font = this.inner_text_font;\n\n        const renderText = !lowQuality;\n\n        const outSlot = this.connecting_output;\n        ctx.lineWidth = 1;\n\n        let maxY = 0;\n        const slotPos = new Float32Array(2); // to reuse\n\n        // render inputs and outputs\n        if (!node.flags.collapsed) {\n            // input connection slots\n            if (node.inputs) {\n                for (let i = 0; i < node.inputs.length; i++) {\n                    const slot = node.inputs[i];\n\n                    ctx.globalAlpha = this.editor_alpha;\n                    // change opacity of incompatible slots when dragging a connection\n                    if (this.connecting_node\n                        && !isValidConnection(slot.type, outSlot.type)) {\n                        ctx.globalAlpha = 0.4 * this.editor_alpha;\n                    }\n\n                    ctx.fillStyle = slot.link\n                        ? slot.color_on\n                        || this.default_connection_color.input_on\n                        : slot.color_off\n                        || this.default_connection_color.input_off;\n\n                    const pos = node.getConnectionPos(true, i, slotPos);\n                    pos[0] -= node.pos[0];\n                    pos[1] -= node.pos[1];\n                    if (maxY < pos[1] + defaultConfig.NODE_SLOT_HEIGHT * 0.5) {\n                        maxY = pos[1] + defaultConfig.NODE_SLOT_HEIGHT * 0.5;\n                    }\n\n                    ctx.beginPath();\n\n                    if (slot.type === defaultConfig.EVENT || slot.shape === defaultConfig.BOX_SHAPE) {\n                        if (horizontal) ctx.rect(pos[0] - 5 + 0.5, pos[1] - 8 + 0.5, 10, 14);\n                        else ctx.rect(pos[0] - 6 + 0.5, pos[1] - 5 + 0.5, 14, 10);\n                    } else if (slot.shape === defaultConfig.ARROW_SHAPE) {\n                        ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n                        ctx.closePath();\n                    } else if (lowQuality) {\n                        ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8);\n                    } else {\n                        ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n                    }\n                    ctx.fill();\n\n                    // render name\n                    if (renderText) {\n                        const text = slot.label ? slot.label : slot.name;\n                        if (text) {\n                            ctx.fillStyle = defaultConfig.NODE_TEXT_COLOR;\n                            if (horizontal || slot.dir === defaultConfig.UP) {\n                                ctx.fillText(text, pos[0], pos[1] - 10);\n                            } else {\n                                ctx.fillText(text, pos[0] + 10, pos[1] + 5);\n                            }\n                        }\n                    }\n                }\n            }\n\n            // output connection slots\n            if (this.connecting_node) {\n                ctx.globalAlpha = 0.4 * this.editor_alpha;\n            }\n\n            ctx.textAlign = horizontal ? \"center\" : \"right\";\n            ctx.strokeStyle = \"black\";\n            if (node.outputs) {\n                for (let i = 0; i < node.outputs.length; i++) {\n                    const slot = node.outputs[i];\n\n                    const pos = node.getConnectionPos(false, i, slotPos);\n                    pos[0] -= node.pos[0];\n                    pos[1] -= node.pos[1];\n                    if (maxY < pos[1] + defaultConfig.NODE_SLOT_HEIGHT * 0.5) {\n                        maxY = pos[1] + defaultConfig.NODE_SLOT_HEIGHT * 0.5;\n                    }\n\n                    ctx.fillStyle = slot.links && slot.links.length\n                        ? slot.color_on\n                        || this.default_connection_color.output_on\n                        : slot.color_off\n                        || this.default_connection_color.output_off;\n                    ctx.beginPath();\n                    // ctx.rect( node.size[0] - 14,i*14,10,10);\n\n                    if (\n                        slot.type === defaultConfig.EVENT\n                        || slot.shape === defaultConfig.BOX_SHAPE\n                    ) {\n                        if (horizontal) {\n                            ctx.rect(\n                                pos[0] - 5 + 0.5,\n                                pos[1] - 8 + 0.5,\n                                10,\n                                14,\n                            );\n                        } else {\n                            ctx.rect(\n                                pos[0] - 6 + 0.5,\n                                pos[1] - 5 + 0.5,\n                                14,\n                                10,\n                            );\n                        }\n                    } else if (slot.shape === defaultConfig.ARROW_SHAPE) {\n                        ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n                        ctx.closePath();\n                    } else if (lowQuality) {\n                        ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8);\n                    } else {\n                        ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n                    }\n\n                    ctx.fill();\n                    if (!lowQuality) ctx.stroke();\n\n                    // render output name\n                    if (renderText) {\n                        const text = slot.label != null ? slot.label : slot.name;\n                        if (text) {\n                            ctx.fillStyle = defaultConfig.NODE_TEXT_COLOR;\n                            if (horizontal || slot.dir === defaultConfig.DOWN) {\n                                ctx.fillText(text, pos[0], pos[1] - 8);\n                            } else {\n                                ctx.fillText(text, pos[0] - 10, pos[1] + 5);\n                            }\n                        }\n                    }\n                }\n            }\n\n            ctx.textAlign = \"left\";\n            ctx.globalAlpha = 1;\n\n            if (node.widgets) {\n                let widgetsY = maxY;\n                if (horizontal || node.widgets_up) widgetsY = 2;\n                if (node.widgets_start_y) widgetsY = node.widgets_start_y;\n                this.drawNodeWidgets(\n                    node,\n                    widgetsY,\n                    ctx,\n                    this.node_widget && this.node_widget[0] === node ? this.node_widget[1] : null,\n                );\n            }\n        } else if (this.render_collapsed_slots) {\n            // if collapsed\n            let inputSlot = null;\n            let outputSlot = null;\n            let storedSlot;\n\n            // get first connected slot to render\n            if (node.inputs) {\n                for (const slot of node.inputs) {\n                    if (slot.link == null) continue;\n                    inputSlot = slot;\n                    storedSlot = slot;\n                    break;\n                }\n            }\n            if (node.outputs) {\n                for (const slot of node.outputs) {\n                    if (!slot.links || !slot.links.length) continue;\n                    outputSlot = slot;\n                    storedSlot = slot;\n                }\n            }\n\n            if (inputSlot) {\n                let x = 0;\n                let y = defaultConfig.NODE_TITLE_HEIGHT * -0.5; // center\n                if (horizontal) {\n                    x = node._collapsed_width * 0.5;\n                    y = -defaultConfig.NODE_TITLE_HEIGHT;\n                }\n                ctx.fillStyle = \"#686\";\n                ctx.beginPath();\n                if (storedSlot.type === defaultConfig.EVENT\n                    || storedSlot.shape === defaultConfig.BOX_SHAPE) {\n                    ctx.rect(x - 7 + 0.5, y - 4, 14, 8);\n                } else if (storedSlot.shape === defaultConfig.ARROW_SHAPE) {\n                    ctx.moveTo(x + 8, y);\n                    ctx.lineTo(x + -4, y - 4);\n                    ctx.lineTo(x + -4, y + 4);\n                    ctx.closePath();\n                } else ctx.arc(x, y, 4, 0, Math.PI * 2);\n                ctx.fill();\n            }\n\n            if (outputSlot) {\n                let x = node._collapsed_width;\n                let y = defaultConfig.NODE_TITLE_HEIGHT * -0.5; // center\n                if (horizontal) {\n                    x = node._collapsed_width * 0.5;\n                    y = 0;\n                }\n                ctx.fillStyle = \"#686\";\n                ctx.strokeStyle = \"black\";\n                ctx.beginPath();\n                if (\n                    storedSlot.type === defaultConfig.EVENT\n                    || storedSlot.shape === defaultConfig.BOX_SHAPE\n                ) {\n                    ctx.rect(x - 7 + 0.5, y - 4, 14, 8);\n                } else if (slot.shape === defaultConfig.ARROW_SHAPE) {\n                    ctx.moveTo(x + 6, y);\n                    ctx.lineTo(x - 6, y - 4);\n                    ctx.lineTo(x - 6, y + 4);\n                    ctx.closePath();\n                } else ctx.arc(x, y, 4, 0, Math.PI * 2);\n                ctx.fill();\n                // ctx.stroke();\n            }\n        }\n\n        if (node.clip_area) ctx.restore();\n\n        ctx.globalAlpha = 1.0;\n    }\n\n    // used by this.over_link_center\n    drawLinkTooltip(ctx, link) {\n        const pos = link._pos;\n        ctx.fillStyle = \"black\";\n        ctx.beginPath();\n        ctx.arc(pos[0], pos[1], 3, 0, Math.PI * 2);\n        ctx.fill();\n\n        if (link.data == null) return;\n\n        if (this.onDrawLinkTooltip && this.onDrawLinkTooltip(ctx, link, this)) return;\n\n        const { data } = link;\n        let text;\n\n        if (data.constructor === Number) text = data.toFixed(2);\n        else if (data.constructor === String) text = `\"${data}\"`;\n        else if (data.constructor === Boolean) text = String(data);\n        else if (data.toToolTip) text = data.toToolTip();\n        else text = `[${data.constructor.name}]`;\n\n        if (!text) return;\n        text = text.substr(0, 30); // avoid weird\n\n        ctx.font = \"14px Courier New\";\n        const info = ctx.measureText(text);\n        const w = info.width + 20;\n        const h = 24;\n        ctx.shadowColor = \"black\";\n        ctx.shadowOffsetX = 2;\n        ctx.shadowOffsetY = 2;\n        ctx.shadowBlur = 3;\n        ctx.fillStyle = \"#454\";\n        ctx.beginPath();\n        ctx.roundRect(pos[0] - w * 0.5, pos[1] - 15 - h, w, h, 3, 3);\n        ctx.moveTo(pos[0] - 10, pos[1] - 15);\n        ctx.lineTo(pos[0] + 10, pos[1] - 15);\n        ctx.lineTo(pos[0], pos[1] - 5);\n        ctx.fill();\n        ctx.shadowColor = \"transparent\";\n        ctx.textAlign = \"center\";\n        ctx.fillStyle = \"#CEC\";\n        ctx.fillText(text, pos[0], pos[1] - 15 - h * 0.3);\n    }\n\n    /**\n     * draws the shape of the given node in the canvas\n     * @method drawNodeShape\n     * @memberOf LGraphCanvas\n     * */\n    drawNodeShape(\n        node,\n        ctx,\n        size,\n        fgcolor,\n        bgcolor,\n        selected,\n        mouseHover,\n    ) {\n        // bg rect\n        ctx.strokeStyle = fgcolor;\n        ctx.fillStyle = bgcolor;\n\n        const titleHeight = defaultConfig.NODE_TITLE_HEIGHT;\n        const lowQuality = this.ds.scale < 0.5;\n\n        // render node area depending on shape\n        const shape = node._shape || node.constructor.shape || defaultConfig.ROUND_SHAPE;\n\n        const { title_mode } = node.constructor;\n\n        let renderTitle = true;\n        if (title_mode === defaultConfig.TRANSPARENT_TITLE) renderTitle = false;\n        else if (title_mode === defaultConfig.AUTOHIDE_TITLE && mouseHover) renderTitle = true;\n\n        const area = tempArea;\n        area[0] = 0; // x\n        area[1] = renderTitle ? -titleHeight : 0; // y\n        area[2] = size[0] + 1; // w\n        area[3] = renderTitle ? size[1] + titleHeight : size[1]; // h\n\n        const oldAlpha = ctx.globalAlpha;\n\n        ctx.beginPath();\n        if (shape === defaultConfig.BOX_SHAPE || lowQuality) {\n            ctx.fillRect(area[0], area[1], area[2], area[3]);\n        } else if (shape === defaultConfig.ROUND_SHAPE || shape === defaultConfig.CARD_SHAPE) {\n            ctx.roundRect(\n                area[0],\n                area[1],\n                area[2],\n                area[3],\n                this.round_radius,\n                shape === defaultConfig.CARD_SHAPE ? 0 : this.round_radius,\n            );\n        } else if (shape === defaultConfig.CIRCLE_SHAPE) {\n            ctx.arc(\n                size[0] * 0.5,\n                size[1] * 0.5,\n                size[0] * 0.5,\n                0,\n                Math.PI * 2,\n            );\n        }\n        ctx.fill();\n\n        // separator\n        if (!node.flags.collapsed) {\n            ctx.shadowColor = \"transparent\";\n            ctx.fillStyle = \"rgba(0,0,0,0.2)\";\n            ctx.fillRect(0, -1, area[2], 2);\n        }\n        ctx.shadowColor = \"transparent\";\n\n        if (node.onDrawBackground) node.onDrawBackground(ctx, this, this.canvas, this.graph_mouse);\n\n        // title bg (remember, it is rendered ABOVE the node)\n        if (renderTitle || title_mode === defaultConfig.TRANSPARENT_TITLE) {\n            // title bar\n            if (node.onDrawTitleBar) {\n                node.onDrawTitleBar(ctx, titleHeight, size, this.ds.scale, fgcolor);\n            } else if (\n                title_mode !== defaultConfig.TRANSPARENT_TITLE\n                && (node.constructor.title_color || this.render_title_colored)\n            ) {\n                const titleColor = node.constructor.title_color || fgcolor;\n\n                if (node.flags.collapsed) {\n                    ctx.shadowColor = defaultConfig.DEFAULT_SHADOW_COLOR;\n                }\n\n                //* gradient test\n                if (this.use_gradients) {\n                    let grad = LGraphCanvas.gradients[titleColor];\n                    if (!grad) {\n                        grad = ctx.createLinearGradient(0, 0, 400, 0);\n                        LGraphCanvas.gradients[titleColor] = grad;\n                        grad.addColorStop(0, titleColor);\n                        grad.addColorStop(1, \"#000\");\n                    }\n                    ctx.fillStyle = grad;\n                } else {\n                    ctx.fillStyle = titleColor;\n                }\n\n                // ctx.globalAlpha = 0.5 * old_alpha;\n                ctx.beginPath();\n                if (shape === defaultConfig.BOX_SHAPE || lowQuality) {\n                    ctx.rect(0, -titleHeight, size[0] + 1, titleHeight);\n                } else if (shape === defaultConfig.ROUND_SHAPE || shape === defaultConfig.CARD_SHAPE) {\n                    ctx.roundRect(\n                        0,\n                        -titleHeight,\n                        size[0] + 1,\n                        titleHeight,\n                        this.round_radius,\n                        node.flags.collapsed ? this.round_radius : 0,\n                    );\n                }\n                ctx.fill();\n                ctx.shadowColor = \"transparent\";\n            }\n\n            // title box\n            const boxSize = 10;\n            if (node.onDrawTitleBox) {\n                node.onDrawTitleBox(ctx, titleHeight, size, this.ds.scale);\n            } else if ([defaultConfig.ROUND_SHAPE, defaultConfig.CIRCLE_SHAPE, defaultConfig.CARD_SHAPE].includes(shape)) {\n                if (lowQuality) {\n                    ctx.fillStyle = \"black\";\n                    ctx.beginPath();\n                    ctx.arc(\n                        titleHeight * 0.5,\n                        titleHeight * -0.5,\n                        boxSize * 0.5 + 1,\n                        0,\n                        Math.PI * 2,\n                    );\n                    ctx.fill();\n                }\n\n                ctx.fillStyle = node.boxcolor || defaultConfig.NODE_DEFAULT_BOXCOLOR;\n                if (lowQuality) ctx.fillRect(titleHeight * 0.5 - boxSize * 0.5, titleHeight * -0.5 - boxSize * 0.5, boxSize, boxSize);\n                else {\n                    ctx.beginPath();\n                    ctx.arc(\n                        titleHeight * 0.5,\n                        titleHeight * -0.5,\n                        boxSize * 0.5,\n                        0,\n                        Math.PI * 2,\n                    );\n                    ctx.fill();\n                }\n            } else {\n                if (lowQuality) {\n                    ctx.fillStyle = \"black\";\n                    ctx.fillRect(\n                        (titleHeight - boxSize) * 0.5 - 1,\n                        (titleHeight + boxSize) * -0.5 - 1,\n                        boxSize + 2,\n                        boxSize + 2,\n                    );\n                }\n                ctx.fillStyle = node.boxcolor || defaultConfig.NODE_DEFAULT_BOXCOLOR;\n                ctx.fillRect(\n                    (titleHeight - boxSize) * 0.5,\n                    (titleHeight + boxSize) * -0.5,\n                    boxSize,\n                    boxSize,\n                );\n            }\n            ctx.globalAlpha = oldAlpha;\n\n            // title text\n            if (node.onDrawTitleText) {\n                node.onDrawTitleText(\n                    ctx,\n                    titleHeight,\n                    size,\n                    this.ds.scale,\n                    this.title_text_font,\n                    selected,\n                );\n            }\n            if (!lowQuality) {\n                ctx.font = this.title_text_font;\n                const title = String(node.getTitle());\n                if (title) {\n                    if (selected) ctx.fillStyle = defaultConfig.NODE_SELECTED_TITLE_COLOR;\n                    else ctx.fillStyle = node.constructor.title_text_color || this.node_title_color;\n                    if (node.flags.collapsed) {\n                        ctx.textAlign = \"left\";\n                        const measure = ctx.measureText(title);\n                        ctx.fillText(\n                            title.substr(0, 20), // avoid urls too long\n                            titleHeight, // + measure.width * 0.5,\n                            defaultConfig.NODE_TITLE_TEXT_Y - titleHeight,\n                        );\n                        ctx.textAlign = \"left\";\n                    } else {\n                        ctx.textAlign = \"left\";\n                        ctx.fillText(\n                            title,\n                            titleHeight,\n                            defaultConfig.NODE_TITLE_TEXT_Y - titleHeight,\n                        );\n                    }\n                }\n            }\n\n            // subgraph box\n            if (!node.flags.collapsed && node.subgraph && !node.skip_subgraph_button) {\n                const w = defaultConfig.NODE_TITLE_HEIGHT;\n                const x = node.size[0] - w;\n                const over = isInsideRectangle(\n                    this.graph_mouse[0] - node.pos[0],\n                    this.graph_mouse[1] - node.pos[1],\n                    x + 2,\n                    -w + 2,\n                    w - 4,\n                    w - 4,\n                );\n                ctx.fillStyle = over ? \"#888\" : \"#555\";\n                if (shape === defaultConfig.BOX_SHAPE || lowQuality) {\n                    ctx.fillRect(x + 2, -w + 2, w - 4, w - 4);\n                } else {\n                    ctx.beginPath();\n                    ctx.roundRect(x + 2, -w + 2, w - 4, w - 4, 4);\n                    ctx.fill();\n                }\n                ctx.fillStyle = \"#333\";\n                ctx.beginPath();\n                ctx.moveTo(x + w * 0.2, -w * 0.6);\n                ctx.lineTo(x + w * 0.8, -w * 0.6);\n                ctx.lineTo(x + w * 0.5, -w * 0.3);\n                ctx.fill();\n            }\n\n            // custom title render\n            if (node.onDrawTitle) node.onDrawTitle(ctx);\n        }\n\n        // render selection marker\n        if (selected) {\n            if (node.onBounding) node.onBounding(area);\n\n            if (title_mode === defaultConfig.TRANSPARENT_TITLE) {\n                area[1] -= titleHeight;\n                area[3] += titleHeight;\n            }\n            ctx.lineWidth = 1;\n            ctx.globalAlpha = 0.8;\n            ctx.beginPath();\n            if (shape === defaultConfig.BOX_SHAPE) {\n                ctx.rect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3],\n                );\n            } else if (\n                shape === defaultConfig.ROUND_SHAPE\n                || (shape === defaultConfig.CARD_SHAPE && node.flags.collapsed)\n            ) {\n                ctx.roundRect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3],\n                    this.round_radius * 2,\n                );\n            } else if (shape === defaultConfig.CARD_SHAPE) {\n                ctx.roundRect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3],\n                    this.round_radius * 2,\n                    2,\n                );\n            } else if (shape === defaultConfig.CIRCLE_SHAPE) {\n                ctx.arc(\n                    size[0] * 0.5,\n                    size[1] * 0.5,\n                    size[0] * 0.5 + 6,\n                    0,\n                    Math.PI * 2,\n                );\n            }\n            ctx.strokeStyle = defaultConfig.NODE_BOX_OUTLINE_COLOR;\n            ctx.stroke();\n            ctx.strokeStyle = fgcolor;\n            ctx.globalAlpha = 1;\n        }\n    }\n\n    /**\n     * draws every connection visible in the canvas\n     * OPTIMIZE THIS: pre-catch connections position instead of recomputing them every time\n     * @method drawConnections\n     * @memberOf LGraphCanvas\n     * */\n    drawConnections(ctx) {\n        const now = getTime();\n        const { visible_area } = this;\n        marginArea[0] = visible_area[0] - 20;\n        marginArea[1] = visible_area[1] - 20;\n        marginArea[2] = visible_area[2] + 40;\n        marginArea[3] = visible_area[3] + 40;\n\n        // draw connections\n        ctx.lineWidth = this.connections_width;\n\n        ctx.fillStyle = \"#AAA\";\n        ctx.strokeStyle = \"#AAA\";\n        ctx.globalAlpha = this.editor_alpha;\n        // for every node\n        const nodes = this.graph._nodes;\n        for (const node of nodes) {\n            // for every input (we render just inputs because it is easier as every slot can only\n            // have one input)\n            if (!node.inputs || !node.inputs.length) {\n                continue;\n            }\n\n            for (let i = 0; i < node.inputs.length; ++i) {\n                const input = node.inputs[i];\n                if (!input || input.link == null) continue;\n\n                const linkId = input.link;\n                const link = this.graph.links[linkId];\n                if (!link) continue;\n\n                // find link info\n                const startNode = this.graph.getNodeById(link.origin_id);\n                if (!startNode) continue;\n\n                const startNodeSlot = link.origin_slot;\n                let startNodeSlotPos = null;\n                if (startNodeSlot === -1) {\n                    startNodeSlotPos = [\n                        startNode.pos[0] + 10,\n                        startNode.pos[1] + 10,\n                    ];\n                } else {\n                    startNodeSlotPos = startNode.getConnectionPos(\n                        false,\n                        startNodeSlot,\n                        tempA,\n                    );\n                }\n\n                const endNodeSlotPos = node.getConnectionPos(true, i, tempB);\n\n                // compute link bounding\n                linkBounding[0] = startNodeSlotPos[0];\n                linkBounding[1] = startNodeSlotPos[1];\n                linkBounding[2] = endNodeSlotPos[0] - startNodeSlotPos[0];\n                linkBounding[3] = endNodeSlotPos[1] - startNodeSlotPos[1];\n\n                if (linkBounding[2] < 0) {\n                    linkBounding[0] += linkBounding[2];\n                    linkBounding[2] = Math.abs(linkBounding[2]);\n                }\n                if (linkBounding[3] < 0) {\n                    linkBounding[1] += linkBounding[3];\n                    linkBounding[3] = Math.abs(linkBounding[3]);\n                }\n\n                // skip links outside of the visible area of the canvas\n                if (!overlapBounding(linkBounding, marginArea)) {\n                    continue;\n                }\n\n                const startSlot = startNode.outputs[startNodeSlot];\n                const endSlot = node.inputs[i];\n                if (!startSlot || !endSlot) continue;\n                const startDir = startSlot.dir\n                    || (startNode.horizontal ? defaultConfig.DOWN : defaultConfig.RIGHT);\n                const endDir = endSlot.dir\n                    || (node.horizontal ? defaultConfig.UP : defaultConfig.LEFT);\n\n                this.renderLink(\n                    ctx,\n                    startNodeSlotPos,\n                    endNodeSlotPos,\n                    link,\n                    false,\n                    0,\n                    null,\n                    startDir,\n                    endDir,\n                );\n\n                // event triggered rendered on top\n                if (link && link._last_time && now - link._last_time < 1000) {\n                    const f = 2.0 - (now - link._last_time) * 0.002;\n                    const tmp = ctx.globalAlpha;\n                    ctx.globalAlpha = tmp * f;\n                    this.renderLink(\n                        ctx,\n                        startNodeSlotPos,\n                        endNodeSlotPos,\n                        link,\n                        true,\n                        f,\n                        \"white\",\n                        startDir,\n                        endDir,\n                    );\n                    ctx.globalAlpha = tmp;\n                }\n            }\n        }\n        ctx.globalAlpha = 1;\n    }\n\n    /**\n     * draws a link between two points\n     * @method renderLink\n     * @param {vec2} a start pos\n     * @param {vec2} b end pos\n     * @param {Object} link the link object with all the link info\n     * @param {boolean} skipBorder ignore the shadow of the link\n     * @param {boolean} flow show flow animation (for events)\n     * @param {string} color the color for the link\n     * @param {number} startDir the direction enum\n     * @param {number} endDir the direction enum\n     * @param {number} numSubline number of sublines (useful to represent vec3 or rgb)\n     * @memberOf LGraphCanvas\n     * */\n    renderLink(\n        ctx,\n        a,\n        b,\n        link,\n        skipBorder,\n        flow,\n        color,\n        startDir,\n        endDir,\n        numSubline,\n    ) {\n        if (link) this.visible_links.push(link);\n\n        // choose color\n        if (!color && link) color = link.color || LGraphCanvas.link_type_colors[link.type];\n        if (!color) color = this.default_link_color;\n        if (link != null && this.highlighted_links[link.id]) color = \"#FFF\";\n\n        startDir = startDir || defaultConfig.RIGHT;\n        endDir = endDir || defaultConfig.LEFT;\n\n        const dist = distance(a, b);\n\n        if (this.render_connections_border && this.ds.scale > 0.6) {\n            ctx.lineWidth = this.connections_width + 4;\n        }\n        ctx.lineJoin = \"round\";\n        numSubline = numSubline || 1;\n        if (numSubline > 1) ctx.lineWidth = 0.5;\n\n        // begin line shape\n        ctx.beginPath();\n        for (let i = 0; i < numSubline; i += 1) {\n            const offsety = (i - (numSubline - 1) * 0.5) * 5;\n\n            if (this.links_render_mode === defaultConfig.SPLINE_LINK) {\n                ctx.moveTo(a[0], a[1] + offsety);\n                let startOffsetX = 0;\n                let startOffsetY = 0;\n                let endOffsetX = 0;\n                let endOffsetY = 0;\n                switch (startDir) {\n                    case defaultConfig.LEFT:\n                        startOffsetX = dist * -0.25;\n                        break;\n                    case defaultConfig.RIGHT:\n                        startOffsetX = dist * 0.25;\n                        break;\n                    case defaultConfig.UP:\n                        startOffsetY = dist * -0.25;\n                        break;\n                    case defaultConfig.DOWN:\n                        startOffsetY = dist * 0.25;\n                        break;\n                    default:\n                        break;\n                }\n                switch (endDir) {\n                    case defaultConfig.LEFT:\n                        endOffsetX = dist * -0.25;\n                        break;\n                    case defaultConfig.RIGHT:\n                        endOffsetX = dist * 0.25;\n                        break;\n                    case defaultConfig.UP:\n                        endOffsetY = dist * -0.25;\n                        break;\n                    case defaultConfig.DOWN:\n                        endOffsetY = dist * 0.25;\n                        break;\n                    default:\n                        break;\n                }\n                ctx.bezierCurveTo(\n                    a[0] + startOffsetX,\n                    a[1] + startOffsetY + offsety,\n                    b[0] + endOffsetX,\n                    b[1] + endOffsetY + offsety,\n                    b[0],\n                    b[1] + offsety,\n                );\n            } else if (this.links_render_mode === defaultConfig.LINEAR_LINK) {\n                ctx.moveTo(a[0], a[1] + offsety);\n                let startOffsetX = 0;\n                let startOffsetY = 0;\n                let endOffsetX = 0;\n                let endOffsetY = 0;\n                switch (startDir) {\n                    case defaultConfig.LEFT:\n                        startOffsetX = -1;\n                        break;\n                    case defaultConfig.RIGHT:\n                        startOffsetX = 1;\n                        break;\n                    case defaultConfig.UP:\n                        startOffsetY = -1;\n                        break;\n                    case defaultConfig.DOWN:\n                        startOffsetY = 1;\n                        break;\n                    default:\n                        break;\n                }\n                switch (endDir) {\n                    case defaultConfig.LEFT:\n                        endOffsetX = -1;\n                        break;\n                    case defaultConfig.RIGHT:\n                        endOffsetX = 1;\n                        break;\n                    case defaultConfig.UP:\n                        endOffsetY = -1;\n                        break;\n                    case defaultConfig.DOWN:\n                        endOffsetY = 1;\n                        break;\n                    default:\n                        break;\n                }\n                const l = 15;\n                ctx.lineTo(\n                    a[0] + startOffsetX * l,\n                    a[1] + startOffsetY * l + offsety,\n                );\n                ctx.lineTo(\n                    b[0] + endOffsetX * l,\n                    b[1] + endOffsetY * l + offsety,\n                );\n                ctx.lineTo(b[0], b[1] + offsety);\n            } else if (this.links_render_mode === defaultConfig.STRAIGHT_LINK) {\n                ctx.moveTo(a[0], a[1]);\n                let startX = a[0];\n                let startY = a[1];\n                let endX = b[0];\n                let endY = b[1];\n\n                if (startDir === defaultConfig.RIGHT) startX += 10;\n                else startY += 10;\n                if (endDir === defaultConfig.LEFT) endX -= 10;\n                else endY -= 10;\n\n                ctx.lineTo(startX, startY);\n                ctx.lineTo((startX + endX) * 0.5, startY);\n                ctx.lineTo((startX + endX) * 0.5, endY);\n                ctx.lineTo(endX, endY);\n                ctx.lineTo(b[0], b[1]);\n            } else return;\n        }\n\n        // rendering the outline of the connection can be a little bit slow\n        if (this.render_connections_border && this.ds.scale > 0.6 && !skipBorder) {\n            ctx.strokeStyle = \"rgba(0,0,0,0.5)\";\n            ctx.stroke();\n        }\n\n        ctx.lineWidth = this.connections_width;\n        ctx.fillStyle = color;\n        ctx.strokeStyle = color;\n        ctx.stroke();\n        // end line shape\n\n        const posConnectionPoint = this.computeConnectionPoint(a, b, 0.5, startDir, endDir);\n        if (link && link._pos) {\n            link._pos[0] = posConnectionPoint[0];\n            link._pos[1] = posConnectionPoint[1];\n        }\n\n        // render arrow in the middle\n        if (this.ds.scale >= 0.6 && this.highquality_render && endDir !== defaultConfig.CENTER) {\n            // render arrow\n            if (this.render_connection_arrows) {\n                // compute two points in the connection\n                const posA = this.computeConnectionPoint(a, b, 0.25, startDir, endDir);\n                const posB = this.computeConnectionPoint(a, b, 0.26, startDir, endDir);\n                const posC = this.computeConnectionPoint(a, b, 0.75, startDir, endDir);\n                const posD = this.computeConnectionPoint(a, b, 0.76, startDir, endDir);\n\n                // compute the angle between them so the arrow points in the right direction\n                let angleA = 0;\n                let angleB = 0;\n                if (this.render_curved_connections) {\n                    angleA = -Math.atan2(posB[0] - posA[0], posB[1] - posA[1]);\n                    angleB = -Math.atan2(posD[0] - posC[0], posD[1] - posC[1]);\n                } else angleB = angleA = b[1] > a[1] ? 0 : Math.PI;\n\n                // render arrow\n                ctx.save();\n                ctx.translate(posA[0], posA[1]);\n                ctx.rotate(angleA);\n                ctx.beginPath();\n                ctx.moveTo(-5, -3);\n                ctx.lineTo(0, 7);\n                ctx.lineTo(5, -3);\n                ctx.fill();\n                ctx.restore();\n                ctx.save();\n                ctx.translate(posC[0], posC[1]);\n                ctx.rotate(angleB);\n                ctx.beginPath();\n                ctx.moveTo(-5, -3);\n                ctx.lineTo(0, 7);\n                ctx.lineTo(5, -3);\n                ctx.fill();\n                ctx.restore();\n            }\n\n            // circle\n            ctx.beginPath();\n            ctx.arc(posConnectionPoint[0], posConnectionPoint[1], 5, 0, Math.PI * 2);\n            ctx.fill();\n        }\n\n        // render flowing points\n        if (flow) {\n            ctx.fillStyle = color;\n            for (let i = 0; i < 5; ++i) {\n                const f = (getTime() * 0.001 + i * 0.2) % 1;\n                const pos = this.computeConnectionPoint(a, b, f, startDir, endDir);\n                ctx.beginPath();\n                ctx.arc(pos[0], pos[1], 5, 0, 2 * Math.PI);\n                ctx.fill();\n            }\n        }\n    }\n\n    /**\n     * returns the link center point based on curvature\n     * @method computeConnectionPoint\n     * @param a\n     * @param b\n     * @param t\n     * @param [startDir]\n     * @param [endDir]\n     * @returns {number[]}\n     * @memberOf LGraphCanvas\n     */\n    computeConnectionPoint(a, b, t, startDir = defaultConfig.RIGHT, endDir = defaultConfig.LEFT) {\n        const dist = distance(a, b);\n        const p0 = a;\n        const p1 = [a[0], a[1]];\n        const p2 = [b[0], b[1]];\n        const p3 = b;\n\n        switch (startDir) {\n            case defaultConfig.LEFT:\n                p1[0] += dist * -0.25;\n                break;\n            case defaultConfig.RIGHT:\n                p1[0] += dist * 0.25;\n                break;\n            case defaultConfig.UP:\n                p1[1] += dist * -0.25;\n                break;\n            case defaultConfig.DOWN:\n                p1[1] += dist * 0.25;\n                break;\n            default:\n                break;\n        }\n        switch (endDir) {\n            case defaultConfig.LEFT:\n                p2[0] += dist * -0.25;\n                break;\n            case defaultConfig.RIGHT:\n                p2[0] += dist * 0.25;\n                break;\n            case defaultConfig.UP:\n                p2[1] += dist * -0.25;\n                break;\n            case defaultConfig.DOWN:\n                p2[1] += dist * 0.25;\n                break;\n            default:\n                break;\n        }\n\n        const c1 = (1 - t) * (1 - t) * (1 - t);\n        const c2 = 3 * ((1 - t) * (1 - t)) * t;\n        const c3 = 3 * (1 - t) * (t * t);\n        const c4 = t * t * t;\n\n        const x = c1 * p0[0] + c2 * p1[0] + c3 * p2[0] + c4 * p3[0];\n        const y = c1 * p0[1] + c2 * p1[1] + c3 * p2[1] + c4 * p3[1];\n        return [x, y];\n    }\n\n    drawExecutionOrder(ctx) {\n        ctx.shadowColor = \"transparent\";\n        ctx.globalAlpha = 0.25;\n\n        ctx.textAlign = \"center\";\n        ctx.strokeStyle = \"white\";\n        ctx.globalAlpha = 0.75;\n\n        const { visible_nodes } = this;\n        for (const node of visible_nodes) {\n            ctx.fillStyle = \"black\";\n            ctx.fillRect(\n                node.pos[0] - defaultConfig.NODE_TITLE_HEIGHT,\n                node.pos[1] - defaultConfig.NODE_TITLE_HEIGHT,\n                defaultConfig.NODE_TITLE_HEIGHT,\n                defaultConfig.NODE_TITLE_HEIGHT,\n            );\n            if (node.order === 0) {\n                ctx.strokeRect(\n                    node.pos[0] - defaultConfig.NODE_TITLE_HEIGHT + 0.5,\n                    node.pos[1] - defaultConfig.NODE_TITLE_HEIGHT + 0.5,\n                    defaultConfig.NODE_TITLE_HEIGHT,\n                    defaultConfig.NODE_TITLE_HEIGHT,\n                );\n            }\n            ctx.fillStyle = \"#FFF\";\n            ctx.fillText(\n                node.order,\n                node.pos[0] + defaultConfig.NODE_TITLE_HEIGHT * -0.5,\n                node.pos[1] - 6,\n            );\n        }\n        ctx.globalAlpha = 1;\n    }\n\n    /**\n     * draws the widgets stored inside a node\n     * @method drawNodeWidgets\n     * @memberOf LGraphCanvas\n     * */\n    drawNodeWidgets(node, posY, ctx, active_widget) {\n        if (!node.widgets || !node.widgets.length) return 0;\n        const width = node.size[0];\n        const { widgets } = node;\n        posY += 2;\n        const H = defaultConfig.NODE_WIDGET_HEIGHT;\n        const showText = this.ds.scale > 0.5;\n        ctx.save();\n        ctx.globalAlpha = this.editor_alpha;\n        const outlineColor = defaultConfig.WIDGET_OUTLINE_COLOR;\n        const backgroundColor = defaultConfig.WIDGET_BGCOLOR;\n        const textColor = defaultConfig.WIDGET_TEXT_COLOR;\n        const secondaryTextColor = defaultConfig.WIDGET_SECONDARY_TEXT_COLOR;\n        const margin = 15;\n\n        for (const w of widgets) {\n            let y = posY;\n            if (w.y) y = w.y;\n            w.last_y = y;\n            ctx.strokeStyle = outlineColor;\n            ctx.fillStyle = \"#222\";\n            ctx.textAlign = \"left\";\n            // ctx.lineWidth = 2;\n            if (w.disabled) ctx.globalAlpha *= 0.5;\n            const widgetWidth = w.width || width;\n\n            switch (w.type) {\n                case \"button\":\n                    if (w.clicked) {\n                        ctx.fillStyle = \"#AAA\";\n                        w.clicked = false;\n                        this.dirty_canvas = true;\n                    }\n                    ctx.fillRect(margin, y, widgetWidth - margin * 2, H);\n                    if (showText && !w.disabled) ctx.strokeRect(margin, y, widgetWidth - margin * 2, H);\n                    if (showText) {\n                        ctx.textAlign = \"center\";\n                        ctx.fillStyle = textColor;\n                        ctx.fillText(w.name, widgetWidth * 0.5, y + H * 0.7);\n                    }\n                    break;\n                case \"toggle\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outlineColor;\n                    ctx.fillStyle = backgroundColor;\n                    ctx.beginPath();\n\n                    if (showText) ctx.roundRect(margin, posY, widgetWidth - margin * 2, H, H * 0.5);\n                    else ctx.rect(margin, posY, widgetWidth - margin * 2, H);\n\n                    ctx.fill();\n                    if (showText && !w.disabled) ctx.stroke();\n                    ctx.fillStyle = w.value ? \"#89A\" : \"#333\";\n                    ctx.beginPath();\n                    ctx.arc(widgetWidth - margin * 2, y + H * 0.5, H * 0.36, 0, Math.PI * 2);\n                    ctx.fill();\n                    if (showText) {\n                        ctx.fillStyle = secondaryTextColor;\n                        if (w.name) ctx.fillText(w.name, margin * 2, y + H * 0.7);\n                        ctx.fillStyle = w.value ? textColor : secondaryTextColor;\n                        ctx.textAlign = \"right\";\n                        ctx.fillText(\n                            w.value\n                                ? w.options.on || \"true\"\n                                : w.options.off || \"false\",\n                            widgetWidth - 40,\n                            y + H * 0.7,\n                        );\n                    }\n                    break;\n                case \"slider\":\n                    ctx.fillStyle = backgroundColor;\n                    ctx.fillRect(margin, y, widgetWidth - margin * 2, H);\n                    var range = w.options.max - w.options.min;\n                    var nvalue = (w.value - w.options.min) / range;\n                    ctx.fillStyle = active_widget === w ? \"#89A\" : \"#678\";\n                    ctx.fillRect(margin, y, nvalue * (widgetWidth - margin * 2), H);\n                    if (showText && !w.disabled) ctx.strokeRect(margin, y, widgetWidth - margin * 2, H);\n                    if (w.marker) {\n                        const marker_nvalue = (w.marker - w.options.min) / range;\n                        ctx.fillStyle = \"#AA9\";\n                        ctx.fillRect(margin + marker_nvalue * (widgetWidth - margin * 2), y, 2, H);\n                    }\n                    if (showText) {\n                        ctx.textAlign = \"center\";\n                        ctx.fillStyle = textColor;\n                        ctx.fillText(\n                            `${w.name}  ${Number(w.value)\n                                .toFixed(3)}`,\n                            widgetWidth * 0.5,\n                            y + H * 0.7,\n                        );\n                    }\n                    break;\n                case \"number\":\n                case \"combo\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outlineColor;\n                    ctx.fillStyle = backgroundColor;\n                    ctx.beginPath();\n                    if (showText) ctx.roundRect(margin, posY, widgetWidth - margin * 2, H, H * 0.5);\n                    else ctx.rect(margin, posY, widgetWidth - margin * 2, H);\n                    ctx.fill();\n                    if (showText) {\n                        if (!w.disabled) ctx.stroke();\n                        ctx.fillStyle = textColor;\n                        if (!w.disabled) {\n                            ctx.beginPath();\n                            ctx.moveTo(margin + 16, posY + 5);\n                            ctx.lineTo(margin + 6, posY + H * 0.5);\n                            ctx.lineTo(margin + 16, posY + H - 5);\n                            ctx.fill();\n                            ctx.beginPath();\n                            ctx.moveTo(widgetWidth - margin - 16, posY + 5);\n                            ctx.lineTo(widgetWidth - margin - 6, posY + H * 0.5);\n                            ctx.lineTo(widgetWidth - margin - 16, posY + H - 5);\n                            ctx.fill();\n                        }\n                        ctx.fillStyle = secondaryTextColor;\n                        ctx.fillText(w.name, margin * 2 + 5, y + H * 0.7);\n                        ctx.fillStyle = textColor;\n                        ctx.textAlign = \"right\";\n                        if (w.type === \"number\") {\n                            ctx.fillText(\n                                Number(w.value)\n                                    .toFixed(\n                                        w.options.precision\n                                            ? w.options.precision\n                                            : 3,\n                                    ),\n                                widgetWidth - margin * 2 - 20,\n                                y + H * 0.7,\n                            );\n                        } else {\n                            let v = w.value;\n                            if (w.options.values) {\n                                let { values } = w.options;\n                                if (values.constructor === Function) values = values();\n                                if (values && values.constructor !== Array) v = values[w.value];\n                            }\n                            ctx.fillText(\n                                v,\n                                widgetWidth - margin * 2 - 20,\n                                y + H * 0.7,\n                            );\n                        }\n                    }\n                    break;\n                case \"string\":\n                case \"text\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outlineColor;\n                    ctx.fillStyle = backgroundColor;\n                    ctx.beginPath();\n\n                    if (showText) ctx.roundRect(margin, posY, widgetWidth - margin * 2, H, H * 0.5);\n                    else ctx.rect(margin, posY, widgetWidth - margin * 2, H);\n\n                    ctx.fill();\n                    if (showText) {\n                        if (!w.disabled) ctx.stroke();\n                        ctx.save();\n                        ctx.beginPath();\n                        ctx.rect(margin, posY, widgetWidth - margin * 2, H);\n                        ctx.clip();\n\n                        // ctx.stroke();\n                        ctx.fillStyle = secondaryTextColor;\n                        if (w.name) ctx.fillText(w.name, margin * 2, y + H * 0.7);\n                        ctx.fillStyle = textColor;\n                        ctx.textAlign = \"right\";\n                        ctx.fillText(String(w.value)\n                            .substr(0, 30), widgetWidth - margin * 2, y + H * 0.7); // 30 chars max\n                        ctx.restore();\n                    }\n                    break;\n                default:\n                    if (w.draw) w.draw(ctx, node, widgetWidth, y, H);\n                    break;\n            }\n            posY += (w.computeSize ? w.computeSize(widgetWidth)[1] : H) + 4;\n            ctx.globalAlpha = this.editor_alpha;\n        }\n        ctx.restore();\n        ctx.textAlign = \"left\";\n    }\n\n    /**\n     * process an event on widgets\n     * @method processNodeWidgets\n     * @memberOf LGraphCanvas\n     * */\n    processNodeWidgets(node, pos, event, activeWidget) {\n        if (!node.widgets || !node.widgets.length) return null;\n\n        const x = pos[0] - node.pos[0];\n        const y = pos[1] - node.pos[1];\n        const width = node.size[0];\n        const refWindow = this.getCanvasWindow();\n\n        for (const w of node.widgets) {\n            if (!w || w.disabled) continue;\n            const widgetHeight = w.computeSize ? w.computeSize(width)[1] : defaultConfig.NODE_WIDGET_HEIGHT;\n            const widgetWidth = w.width || width;\n            // outside\n            if (w !== activeWidget\n                && (x < 6 || x > widgetWidth - 12 || y < w.last_y || y > w.last_y + widgetHeight)) {\n                continue;\n            }\n\n            const oldValue = w.value;\n\n            // if ( w == active_widget || (x > 6 && x < widget_width - 12 && y > w.last_y && y <\n            // w.last_y + widget_height) ) { inside widget\n            switch (w.type) {\n                case \"button\":\n                    if (event.type === \"mousemove\") {\n                        break;\n                    }\n                    if (w.callback) {\n                        setTimeout(() => w.callback(w, this, node, pos, event), 20);\n                    }\n                    w.clicked = true;\n                    this.dirty_canvas = true;\n                    break;\n                case \"slider\":\n                    const range = w.options.max - w.options.min;\n                    const nvalue = clamp((x - 15) / (widgetWidth - 30), 0, 1);\n                    w.value = w.options.min + (w.options.max - w.options.min) * nvalue;\n                    if (w.callback) {\n                        setTimeout(() => innerValueChange(w, w.value), 20);\n                    }\n                    this.dirty_canvas = true;\n                    break;\n                case \"number\":\n                case \"combo\":\n                    const oldValue = w.value;\n                    if (event.type === \"mousemove\" && w.type === \"number\") {\n                        w.value += event.deltaX * 0.1 * (w.options.step || 1);\n                        if (w.options.min && w.value < w.options.min) w.value = w.options.min;\n                        if (w.options.max && w.value > w.options.max) w.value = w.options.max;\n                    } else if (event.type === \"mousedown\") {\n                        let { values } = w.options;\n                        if (values && values.constructor === Function) {\n                            values = w.options.values(w, node);\n                        }\n                        let valuesList = [];\n\n                        if (w.type !== \"number\") valuesList = values.constructor === Array ? values : Object.keys(values);\n\n                        const delta = x < 40 ? -1 : x > widgetWidth - 40 ? 1 : 0;\n                        if (w.type === \"number\") {\n                            w.value += delta * 0.1 * (w.options.step || 1);\n                            if (w.options.min != null && w.value < w.options.min) {\n                                w.value = w.options.min;\n                            }\n                            if (w.options.max != null && w.value > w.options.max) {\n                                w.value = w.options.max;\n                            }\n                        } else if (delta) { // clicked in arrow, used for combos\n                            let index = -1;\n                            this.last_mouseclick = 0; // avoids dobl click event\n                            if (values.constructor === Object) {\n                                index = valuesList.indexOf(String(w.value)) + delta;\n                            } else {\n                                index = valuesList.indexOf(w.value) + delta;\n                            }\n                            if (index >= valuesList.length) {\n                                index = valuesList.length - 1;\n                            }\n                            if (index < 0) {\n                                index = 0;\n                            }\n                            if (values.constructor === Array) {\n                                w.value = values[index];\n                            } else {\n                                w.value = index;\n                            }\n                        } else { // combo clicked\n                            const textValues = values !== valuesList\n                                ? Object.values(values)\n                                : values;\n                            const menu = new ContextMenu(textValues, {\n                                scale: Math.max(1, this.ds.scale),\n                                event,\n                                className: \"dark\",\n                                callback: innerClicked.bind(w),\n                            },\n                            refWindow);\n\n                            function innerClicked(v, option, event) {\n                                if (values != valuesList) v = textValues.indexOf(v);\n                                this.value = v;\n                                innerValueChange(this, v);\n                                that.dirty_canvas = true;\n                                return false;\n                            }\n                        }\n                    } else if (event.type === \"mouseup\" && w.type === \"number\") {\n                        const delta = x < 40 ? -1 : x > widgetWidth - 40 ? 1 : 0;\n                        if (event.click_time < 200 && delta == 0) {\n                            this.prompt(\"Value\", w.value, (v) => {\n                                w.value = Number(v);\n                                innerValueChange(w, w.value);\n                            }, event);\n                        }\n                    }\n\n                    if (oldValue !== w.value) {\n                        setTimeout(\n                            () => {\n                                innerValueChange(this, this.value);\n                            },\n                            20,\n                        );\n                    }\n                    this.dirty_canvas = true;\n                    break;\n                case \"toggle\":\n                    if (event.type === \"mousedown\") {\n                        w.value = !w.value;\n                        setTimeout(() => {\n                            innerValueChange(w, w.value);\n                        }, 20);\n                    }\n                    break;\n                case \"string\":\n                case \"text\":\n                    if (event.type === \"mousedown\") {\n                        this.prompt(\"Value\", w.value, (v) => {\n                            w.value = v;\n                            innerValueChange(w, v);\n                        }, event, w.options ? w.options.multiline : false);\n                    }\n                    break;\n                default:\n                    if (w.mouse) {\n                        this.dirty_canvas = w.mouse(event, [x, y], node);\n                    }\n                    break;\n            } // end switch\n\n            // value changed\n            if (oldValue !== w.value) {\n                if (node.onWidgetChanged) node.onWidgetChanged(w.name, w.value, oldValue, w);\n                node.graph._version++;\n            }\n\n            return w;\n        }\n\n        const that = this;\n        function innerValueChange(widget, value) {\n            widget.value = value;\n            if (widget.options && widget.options.property && node.properties[widget.options.property]) {\n                node.setProperty(widget.options.property, value);\n            }\n            if (widget.callback) {\n                widget.callback(widget.value, that, node, pos, event);\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * draws every group area in the background\n     * @method drawGroups\n     * @memberOf LGraphCanvas\n     * */\n    drawGroups(canvas, ctx) {\n        if (!this.graph) return;\n\n        const groups = this.graph._groups;\n\n        ctx.save();\n        ctx.globalAlpha = 0.5 * this.editor_alpha;\n\n        for (const group of groups) {\n            if (!overlapBounding(this.visible_area, group._bounding)) {\n                continue;\n            } // out of the visible area\n\n            ctx.fillStyle = group.color || \"#335\";\n            ctx.strokeStyle = group.color || \"#335\";\n            const pos = group._pos;\n            const size = group._size;\n            ctx.globalAlpha = 0.25 * this.editor_alpha;\n            ctx.beginPath();\n            ctx.rect(pos[0] + 0.5, pos[1] + 0.5, size[0], size[1]);\n            ctx.fill();\n            ctx.globalAlpha = this.editor_alpha;\n            ctx.stroke();\n\n            ctx.beginPath();\n            ctx.moveTo(pos[0] + size[0], pos[1] + size[1]);\n            ctx.lineTo(pos[0] + size[0] - 10, pos[1] + size[1]);\n            ctx.lineTo(pos[0] + size[0], pos[1] + size[1] - 10);\n            ctx.fill();\n\n            const fontSize = group.font_size || defaultConfig.DEFAULT_GROUP_FONT_SIZE;\n            ctx.font = `${fontSize}px Arial`;\n            ctx.fillText(group.title, pos[0] + 4, pos[1] + fontSize);\n        }\n\n        ctx.restore();\n    }\n\n    adjustNodesSize() {\n        const nodes = this.graph._nodes;\n        for (const node of nodes) node.size = node.computeSize();\n        this.setDirty(true, true);\n    }\n\n    /**\n     * resizes the canvas to a given size, if no size is passed, then it tries to fill the\n     * parentNode\n     * @method resize\n     * @memberOf LGraphCanvas\n     * */\n    resize(width, height) {\n        if (!width && !height) {\n            const parent = this.canvas.parentNode;\n            width = parent.offsetWidth;\n            height = parent.offsetHeight;\n        }\n\n        if (this.canvas.width === width && this.canvas.height === height) {\n            return;\n        }\n\n        this.canvas.width = width;\n        this.canvas.height = height;\n        this.bgcanvas.width = this.canvas.width;\n        this.bgcanvas.height = this.canvas.height;\n        this.setDirty(true, true);\n    }\n\n    /**\n     * switches to live mode (node shapes are not rendered, only the content)\n     * this feature was designed when graphs where meant to create user interfaces\n     * @method switchLiveMode\n     * @memberOf LGraphCanvas\n     * */\n    switchLiveMode(transition) {\n        if (!transition) {\n            this.live_mode = !this.live_mode;\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n            return;\n        }\n\n        const delta = this.live_mode ? 1.1 : 0.9;\n        if (this.live_mode) {\n            this.live_mode = false;\n            this.editor_alpha = 0.1;\n        }\n\n        const t = setInterval(() => {\n            this.editor_alpha *= delta;\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n\n            if (delta < 1 && this.editor_alpha < 0.01) {\n                clearInterval(t);\n                if (delta < 1) {\n                    this.live_mode = true;\n                }\n            }\n            if (delta > 1 && this.editor_alpha > 0.99) {\n                clearInterval(t);\n                this.editor_alpha = 1;\n            }\n        }, 1);\n    }\n\n    /**\n     * @method onNodeSelectionChange\n     * @param node\n     * @todo Need create event\n     * @memberOf LGraphCanvas\n     */\n    onNodeSelectionChange(node) {\n        // disabled\n    }\n\n    /**\n     * @method touchHandler\n     * @param {TouchEvent} event\n     * @memberOf LGraphCanvas\n     */\n    touchHandler(event) {\n        // alert(\"foo\");\n        const touches = event.changedTouches;\n        const first = touches[0];\n        let type = \"\";\n\n        switch (event.type) {\n            case \"touchstart\":\n                type = \"mousedown\";\n                break;\n            case \"touchmove\":\n                type = \"mousemove\";\n                break;\n            case \"touchend\":\n                type = \"mouseup\";\n                break;\n            default:\n                return;\n        }\n\n        // initMouseEvent(type, canBubble, cancelable, view, clickCount,\n        //           screenX, screenY, clientX, clientY, ctrlKey,\n        //           altKey, shiftKey, metaKey, button, relatedTarget);\n\n        const window = this.getCanvasWindow();\n        const { document } = window;\n\n        const simulatedEvent = document.createEvent(\"MouseEvent\");\n        simulatedEvent.initMouseEvent(\n            type,\n            true,\n            true,\n            window,\n            1,\n            first.screenX,\n            first.screenY,\n            first.clientX,\n            first.clientY,\n            false,\n            false,\n            false,\n            false,\n            0 /* left */,\n            null,\n        );\n        first.target.dispatchEvent(simulatedEvent);\n        event.preventDefault();\n    }\n\n    /**\n     * @method onGroupAdd\n     * @param info\n     * @param entry\n     * @param {MouseEvent} mouseEvent\n     * @memberOf LGraphCanvas\n     */\n    static onGroupAdd(info, entry, mouseEvent) {\n        const canvas = LGraphCanvas.active_canvas;\n\n        const group = new LGraphGroup();\n        group.pos = canvas.convertEventToCanvasOffset(mouseEvent);\n        canvas.graph.add(group);\n    }\n\n    static onMenuAdd(node, options, e, previousMenu, callback) {\n        const canvas = LGraphCanvas.active_canvas;\n        const refWindow = canvas.getCanvasWindow();\n        const { graph } = canvas;\n        if (!graph) return;\n\n        function inner_onMenuAdded(base_category, prev_menu) {\n            const categories = registry.getNodeTypesCategories(canvas.filter || graph.filter)\n                .filter((category) => category.startsWith(base_category));\n            const entries = [];\n\n            categories.forEach((category) => {\n                if (!category) {\n                    return;\n                }\n\n                const base_category_regex = new RegExp(`^(${base_category})`);\n                const category_name = category.replace(base_category_regex, \"\").split(\"/\")[0];\n                const category_path = base_category === \"\" ? `${category_name}/` : `${base_category + category_name}/`;\n\n                let name = category_name;\n                if (name.indexOf(\"::\") != -1) {\n                    name = name.split(\"::\")[1];\n                }\n\n                const index = entries.findIndex((entry) => entry.value === category_path);\n                if (index === -1) {\n                    entries.push({\n                        value: category_path,\n                        content: name,\n                        has_submenu: true,\n                        callback(value, event, mouseEvent, contextMenu) {\n                            inner_onMenuAdded(value.value, contextMenu);\n                        },\n                    });\n                }\n            });\n\n            const nodes = registry.getNodeTypesInCategory(base_category.slice(0, -1), canvas.filter || graph.filter);\n            nodes.forEach((node) => {\n                if (node.skip_list) return;\n\n                const entry = {\n                    value: node.type,\n                    content: node.title,\n                    has_submenu: false,\n                    callback(value, event, mouseEvent, contextMenu) {\n                        const first_event = contextMenu.getFirstEvent();\n                        canvas.graph.beforeChange();\n                        const node = LGraphNode.createNode(value.value);\n                        if (node) {\n                            node.pos = canvas.convertEventToCanvasOffset(first_event);\n                            canvas.graph.add(node);\n                        }\n                        if (callback) callback(node);\n                        canvas.graph.afterChange();\n                    },\n                };\n\n                entries.push(entry);\n            });\n\n            new ContextMenu(entries, {\n                event: e,\n                parentMenu: prev_menu,\n            }, refWindow);\n        }\n\n        inner_onMenuAdded(\"\", previousMenu);\n        return false;\n    }\n\n    /**\n     * @method onMenuCollapseAll\n     * @todo Need create event\n     * @memberOf LGraphCanvas\n     */\n    static onMenuCollapseAll() {\n    }\n\n    /**\n     * @method onMenuNodeEdit\n     * @todo Need create event\n     * @memberOf LGraphCanvas\n     */\n    static onMenuNodeEdit() {\n    }\n\n    static showMenuNodeOptionalInputs(v, optionsParam, e, previousMenu, node) {\n        if (!node) return;\n\n        const that = this;\n        const canvas = LGraphCanvas.active_canvas;\n        const refWindow = canvas.getCanvasWindow();\n\n        let options = node.optional_inputs;\n        if (node.onGetInputs) options = node.onGetInputs();\n\n        let entries = [];\n        if (options) {\n            for (const entry of options) {\n                if (!entry) {\n                    entries.push(null);\n                    continue;\n                }\n                let label = entry[0];\n                if (entry[2] && entry[2].label) {\n                    label = entry[2].label;\n                }\n                const data = {\n                    content: label,\n                    value: entry,\n                };\n                if (entry[1] === defaultConfig.ACTION) {\n                    data.className = \"event\";\n                }\n                entries.push(data);\n            }\n        }\n\n        if (this.onMenuNodeInputs) entries = this.onMenuNodeInputs(entries);\n\n        if (!entries.length) {\n            console.log(\"no input entries\");\n            return;\n        }\n\n        const menu = new ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: innerClicked,\n                parentMenu: previousMenu,\n                node,\n            },\n            refWindow,\n        );\n\n        function innerClicked(v, e, prev) {\n            if (!node) {\n                return;\n            }\n\n            if (v.callback) {\n                v.callback.call(that, node, v, e, prev);\n            }\n\n            if (v.value) {\n                node.graph.beforeChange();\n                node.addInput(v.value[0], v.value[1], v.value[2]);\n                node.setDirtyCanvas(true, true);\n                node.graph.afterChange();\n            }\n        }\n\n        return false;\n    }\n\n    static showMenuNodeOptionalOutputs(v, optionsParam, e, previousMenu, node) {\n        if (!node) return;\n\n        const that = this;\n        const canvas = LGraphCanvas.active_canvas;\n        const refWindow = canvas.getCanvasWindow();\n\n        let options = node.optional_outputs;\n        if (node.onGetOutputs) {\n            options = node.onGetOutputs();\n        }\n\n        let entries = [];\n        if (options) {\n            for (const entry of options) {\n                if (!entry) {\n                    // separator?\n                    entries.push(null);\n                    continue;\n                }\n\n                if (node.flags\n                    && node.flags.skip_repeated_outputs\n                    && node.findOutputSlot(entry[0]) !== -1) {\n                    continue;\n                } // skip the ones already on\n                let label = entry[0];\n                if (entry[2] && entry[2].label) label = entry[2].label;\n                const data = {\n                    content: label,\n                    value: entry,\n                };\n                if (entry[1] === defaultConfig.EVENT) data.className = \"event\";\n                entries.push(data);\n            }\n        }\n\n        if (this.onMenuNodeOutputs) entries = this.onMenuNodeOutputs(entries);\n\n        if (!entries.length) return;\n\n        const menu = new ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: innerClicked,\n                parentMenu: previousMenu,\n                node,\n            },\n            refWindow,\n        );\n\n        function innerClicked(v, e, prev) {\n            if (!node) return;\n\n            if (v.callback) v.callback.call(that, node, v, e, prev);\n\n            if (!v.value) {\n                return;\n            }\n\n            const value = v.value[1];\n\n            if (\n                value\n                && (value.constructor === Object || value.constructor === Array)\n            ) {\n                // submenu why?\n                const entries = [];\n                for (const i in value) {\n                    entries.push({\n                        content: i,\n                        value: value[i],\n                    });\n                }\n                new ContextMenu(entries, {\n                    event: e,\n                    callback: innerClicked,\n                    parentMenu: previousMenu,\n                    node,\n                });\n                return false;\n            }\n            node.graph.beforeChange();\n            node.addOutput(v.value[0], v.value[1], v.value[2]);\n            node.setDirtyCanvas(true, true);\n            node.graph.afterChange();\n        }\n\n        return false;\n    }\n\n    static onShowMenuNodeProperties(value, options, e, previousMenu, node) {\n        if (!node || !node.properties) {\n            return;\n        }\n\n        const canvas = LGraphCanvas.active_canvas;\n        const refWindow = canvas.getCanvasWindow();\n\n        const entries = [];\n        // eslint-disable-next-line\n        for (const i in node.properties) {\n            let value = node.properties[i] ? node.properties[i] : \" \";\n            if (typeof value === \"object\") value = JSON.stringify(value);\n            const info = node.getPropertyInfo(i);\n            if (info.type == \"enum\" || info.type == \"combo\") value = LGraphCanvas.getPropertyPrintableValue(value, info.values);\n\n            // value could contain invalid html characters, clean that\n            value = LGraphCanvas.decodeHTML(value);\n            entries.push({\n                content:\n                    `<span class=\"property_name\">${\n                        info.label ? info.label : i\n                    }</span>`\n                    + `<span class=\"property_value\">${\n                        value\n                    }</span>`,\n                value: i,\n            });\n        }\n        if (!entries.length) {\n            return;\n        }\n\n        const menu = new ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: innerClicked,\n                parentMenu: previousMenu,\n                allow_html: true,\n                node,\n            },\n            refWindow,\n        );\n\n        function innerClicked(v) {\n            if (!node) {\n                return;\n            }\n            const rect = this.getBoundingClientRect();\n            canvas.showEditPropertyValue(node, v.value, {\n                position: [rect.left, rect.top],\n            });\n        }\n\n        return false;\n    }\n\n    static decodeHTML(str) {\n        const e = document.createElement(\"div\");\n        e.innerText = str;\n        return e.innerHTML;\n    }\n\n    static onResizeNode(value, options, e, menu, node) {\n        if (!node) return;\n        node.size = node.computeSize();\n        if (node.onResize) node.onResize(node.size);\n        node.setDirtyCanvas(true, true);\n    }\n\n    showLinkMenu(link, e) {\n        const that = this;\n        const options = [\"Add Node\", null, \"Delete\"];\n        const menu = new ContextMenu(options, {\n            event: e,\n            title: link.data != null ? link.data.constructor.name : null,\n            callback: innerClicked,\n        });\n\n        function innerClicked(v, options, e) {\n            switch (v) {\n                case \"Add Node\":\n                    LGraphCanvas.onMenuAdd(null, null, e, menu, (node) => {\n                        console.log(\"node autoconnect\");\n                        const nodeLeft = that.graph.getNodeById(link.origin_id);\n                        const nodeRight = that.graph.getNodeById(link.target_id);\n                        if (!node.inputs\n                            || !node.inputs.length\n                            || !node.outputs\n                            || !node.outputs.length) return;\n                        if (nodeLeft.outputs[link.origin_slot].type === node.inputs[0].type && node.outputs[0].type === nodeRight.inputs[0].type) {\n                            nodeLeft.connect(link.origin_slot, node, 0);\n                            node.connect(0, nodeRight, link.target_slot);\n                            node.pos[0] -= node.size[0] * 0.5;\n                        }\n                    });\n                    break;\n                case \"Delete\":\n                    that.graph.removeLink(link.id);\n                    break;\n                default:\n            }\n        }\n\n        return false;\n    }\n\n    static onShowPropertyEditor(item, options, e, menu, node) {\n        const property = item.property || \"title\";\n        const value = node[property];\n\n        const dialog = document.createElement(\"div\");\n        dialog.className = \"graphdialog\";\n        dialog.innerHTML = \"<span class='name'></span><input autofocus type='text' class='value'/><button>OK</button>\";\n\n        const title = dialog.querySelector(\".name\");\n        title.innerText = property;\n\n        const input = dialog.querySelector(\".value\");\n        if (input) {\n            input.value = value;\n            input.addEventListener(\"blur\", (e) => {\n                input.focus();\n            });\n            input.addEventListener(\"keydown\", (e) => {\n                if (e.keyCode !== 13 && e.target.localName !== \"textarea\") return;\n                setValue(input.value);\n                e.preventDefault();\n                e.stopPropagation();\n            });\n        }\n\n        const graphcanvas = LGraphCanvas.active_canvas;\n        const { canvas } = graphcanvas;\n\n        const rect = canvas.getBoundingClientRect();\n        let offsetx = -20;\n        let offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (e) {\n            dialog.style.left = `${e.clientX + offsetx}px`;\n            dialog.style.top = `${e.clientY + offsety}px`;\n        } else {\n            dialog.style.left = `${canvas.width * 0.5 + offsetx}px`;\n            dialog.style.top = `${canvas.height * 0.5 + offsety}px`;\n        }\n\n        const button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", () => setValue(input.value));\n        canvas.parentNode.appendChild(dialog);\n\n        function setValue(value) {\n            if (item.type === \"Number\") {\n                value = Number(value);\n            } else if (item.type === \"Boolean\") {\n                value = Boolean(value);\n            }\n            node[property] = value;\n            if (dialog.parentNode) {\n                dialog.remove();\n            }\n            node.setDirtyCanvas(true, true);\n        }\n    }\n\n    prompt(title = \"\", value, callback, event, multiline) {\n        const that = this;\n\n        let modified = false;\n\n        const dialog = document.createElement(\"div\");\n        dialog.className = \"graphdialog rounded\";\n        if (multiline) {\n            dialog.innerHTML = \"<span class='name'></span> <textarea autofocus class='value'></textarea><button class='rounded'>OK</button>\";\n        } else {\n            dialog.innerHTML = \"<span class='name'></span> <input autofocus type='text' class='value'/><button class='rounded'>OK</button>\";\n        }\n        dialog.close = () => {\n            this.prompt_box = null;\n            if (dialog.parentNode) dialog.remove();\n        };\n\n        if (this.ds.scale > 1) {\n            dialog.style.transform = `scale(${this.ds.scale})`;\n        }\n\n        dialog.addEventListener(\"mouseleave\", (e) => {\n            if (!modified) dialog.close();\n        });\n\n        if (this.prompt_box) {\n            this.prompt_box.close();\n        }\n        this.prompt_box = dialog;\n\n        const first = null;\n        const timeout = null;\n        const selected = null;\n\n        const nameElement = dialog.querySelector(\".name\");\n        nameElement.innerText = title;\n        const valueElement = dialog.querySelector(\".value\");\n        valueElement.value = value;\n\n        const input = valueElement;\n        input.addEventListener(\"keydown\", (e) => {\n            modified = true;\n            if (e.keyCode === 27) dialog.close();\n            else if (e.keyCode === 13 && e.target.localName !== \"textarea\") {\n                if (callback) {\n                    callback(input.value);\n                }\n                dialog.close();\n            } else {\n                return;\n            }\n            e.preventDefault();\n            e.stopPropagation();\n        });\n\n        const button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", () => {\n            if (callback) callback(input.value);\n            this.setDirty(true);\n            dialog.close();\n        });\n\n        const graphcanvas = LGraphCanvas.active_canvas;\n        const { canvas } = graphcanvas;\n\n        const rect = canvas.getBoundingClientRect();\n        let offsetx = -20;\n        let offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (event) {\n            dialog.style.left = `${event.clientX + offsetx}px`;\n            dialog.style.top = `${event.clientY + offsety}px`;\n        } else {\n            dialog.style.left = `${canvas.width * 0.5 + offsetx}px`;\n            dialog.style.top = `${canvas.height * 0.5 + offsety}px`;\n        }\n\n        canvas.parentNode.appendChild(dialog);\n        setTimeout(() => input.focus(), 10);\n\n        return dialog;\n    }\n\n    static search_limit = -1\n\n    showSearchBox = function (event) {\n        const that = this;\n        const graphcanvas = LGraphCanvas.active_canvas;\n        const { canvas } = graphcanvas;\n        const rootDocument = canvas.ownerDocument || document;\n\n        const dialog = document.createElement(\"div\");\n        dialog.className = \"litegraph litesearchbox graphdialog rounded\";\n        dialog.innerHTML = \"<span class='name'>Search</span> <input autofocus type='text' class='value rounded'/><div class='helper'></div>\";\n        dialog.close = () => {\n            this.search_box = null;\n            rootDocument.body.focus();\n            rootDocument.body.style.overflow = \"\";\n\n            setTimeout(() => {\n                this.canvas.focus();\n            }, 20); // important, if canvas loses focus keys wont be captured\n            if (dialog.parentNode) {\n                dialog.remove();\n            }\n        };\n\n        let timeoutClose = null;\n\n        if (this.ds.scale > 1) dialog.style.transform = `scale(${this.ds.scale})`;\n\n        dialog.addEventListener(\"mouseenter\", () => {\n            if (timeoutClose) {\n                clearTimeout(timeoutClose);\n                timeoutClose = null;\n            }\n        });\n\n        dialog.addEventListener(\"mouseleave\", () => {\n            // dialog.close();\n            timeoutClose = setTimeout(() => dialog.close(), 500);\n        });\n\n        if (this.search_box) this.search_box.close();\n        this.search_box = dialog;\n\n        const helper = dialog.querySelector(\".helper\");\n\n        let first = null;\n        let timeout = null;\n        let selected = null;\n\n        const input = dialog.querySelector(\"input\");\n        if (input) {\n            input.addEventListener(\"blur\", () => input.focus());\n            input.addEventListener(\"keydown\", (e) => {\n                if (e.keyCode === 38) {\n                    // UP\n                    changeSelection(false);\n                } else if (e.keyCode === 40) {\n                    // DOWN\n                    changeSelection(true);\n                } else if (e.keyCode === 27) {\n                    // ESC\n                    dialog.close();\n                } else if (e.keyCode === 13) {\n                    if (selected) {\n                        select(selected.innerHTML);\n                    } else if (first) {\n                        select(first);\n                    } else {\n                        dialog.close();\n                    }\n                } else {\n                    if (timeout) {\n                        clearInterval(timeout);\n                    }\n                    timeout = setTimeout(refreshHelper, 10);\n                    return;\n                }\n                e.preventDefault();\n                e.stopPropagation();\n                e.stopImmediatePropagation();\n                return true;\n            });\n        }\n\n        if (rootDocument.fullscreenElement) rootDocument.fullscreenElement.appendChild(dialog);\n        else {\n            rootDocument.body.appendChild(dialog);\n            rootDocument.body.style.overflow = \"hidden\";\n        }\n\n        // compute best position\n        const rect = canvas.getBoundingClientRect();\n\n        const left = (event ? event.clientX : (rect.left + rect.width * 0.5)) - 80;\n        const top = (event ? event.clientY : (rect.top + rect.height * 0.5)) - 20;\n        dialog.style.left = `${left}px`;\n        dialog.style.top = `${top}px`;\n\n        // To avoid out of screen problems\n        if (event.layerY > (rect.height - 200)) {\n            helper.style.maxHeight = `${rect.height - event.layerY - 20}px`;\n        }\n\n        input.focus();\n\n        function select(name) {\n            if (name) {\n                if (that.onSearchBoxSelection) {\n                    that.onSearchBoxSelection(name, event, graphcanvas);\n                } else {\n                    const extra = defaultConfig.searchbox_extras[name.toLowerCase()];\n                    if (extra) {\n                        name = extra.type;\n                    }\n\n                    graphcanvas.graph.beforeChange();\n                    const node = LGraphNode.createNode(name);\n                    if (node) {\n                        node.pos = graphcanvas.convertEventToCanvasOffset(\n                            event,\n                        );\n                        graphcanvas.graph.add(node);\n                    }\n\n                    if (extra && extra.data) {\n                        if (extra.data.properties) {\n                            // eslint-disable-next-line\n                            for (const i in extra.data.properties) {\n                                node.addProperty(i, extra.data.properties[i]);\n                            }\n                        }\n                        if (extra.data.inputs) {\n                            node.inputs = [];\n                            // eslint-disable-next-line\n                            for (const i in extra.data.inputs) {\n                                node.addOutput(\n                                    extra.data.inputs[i][0],\n                                    extra.data.inputs[i][1],\n                                );\n                            }\n                        }\n                        if (extra.data.outputs) {\n                            node.outputs = [];\n                            // eslint-disable-next-line\n                            for (const i in extra.data.outputs) {\n                                node.addOutput(\n                                    extra.data.outputs[i][0],\n                                    extra.data.outputs[i][1],\n                                );\n                            }\n                        }\n                        if (extra.data.title) node.title = extra.data.title;\n                        if (extra.data.json) node.configure(extra.data.json);\n\n                        graphcanvas.graph.afterChange();\n                    }\n                }\n            }\n\n            dialog.close();\n        }\n\n        function changeSelection(forward) {\n            const prev = selected;\n            if (selected) selected.classList.remove(\"selected\");\n            if (!selected) {\n                selected = forward\n                    ? helper.childNodes[0]\n                    : helper.childNodes[helper.childNodes.length];\n            } else {\n                selected = forward\n                    ? selected.nextSibling\n                    : selected.previousSibling;\n                if (!selected) selected = prev;\n            }\n            if (!selected) return;\n            selected.classList.add(\"selected\");\n            selected.scrollIntoView({\n                block: \"end\",\n                behavior: \"smooth\",\n            });\n        }\n\n        function refreshHelper() {\n            timeout = null;\n            let str = input.value;\n            first = null;\n            helper.innerHTML = \"\";\n            if (!str) return;\n\n            if (that.onSearchBox) {\n                const list = that.onSearchBox(helper, str, graphcanvas);\n                if (list) {\n                    for (const l of list) addResult(l);\n                }\n            } else {\n                let c = 0;\n                str = str.toLowerCase();\n                const filter = graphcanvas.filter || graphcanvas.graph.filter;\n\n                // extras\n                // eslint-disable-next-line\n                for (const i in defaultConfig.searchbox_extras) {\n                    const extra = defaultConfig.searchbox_extras[i];\n                    if (extra.desc.toLowerCase().indexOf(str) === -1) {\n                        continue;\n                    }\n                    const ctor = defaultConfig.registered_node_types[extra.type];\n                    if (ctor && ctor.filter !== filter) continue;\n                    addResult(extra.desc, \"searchbox_extra\");\n                    if (LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit) {\n                        break;\n                    }\n                }\n\n                const keys = Object.keys(defaultConfig.registered_node_types); // types\n                const filtered = keys.filter((type) => {\n                    const ctor = defaultConfig.registered_node_types[type];\n                    if (filter && ctor.filter !== filter) return false;\n                    return type.toLowerCase().indexOf(str) !== -1;\n                });\n\n                for (const filteredItem of filtered) {\n                    addResult(filteredItem);\n                    if (LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit) {\n                        break;\n                    }\n                }\n            }\n\n            function addResult(type, className) {\n                const help = document.createElement(\"div\");\n                if (!first) first = type;\n                help.innerText = type;\n                help.dataset.type = escape(type);\n                help.className = \"litegraph lite-search-item\";\n                if (className) help.className += ` ${className}`;\n                help.addEventListener(\"click\", () => {\n                    select(unescape(help.dataset.type));\n                });\n                helper.appendChild(help);\n            }\n        }\n\n        return dialog;\n    }\n\n    showEditPropertyValue(node, property, options = {}) {\n        if (!node || node.properties[property] === undefined) return;\n\n        const info = node.getPropertyInfo(property);\n        const { type } = info;\n\n        let inputHTML = \"\";\n\n        if ([\"sring\", \"number\", \"array\", \"object\"].includes(type)) {\n            inputHTML = \"<input autofocus type='text' class='value'/>\";\n        } else if ([\"enum\", \"combo\"].includes(type) && info.values) {\n            inputHTML = \"<select autofocus type='text' class='value'>\";\n            // eslint-disable-next-line\n            for (const i in info.values) {\n                let value = i;\n                if (info.values.constructor === Array) value = info.values[i];\n\n                inputHTML += `<option value=\"${value}\" ${value == node.properties[property] ? \"selected\" : \"\"}>${info.values[i]}</option>`;\n            }\n            inputHTML += \"</select>\";\n        } else if (type === \"boolean\") {\n            inputHTML = `<input autofocus type=\"checkbox\" class=\"value\" ${\n                node.properties[property] ? \"checked\" : \"\"\n            }/>`;\n        } else {\n            console.warn(`unknown type: ${type}`);\n            return;\n        }\n\n        const dialog = this.createDialog(\n            `<span class=\"name\">${\n                info.label ? info.label : property\n            }</span>${\n                inputHTML\n            }<button>OK</button>`,\n            options,\n        );\n\n        if ([\"enum\", \"combo\"].includes(type) && info.values) {\n            const input = dialog.querySelector(\"select\");\n            input.addEventListener(\"change\", (e) => {\n                setValue(e.target.value);\n            });\n        } else if (type === \"boolean\") {\n            const input = dialog.querySelector(\"input\");\n            if (input) {\n                input.addEventListener(\"click\", () => setValue(!!input.checked));\n            }\n        } else {\n            const input = dialog.querySelector(\"input\");\n            if (input) {\n                input.addEventListener(\"blur\", () => { input.focus(); });\n\n                let v = node.properties[property] ? node.properties[property] : \"\";\n                if (type !== \"string\") {\n                    v = JSON.stringify(v);\n                }\n\n                input.value = v;\n                input.addEventListener(\"keydown\", (e) => {\n                    if (e.keyCode != 13) return;\n                    setValue(input.value);\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n            }\n        }\n\n        const button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", () => setValue(input.value));\n        function setValue(value) {\n            if (info\n                && info.values\n                && info.values.constructor === Object\n                && info.values[value]) value = info.values[value];\n\n            if (typeof node.properties[property] === \"number\") {\n                value = Number(value);\n            }\n            if ([\"array\", \"object\"].includes(type)) {\n                value = JSON.parse(value);\n            }\n            node.properties[property] = value;\n            if (node.graph) {\n                node.graph._version++;\n            }\n            if (node.onPropertyChanged) {\n                node.onPropertyChanged(property, value);\n            }\n            if (options.onclose) options.onclose();\n            dialog.close();\n            node.setDirtyCanvas(true, true);\n        }\n\n        return dialog;\n    }\n\n    createDialog(html, options = {}) {\n        const dialog = document.createElement(\"div\");\n        dialog.className = \"graphdialog\";\n        dialog.innerHTML = html;\n\n        const rect = this.canvas.getBoundingClientRect();\n        let offsetx = -20;\n        let offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (options.position) {\n            offsetx += options.position[0];\n            offsety += options.position[1];\n        } else if (options.event) {\n            offsetx += options.event.clientX;\n            offsety += options.event.clientY;\n        } // centered\n        else {\n            offsetx += this.canvas.width * 0.5;\n            offsety += this.canvas.height * 0.5;\n        }\n\n        dialog.style.left = `${offsetx}px`;\n        dialog.style.top = `${offsety}px`;\n\n        this.canvas.parentNode.appendChild(dialog);\n\n        dialog.close = () => {\n            if (dialog.parentNode) dialog.remove();\n        };\n\n        return dialog;\n    }\n\n    createPanel(title, options = {}) {\n        const refWindow = options.window || window;\n\n        const root = document.createElement(\"div\");\n        root.className = \"litegraph dialog\";\n        root.innerHTML = \"<div class='dialog-header'><span class='dialog-title'></span></div><div class='dialog-content'></div><div class='dialog-footer'></div>\";\n        root.header = root.querySelector(\".dialog-header\");\n\n        if (options.width) root.style.width = options.width + (options.width.constructor === Number ? \"px\" : \"\");\n        if (options.height) root.style.height = options.height + (options.height.constructor === Number ? \"px\" : \"\");\n        if (options.closable) {\n            const close = document.createElement(\"span\");\n            close.innerHTML = \"&#10005;\";\n            close.classList.add(\"close\");\n            close.addEventListener(\"click\", () => root.close());\n            root.header.appendChild(close);\n        }\n        root.title_element = root.querySelector(\".dialog-title\");\n        root.title_element.innerText = title;\n        root.content = root.querySelector(\".dialog-content\");\n        root.footer = root.querySelector(\".dialog-footer\");\n\n        root.close = () => root.remove();\n\n        root.clear = () => root.content.innerHTML = \"\";\n\n        root.addHTML = (code, classname, onFooter) => {\n            const elem = document.createElement(\"div\");\n            if (classname) elem.className = classname;\n            elem.innerHTML = code;\n            if (onFooter) root.footer.appendChild(elem);\n            else root.content.appendChild(elem);\n            return elem;\n        };\n\n        root.addButton = (name, callback, options) => {\n            const elem = document.createElement(\"button\");\n            elem.innerText = name;\n            elem.options = options;\n            elem.classList.add(\"btn\");\n            elem.addEventListener(\"click\", callback);\n            root.footer.appendChild(elem);\n            return elem;\n        };\n\n        root.addSeparator = () => {\n            const elem = document.createElement(\"div\");\n            elem.className = \"separator\";\n            root.content.appendChild(elem);\n        };\n\n        root.addWidget = (type, name, value, options = {}, callback) => {\n            type = type.toLowerCase();\n            value = String(value);\n            let strValue = type === \"number\" ? new Number(value).toFixed(3) : value.toString();\n            const elem = document.createElement(\"div\");\n            elem.className = \"property\";\n            elem.innerHTML = \"<span class='property_name'></span><span class='property_value'></span>\";\n            elem.querySelector(\".property_name\").innerText = name;\n            const valueElement = elem.querySelector(\".property_value\");\n            valueElement.innerText = strValue;\n            elem.dataset.property = name;\n            elem.dataset.type = options.type || type;\n            elem.options = options;\n            elem.value = strValue;\n\n            if (type === \"boolean\") {\n                elem.classList.add(\"boolean\");\n                if (value) elem.classList.add(\"bool-on\");\n                elem.addEventListener(\"click\", () => {\n                    // var v = node.properties[this.dataset[\"property\"]];\n                    // node.setProperty(this.dataset[\"property\"],!v); this.innerText = v ? \"true\" :\n                    // \"false\";\n                    const propname = elem.dataset.property;\n                    this.value = !elem.value;\n                    this.classList.toggle(\"bool-on\");\n                    this.querySelector(\".property_value\").innerText = elem.value ? \"true\" : \"false\";\n                    innerChange(propname, elem.value);\n                });\n            } else if ([\"string\", \"number\"].includes(type)) {\n                valueElement.setAttribute(\"contenteditable\", true);\n                valueElement.addEventListener(\"keydown\", (e) => {\n                    if (e.code === \"Enter\") {\n                        e.preventDefault();\n                        valueElement.blur();\n                    }\n                });\n                valueElement.addEventListener(\"blur\", () => {\n                    let v = valueElement.innerText;\n                    const propname = valueElement.parentNode.dataset.property;\n                    const proptype = valueElement.parentNode.dataset.type;\n                    if (proptype === \"number\") v = Number(v);\n                    innerChange(propname, v);\n                });\n            } else if ([\"enum\", \"combo\"].includes(type)) strValue = LGraphCanvas.getPropertyPrintableValue(value, options.values);\n            valueElement.innerText = strValue;\n\n            valueElement.addEventListener(\"click\", (event) => {\n                const values = options.values || [];\n                const propname = valueElement.parentNode.dataset.property;\n                const menu = new ContextMenu(values, {\n                    event,\n                    className: \"dark\",\n                    callback: (v, option, event) => {\n                        this.innerText = v;\n                        innerChange(propname, v);\n                        return false;\n                    },\n                },\n                refWindow);\n            });\n\n            root.content.appendChild(elem);\n\n            function innerChange(name, value) {\n                console.log(\"change\", name, value);\n                // that.dirty_canvas = true;\n                if (options.callback) options.callback(name, value);\n                if (callback) callback(name, value);\n            }\n\n            return elem;\n        };\n\n        return root;\n    }\n\n    static getPropertyPrintableValue(value, values) {\n        if (!values) return String(value);\n        if (values.constructor === Array) return String(value);\n\n        if (values.constructor === Object) {\n            let desc_value = \"\";\n            for (const k in values) {\n                if (values[k] !== value) continue;\n                desc_value = k;\n                break;\n            }\n            return `${String(value)} (${desc_value})`;\n        }\n    }\n\n    showShowNodePanel = function (node) {\n        window.SELECTED_NODE = node;\n        let panel = document.querySelector(\"#node-panel\");\n        if (panel) panel.close();\n        const refWindow = this.getCanvasWindow();\n        panel = this.createPanel(node.title || \"\", {\n            closable: true,\n            window: refWindow,\n        });\n        panel.id = \"node-panel\";\n        panel.node = node;\n        panel.classList.add(\"settings\");\n        const that = this;\n        const graphcanvas = this;\n\n        const inner_refresh = () => {\n            panel.content.innerHTML = \"\"; // clear\n            panel.addHTML(`<span class=\"node_type\">${node.type}</span><span class=\"node_desc\">${node.constructor.desc || \"\"}</span><span class=\"separator\"></span>`);\n\n            panel.addHTML(\"<h3>Properties</h3>\");\n\n            for (const i in node.properties) {\n                const value = node.properties[i];\n                const info = node.getPropertyInfo(i);\n\n                if (node.onAddPropertyToPanel && node.onAddPropertyToPanel(i, panel)) continue;\n\n                panel.addWidget(info.widget || info.type, i, value, info, (name, value) => {\n                    graphcanvas.graph.beforeChange(node);\n                    node.setProperty(name, value);\n                    graphcanvas.graph.afterChange();\n                    graphcanvas.dirty_canvas = true;\n                });\n            }\n\n            panel.addSeparator();\n\n            if (node.onShowCustomPanelInfo) node.onShowCustomPanelInfo(panel);\n            panel.addButton(\"Delete\", () => {\n                if (node.block_delete) return;\n                node.graph.remove(node);\n                panel.close();\n            })\n                .classList\n                .add(\"delete\");\n        };\n\n        function inner_showCodePad(node, propname) {\n            panel.style.top = \"calc( 50% - 250px)\";\n            panel.style.left = \"calc( 50% - 400px)\";\n            panel.style.width = \"800px\";\n            panel.style.height = \"500px\";\n\n            panel.content.innerHTML = \"<textarea class='code'></textarea>\";\n            const textarea = panel.content.querySelector(\"textarea\");\n            textarea.value = node.properties[propname];\n            textarea.addEventListener(\"keydown\", (e) => {\n                if (e.code === \"Enter\" && e.ctrlKey) {\n                    console.log(\"Assigned\");\n                    node.setProperty(propname, textarea.value);\n                }\n            });\n            textarea.style.height = \"calc(100% - 40px)\";\n\n            const assign = that.createButton(\"Assign\", null, () => {\n                node.setProperty(propname, textarea.value);\n            });\n            panel.content.appendChild(assign);\n            const button = that.createButton(\"Close\", null, () => {\n                panel.style.height = \"\";\n                inner_refresh();\n            });\n            button.style.float = \"right\";\n            panel.content.appendChild(button);\n        }\n\n        inner_refresh();\n\n        this.canvas.parentNode.appendChild(panel);\n    }\n\n    showSubgraphPropertiesDialog(node) {\n        console.log(\"showing subgraph properties dialog\");\n\n        const old_panel = this.canvas.parentNode.querySelector(\".subgraph_dialog\");\n        if (old_panel) old_panel.close();\n\n        const panel = this.createPanel(\"Subgraph Inputs\", {\n            closable: true,\n            width: 500,\n        });\n        panel.node = node;\n        panel.classList.add(\"subgraph_dialog\");\n\n        function inner_refresh() {\n            panel.clear();\n\n            // show currents\n            if (node.inputs) {\n                for (const input of node.inputs) {\n                    if (input.not_subgraph_input) continue;\n                    const html = \"<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>\";\n                    const elem = panel.addHTML(html, \"subgraph_property\");\n                    elem.dataset.name = input.name;\n                    elem.dataset.slot = i;\n                    elem.querySelector(\".name\").innerText = input.name;\n                    elem.querySelector(\".type\").innerText = input.type;\n                    elem.querySelector(\"button\")\n                        .addEventListener(\"click\", () => {\n                            node.removeInput(Number(elem.parentNode.dataset.slot));\n                            inner_refresh();\n                        });\n                }\n            }\n        }\n\n        // add extra\n        const html = \" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'/><button>+</button>\";\n        const elem = panel.addHTML(html, \"subgraph_property extra\", true);\n        elem.querySelector(\"button\")\n            .addEventListener(\"click\", function (e) {\n                const elem = this.parentNode;\n                const name = elem.querySelector(\".name\").value;\n                const type = elem.querySelector(\".type\").value;\n                if (!name || node.findInputSlot(name) !== -1) return;\n                node.addInput(name, type);\n                elem.querySelector(\".name\").value = \"\";\n                elem.querySelector(\".type\").value = \"\";\n                inner_refresh();\n            });\n\n        inner_refresh();\n        this.canvas.parentNode.appendChild(panel);\n        return panel;\n    }\n\n    checkPanels() {\n        if (!this.canvas) return;\n        const panels = this.canvas.parentNode.querySelectorAll(\".litegraph.dialog\");\n        for (const panel of panels) {\n            if (!panel.node) continue;\n            if (!panel.node.graph || panel.graph !== this.graph) panel.close();\n        }\n    }\n\n    static onMenuNodeCollapse(value, options, e, menu, node) {\n        node.graph.beforeChange(node);\n        node.collapse();\n        node.graph.afterChange(node);\n    }\n\n    static onMenuNodePin(value, options, e, menu, node) {\n        node.pin();\n    }\n\n    static onMenuNodeMode = function (value, options, e, menu, node) {\n        new ContextMenu(\n            [\"Always\", \"On Event\", \"On Trigger\", \"Never\"],\n            {\n                event: e,\n                callback: (v) => {\n                    if (!node) {\n                        return;\n                    }\n                    switch (v) {\n                        case \"On Event\":\n                            node.mode = defaultConfig.ON_EVENT;\n                            break;\n                        case \"On Trigger\":\n                            node.mode = defaultConfig.ON_TRIGGER;\n                            break;\n                        case \"Never\":\n                            node.mode = defaultConfig.NEVER;\n                            break;\n                        case \"Always\":\n                        default:\n                            node.mode = defaultConfig.ALWAYS;\n                            break;\n                    }\n                },\n                parentMenu: menu,\n                node,\n            },\n        );\n        return false;\n    }\n\n    static onMenuNodeColors(value, options, e, menu, node) {\n        if (!node) throw new Error(\"no node for color\");\n        const values = [];\n        values.push({\n            value: null,\n            content:\n                \"<span style='display: block; padding-left: 4px;'>No color</span>\",\n        });\n\n        // eslint-disable-next-line\n        for (const i in LGraphCanvas.node_colors) {\n            const color = LGraphCanvas.node_colors[i];\n            values.push({\n                value: i,\n                content: `<span style=\"display: block; color: #999; padding-left: 4px; border-left: 8px solid ${color.color}; background-color:${color.bgcolor}\">${i}</span>`,\n            });\n        }\n        new ContextMenu(values, {\n            event: e,\n            callback: (v) => {\n                if (!node) {\n                    return;\n                }\n\n                const color = v.value ? LGraphCanvas.node_colors[v.value] : null;\n                if (color) {\n                    if (node.constructor.name === \"LGraphGroup\") {\n                        node.color = color.groupcolor;\n                    } else {\n                        node.color = color.color;\n                        node.bgcolor = color.bgcolor;\n                    }\n                } else {\n                    delete node.color;\n                    delete node.bgcolor;\n                }\n                node.setDirtyCanvas(true, true);\n            },\n            parentMenu: menu,\n            node,\n        });\n\n        return false;\n    }\n\n    static onMenuNodeShapes(value, options, e, menu, node) {\n        if (!node) {\n            throw new Error(\"no node passed\");\n        }\n\n        new ContextMenu(defaultConfig.VALID_SHAPES, {\n            event: e,\n            callback: (v) => {\n                if (!node) return;\n                node.graph.beforeChange(node);\n                node.shape = v;\n                node.graph.afterChange(node);\n                node.setDirtyCanvas(true);\n            },\n        }, {\n            parentMenu: menu,\n            node,\n        });\n\n        return false;\n    }\n\n    static onMenuNodeRemove(value, options, e, menu, node) {\n        if (!node) throw new Error(\"no node passed\");\n        if (node.removable === false) return;\n\n        const { graph } = node;\n        graph.beforeChange();\n        graph.remove(node);\n        graph.afterChange();\n        node.setDirtyCanvas(true, true);\n    }\n\n    static onMenuNodeToSubgraph(value, options, e, menu, node) {\n        const { graph } = node;\n        const graphcanvas = LGraphCanvas.active_canvas;\n        if (!graphcanvas) return;\n\n        let nodesList = Object.values(graphcanvas.selected_nodes || {});\n        if (!nodesList.length) nodesList = [node];\n\n        const subgraphNode = LGraphNode.createNode(\"graph/subgraph\");\n        subgraphNode.pos = node.pos.concat();\n        graph.add(subgraphNode);\n\n        subgraphNode.buildFromNodes(nodesList);\n\n        graphcanvas.deselectAllNodes();\n        node.setDirtyCanvas(true, true);\n    }\n\n    static onMenuNodeClone(value, options, e, menu, node) {\n        if (node.clonable === false) return;\n        const newnode = node.clone();\n        if (!newnode) return;\n        newnode.pos = [node.pos[0] + 5, node.pos[1] + 5];\n\n        node.graph.beforeChange();\n        node.graph.add(newnode);\n        node.graph.afterChange();\n\n        node.setDirtyCanvas(true, true);\n    }\n\n    static node_colors = {\n        red: {\n            color: \"#322\",\n            bgcolor: \"#533\",\n            groupcolor: \"#A88\",\n        },\n        brown: {\n            color: \"#332922\",\n            bgcolor: \"#593930\",\n            groupcolor: \"#b06634\",\n        },\n        green: {\n            color: \"#232\",\n            bgcolor: \"#353\",\n            groupcolor: \"#8A8\",\n        },\n        blue: {\n            color: \"#223\",\n            bgcolor: \"#335\",\n            groupcolor: \"#88A\",\n        },\n        pale_blue: {\n            color: \"#2a363b\",\n            bgcolor: \"#3f5159\",\n            groupcolor: \"#3f789e\",\n        },\n        cyan: {\n            color: \"#233\",\n            bgcolor: \"#355\",\n            groupcolor: \"#8AA\",\n        },\n        purple: {\n            color: \"#323\",\n            bgcolor: \"#535\",\n            groupcolor: \"#a1309b\",\n        },\n        yellow: {\n            color: \"#432\",\n            bgcolor: \"#653\",\n            groupcolor: \"#b58b2a\",\n        },\n        black: {\n            color: \"#222\",\n            bgcolor: \"#000\",\n            groupcolor: \"#444\",\n        },\n    }\n\n    getCanvasMenuOptions() {\n        let options = null;\n        if (this.getMenuOptions) {\n            options = this.getMenuOptions();\n        } else {\n            options = [\n                {\n                    content: \"Add Node\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuAdd,\n                },\n                {\n                    content: \"Add Group\",\n                    callback: LGraphCanvas.onGroupAdd,\n                },\n                // {content:\"Collapse All\", callback: LGraphCanvas.onMenuCollapseAll }\n            ];\n\n            if (this._graph_stack && this._graph_stack.length > 0) {\n                options.push(null, {\n                    content: \"Close subgraph\",\n                    callback: this.closeSubgraph.bind(this),\n                });\n            }\n        }\n\n        if (this.getExtraMenuOptions) {\n            const extra = this.getExtraMenuOptions(this, options);\n            if (extra) options = options.concat(extra);\n        }\n\n        return options;\n    }\n\n    getNodeMenuOptions(node) {\n        let options = null;\n\n        if (node.getMenuOptions) options = node.getMenuOptions(this);\n        else {\n            options = [\n                {\n                    content: \"Inputs\",\n                    has_submenu: true,\n                    disabled: true,\n                    callback: LGraphCanvas.showMenuNodeOptionalInputs,\n                },\n                {\n                    content: \"Outputs\",\n                    has_submenu: true,\n                    disabled: true,\n                    callback: LGraphCanvas.showMenuNodeOptionalOutputs,\n                },\n                null,\n                {\n                    content: \"Properties\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onShowMenuNodeProperties,\n                },\n                null,\n                {\n                    content: \"Title\",\n                    callback: LGraphCanvas.onShowPropertyEditor,\n                },\n                {\n                    content: \"Mode\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeMode,\n                },\n                {\n                    content: \"Resize\",\n                    callback() {\n                        if (node.resizable) {\n                            return LGraphCanvas.onResizeNode;\n                        }\n                    },\n                },\n                {\n                    content: \"Collapse\",\n                    callback: LGraphCanvas.onMenuNodeCollapse,\n                },\n                {\n                    content: \"Pin\",\n                    callback: LGraphCanvas.onMenuNodePin,\n                },\n                {\n                    content: \"Colors\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeColors,\n                },\n                {\n                    content: \"Shapes\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeShapes,\n                },\n                null,\n            ];\n        }\n\n        if (node.onGetInputs) {\n            const inputs = node.onGetInputs();\n            if (inputs && inputs.length) options[0].disabled = false;\n        }\n\n        if (node.onGetOutputs) {\n            const outputs = node.onGetOutputs();\n            if (outputs && outputs.length) options[1].disabled = false;\n        }\n\n        if (node.getExtraMenuOptions) {\n            const extra = node.getExtraMenuOptions(this, options);\n            if (extra) {\n                extra.push(null);\n                options = extra.concat(options);\n            }\n        }\n\n        if (node.clonable) {\n            options.push({\n                content: \"Clone\",\n                callback: LGraphCanvas.onMenuNodeClone,\n            });\n        }\n\n        options.push(null, {\n            content: \"Remove\",\n            disabled: !(node.removable !== false && !node.block_delete),\n            callback: LGraphCanvas.onMenuNodeRemove,\n        });\n\n        if (node.graph && node.graph.onGetNodeMenuOptions) {\n            node.graph.onGetNodeMenuOptions(options, node);\n        }\n\n        return options;\n    }\n\n    getGroupMenuOptions() {\n        return [\n            {\n                content: \"Title\",\n                callback: LGraphCanvas.onShowPropertyEditor,\n            },\n            {\n                content: \"Color\",\n                has_submenu: true,\n                callback: LGraphCanvas.onMenuNodeColors,\n            },\n            {\n                content: \"Font size\",\n                property: \"font_size\",\n                type: \"Number\",\n                callback: LGraphCanvas.onShowPropertyEditor,\n            },\n            null,\n            {\n                content: \"Remove\",\n                callback: LGraphCanvas.onMenuNodeRemove,\n            },\n        ];\n    }\n\n    processContextMenu(node, event) {\n        const that = this;\n        const canvas = LGraphCanvas.active_canvas;\n        const refWindow = canvas.getCanvasWindow();\n\n        let menuInfo = null;\n        const options = {\n            event,\n            callback: inner_option_clicked,\n            extra: node,\n        };\n\n        if (node) options.title = node.type;\n\n        // check if mouse is in input\n        let slot = null;\n        if (node) {\n            slot = node.getSlotInPosition(event.canvasX, event.canvasY);\n            LGraphCanvas.active_node = node;\n        }\n\n        if (slot) {\n            // on slot\n            menuInfo = [];\n            if (node.getSlotMenuOptions) menuInfo = node.getSlotMenuOptions(slot);\n            else {\n                if (slot && slot.output && slot.output.links && slot.output.links.length) {\n                    menuInfo.push({\n                        content: \"Disconnect Links\",\n                        slot,\n                    });\n                }\n                const _slot = slot.input || slot.output;\n                menuInfo.push(_slot.locked ? \"Cannot remove\" : { content: \"Remove Slot\", slot });\n                menuInfo.push(_slot.nameLocked ? \"Cannot rename\" : { content: \"Rename Slot\", slot });\n            }\n            options.title = (slot.input ? slot.input.type : slot.output.type) || \"*\";\n            if (slot.input && slot.input.type === defaultConfig.ACTION) options.title = \"Action\";\n            if (slot.output && slot.output.type === defaultConfig.EVENT) options.title = \"Event\";\n        } else if (node) {\n            menuInfo = this.getNodeMenuOptions(node);\n        } else {\n            menuInfo = this.getCanvasMenuOptions();\n            const group = this.graph.getGroupOnPos(event.canvasX, event.canvasY);\n            if (group) {\n                // on group\n                menuInfo.push(null, {\n                    content: \"Edit Group\",\n                    has_submenu: true,\n                    submenu: {\n                        title: \"Group\",\n                        extra: group,\n                        options: this.getGroupMenuOptions(group),\n                    },\n                });\n            }\n        }\n\n        // show menu\n        if (!menuInfo) return;\n\n        const menu = new ContextMenu(menuInfo, options, refWindow);\n\n        function inner_option_clicked(v, options, e) {\n            if (!v) {\n                return;\n            }\n\n            if (v.content === \"Remove Slot\") {\n                const info = v.slot;\n                if (info.input) node.removeInput(info.slot);\n                else if (info.output) node.removeOutput(info.slot);\n            } else if (v.content === \"Disconnect Links\") {\n                const info = v.slot;\n                if (info.output) node.disconnectOutput(info.slot);\n                else if (info.input) node.disconnectInput(info.slot);\n            } else if (v.content === \"Rename Slot\") {\n                const info = v.slot;\n                const slotInfo = info.input\n                    ? node.getInputInfo(info.slot) : node.getOutputInfo(info.slot);\n                const dialog = that.createDialog(\n                    \"<span class='name'>Name</span><input autofocus type='text'/><button>OK</button>\",\n                    options,\n                );\n                const input = dialog.querySelector(\"input\");\n                if (input && slotInfo) input.value = slotInfo.label || \"\";\n                dialog.querySelector(\"button\")\n                    .addEventListener(\"click\", () => {\n                        if (input.value) {\n                            if (slotInfo) slotInfo.label = input.value;\n                            that.setDirty(true);\n                        }\n                        dialog.close();\n                    });\n            }\n        }\n    }\n}\n","import defaultConfig from \"./utils/defaultConfig\";\nimport getTime from \"./utils/time\";\nimport LGraphNode from \"./LGraphNode\";\nimport LGraphGroup from \"./LGraphGroup\";\nimport LGraphCanvas from \"./LGraphCanvas\";\nimport LLink from \"./LLink\";\n\n/**\n * LGraph is the class that contain a full graph.\n * We instantiate one and add nodes to it, and then we can run the execution loop.\n * supported callbacks:\n + onNodeAdded: when a new node is added to the graph\n + onNodeRemoved: when a node inside this graph is removed\n + onNodeConnectionChange: some connection has changed in the graph (connected or disconnected)\n *\n * @class LGraph\n * @constructor\n * @param {Object} o data from previous serialization [optional]\n */\nexport default class LGraph {\n    constructor(o) {\n        if (defaultConfig.debug) {\n            console.log(\"Graph created\");\n        }\n        this.list_of_graphcanvas = null;\n        this.clear();\n\n        if (o) {\n            this.configure(o);\n        }\n    }\n\n    getSupportedTypes() {\n        return this.supportedTypes || LGraph.supportedTypes;\n    }\n\n    STATUS_STOPPED = 1;\n\n    STATUS_RUNNING = 2;\n\n    supportedTypes = [\"number\", \"string\", \"boolean\"];\n\n    static supportedTypes = [\"number\", \"string\", \"boolean\"];\n    // used to know which types of connections support this graph (some graphs do not allow certain\n    // types)\n\n    /**\n     * Removes all nodes from this graph\n     * @method clear\n     * @memberOf LGraph\n     */\n    clear() {\n        this.stop();\n        this.status = this.STATUS_STOPPED;\n\n        this.last_node_id = 0;\n        this.last_link_id = 0;\n\n        this._version = -1; // used to detect changes\n\n        // safe clear\n        if (this._nodes) {\n            for (const node of this._nodes) {\n                if (node.onRemoved) node.onRemoved();\n            }\n        }\n\n        // nodes\n        this._nodes = [];\n        this._nodes_by_id = {};\n        this._nodes_in_order = []; // nodes sorted in execution order\n        this._nodes_executable = null; // nodes that contain onExecute sorted in execution order\n\n        // other scene stuff\n        this._groups = [];\n\n        // links\n        this.links = {}; // container with all the links\n\n        // iterations\n        this.iteration = 0;\n\n        // custom data\n        this.config = {};\n        this.vars = {};\n        this.extra = {}; // to store custom data\n\n        // timing\n        this.globaltime = 0;\n        this.runningtime = 0;\n        this.fixedtime = 0;\n        this.fixedtime_lapse = 0.01;\n        this.elapsed_time = 0.01;\n        this.last_update_time = 0;\n        this.starttime = 0;\n\n        this.catch_errors = true;\n\n        // subgraph_data\n        this.inputs = {};\n        this.outputs = {};\n\n        // notify canvas to redraw\n        this.change();\n\n        this.sendActionToCanvas(\"clear\");\n    }\n\n    /**\n     * Attach Canvas to this graph\n     * @method attachCanvas\n     * @param {GraphCanvas} graphcanvas\n     * @memberOf LGraph\n     */\n    attachCanvas(graphcanvas) {\n        if (graphcanvas.constructor !== LGraphCanvas) {\n            throw new Error(\"attachCanvas expects a LGraphCanvas instance\");\n        }\n        if (graphcanvas.graph && graphcanvas.graph !== this) {\n            graphcanvas.graph.detachCanvas(graphcanvas);\n        }\n\n        graphcanvas.graph = this;\n\n        if (!this.list_of_graphcanvas) this.list_of_graphcanvas = [];\n        this.list_of_graphcanvas.push(graphcanvas);\n    }\n\n    /**\n     * Detach Canvas from this graph\n     * @method detachCanvas\n     * @param {GraphCanvas} graphcanvas\n     * @memberOf LGraph\n     */\n    detachCanvas(graphcanvas) {\n        if (!this.list_of_graphcanvas) {\n            return;\n        }\n\n        const pos = this.list_of_graphcanvas.indexOf(graphcanvas);\n        if (pos === -1) {\n            return;\n        }\n        graphcanvas.graph = null;\n        this.list_of_graphcanvas.splice(pos, 1);\n    }\n\n    /**\n     * Starts running this graph every interval milliseconds.\n     * @method start\n     * @param {number} interval amount of milliseconds between executions, if 0 then it renders to\n     *     the monitor refresh rate\n     * @memberOf LGraph\n     */\n    start(interval) {\n        if (this.status === LGraph.STATUS_RUNNING) {\n            return;\n        }\n        this.status = LGraph.STATUS_RUNNING;\n\n        if (this.onPlayEvent) {\n            this.onPlayEvent();\n        }\n\n        this.sendEventToAllNodes(\"onStart\");\n\n        // launch\n        this.starttime = getTime();\n        this.last_update_time = this.starttime;\n        interval = interval || 0;\n        const that = this;\n\n        // execute once per frame\n        if (interval === 0 && typeof window !== \"undefined\" && window.requestAnimationFrame) {\n            // eslint-disable-next-line no-inner-declarations\n            function onFrame() {\n                if (that.execution_timer_id !== -1) {\n                    return;\n                }\n                window.requestAnimationFrame(onFrame);\n                if (that.onBeforeStep) that.onBeforeStep();\n                that.runStep(1, !that.catch_errors);\n                if (that.onAfterStep) that.onAfterStep();\n            }\n\n            this.execution_timer_id = -1;\n            onFrame();\n        } else { // execute every 'interval' ms\n            this.execution_timer_id = setInterval(() => {\n                // execute\n                if (that.onBeforeStep) that.onBeforeStep();\n                that.runStep(1, !that.catch_errors);\n                if (that.onAfterStep) that.onAfterStep();\n            }, interval);\n        }\n    }\n\n    /**\n     * Stops the execution loop of the graph\n     * @method stop execution\n     * @memberOf LGraph\n     */\n    stop() {\n        if (this.status === LGraph.STATUS_STOPPED) {\n            return;\n        }\n\n        this.status = LGraph.STATUS_STOPPED;\n\n        if (this.onStopEvent) {\n            this.onStopEvent();\n        }\n\n        if (this.execution_timer_id) {\n            if (this.execution_timer_id !== -1) {\n                clearInterval(this.execution_timer_id);\n            }\n            this.execution_timer_id = null;\n        }\n\n        this.sendEventToAllNodes(\"onStop\");\n    }\n\n    /**\n     * Run N steps (cycles) of the graph\n     * @method runStep\n     * @param {number} num number of steps to run, default is 1\n     * @param {Boolean} doNotCatchError [optional] if you want to try/catch errors\n     * @param {number} limit max number of nodes to execute (used to execute from start to a node)\n     * @memberOf LGraph\n     */\n    runStep(num, doNotCatchError, limit) {\n        num = num || 1;\n\n        const start = getTime();\n        this.globaltime = 0.001 * (start - this.starttime);\n\n        const nodes = this._nodes_executable\n            ? this._nodes_executable\n            : this._nodes;\n        if (!nodes) {\n            return;\n        }\n\n        limit = limit || nodes.length;\n\n        if (doNotCatchError) {\n            // iterations\n            for (let i = 0; i < num; i++) {\n                for (let j = 0; j < limit; j++) {\n                    const node = nodes[j];\n                    if (node.mode === defaultConfig.ALWAYS && node.onExecute) {\n                        node.onExecute(); // hard to send elapsed time\n                    }\n                }\n\n                this.fixedtime += this.fixedtime_lapse;\n                if (this.onExecuteStep) {\n                    this.onExecuteStep();\n                }\n            }\n\n            if (this.onAfterExecute) {\n                this.onAfterExecute();\n            }\n        } else {\n            try {\n                // iterations\n                for (let i = 0; i < num; i++) {\n                    for (let j = 0; j < limit; ++j) {\n                        const node = nodes[j];\n                        if (node.mode === defaultConfig.ALWAYS && node.onExecute) {\n                            node.onExecute();\n                        }\n                    }\n\n                    this.fixedtime += this.fixedtime_lapse;\n                    if (this.onExecuteStep) {\n                        this.onExecuteStep();\n                    }\n                }\n\n                if (this.onAfterExecute) {\n                    this.onAfterExecute();\n                }\n                this.errors_in_execution = false;\n            } catch (err) {\n                this.errors_in_execution = true;\n                if (defaultConfig.throw_errors) {\n                    throw err;\n                }\n                if (defaultConfig.debug) {\n                    console.log(`Error during execution: ${err}`);\n                }\n                this.stop();\n            }\n        }\n\n        const now = getTime();\n        let elapsed = now - start;\n        if (elapsed === 0) {\n            elapsed = 1;\n        }\n        this.execution_time = 0.001 * elapsed;\n        this.globaltime += 0.001 * elapsed;\n        this.iteration += 1;\n        this.elapsed_time = (now - this.last_update_time) * 0.001;\n        this.last_update_time = now;\n    }\n\n    /**\n     * Updates the graph execution order according to relevance of the nodes (nodes with only\n     * outputs have more relevance than nodes with only inputs.\n     * @method updateExecutionOrder\n     * @memberOf LGraph\n     */\n    updateExecutionOrder() {\n        this._nodes_in_order = this.computeExecutionOrder(false);\n        this._nodes_executable = [];\n        for (const node of this._nodes_in_order) {\n            if (node.onExecute) {\n                this._nodes_executable.push(node);\n            }\n        }\n    }\n\n    /**\n     * It computes the executable nodes in order and returns it\n     * @param onlyOnExecute\n     * @param setLevel\n     * @returns {this}\n     * @internal\n     * @memberOf LGraph\n     */\n    computeExecutionOrder(onlyOnExecute, setLevel) {\n        let L = [];\n        const S = [];\n        const M = {};\n        const visitedLinks = {}; // to avoid repeating links\n        const remainingLinks = {}; // to a\n\n        // search for the nodes without inputs (starting nodes)\n        for (const node of this._nodes) {\n            if (onlyOnExecute && !node.onExecute) {\n                continue;\n            }\n\n            M[node.id] = node; // add to pending nodes\n\n            let num = 0; // num of input connections\n            if (node.inputs) {\n                for (let j = 0, l2 = node.inputs.length; j < l2; j++) {\n                    if (node.inputs[j] && node.inputs[j].link != null) {\n                        num += 1;\n                    }\n                }\n            }\n\n            if (num === 0) {\n                // is a starting node\n                S.push(node);\n                if (setLevel) {\n                    node._level = 1;\n                }\n            } else {\n                if (setLevel) {\n                    node._level = 0;\n                }\n                remainingLinks[node.id] = num;\n            }\n        }\n\n        while (true) {\n            if (S.length === 0) {\n                break;\n            }\n\n            // get an starting node\n            const node = S.shift();\n            L.push(node); // add to ordered list\n            delete M[node.id]; // remove from the pending nodes\n\n            if (!node.outputs) {\n                continue;\n            }\n\n            // for every output\n            for (const output of node.outputs) {\n                if (\n                    output == null\n                    || output.links == null\n                    || output.links.length === 0\n                ) {\n                    continue;\n                }\n\n                // for every connection\n                for (const linkId of output.links) {\n                    const link = this.links[linkId];\n                    if (!link) {\n                        continue;\n                    }\n\n                    // already visited link (ignore it)\n                    if (visitedLinks[link.id]) {\n                        continue;\n                    }\n\n                    const targetNode = this.getNodeById(link.target_id);\n                    if (targetNode == null) {\n                        visitedLinks[link.id] = true;\n                        continue;\n                    }\n\n                    if (\n                        setLevel\n                        && (!targetNode._level\n                        || targetNode._level <= node._level)\n                    ) {\n                        targetNode._level = node._level + 1;\n                    }\n\n                    visitedLinks[link.id] = true; // mark as visited\n                    remainingLinks[targetNode.id] -= 1; // reduce the number of links remaining\n                    if (remainingLinks[targetNode.id] === 0) {\n                        S.push(targetNode);\n                    } // if no more links, then add to starters array\n                }\n            }\n        }\n\n        // the remaining ones (loops)\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const i in M) L.push(M[i]);\n\n        if (L.length !== this._nodes.length && defaultConfig.debug) {\n            console.warn(\"something went wrong, nodes missing\");\n        }\n\n        const l = L.length;\n\n        // save order number in the node\n        for (let i = 0; i < l; i++) L[i].order = i;\n\n        // sort now by priority\n        L = L.sort((A, B) => {\n            const Ap = A.constructor.priority || A.priority || 0;\n            const Bp = B.constructor.priority || B.priority || 0;\n            if (Ap === Bp) {\n                // if same priority, sort by order\n                return A.order - B.order;\n            }\n            return Ap - Bp; // sort by priority\n        });\n\n        // save order number in the node, again...\n        for (let i = 0; i < l; ++i) L[i].order = i;\n\n        return L;\n    }\n\n    /**\n     * Returns all the nodes that could affect this one (ancestors) by crawling all the inputs\n     * recursively. It doesn't include the node itself\n     * @method getAncestors\n     * @memberOf LGraph\n     * @return {Array} an array with all the LGraphNodes that affect this node, in order of\n     *     execution\n     */\n    // eslint-disable-next-line class-methods-use-this\n    getAncestors(node) {\n        const ancestors = [];\n        const pending = [node];\n        const visited = {};\n\n        while (pending.length) {\n            const current = pending.shift();\n            if (!current.inputs) {\n                continue;\n            }\n            if (!visited[current.id] && current !== node) {\n                visited[current.id] = true;\n                ancestors.push(current);\n            }\n\n            for (let i = 0; i < current.inputs.length; ++i) {\n                const input = current.getInputNode(i);\n                if (input && ancestors.indexOf(input) === -1) {\n                    pending.push(input);\n                }\n            }\n        }\n\n        ancestors.sort((a, b) => a.order - b.order);\n        return ancestors;\n    }\n\n    /**\n     * Positions every node in a more readable manner\n     * @method arrange\n     * @memberOf LGraph\n     */\n    arrange(margin) {\n        margin = margin || 100;\n\n        const nodes = this.computeExecutionOrder(false, true);\n        const columns = [];\n        for (const node of nodes) {\n            const col = node._level || 1;\n            if (!columns[col]) {\n                columns[col] = [];\n            }\n            columns[col].push(node);\n        }\n\n        let x = margin;\n\n        for (const column of columns) {\n            if (!column) {\n                continue;\n            }\n            let maxSize = 100;\n            let y = margin + defaultConfig.NODE_TITLE_HEIGHT;\n            for (const node of column) {\n                node.pos[0] = x;\n                node.pos[1] = y;\n                if (node.size[0] > maxSize) maxSize = node.size[0];\n                y += node.size[1] + margin + defaultConfig.NODE_TITLE_HEIGHT;\n            }\n            x += maxSize + margin;\n        }\n\n        this.setDirtyCanvas(true, true);\n    }\n\n    /**\n     * Returns the amount of time the graph has been running in milliseconds\n     * @method getTime\n     * @return {number} number of milliseconds the graph has been running\n     * @memberOf LGraph\n     */\n    getTime() {\n        return this.globaltime;\n    }\n\n    /**\n     * Returns the amount of time accumulated using the fixedtime_lapse var. This is used in\n     * context where the time increments should be constant\n     * @method getFixedTime\n     * @return {number} number of milliseconds the graph has been running\n     * @memberOf LGraph\n     */\n\n    getFixedTime() {\n        return this.fixedtime;\n    }\n\n    /**\n     * Returns the amount of time it took to compute the latest iteration. Take into account that\n     * this number could be not correct if the nodes are using graphical actions\n     * @method getElapsedTime\n     * @return {number} number of milliseconds it took the last cycle\n     * @memberOf LGraph\n     */\n\n    getElapsedTime() {\n        return this.elapsed_time;\n    }\n\n    /**\n     * Sends an event to all the nodes, useful to trigger stuff\n     * @method sendEventToAllNodes\n     * @param {String} eventname the name of the event (function to be called)\n     * @param {Array} params parameters in array format\n     * @memberOf LGraph\n     */\n    sendEventToAllNodes(eventname, params, mode) {\n        mode = mode || defaultConfig.ALWAYS;\n\n        const nodes = this._nodes_in_order ? this._nodes_in_order : this._nodes;\n        if (!nodes) {\n            return;\n        }\n\n        for (let j = 0, l = nodes.length; j < l; ++j) {\n            const node = nodes[j];\n\n            if (\n                node.constructor.name === \"Subgraph\"\n                && eventname !== \"onExecute\"\n            ) {\n                if (node.mode === mode) {\n                    node.sendEventToAllNodes(eventname, params, mode);\n                }\n                continue;\n            }\n\n            if (!node[eventname] || node.mode !== mode) {\n                continue;\n            }\n            if (params === undefined) {\n                node[eventname]();\n            } else if (params && params.constructor === Array) {\n                node[eventname](...params);\n            } else {\n                node[eventname](params);\n            }\n        }\n    }\n\n    sendActionToCanvas(action, params = []) {\n        if (!this.list_of_graphcanvas) {\n            return;\n        }\n\n        for (const c of this.list_of_graphcanvas) {\n            if (c[action]) {\n                c[action](...params);\n            }\n        }\n    }\n\n    /**\n     * Adds a new node instance to this graph\n     * @method add\n     * @param {LGraphNode} node the instance of the node\n     * @param {boolean} skipComputeOrder\n     * @memberOf LGraph\n     */\n\n    add(node, skipComputeOrder) {\n        if (!node) {\n            return;\n        }\n\n        // groups\n        if (node.constructor === LGraphGroup) {\n            this._groups.push(node);\n            this.setDirtyCanvas(true);\n            this.change();\n            node.graph = this;\n            this._version++;\n            return;\n        }\n\n        // nodes\n        if (node.id !== -1 && this._nodes_by_id[node.id]) {\n            console.warn(\n                \"LiteGraph: there is already a node with this ID, changing it\",\n            );\n            node.id = ++this.last_node_id;\n        }\n\n        if (this._nodes.length >= defaultConfig.MAX_NUMBER_OF_NODES) {\n            throw new Error(\"LiteGraph: max number of nodes in a graph reached\");\n        }\n\n        // give him an id\n        if (!node.id || node.id === -1) {\n            node.id = ++this.last_node_id;\n        } else if (this.last_node_id < node.id) {\n            this.last_node_id = node.id;\n        }\n\n        node.graph = this;\n        this._version++;\n\n        this._nodes.push(node);\n        this._nodes_by_id[node.id] = node;\n\n        if (node.onAdded) node.onAdded(this);\n\n        if (this.config.align_to_grid) node.alignToGrid();\n\n        if (!skipComputeOrder) this.updateExecutionOrder();\n\n        if (this.onNodeAdded) this.onNodeAdded(node);\n\n        this.setDirtyCanvas(true);\n        this.change();\n\n        return node; // to chain actions\n    }\n\n    /**\n     * Removes a node from the graph\n     * @method remove\n     * @param {LGraphNode} node the instance of the node\n     * @memberOf LGraph\n     */\n\n    remove(node) {\n        if (node.constructor.name === \"LGraphGroup\") {\n            const index = this._groups.indexOf(node);\n            if (index !== -1) {\n                this._groups.splice(index, 1);\n            }\n            node.graph = null;\n            this._version++;\n            this.setDirtyCanvas(true, true);\n            this.change();\n            return;\n        }\n\n        if (this._nodes_by_id[node.id] == null) {\n            return;\n        } // not found\n\n        if (node.ignore_remove) {\n            return;\n        } // cannot be removed\n\n        this.beforeChange(); // sure?\n\n        // disconnect inputs\n        if (node.inputs) {\n            for (let i = 0; i < node.inputs.length; i++) {\n                const slot = node.inputs[i];\n                if (slot.link != null) {\n                    node.disconnectInput(i);\n                }\n            }\n        }\n\n        // disconnect outputs\n        if (node.outputs) {\n            for (let i = 0; i < node.outputs.length; i++) {\n                const slot = node.outputs[i];\n                if (slot.links != null && slot.links.length) {\n                    node.disconnectOutput(i);\n                }\n            }\n        }\n\n        // node.id = -1; //why?\n\n        // callback\n        if (node.onRemoved) {\n            node.onRemoved();\n        }\n\n        node.graph = null;\n        this._version++;\n\n        // remove from canvas render\n        if (this.list_of_graphcanvas) {\n            for (const canvas of this.list_of_graphcanvas) {\n                if (canvas.selected_nodes[node.id]) {\n                    delete canvas.selected_nodes[node.id];\n                }\n                if (canvas.node_dragged === node) {\n                    canvas.node_dragged = null;\n                }\n            }\n        }\n\n        // remove from containers\n        if (this._nodes.includes(node)) {\n            this._nodes = this._nodes.filter(n => n !== node);\n        }\n        delete this._nodes_by_id[node.id];\n\n        if (this.onNodeRemoved) {\n            this.onNodeRemoved(node);\n        }\n\n        // close panels\n        this.sendActionToCanvas(\"checkPanels\");\n\n        this.setDirtyCanvas(true, true);\n        this.afterChange(); // sure?\n        this.change();\n\n        this.updateExecutionOrder();\n    }\n\n    /**\n     * Returns a node by its id.\n     * @method getNodeById\n     * @param {Number} id\n     * @memberOf LGraph\n     */\n\n    getNodeById(id) {\n        if (id == null) {\n            return null;\n        }\n        return this._nodes_by_id[id];\n    }\n\n    /**\n     * Returns a list of nodes that matches a class\n     * @method findNodesByClass\n     * @param {Class} classObject the class itself (not an string)\n     * @param {Array} result\n     * @return {Array} a list with all the nodes of this type\n     * @memberOf LGraph\n     */\n    findNodesByClass(classObject, result = []) {\n        result.length = 0;\n        for (const node of this._nodes) {\n            if (node.constructor === classObject) result.push(node);\n        }\n        return result;\n    }\n\n    /**\n     * Returns a list of nodes that matches a type\n     * @method findNodesByType\n     * @param {String} type the name of the node type\n     * @param {Array} result\n     * @return {Array} a list with all the nodes of this type\n     * @memberOf LGraph\n     */\n    findNodesByType(type, result = []) {\n        type = type.toLowerCase();\n        result = result || [];\n        result.length = 0;\n        for (const node of this._nodes) {\n            if (node.type.toLowerCase() === type) result.push(node);\n        }\n        return result;\n    }\n\n    /**\n     * Returns the first node that matches a name in its title\n     * @method findNodeByTitle\n     * @param {String} title the name of the node to search\n     * @return {Node} the node or null\n     * @memberOf LGraph\n     */\n    findNodeByTitle(title) {\n        for (const node of this._nodes) {\n            if (node.title === title) return node;\n        }\n        return null;\n    }\n\n    /**\n     * Returns a list of nodes that matches a name\n     * @method findNodesByTitle\n     * @param {String} title the name of the node to search\n     * @return {Array} a list with all the nodes with this name\n     * @memberOf LGraph\n     */\n    findNodesByTitle(title) {\n        const result = [];\n        for (const node of this._nodes) {\n            if (node.title === title) result.push(node);\n        }\n        return result;\n    }\n\n    /**\n     * Returns the top-most node in this position of the canvas\n     * @method getNodeOnPos\n     * @param {number} x the x coordinate in canvas space\n     * @param {number} y the y coordinate in canvas space\n     * @param {Array} nodesList a list with all the nodes to search from, by default is all the\n     *     nodes in the graph\n     * @param {number} margin\n     * @return {LGraphNode} the node at this position or null\n     * @memberOf LGraph\n     */\n    getNodeOnPos(x, y, nodesList = this._nodes, margin) {\n        for (const n of nodesList) {\n            if (n.isPointInside(x, y, margin)) return n;\n        }\n        return null;\n    }\n\n    /**\n     * Returns the top-most group in that position\n     * @method getGroupOnPos\n     * @param {number} x the x coordinate in canvas space\n     * @param {number} y the y coordinate in canvas space\n     * @return {LGraphGroup} the group or null\n     * @memberOf LGraph\n     */\n    getGroupOnPos(x, y) {\n        for (const g of this._groups) {\n            if (g.isPointInside(x, y, 2, true)) return g;\n        }\n        return null;\n    }\n\n    /**\n     * Checks that the node type matches the node type registered, used when replacing a nodetype\n     * by a newer version during execution this replaces the ones using the old version with the\n     * new version\n     * @method checkNodeTypes\n     * @memberOf LGraph\n     */\n    checkNodeTypes() {\n        for (let node of this._nodes) {\n            const ctor = defaultConfig.registered_node_types[node.type];\n            if (node.constructor === ctor) {\n                continue;\n            }\n            console.log(`node being replaced by newer version: ${node.type}`);\n            const newnode = LGraphNode.createNode(node.type);\n            node = newnode;\n            newnode.configure(node.serialize());\n            newnode.graph = this;\n            this._nodes_by_id[newnode.id] = newnode;\n            if (node.inputs) {\n                newnode.inputs = node.inputs.concat();\n            }\n            if (node.outputs) {\n                newnode.outputs = node.outputs.concat();\n            }\n        }\n        this.updateExecutionOrder();\n    }\n\n    onAction(action, param) {\n        this._input_nodes = this.findNodesByClass(\n            LiteGraph.GraphInput,\n            this._input_nodes,\n        );\n        for (const node of this._input_nodes) {\n            if (node.properties.name !== action) {\n                continue;\n            }\n            node.onAction(action, param);\n            break;\n        }\n    }\n\n    trigger(action, param) {\n        if (this.onTrigger) {\n            this.onTrigger(action, param);\n        }\n    }\n\n    /**\n     * Tell this graph it has a global graph input of this type\n     * @method addGlobalInput\n     * @param {String} name\n     * @param {String} type\n     * @param {*} value [optional]\n     * @memberOf LGraph\n     */\n    addInput(name, type, value) {\n        const input = this.inputs[name];\n        if (input) {\n            // already exist\n            return;\n        }\n\n        this.beforeChange();\n        this.inputs[name] = {\n            name,\n            type,\n            value,\n        };\n        this._version++;\n        this.afterChange();\n\n        if (this.onInputAdded) {\n            this.onInputAdded(name, type);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    }\n\n    /**\n     * Assign a data to the global graph input\n     * @method setGlobalInputData\n     * @param {String} name\n     * @param {*} data\n     * @memberOf LGraph\n     */\n    setInputData(name, data) {\n        const input = this.inputs[name];\n        if (!input) {\n            return;\n        }\n        input.value = data;\n    }\n\n    /**\n     * Returns the current value of a global graph input\n     * @method getInputData\n     * @param {String} name\n     * @return {*} the data\n     * @memberOf LGraph\n     */\n    getInputData(name) {\n        const input = this.inputs[name];\n        if (!input) {\n            return null;\n        }\n        return input.value;\n    }\n\n    /**\n     * Changes the newName of a global graph input\n     * @method renameInput\n     * @param {String} oldName\n     * @param {String} new_name\n     * @memberOf LGraph\n     */\n    renameInput(oldName, newName) {\n        if (newName === oldName) {\n            return;\n        }\n\n        if (!this.inputs[oldName]) {\n            return false;\n        }\n\n        if (this.inputs[newName]) {\n            console.error(\"there is already one input with that newName\");\n            return false;\n        }\n\n        this.inputs[newName] = this.inputs[oldName];\n        delete this.inputs[oldName];\n        this._version++;\n\n        if (this.onInputRenamed) {\n            this.onInputRenamed(oldName, newName);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    }\n\n    /**\n     * Changes the type of a global graph input\n     * @method changeInputType\n     * @param {String} name\n     * @param {String} type\n     * @memberOf LGraph\n     */\n    changeInputType(name, type) {\n        if (!this.inputs[name]) {\n            return false;\n        }\n\n        if (\n            this.inputs[name].type\n            && String(this.inputs[name].type).toLowerCase()\n            === String(type).toLowerCase()\n        ) {\n            return;\n        }\n\n        this.inputs[name].type = type;\n        this._version++;\n        if (this.onInputTypeChanged) {\n            this.onInputTypeChanged(name, type);\n        }\n    }\n\n    /**\n     * Removes a global graph input\n     * @method removeInput\n     * @param {String} name\n     * @memberOf LGraph\n     */\n    removeInput(name) {\n        if (!this.inputs[name]) {\n            return false;\n        }\n\n        delete this.inputs[name];\n        this._version++;\n\n        if (this.onInputRemoved) {\n            this.onInputRemoved(name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n        return true;\n    }\n\n    /**\n     * Creates a global graph output\n     * @method addOutput\n     * @param {String} name\n     * @param {String} type\n     * @param {*} value\n     * @memberOf LGraph\n     */\n    addOutput(name, type, value) {\n        this.outputs[name] = {\n            name,\n            type,\n            value,\n        };\n        this._version++;\n\n        if (this.onOutputAdded) {\n            this.onOutputAdded(name, type);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    }\n\n    /**\n     * Assign a data to the global output\n     * @method setOutputData\n     * @param {String} name\n     * @param {String} value\n     * @memberOf LGraph\n     */\n    setOutputData(name, value) {\n        const output = this.outputs[name];\n        if (!output) {\n            return;\n        }\n        output.value = value;\n    }\n\n    /**\n     * Returns the current value of a global graph output\n     * @method getOutputData\n     * @param {String} name\n     * @return {*} the data\n     * @memberOf LGraph\n     */\n    getOutputData(name) {\n        const output = this.outputs[name];\n        if (!output) {\n            return null;\n        }\n        return output.value;\n    }\n\n    /**\n     * Renames a global graph output\n     * @method renameOutput\n     * @param {String} oldName\n     * @param {String} newName\n     * @memberOf LGraph\n     */\n    renameOutput(oldName, newName) {\n        if (!this.outputs[oldName]) {\n            return false;\n        }\n\n        if (this.outputs[newName]) {\n            console.error(\"there is already one output with that newName\");\n            return false;\n        }\n\n        this.outputs[newName] = this.outputs[oldName];\n        delete this.outputs[oldName];\n        this._version++;\n\n        if (this.onOutputRenamed) {\n            this.onOutputRenamed(oldName, newName);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    }\n\n    /**\n     * Changes the type of a global graph output\n     * @method changeOutputType\n     * @param {String} name\n     * @param {String} type\n     * @memberOf LGraph\n     */\n    changeOutputType(name, type) {\n        if (!this.outputs[name]) {\n            return false;\n        }\n\n        if (\n            this.outputs[name].type\n            && String(this.outputs[name].type).toLowerCase()\n            === String(type).toLowerCase()\n        ) {\n            return;\n        }\n\n        this.outputs[name].type = type;\n        this._version++;\n        if (this.onOutputTypeChanged) {\n            this.onOutputTypeChanged(name, type);\n        }\n    }\n\n    /**\n     * Removes a global graph output\n     * @method removeOutput\n     * @param {String} name\n     * @memberOf LGraph\n     */\n    removeOutput(name) {\n        if (!this.outputs[name]) {\n            return false;\n        }\n        delete this.outputs[name];\n        this._version++;\n\n        if (this.onOutputRemoved) {\n            this.onOutputRemoved(name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n        return true;\n    }\n\n    triggerInput(name, value) {\n        const nodes = this.findNodesByTitle(name);\n        for (let i = 0; i < nodes.length; ++i) {\n            nodes[i].onTrigger(value);\n        }\n    }\n\n    setCallback(name, func) {\n        const nodes = this.findNodesByTitle(name);\n        for (let i = 0; i < nodes.length; ++i) {\n            nodes[i].setTrigger(func);\n        }\n    }\n\n    // used for undo, called before any change is made to the graph\n    beforeChange(info) {\n        if (this.onBeforeChange) {\n            this.onBeforeChange(this, info);\n        }\n        this.sendActionToCanvas(\"onBeforeChange\", this);\n    }\n\n    // used to resend actions, called after any change is made to the graph\n    afterChange(info) {\n        if (this.onAfterChange) {\n            this.onAfterChange(this, info);\n        }\n        this.sendActionToCanvas(\"onAfterChange\", this);\n    }\n\n    connectionChange(node) {\n        this.updateExecutionOrder();\n        if (this.onConnectionChange) {\n            this.onConnectionChange(node);\n        }\n        this._version++;\n        this.sendActionToCanvas(\"onConnectionChange\");\n    }\n\n    /**\n     * returns if the graph is in live mode\n     * @method isLive\n     * @memberOf LGraph\n     */\n\n    isLive() {\n        if (!this.list_of_graphcanvas) {\n            return false;\n        }\n\n        for (let i = 0; i < this.list_of_graphcanvas.length; ++i) {\n            const c = this.list_of_graphcanvas[i];\n            if (c.live_mode) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * clears the triggered slot animation in all links (stop visual animation)\n     * @method clearTriggeredSlots\n     * @memberOf LGraph\n     */\n    clearTriggeredSlots() {\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const i in this.links) {\n            const linkInfo = this.links[i];\n            if (!linkInfo) {\n                continue;\n            }\n            if (linkInfo._last_time) {\n                linkInfo._last_time = 0;\n            }\n        }\n    }\n\n    /* Called when something visually changed (not the graph!) */\n    change() {\n        if (defaultConfig.debug) {\n            console.log(\"Graph changed\");\n        }\n        this.sendActionToCanvas(\"setDirty\", [true, true]);\n        if (this.on_change) this.on_change(this);\n    }\n\n    setDirtyCanvas(fg, bg) {\n        this.sendActionToCanvas(\"setDirty\", [fg, bg]);\n    }\n\n    /**\n     * Destroys a link\n     * @method removeLink\n     * @param {Number} linkId\n     * @memberOf LGraph\n     */\n    removeLink(linkId) {\n        const link = this.links[linkId];\n        if (!link) {\n            return;\n        }\n        const node = this.getNodeById(link.target_id);\n        if (node) {\n            node.disconnectInput(link.target_slot);\n        }\n    }\n\n    // save and recover app state ***************************************\n    /**\n     * Creates a Object containing all the info about this graph, it can be serialized\n     * @method serialize\n     * @return {Object} value of the node\n     * @memberOf LGraph\n     */\n    serialize() {\n        const nodesInfo = [];\n        for (const node of this._nodes) {\n            nodesInfo.push(node.serialize());\n        }\n\n        // pack link info into a non-verbose format\n        const links = [];\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const i in this.links) {\n            // links is an OBJECT\n            let link = this.links[i];\n            if (!link.serialize) {\n                // weird bug I havent solved yet\n                console.warn(\n                    \"weird LLink bug, link info is not a LLink but a regular object\",\n                );\n                const link2 = new LLink();\n                // eslint-disable-next-line guard-for-in,no-restricted-syntax\n                for (const j in link) {\n                    link2[j] = link[j];\n                }\n                this.links[i] = link2;\n                link = link2;\n            }\n\n            links.push(link.serialize());\n        }\n\n        const groupsInfo = [];\n        for (const group of this._groups) groupsInfo.push(group.serialize());\n\n        const data = {\n            last_node_id: this.last_node_id,\n            last_link_id: this.last_link_id,\n            nodes: nodesInfo,\n            links,\n            groups: groupsInfo,\n            config: this.config,\n            extra: this.extra,\n            version: defaultConfig.VERSION,\n        };\n\n        if (this.onSerialize) this.onSerialize(data);\n\n        return data;\n    }\n\n    /**\n     * Configure a graph from a JSON string\n     * @method configure\n     * @param {String} str configure a graph from a JSON string\n     * @param {Boolean} returns if there was any error parsing\n     * @memberOf LGraph\n     */\n    configure(data, keepOld) {\n        if (!data) {\n            return;\n        }\n\n        if (!keepOld) this.clear();\n\n        const { nodes } = data;\n\n        // decode links info (they are very verbose)\n        if (data.links && data.links.constructor === Array) {\n            const links = [];\n            for (const linkData of data.links) {\n                if (!linkData) {\n                    console.warn(\"serialized graph link data contains errors, skipping.\");\n                    continue;\n                }\n                const link = new LLink();\n                link.configure(linkData);\n                links[link.id] = link;\n            }\n            data.links = links;\n        }\n\n        // copy all stored fields\n        // eslint-disable-next-line guard-for-in,no-restricted-syntax\n        for (const i in data) {\n            if (i === \"nodes\" || i === \"groups\") {\n                continue;\n            }\n            this[i] = data[i];\n        }\n\n        let error = false;\n\n        // create nodes\n        this._nodes = [];\n        if (nodes) {\n            for (const nInfo of nodes) {\n                let node = LGraphNode.createNode(nInfo.type, nInfo.title);\n                if (!node) {\n                    if (defaultConfig.debug) {\n                        console.log(\n                            `Node not found or has errors: ${nInfo.type}`,\n                        );\n                    }\n\n                    // in case of error we create a replacement node to avoid losing info\n                    node = new LGraphNode();\n                    node.last_serialization = nInfo;\n                    node.has_errors = true;\n                    error = true;\n                    // continue;\n                }\n\n                node.id = nInfo.id; // id it or it will create a new id\n                this.add(node, true); // add before configure, otherwise configure cannot create\n                // links\n            }\n\n            // configure nodes afterwards so they can reach each other\n            for (const nInfo of nodes) {\n                const node = this.getNodeById(nInfo.id);\n                if (node) {\n                    node.configure(nInfo);\n                }\n            }\n        }\n\n        // groups\n        this._groups.length = 0;\n        if (data.groups) {\n            for (const dataGroup of data.groups) {\n                const group = new LGraphGroup();\n                group.configure(dataGroup);\n                this.add(group);\n            }\n        }\n\n        this.updateExecutionOrder();\n\n        this.extra = data.extra || {};\n\n        if (this.onConfigure) this.onConfigure(data);\n\n        this._version++;\n        this.setDirtyCanvas(true, true);\n        return error;\n    }\n\n    load(url, callback) {\n        const that = this;\n\n        // from file\n        if (url.constructor === File || url.constructor === Blob) {\n            const reader = new FileReader();\n            reader.addEventListener(\"load\", (event) => {\n                const data = JSON.parse(event.target.result);\n                that.configure(data);\n                if (callback) callback();\n            });\n\n            reader.readAsText(url);\n            return;\n        }\n\n        // is a string, then an URL\n        const req = new XMLHttpRequest();\n        req.open(\"GET\", url, true);\n        req.send(null);\n        req.onload(() => {\n            if (req.status !== 200) {\n                console.error(\"Error loading graph:\", req.status, req.response);\n                return;\n            }\n            const data = JSON.parse(req.response);\n            that.configure(data);\n            if (callback) callback();\n        });\n        req.onerror((err) => {\n            console.error(\"Error loading graph:\", err);\n        });\n    }\n\n    /**\n     * Node event manager\n     * @todo Need create event\n     * @param node\n     * @param msg\n     * @param color\n     * @memberOf LGraph\n     */\n    onNodeTrace(node, msg, color) {\n        // TODO\n    }\n}\n","import { clamp } from \"./utils/math\";\n/**\n * @class CurveEditor\n * @param points\n */\nexport default class CurveEditor {\n    constructor(points) {\n        this.points = points;\n        this.selected = -1;\n        this.nearest = -1;\n        this.size = null; // stores last size used\n        this.must_update = true;\n        this.margin = 5;\n    }\n\n    sampleCurve(f, points) {\n        if (!points) return;\n        for (let i = 0; i < points.length - 1; ++i) {\n            const p = points[i];\n            const pn = points[i + 1];\n            if (pn[0] < f) continue;\n            const r = (pn[0] - p[0]);\n            if (Math.abs(r) < 0.00001) return p[1];\n            const localF = (f - p[0]) / r;\n            return p[1] * (1.0 - localF) + pn[1] * localF;\n        }\n        return 0;\n    }\n\n    draw(ctx, size, graphcanvas, backgroundColor, lineColor = \"#666\", inactive) {\n        const { points } = this;\n        if (!points) return;\n        this.size = size;\n        const w = size[0] - this.margin * 2;\n        const h = size[1] - this.margin * 2;\n\n        ctx.save();\n        ctx.translate(this.margin, this.margin);\n\n        if (backgroundColor) {\n            ctx.fillStyle = \"#111\";\n            ctx.fillRect(0, 0, w, h);\n            ctx.fillStyle = \"#222\";\n            ctx.fillRect(w * 0.5, 0, 1, h);\n            ctx.strokeStyle = \"#333\";\n            ctx.strokeRect(0, 0, w, h);\n        }\n        ctx.strokeStyle = lineColor;\n        if (inactive) ctx.globalAlpha = 0.5;\n        ctx.beginPath();\n        for (const point of points) {\n            ctx.lineTo(point[0] * w, (1.0 - point[1]) * h);\n        }\n        ctx.stroke();\n        ctx.globalAlpha = 1;\n        if (!inactive) {\n            for (let i = 0; i < points.length; ++i) {\n                const p = points[i];\n                if (this.selected === i) ctx.fillStyle = \"#FFF\";\n                else if (this.nearest === i) ctx.fillStyle = \"#DDD\";\n                else ctx.fillStyle = \"#AAA\";\n                ctx.beginPath();\n                ctx.arc(p[0] * w, (1.0 - p[1]) * h, 2, 0, Math.PI * 2);\n                ctx.fill();\n            }\n        }\n        ctx.restore();\n    }\n\n    onMouseDown(localpos, graphcanvas) {\n        const { points } = this;\n        if (!points) return;\n        if (localpos[1] < 0) return;\n\n        // this.captureInput(true);\n        const w = this.size[0] - this.margin * 2;\n        const h = this.size[1] - this.margin * 2;\n        const x = localpos[0] - this.margin;\n        const y = localpos[1] - this.margin;\n        const pos = [x, y];\n        const maxDist = 30 / graphcanvas.ds.scale;\n        // search closer one\n        this.selected = this.getCloserPoint(pos, maxDist);\n        // create one\n        if (this.selected === -1) {\n            const point = [x / w, 1 - y / h];\n            points.push(point);\n            points.sort((a, b) => a[0] - b[0]);\n            this.selected = points.indexOf(point);\n            this.must_update = true;\n        }\n        if (this.selected !== -1) return true;\n    }\n\n    onMouseMove(localpos, graphcanvas) {\n        const { points } = this;\n        if (!points) return;\n        const s = this.selected;\n        if (s < 0) return;\n        const x = (localpos[0] - this.margin) / (this.size[0] - this.margin * 2);\n        const y = (localpos[1] - this.margin) / (this.size[1] - this.margin * 2);\n        const curvepos = [(localpos[0] - this.margin), (localpos[1] - this.margin)];\n        const maxDist = 30 / graphcanvas.ds.scale;\n        this._nearest = this.getCloserPoint(curvepos, maxDist);\n        const point = points[s];\n        if (point) {\n            const isEdgePoint = s === 0 || s === points.length - 1;\n            if (!isEdgePoint\n                && (localpos[0] < -10\n                    || localpos[0] > this.size[0] + 10\n                    || localpos[1] < -10\n                    || localpos[1] > this.size[1] + 10)) {\n                points.splice(s, 1);\n                this.selected = -1;\n                return;\n            }\n            if (!isEdgePoint) {\n                point[0] = clamp(x, 0, 1);\n            } else {\n                point[0] = s === 0 ? 0 : 1;\n            }\n            point[1] = 1.0 - clamp(y, 0, 1);\n            points.sort((a, b) => a[0] - b[0]);\n            this.selected = points.indexOf(point);\n            this.must_update = true;\n        }\n    }\n\n    onMouseUp() {\n        this.selected = -1;\n        return false;\n    }\n\n    getCloserPoint(pos, maxDist = 30) {\n        const { points } = this;\n        if (!points) return -1;\n        const w = (this.size[0] - this.margin * 2);\n        const h = (this.size[1] - this.margin * 2);\n        const num = points.length;\n        const p2 = [0, 0];\n        let minDist = 1000000;\n        let closest = -1;\n        let lastValid = -1;\n        for (let i = 0; i < num; ++i) {\n            const p = points[i];\n            p2[0] = p[0] * w;\n            p2[1] = (1.0 - p[1]) * h;\n            // eslint-disable-next-line no-unused-vars\n            if (p2[0] < pos[0]) lastValid = i;\n            const dist = vec2.distance(pos, p2);\n            if (dist > minDist || dist > maxDist) continue;\n            closest = i;\n            minDist = dist;\n        }\n        return closest;\n    }\n}\n","// Creates an interface to access extra features from a graph (like play, stop, live, etc)\nimport LGraph from \"./LGraph\";\nimport LGraphCanvas from \"./LGraphCanvas\";\n\n/**\n * @class Editor\n * @param containerId\n * @param options\n */\nexport default class Editor {\n    constructor(containerId, options) {\n        options = options || {};\n\n        // fill container\n        const html = \"<div class='content'><div class='editor-area'><canvas class='graphcanvas' width='1000' height='500' tabindex=10></canvas></div></div>\";\n\n        const root = document.createElement(\"div\");\n        this.root = root;\n        root.className = \"litegraph litegraph-editor\";\n        root.innerHTML = html;\n\n        this.content = root.querySelector(\".content\");\n        this.footer = root.querySelector(\".footer\");\n\n        const canvas = root.querySelector(\".graphcanvas\");\n\n        // create graph\n        const graph = (this.graph = new LGraph());\n        const graphcanvas = (this.graphcanvas = new LGraphCanvas(canvas, graph));\n        graphcanvas.background_image = \"imgs/grid.png\";\n        graph.onAfterExecute = function () {\n            graphcanvas.draw(true);\n        };\n\n        graphcanvas.onDropItem = this.onDropItem.bind(this);\n\n        if (options.miniwindow) {\n            this.addMiniWindow(300, 200);\n        }\n\n        // append to DOM\n        const parent = document.getElementById(containerId);\n        if (parent) {\n            parent.appendChild(root);\n        }\n\n        graphcanvas.resize();\n        // graphcanvas.draw(true,true);\n    }\n\n    onDropItem(e) {\n        for (const file of e.dataTransfer.files) {\n            const ext = LGraphCanvas.getFileExtension(file.name);\n            const reader = new FileReader();\n            if (ext === \"json\") {\n                reader.onload = (event) => {\n                    this.graph.configure(JSON.parse(event.target.result));\n                };\n                reader.readAsText(file);\n            }\n        }\n    }\n\n    addMiniWindow(w, h) {\n        const miniwindow = document.createElement(\"div\");\n        miniwindow.className = \"litegraph miniwindow\";\n        miniwindow.innerHTML = `<canvas class='graphcanvas' width='${\n            w\n        }' height='${\n            h\n        }' tabindex=10></canvas>`;\n        const canvas = miniwindow.querySelector(\"canvas\");\n        const that = this;\n\n        const graphcanvas = new LGraphCanvas(canvas, this.graph);\n        graphcanvas.show_info = false;\n        graphcanvas.background_image = \"imgs/grid.png\";\n        graphcanvas.scale = 0.25;\n        graphcanvas.allow_dragnodes = false;\n        graphcanvas.allow_interaction = false;\n        graphcanvas.render_shadows = false;\n        graphcanvas.max_zoom = 0.25;\n        this.miniwindow_graphcanvas = graphcanvas;\n        graphcanvas.onClear = function () {\n            graphcanvas.scale = 0.25;\n            graphcanvas.allow_dragnodes = false;\n            graphcanvas.allow_interaction = false;\n        };\n        graphcanvas.onRenderBackground = function (canvas, ctx) {\n            ctx.strokeStyle = \"#567\";\n            let tl = that.graphcanvas.convertOffsetToCanvas([0, 0]);\n            let br = that.graphcanvas.convertOffsetToCanvas([\n                that.graphcanvas.canvas.width,\n                that.graphcanvas.canvas.height,\n            ]);\n            tl = this.convertCanvasToOffset(tl);\n            br = this.convertCanvasToOffset(br);\n            ctx.lineWidth = 1;\n            ctx.strokeRect(\n                Math.floor(tl[0]) + 0.5,\n                Math.floor(tl[1]) + 0.5,\n                Math.floor(br[0] - tl[0]),\n                Math.floor(br[1] - tl[1]),\n            );\n        };\n\n        miniwindow.style.position = \"absolute\";\n        miniwindow.style.top = \"4px\";\n        miniwindow.style.right = \"4px\";\n\n        const closeBouton = document.createElement(\"div\");\n        closeBouton.className = \"corner-button\";\n        closeBouton.innerHTML = \"&#10060;\";\n        closeBouton.addEventListener(\"click\", (e) => {\n            graphcanvas.setGraph(null);\n            miniwindow.remove();\n        });\n        miniwindow.appendChild(closeBouton);\n\n        this.root.querySelector(\".content\").appendChild(miniwindow);\n    }\n}\n","import \"../css/litegraph.css\";\nimport \"../css/litegraph-editor.css\";\n\nexport { default as LGraph } from \"./LGraph\";\nexport { default as LLink } from \"./LLink\";\nexport { default as LGraphNode } from \"./LGraphNode\";\nexport { default as LGraphGroup } from \"./LGraphGroup\";\nexport { default as DragAndScale } from \"./DragAndScale\";\nexport { default as CurveEditor } from \"./CurveEditor\";\nexport { default as LGraphCanvas } from \"./LGraphCanvas\";\nexport { default as ContextMenu } from \"./ContextMenu\";\nexport { default as Editor } from \"./litegraph-editor\";\n\nexport { default as defaultConfig } from \"./utils/defaultConfig\";\nexport * from \"./utils/registry\";\nexport * from \"./utils/math\";\nexport * from \"./utils/function\";\n\nif (typeof CanvasRenderingContext2D !== \"undefined\") {\n    CanvasRenderingContext2D.prototype.roundRect = function roundRect(\n        x,\n        y,\n        width,\n        height,\n        radius = 5,\n        radiusLow = radius,\n    ) {\n        this.moveTo(x + radius, y);\n        this.lineTo(x + width - radius, y);\n        this.quadraticCurveTo(x + width, y, x + width, y + radius);\n\n        this.lineTo(x + width, y + height - radiusLow);\n        this.quadraticCurveTo(\n            x + width,\n            y + height,\n            x + width - radiusLow,\n            y + height,\n        );\n        this.lineTo(x + radiusLow, y + height);\n        this.quadraticCurveTo(x, y + height, x, y + height - radiusLow);\n        this.lineTo(x, y + radius);\n        this.quadraticCurveTo(x, y, x + radius, y);\n    };\n}\n"],"names":["VERSION","CANVAS_GRID_SIZE","NODE_TITLE_HEIGHT","NODE_TITLE_TEXT_Y","NODE_SLOT_HEIGHT","NODE_WIDGET_HEIGHT","NODE_WIDTH","NODE_MIN_WIDTH","NODE_COLLAPSED_RADIUS","NODE_COLLAPSED_WIDTH","NODE_TITLE_COLOR","NODE_SELECTED_TITLE_COLOR","NODE_TEXT_SIZE","NODE_TEXT_COLOR","NODE_SUBTEXT_SIZE","NODE_DEFAULT_COLOR","NODE_DEFAULT_BGCOLOR","NODE_DEFAULT_BOXCOLOR","NODE_DEFAULT_SHAPE","NODE_BOX_OUTLINE_COLOR","DEFAULT_SHADOW_COLOR","DEFAULT_GROUP_FONT","WIDGET_BGCOLOR","WIDGET_OUTLINE_COLOR","WIDGET_TEXT_COLOR","WIDGET_SECONDARY_TEXT_COLOR","LINK_COLOR","EVENT_LINK_COLOR","CONNECTING_LINK_COLOR","MAX_NUMBER_OF_NODES","DEFAULT_POSITION","VALID_SHAPES","BOX_SHAPE","ROUND_SHAPE","CIRCLE_SHAPE","CARD_SHAPE","ARROW_SHAPE","INPUT","OUTPUT","EVENT","ACTION","ALWAYS","ON_EVENT","NEVER","ON_TRIGGER","UP","DOWN","LEFT","RIGHT","CENTER","STRAIGHT_LINK","LINEAR_LINK","SPLINE_LINK","NORMAL_TITLE","NO_TITLE","TRANSPARENT_TITLE","AUTOHIDE_TITLE","proxy","node_images_path","debug","catch_exceptions","throw_errors","allow_scripts","registered_node_types","node_types_by_file_extension","Nodes","Globals","searchbox_extras","auto_sort_node_types","getTime","performance","now","Date","process","t","hrtime","cloneObject","obj","target","r","JSON","parse","stringify","i","unregisterNodeType","type","baseClass","constructor","String","defaultConfig","Error","name","registerNodeType","prototype","TypeError","console","log","classname","pos","lastIndexOf","category","substr","title","prev","Object","hasOwnProperty","call","defineProperty","set","v","_shape","get","enumerable","configurable","onPropertyChange","warn","supported_extensions","ext","toLowerCase","onNodeTypeRegistered","onNodeTypeReplaced","clearRegisteredTypes","getNodeType","getNodeTypesInCategory","filter","push","sort","registerSearchboxExtra","nodeType","description","data","desc","getNodeTypesCategories","categories","id","skip_list","result","getParameterNames","func","replace","split","Boolean","wrapFunctionAsNode","paramType","returnType","properties","params","Array","length","code","names","classobj","Function","pop","onExecute","getInputData","apply","setOutputData","isValidConnection","typeA","typeB","indexOf","supportedTypesA","supportedTypesB","j","LLink","origin_id","origin_slot","target_id","target_slot","_data","_pos","Float32Array","o","distance","a","b","Math","sqrt","isInsideRectangle","x","y","left","top","width","height","overlapBounding","AEndX","AEndY","BEndX","BEndY","clamp","LGraphNode","size","graph","inputs","outputs","connections","properties_info","flags","info","_version","k","onPropertyChanged","configure","onConnectionsChange","input","linkInfo","links","link","output","widgets","widget","options","property","value","widgets_values","onConfigure","order","mode","last_serialization","serialize_widgets","color","bgcolor","boxcolor","shape","onSerialize","node","createNode","serialize","prevValue","w","slot","output_info","link_id","forceUpdate","linkId","getNodeById","updateOutputData","slot_name","force_update","findInputSlot","slot_info","link_info","l","input_info","target_node","action","param","_last_trigger_time","triggerSlot","_last_time","target_connection","onAction","onResize","default_value","extra_info","onOutputAdded","setSize","computeSize","setDirtyCanvas","array","disconnectOutput","splice","onOutputRemoved","onInputAdded","disconnectInput","onInputRemoved","direction","out","concat","rows","max","font_size","title_width","compute_text_size","input_width","output_width","text","label","text_width","slot_start_y","widgets_height","widgets_up","widgets_start_y","min_height","widgets_info","onGetPropertyInfo","callback","values","custom_widget","onBounding","margin","skip_title","margin_top","isLive","collapsed","_collapsed_width","link_pos","getConnectionPos","findOutputSlot","Number","changed","beforeChange","onConnectInput","connectionChange","last_link_id","onNodeConnectionChange","afterChange","is_input","slot_number","num_slots","offset","horizontal","round","msg","MAX_CONSOLE","shift","onNodeTrace","dirty_foreground","dirty_background","sendActionToCanvas","url","img","Image","src","ready","onload","list_of_graphcanvas","list","c","node_capturing_input","force","collapsable","undefined","pinned","graphcanvas","scale","err","error","folderWildcard","tmp","document","getElementsByTagName","scriptFiles","docHeadObj","location","href","script","dynamicScript","createElement","appendChild","removeChild","object","getOwnPropertyNames","LGraphGroup","isPointInside","_ctor","_bounding","subarray","_size","_nodes","nodes","node_bounding","getBounding","deltax","deltay","ignore_nodes","bounding","font","DragAndScale","element","skipEvents","max_scale","min_scale","onredraw","enabled","last_mouse","visible_area","bindEvents","_binded_mouse_callback","onMouse","bind","addEventListener","startx","starty","endx","endy","e","canvas","rect","getBoundingClientRect","clientX","clientY","canvasx","canvasy","dragging","ignore","onmouse","removeEventListener","body","mouseDrag","eventType","wheel","deltaY","wheelDeltaY","detail","wheelDelta","delta","changeDeltaScale","preventDefault","stopPropagation","ctx","translate","zoomingCenter","center","convertCanvasToOffset","abs","newCenter","deltaOffset","changeScale","getFileExtension","question","point","ContextMenu","that","parentMenu","lock","current_submenu","eventClass","event","root","className","style","minWidth","minHeight","pointerEvents","setTimeout","button","close","on_mouse_wheel","parseInt","scroll_speed","toFixed","innerHTML","content","addItem","closing_timer","clearTimeout","rootDocument","ownerDocument","fullscreenElement","bodyRect","rootRect","transform","disabled","classList","add","submenu","has_submenu","dataset","onclick_callback","inner_onclick","autoopen","inner_over","closeParent","ignore_item_callbacks","extra","ignoreParentMenu","parentNode","remove","isCursorOverElement","trigger","getTopMenu","getFirstEvent","eventName","evt","createEvent","initCustomEvent","dispatchEvent","__events","ref_window","window","elements","querySelectorAll","el","re","temp","tempVC2","tempArea","marginArea","linkBounding","tempA","tempB","LGraphCanvas","active_canvas","dialog","search_box","focus","overflow","timeoutClose","ds","helper","querySelector","first","timeout","selected","keyCode","changeSelection","select","clearInterval","refreshHelper","stopImmediatePropagation","layerY","maxHeight","onSearchBoxSelection","convertEventToCanvasOffset","addProperty","addOutput","json","forward","childNodes","nextSibling","previousSibling","scrollIntoView","block","behavior","str","onSearchBox","addResult","ctor","search_limit","keys","filtered","filteredItem","help","innerText","escape","unescape","SELECTED_NODE","panel","refWindow","getCanvasWindow","createPanel","closable","inner_refresh","addHTML","getPropertyInfo","onAddPropertyToPanel","addWidget","setProperty","dirty_canvas","addSeparator","onShowCustomPanelInfo","addButton","block_delete","background_image","DEFAULT_BACKGROUND_IMAGE","zoom_modify_alpha","title_text_font","inner_text_font","node_title_color","default_link_color","default_connection_color","input_off","input_on","output_off","output_on","highquality_render","use_gradients","editor_alpha","pause_rendering","clear_background","read_only","render_only_selected","live_mode","show_info","allow_dragcanvas","allow_dragnodes","allow_interaction","allow_searchbox","allow_reconnect_links","drag_mode","dragging_rectangle","set_canvas_dirty_on_mouse_event","always_render_background","render_shadows","render_canvas_border","render_connections_shadows","render_connections_border","render_curved_connections","render_connection_arrows","render_collapsed_slots","render_execution_order","render_title_colored","render_link_tooltip","links_render_mode","mouse","graph_mouse","canvas_mouse","onDrawBackground","onDrawForeground","onDrawOverlay","onDrawLinkTooltip","onNodeMoved","onSelectionChange","onConnectingChange","onBeforeChange","onAfterChange","connections_width","round_radius","current_node","node_widget","over_link_center","last_mouse_position","visible_links","attachCanvas","setCanvas","clear","skip_render","startRendering","autoresize","frame","last_draw_time","render_time","fps","selected_nodes","selected_group","visible_nodes","node_dragged","node_over","connecting_node","highlighted_links","dragging_canvas","dirty_bgcanvas","dirty_area","node_in_panel","last_mouseclick","onClear","skipClear","detachCanvas","_graph_stack","setDirty","checkPanels","subgraphNode","_subgraph_node","centerOnNode","selectNodes","getElementById","unbindEvents","tabindex","bgcanvas","getContext","localName","webgl_enabled","enableWebGL","_mousemove_callback","processMouseMove","_mouseup_callback","processMouseUp","_events_binded","_mousedown_callback","processMouseDown","_mousewheel_callback","processMouseWheel","_doNothing","touchHandler","_key_callback","processKey","_ondrop_callback","processDrop","_doReturnTrue","GL","enableWebGLCanvas","gl","webgl","bgctx","fgcanvas","doc","defaultView","is_rendering","renderFrame","draw","requestAnimationFrame","block_click","adjustMouseEvent","getNodeOnPos","canvasX","canvasY","skipAction","isDoubleClick","localX","localY","last_click_position","closeAllContextMenus","which","ctrlKey","clickingCanvasBg","bringToFront","resizable","resizing_node","cursor","linkPos","connecting_output","connecting_pos","connecting_slot","shiftKey","onOutputDblClick","onOutputClick","onInputDblClick","onInputClick","_nodes_by_id","blockDragNote","processNodeWidgets","onDblClick","processNodeDblClicked","onMouseDown","subgraph","skip_subgraph_button","openSubgraph","processNodeSelected","showLinkMenu","getGroupOnPos","selected_group_resizing","dist","recomputeInsideNodes","showSearchBox","processContextMenu","last_mouse_dragging","change","activeElement","nodeName","resize","move","_node","mouseOver","onMouseLeave","redraw_on_mouse","onMouseEnter","onMouseMove","_highlight_input","isOverNodeBox","isOverNodeInput","slotType","overLink","nKeys","n","desiredSize","minSize","click_time","diffx","diffy","nodeBounding","deselectAllNodes","h","toSelect","connect","getInputInfo","collapse","config","align_to_grid","alignToGrid","onMouseUp","titleHeight","slotPos","isInside","blockDefault","metaKey","copyToClipboard","pasteFromClipboard","deleteSelectedNodes","onKeyDown","onKeyUp","localStorage","getItem","clipboardInfo","node_data","origin_node","index","selectedNodesArray","relative_id","cloned","clone","_relative_id","setItem","onDropItem","checkDropItem","onDropFile","onDropData","files","dataTransfer","file","filename","reader","FileReader","readAsText","readAsDataURL","readAsArrayBuffer","nodetype","onShowNodePanel","showShowNodePanel","onNodeDblClicked","selectNode","onNodeSelected","addToCurrentSelection","is_selected","onSelected","onDeselected","onNodeDeselected","inputLink","outputLink","inputNode","getInputNode","outputNode","getOutputNodes","deltaX","convertOffsetToCanvas","unshift","visibleNodes","force_canvas","force_bgcanvas","computeVisibleArea","drawBackCanvas","drawFrontCanvas","start2D","restore","setTransform","save","beginPath","clip","clearRect","drawImage","onRender","renderInfo","toCanvasContext","drawnNodes","computeVisibleNodes","drawNode","drawExecutionOrder","links_ontop","drawConnections","lineWidth","linkColor","renderLink","dir","arc","PI","fill","fillStyle","strokeStyle","strokeRect","drawLinkTooltip","visible_rect","drawSubgraphPanel","finish2D","subnode","num","floor","globalAlpha","roundRect","textAlign","fillText","drawButton","closeSubgraph","not_subgraph_input","input_node_type","newnode","tw","measureText","showSubgraphPropertiesDialog","hovercolor","textcolor","hover","clicked","blockClick","holdClick","globaltime","iteration","start","g","getTitle","bgAlreadyPainted","onRenderBackground","imageSmoothingEnabled","mozImageSmoothingEnabled","_bg_img","pattern","_pattern","createPattern","_pattern_img","fillRect","_groups","drawGroups","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","finish","glow","lowQuality","onDrawCollapsed","min","clip_area","has_errors","drawNodeShape","renderText","outSlot","maxY","color_on","color_off","moveTo","lineTo","closePath","stroke","widgetsY","drawNodeWidgets","inputSlot","outputSlot","storedSlot","toToolTip","fgcolor","mouseHover","title_mode","renderTitle","area","oldAlpha","onDrawTitleBar","title_color","titleColor","grad","gradients","createLinearGradient","addColorStop","boxSize","onDrawTitleBox","includes","onDrawTitleText","title_text_color","over","onDrawTitle","startNode","startNodeSlot","startNodeSlotPos","endNodeSlotPos","startSlot","endSlot","startDir","endDir","f","skipBorder","flow","numSubline","link_type_colors","lineJoin","offsety","startOffsetX","startOffsetY","endOffsetX","endOffsetY","bezierCurveTo","startX","startY","endX","endY","posConnectionPoint","computeConnectionPoint","posA","posB","posC","posD","angleA","angleB","atan2","rotate","p0","p1","p2","p3","c1","c2","c3","c4","posY","active_widget","H","showText","outlineColor","backgroundColor","textColor","secondaryTextColor","last_y","widgetWidth","on","off","range","nvalue","marker","marker_nvalue","precision","activeWidget","widgetHeight","oldValue","innerValueChange","step","valuesList","innerClicked","option","textValues","menu","prompt","multiline","onWidgetChanged","groups","group","fontSize","DEFAULT_GROUP_FONT_SIZE","parent","offsetWidth","offsetHeight","transition","setInterval","touches","changedTouches","simulatedEvent","initMouseEvent","screenX","screenY","onMenuAdd","nodeLeft","nodeRight","removeLink","modified","prompt_box","nameElement","valueElement","offsetx","inputHTML","createDialog","setValue","checked","onclose","html","position","header","title_element","footer","onFooter","elem","strValue","toString","propname","toggle","innerChange","setAttribute","blur","proptype","getPropertyPrintableValue","old_panel","removeInput","addInput","panels","getMenuOptions","onGroupAdd","getExtraMenuOptions","showMenuNodeOptionalInputs","showMenuNodeOptionalOutputs","onShowMenuNodeProperties","onShowPropertyEditor","onMenuNodeMode","onResizeNode","onMenuNodeCollapse","onMenuNodePin","onMenuNodeColors","onMenuNodeShapes","onGetInputs","onGetOutputs","clonable","onMenuNodeClone","removable","onMenuNodeRemove","onGetNodeMenuOptions","menuInfo","inner_option_clicked","getSlotInPosition","active_node","getSlotMenuOptions","_slot","locked","nameLocked","getNodeMenuOptions","getCanvasMenuOptions","getGroupMenuOptions","removeOutput","slotInfo","getOutputInfo","entry","mouseEvent","previousMenu","inner_onMenuAdded","base_category","prev_menu","registry","startsWith","entries","forEach","base_category_regex","RegExp","category_name","category_path","findIndex","contextMenu","slice","first_event","optionsParam","optional_inputs","onMenuNodeInputs","optional_outputs","skip_repeated_outputs","onMenuNodeOutputs","decodeHTML","allow_html","showEditPropertyValue","item","desc_value","pin","node_colors","groupcolor","nodesList","buildFromNodes","number","red","brown","green","blue","pale_blue","cyan","purple","yellow","black","LGraph","supportedTypes","stop","status","STATUS_STOPPED","last_node_id","onRemoved","_nodes_in_order","_nodes_executable","vars","runningtime","fixedtime","fixedtime_lapse","elapsed_time","last_update_time","starttime","catch_errors","interval","STATUS_RUNNING","onPlayEvent","sendEventToAllNodes","onFrame","execution_timer_id","onBeforeStep","runStep","onAfterStep","onStopEvent","doNotCatchError","limit","onExecuteStep","onAfterExecute","errors_in_execution","elapsed","execution_time","computeExecutionOrder","onlyOnExecute","setLevel","L","S","M","visitedLinks","remainingLinks","l2","_level","targetNode","A","B","Ap","priority","Bp","ancestors","pending","visited","current","columns","col","column","maxSize","eventname","skipComputeOrder","onAdded","updateExecutionOrder","onNodeAdded","ignore_remove","onNodeRemoved","classObject","_input_nodes","findNodesByClass","LiteGraph","GraphInput","onTrigger","onInputsOutputsChange","oldName","newName","onInputRenamed","onInputTypeChanged","onOutputRenamed","onOutputTypeChanged","findNodesByTitle","setTrigger","onConnectionChange","on_change","fg","bg","nodesInfo","link2","groupsInfo","version","keepOld","linkData","nInfo","dataGroup","File","Blob","req","XMLHttpRequest","open","send","response","onerror","CurveEditor","points","nearest","must_update","p","pn","localF","lineColor","inactive","localpos","maxDist","getCloserPoint","s","curvepos","_nearest","isEdgePoint","minDist","closest","lastValid","vec2","Editor","containerId","miniwindow","addMiniWindow","max_zoom","miniwindow_graphcanvas","tl","br","right","closeBouton","setGraph","CanvasRenderingContext2D","radius","radiusLow","quadraticCurveTo"],"mappings":"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"}